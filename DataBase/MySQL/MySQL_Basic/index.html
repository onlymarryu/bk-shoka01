<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="记录“美食”每刻" href="https://eth168.top/rss.xml"><link rel="alternate" type="application/atom+xml" title="记录“美食”每刻" href="https://eth168.top/atom.xml"><link rel="alternate" type="application/json" title="记录“美食”每刻" href="https://eth168.top/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="数据库,MySQL"><link rel="canonical" href="https://eth168.top/DataBase/MySQL/MySQL_Basic/"><title>MySQL 基础 - MySQL - 数据库 | 雾都博客 = 记录 “美食” 每刻</title><meta name="generator" content="Hexo 6.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">MySQL 基础</h1><div class="meta"><span class="item" title="创建时间：2021-11-02 00:00:00"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2021-11-02T00:00:00+08:00">2021-11-02</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>41k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>37 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">雾都博客</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gicivghyooj20zk0m8dir.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gipet8c1a2j20zk0m8kct.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1giclgi503lj20zk0m8hdt.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1giclh0m9pdj20zk0m8hdt.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gicis3attqj20zk0m8k7l.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gicit4jrvuj20zk0m8785.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" itemprop="item" rel="index" title="分类于 数据库"><span itemprop="name">数据库</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/MySQL/" itemprop="item" rel="index" title="分类于 MySQL"><span itemprop="name">MySQL</span></a><meta itemprop="position" content="2"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://eth168.top/DataBase/MySQL/MySQL_Basic/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="雾都"><meta itemprop="description" content=", 记录 “美食” 每刻"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="记录 “美食” 每刻"></span><div class="body md" itemprop="articleBody"><h1 id="数据库基本概念"><a class="anchor" href="#数据库基本概念">#</a> 数据库基本概念</h1><p>（1）数据<br>所谓数据（Data）是指对客观事物进行描述并可以鉴别的符号，这些符号是可识别的、抽象的。它不仅仅指狭义上的数字，而是有多种表现形式：字母、文字、文本、图形、音频、视频等。现在计算机存储和处理的数据范围十分广泛，而描述这些数据的符号也变得越来越复杂了。</p><p>（2）数据库<br>数据库（Database，DB）指的是以一定格式存放、能够实现多个用户共享、与应用程序彼此独立的数据集合。</p><p>（3）数据库管理系统<br>数据库管理系统（Database Management System，DBMS）是用来定义和管理数据的软件。如何科学的组织和存储数据，如何高效的获取和维护数据，如何保证数据的安全性和完整性，这些都需要靠数据库管理系统完成。目前，比较流行的数据库管理系统有：Oracle、MySQL、SQL Server、DB2 等。</p><p>（4）数据库应用程序<br>数据库应用程序（Database Application System，DBAS）是在数据库管理系统基础上，使用数据库管理系统的语法，开发的直接面对最终用户的应用程序，如学生管理系统、人事管理系统、图书管理系统等。</p><p>（5）数据库管理员<br>数据库管理员（Database Administrator，DBA）是指对数据库管理系统进行操作的人员，其主要负责数据库的运营和维护。</p><p>（6）最终用户<br>最终用户（User）指的是数据库应用程序的使用者。用户面向的是数据库应用程序（通过应用程序操作数据），并不会直接与数据库打交道。</p><p>（7） 数据库系统<br>数据库系统（Database System，DBS）一般是由数据库、数据库管理系统、数据库应用程序、数据库管理员和最终用户构成。其中 DBMS 是数据库系统的基础和核心。</p><img data-src="/DataBase/MySQL/MySQL_Basic/image-20221027160110791.png" title="image-20221027160110791"><h1 id="mysql介绍"><a class="anchor" href="#mysql介绍">#</a> MySQL 介绍</h1><p>MySQL 数据库最初是由瑞典 MySQL AB 公司开发，2008 年 1 月 16 号被 Sun 公司收购。2009 年，SUN 又被 Oracle 收购。MySQL 是目前 IT 行业最流行的开放源代码的数据库管理系统，同时它也是一个支持多线程高并发多用户的关系型数据库管理系统。MySQL 之所以受到业界人士的青睐，主要是因为其具有以下几方面优点：</p><ol><li>开放源代码<br>MySQL 最强大的优势之一在于它是一个开放源代码的数据库管理系统。开源的特点是给予了用户根据自己需要修改 DBMS 的自由。MySQL 采用了 General Public License，这意味着授予用户阅读、修改和优化源代码的权利，这样即使是免费版的 MySQL 的功能也足够强大，这也是为什么 MySQL 越来越受欢迎的主要原因。</li><li>跨平台<br>MySQL 可以在不同的操作系统下运行，简单地说，MySQL 可以支持 Windows 系统、UNIX 系统、Linux 系统等多种操作系统平台。这意味着在一个操作系统中实现的应用程序可以很方便地移植到其他的操作系统下。</li><li>轻量级<br>MySQL 的核心程序完全采用多线程编程，这些线程都是轻量级的进程，它在灵活地为用户提供服务的同时，又不会占用过多的系统资源。因此 MySQL 能够更快速、高效的处理数据。</li><li>成本低<br>MySQL 分为社区版和企业版，社区版是完全免费的，而企业版是收费的。即使在开发中需要用到一些付费的附加功能，价格相对于昂贵的 Oracle、DB2 等也是有很大优势的。其实免费的社区版也支持多种数据类型和正规的 SQL 查询语言，能够对数据进行各种查询、增加、删除、修改等操作，所以一般情况下社区版就可以满足开发需求了，而对数据库可靠性要求比较高的企业可以选择企业版。<br>另外，PHP 中提供了一整套的 MySQL 函数，对 MySQL 进行了全方位的强力支持。<br>总体来说，MySQL 是一款开源的、免费的、轻量级的关系型数据库，其具有体积小、速度快、成本低、开放源码等优点，其发展前景是无可限量的。</li></ol><p>PS：社区版与企业版主要的区别是：</p><ol><li>社区版包含所有 MySQL 的最新功能，而企业版只包含稳定之后的功能。换句话说，社区版可以理解为是企业版的测试版。<br>2.MySQL 官方的支持服务只是针对企业版，如果用户在使用社区版时出现了问题，MySQL 官方是不负责任的。</li></ol><h1 id="mysql安装"><a class="anchor" href="#mysql安装">#</a> MySQL 安装</h1><h2 id="1-卸载原来的版本"><a class="anchor" href="#1-卸载原来的版本">#</a> 1、卸载原来的版本</h2><h3 id="1-查看mysql的安装情况"><a class="anchor" href="#1-查看mysql的安装情况">#</a> 1、查看 mysql 的安装情况</h3><figure class="highlight sh"><figcaption data-lang="sh"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">rpm</span> <span class="token parameter variable">-qa</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-i</span> mysql</pre></td></tr></table></figure><img data-src="/DataBase/MySQL/MySQL_Basic/1570605325400.png"><h3 id="2-删除上图安装的软件"><a class="anchor" href="#2-删除上图安装的软件">#</a> 2、删除上图安装的软件</h3><figure class="highlight sh"><figcaption data-lang="sh"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">rpm</span> <span class="token parameter variable">-ev</span> <span class="token parameter variable">--nodeps</span> mysql57-community-release-el5-7.noarch</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">rpm</span> <span class="token parameter variable">-ev</span> <span class="token parameter variable">--nodeps</span> mysql-community-server-5.7.18-1.el5.x86_64</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token function">rpm</span> <span class="token parameter variable">-ev</span> <span class="token parameter variable">--nodeps</span> mysql-community-client-5.7.18-1.el5.x86_64</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token function">rpm</span> <span class="token parameter variable">-ev</span> <span class="token parameter variable">--nodeps</span> mysql-community-libs-5.7.18-1.el5.x86_64</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token function">rpm</span> <span class="token parameter variable">-ev</span> <span class="token parameter variable">--nodeps</span> mysql-community-common-5.7.18-1.el5.x86_64</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token function">rpm</span> <span class="token parameter variable">-ev</span> <span class="token parameter variable">--nodeps</span> mysql-5.7.18-1.el5.x86_64</pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token function">rpm</span> <span class="token parameter variable">-ev</span> <span class="token parameter variable">--nodeps</span> mysql-community-libs-compat-5.7.18-1.el5.x86_64</pre></td></tr></table></figure><h3 id="3-都删除成功之后查找相关的mysql的文件"><a class="anchor" href="#3-都删除成功之后查找相关的mysql的文件">#</a> 3、都删除成功之后，查找相关的 mysql 的文件</h3><figure class="highlight sh"><figcaption data-lang="sh"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">find</span> / <span class="token parameter variable">-name</span> mysql</pre></td></tr></table></figure><img data-src="/DataBase/MySQL/MySQL_Basic/1570605553095.png"><h3 id="4-删除全部文件"><a class="anchor" href="#4-删除全部文件">#</a> 4、删除全部文件</h3><figure class="highlight sh"><figcaption data-lang="sh"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">rm</span> <span class="token parameter variable">-rf</span> /etc/selinux/targeted/active/modules/100/mysql</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">rm</span> <span class="token parameter variable">-rf</span> /root/mysql</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token function">rm</span> <span class="token parameter variable">-rf</span> /root/mysql/data/mysql</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token function">rm</span> <span class="token parameter variable">-rf</span> /var/lib/mysql</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token function">rm</span> <span class="token parameter variable">-rf</span> /var/lib/mysql/mysql</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token function">rm</span> <span class="token parameter variable">-rf</span> /usr/share/mysql</pre></td></tr></table></figure><h3 id="5-再次执行命令"><a class="anchor" href="#5-再次执行命令">#</a> 5、再次执行命令</h3><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">rpm</span> <span class="token parameter variable">-qa</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-i</span> mysql</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">#如果没有显式则表示卸载完成</span></pre></td></tr></table></figure><h2 id="2-删除mariadb-libs不可省略"><a class="anchor" href="#2-删除mariadb-libs不可省略">#</a> 2、删除 mariadb-libs (不可省略)</h2><figure class="highlight sh"><figcaption data-lang="sh"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 检查 mariadb-libs</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">rpm</span> -qa<span class="token operator">|</span><span class="token function">grep</span> mariadb</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment"># 卸载 mariadb-libs</span></pre></td></tr><tr><td data-num="4"></td><td><pre>yum remove <span class="token parameter variable">-y</span> mariadb-libs</pre></td></tr></table></figure><h2 id="3-安装mysql"><a class="anchor" href="#3-安装mysql">#</a> 3、安装 MySQL</h2><h3 id="1输入"><a class="anchor" href="#1输入">#</a> 1，输入：</h3><p>wegt <span class="exturl" data-url="aHR0cHM6Ly9kZXYubXlzcWwuY29tL2dldC9teXNxbCVFNyU4OSU4OCVFNiU5QyVBQyVFNSU4RiVCNy1jb21tdW5pdHktcmVsZWFzZS1lbCVFNSVBNCVBNyVFNyU4OSU4OCVFNiU5QyVBQy0lRTUlQjAlOEYlRTclODklODglRTYlOUMlQUMubm9hcmNoLnJwbQ==">https://dev.mysql.com/get/mysql 版本号 - community-release-el 大版本 - 小版本.noarch.rpm</span></p><figure class="highlight sh"><figcaption data-lang="sh"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">wget</span> https://dev.mysql.com/get/mysql57-community-release-el5-7.noarch.rpm</pre></td></tr></table></figure><h3 id="2-安装数据源"><a class="anchor" href="#2-安装数据源">#</a> 2、安装数据源</h3><figure class="highlight sh"><figcaption data-lang="sh"></figcaption><table><tr><td data-num="1"></td><td><pre>yum <span class="token function">install</span> <span class="token parameter variable">-y</span> mysql57-community-release-el5-7.noarch.rpm</pre></td></tr></table></figure><h3 id="3-查看mysql源是否安装成功"><a class="anchor" href="#3-查看mysql源是否安装成功">#</a> 3、查看 mysql 源是否安装成功</h3><figure class="highlight sh"><figcaption data-lang="sh"></figcaption><table><tr><td data-num="1"></td><td><pre>yum repolist enabled <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"mysql.*-community.*"</span></pre></td></tr></table></figure><h3 id="4-安装数据库"><a class="anchor" href="#4-安装数据库">#</a> 4、安装数据库</h3><figure class="highlight sh"><figcaption data-lang="sh"></figcaption><table><tr><td data-num="1"></td><td><pre>yum <span class="token function">install</span> <span class="token parameter variable">-y</span>  mysql-community-server</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment"># 如果过期可以在运行安装程序之前导入密钥</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token function">rpm</span> <span class="token parameter variable">--import</span> https://repo.mysql.com/RPM-GPG-KEY-mysql-2022</pre></td></tr></table></figure><h3 id="5-启动mysql"><a class="anchor" href="#5-启动mysql">#</a> 5、启动 mysql</h3><figure class="highlight sh"><figcaption data-lang="sh"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># centos7</span></pre></td></tr><tr><td data-num="2"></td><td><pre>systemctl restart mysqld</pre></td></tr><tr><td data-num="3"></td><td><pre>systemctl status mysqld</pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment"># centos6</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token function">service</span> mysqld start</pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token function">service</span> mysqld status</pre></td></tr></table></figure><h3 id="6-显示mysql的随机密码"><a class="anchor" href="#6-显示mysql的随机密码">#</a> 6、显示 mysql 的随机密码</h3><figure class="highlight sh"><figcaption data-lang="sh"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">grep</span> <span class="token string">'temporary password'</span> /var/log/mysqld.log</pre></td></tr></table></figure><img data-src="/DataBase/MySQL/MySQL_Basic/image-20220827193405451.png"><h3 id="7-登录并修改mysql密码"><a class="anchor" href="#7-登录并修改mysql密码">#</a> 7、登录并修改 mysql 密码</h3><p>登录：mysql -u root -p 然后输入上面生成的密码</p><p><strong><em>修改自定义密码，设置自己想要的密码</em></strong></p><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">-- ALTER USER 'root'@'localhost' IDENTIFIED BY ' 密码 ';</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">ALTER</span> <span class="token keyword">USER</span> <span class="token string">'root'</span><span class="token variable">@'localhost'</span> IDENTIFIED <span class="token keyword">BY</span> <span class="token string">'root'</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong><em>失败了的话就修改策略，将策略降低一下就可以了</em></strong></p><p>查看密码策略：</p><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">SHOW</span> VARIABLES <span class="token operator">LIKE</span> <span class="token string">'%validate_password%'</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>修改密码策略</p><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">-- 修改密码长度：（长度）</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">set</span> <span class="token keyword">global</span> validate_password<span class="token punctuation">.</span>length<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">set</span> <span class="token keyword">global</span> validate_password_length<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">-- 修改密码等级：（等级）</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">set</span> <span class="token keyword">global</span> validate_password<span class="token punctuation">.</span>policy<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">set</span> <span class="token keyword">global</span> validate_password_policy<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h2 id="4-其他配置"><a class="anchor" href="#4-其他配置">#</a> 4、其他配置</h2><h3 id="1开机自启"><a class="anchor" href="#1开机自启">#</a> 1. 开机自启</h3><figure class="highlight sh"><figcaption data-lang="sh"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 开机启动</span></pre></td></tr><tr><td data-num="2"></td><td><pre>systemctl <span class="token builtin class-name">enable</span> mysql</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment"># 关闭自动启动</span></pre></td></tr><tr><td data-num="4"></td><td><pre>systemctl disable mysqld</pre></td></tr></table></figure><h3 id="2远程连接"><a class="anchor" href="#2远程连接">#</a> 2. 远程连接</h3><h4 id="方法一-创建一个用户-支持远程连接"><a class="anchor" href="#方法一-创建一个用户-支持远程连接">#</a> 方法一、创建一个用户 支持远程连接</h4><p>①登录 ：mysql -u root -p</p><p>②创建用户： create user 'aaa'@'%' identified by '123456';</p><p>③授权所有权限给 user 这个新用户 ：grant all on <em>.</em> to 'aaa'@'%';</p><p>④退出 mysql：quit;</p><h4 id="方法二-设置root用户支持远程连接"><a class="anchor" href="#方法二-设置root用户支持远程连接">#</a> 方法二、设置 root 用户支持远程连接</h4><p>①登录：mysql -u root -p （ 注：系统提示输入数据库 root 用户的密码，输入完成后即进入 mysql 控制台，这个命令的第一个 mysql 是执行命令，第二个 mysql 是系统数据名称，不一样的。）</p><p>②设置权限：</p><p>赋予权限格式： grant 权限 on 数据库对象 to 用户 @IP (或者相应正则)</p><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">-- 新建用户规则或者直接修改 root 用户的规则 ，2 选一</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">use</span> mysql<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">-- 这里表示赋予该用户所有数据库所有表（*.* 表示所有表），% 表示所有 IP 地址。</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">GRANT</span> <span class="token keyword">ALL</span> <span class="token keyword">PRIVILEGES</span> <span class="token keyword">ON</span> <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">TO</span> <span class="token string">'root'</span><span class="token variable">@'%'</span> IDENTIFIED <span class="token keyword">BY</span> <span class="token string">'123456'</span> <span class="token keyword">WITH</span> <span class="token keyword">GRANT</span> <span class="token keyword">OPTION</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">-- 使 root 能再任何 host 访问</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">update</span> <span class="token keyword">user</span> <span class="token keyword">set</span> host <span class="token operator">=</span> <span class="token string">'%'</span> <span class="token keyword">where</span> <span class="token keyword">user</span> <span class="token operator">=</span> <span class="token string">'root'</span><span class="token punctuation">;</span>      </pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment">-- 刷新</span></pre></td></tr><tr><td data-num="10"></td><td><pre>FLUSH <span class="token keyword">PRIVILEGES</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>③查看：</p><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">use</span> mysql<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">SELECT</span> HOST<span class="token punctuation">,</span><span class="token keyword">USER</span> <span class="token keyword">FROM</span> <span class="token keyword">USER</span><span class="token punctuation">;</span></pre></td></tr></table></figure><img data-src="/DataBase/MySQL/MySQL_Basic/920952e9041b4af1a8a49eb64e0f4430.jpeg"><p>④退出 mysql：quit;</p><h2 id="其他安装方式"><a class="anchor" href="#其他安装方式">#</a> 其他安装方式</h2><h3 id="docker"><a class="anchor" href="#docker">#</a> docker</h3><h4 id="1-查询镜像"><a class="anchor" href="#1-查询镜像">#</a> 1、查询镜像</h4><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">docker</span> search mysql</pre></td></tr></table></figure><h4 id="2-拉取镜像"><a class="anchor" href="#2-拉取镜像">#</a> 2、拉取镜像</h4><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">docker</span> pull mysql:5.7</pre></td></tr></table></figure><h4 id="3-构建容器"><a class="anchor" href="#3-构建容器">#</a> 3、构建容器</h4><p>先自己创建配置文件基础模板（<strong>要是后期要修改配置文件必须加入 模板中的两个元素，不然容器启动会出错</strong>）</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /root/mysql/conf</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">vim</span>  /root/mysql/conf/my.cnf</pre></td></tr></table></figure><p><strong>模板内容：</strong></p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token operator">!</span>includedir /etc/mysql/conf.d/</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token operator">!</span>includedir /etc/mysql/mysql.conf.d/</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">[</span>mysql<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="5"></td><td><pre>default-character-set<span class="token operator">=</span>utf8mb4</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">[</span>mysqld<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token assign-left variable">character_set_server</span><span class="token operator">=</span>utf8mb4</pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token assign-left variable">init_connect</span><span class="token operator">=</span><span class="token string">'SET NAMES utf8'</span></pre></td></tr><tr><td data-num="9"></td><td><pre>lower_case_table_names <span class="token operator">=</span> <span class="token number">1</span></pre></td></tr></table></figure><p><strong>构建容器</strong></p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">docker</span> run <span class="token punctuation">\</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token parameter variable">-p</span> <span class="token number">3306</span>:3306 <span class="token punctuation">\</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token parameter variable">-v</span> /root/mysql/data:/var/lib/mysql <span class="token punctuation">\</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token parameter variable">-v</span> /root/mysql/logs:/logs <span class="token punctuation">\</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token parameter variable">-v</span> /root/mysql/conf/my.cnf:/etc/mysql/my.cnf <span class="token punctuation">\</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token parameter variable">-e</span> <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span>root <span class="token punctuation">\</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token parameter variable">--name</span> mysql <span class="token punctuation">\</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token parameter variable">--hostname</span> node1 <span class="token punctuation">\</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token parameter variable">--restart</span><span class="token operator">=</span>always <span class="token punctuation">\</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token parameter variable">-d</span> mysql:5.7</pre></td></tr></table></figure><p><strong>注</strong>：出错时将本地映射文件检查一下，要是不需要配置，只需映射直接删掉就可，以后再改配置文件</p><h4 id="4-进入容器"><a class="anchor" href="#4-进入容器">#</a> 4、进入容器</h4><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> mysql /bin/bash</pre></td></tr><tr><td data-num="2"></td><td><pre>或者</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> mysql mysql <span class="token parameter variable">-uroot</span> <span class="token parameter variable">-p</span></pre></td></tr></table></figure><h3 id="docker-compose"><a class="anchor" href="#docker-compose">#</a> docker-compose</h3><blockquote><p>前提安装了 docker-compose</p></blockquote><h4 id="配置-docker-comoseyml-文件"><a class="anchor" href="#配置-docker-comoseyml-文件">#</a> 配置 docker-comose.yml 文件</h4><p>5.7：</p><figure class="highlight yml"><figcaption data-lang="YAML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">"3.0"</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token key atrule">services</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token key atrule">mysql8</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token key atrule">image</span><span class="token punctuation">:</span> mysql<span class="token punctuation">:</span>5.7.32</pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> my_db57</pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always</pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token key atrule">volumes</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="8"></td><td><pre>      <span class="token punctuation">-</span> ./db<span class="token punctuation">:</span>/var/lib/mysql</pre></td></tr><tr><td data-num="9"></td><td><pre>      <span class="token punctuation">-</span> ./conf/my.cnf<span class="token punctuation">:</span>/etc/my.cnf</pre></td></tr><tr><td data-num="10"></td><td><pre>      <span class="token comment"># 数据库初始化脚本，当 Mysql 容器首次启动时，会在 /docker-entrypoint-initdb.d 目录下扫描 .sh，.sql，.sql.gz 类型的文件。如果这些类型的文件存在，将执行它们来初始化一个数据库；</span></pre></td></tr><tr><td data-num="11"></td><td><pre>      <span class="token punctuation">-</span> ./init/<span class="token punctuation">:</span>/docker<span class="token punctuation">-</span>entrypoint<span class="token punctuation">-</span>initdb.d/</pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token key atrule">environment</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="13"></td><td><pre>      <span class="token punctuation">-</span> MYSQL_ROOT_PASSWORD=123456</pre></td></tr><tr><td data-num="14"></td><td><pre>      <span class="token comment"># 指定初始化 sql 文件的数据库，简单来书就是新建一个数据库</span></pre></td></tr><tr><td data-num="15"></td><td><pre>      <span class="token punctuation">-</span> MYSQL_DATABASE=my_db</pre></td></tr><tr><td data-num="16"></td><td><pre>      <span class="token punctuation">-</span> TZ=Asia/Shanghai</pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token key atrule">ports</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="18"></td><td><pre>      <span class="token punctuation">-</span> 3311<span class="token punctuation">:</span><span class="token number">3306</span></pre></td></tr></table></figure><p>8.0</p><figure class="highlight yml"><figcaption data-lang="YAML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">"3.0"</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token key atrule">services</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token key atrule">mysql8</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token key atrule">image</span><span class="token punctuation">:</span> mysql<span class="token punctuation">:</span>8.0.25</pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> my_db8</pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always</pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token key atrule">volumes</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="8"></td><td><pre>      <span class="token punctuation">-</span> ./db<span class="token punctuation">:</span>/var/lib/mysql</pre></td></tr><tr><td data-num="9"></td><td><pre>      <span class="token punctuation">-</span> ./conf/my.cnf<span class="token punctuation">:</span>/etc/my.cnf</pre></td></tr><tr><td data-num="10"></td><td><pre>      <span class="token comment"># 数据库初始化脚本，当 Mysql 容器首次启动时，会在 /docker-entrypoint-initdb.d 目录下扫描 .sh，.sql，.sql.gz 类型的文件。如果这些类型的文件存在，将执行它们来初始化一个数据库；</span></pre></td></tr><tr><td data-num="11"></td><td><pre>      <span class="token punctuation">-</span> ./init/<span class="token punctuation">:</span>/docker<span class="token punctuation">-</span>entrypoint<span class="token punctuation">-</span>initdb.d/</pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token key atrule">environment</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="13"></td><td><pre>      <span class="token punctuation">-</span> MYSQL_ROOT_PASSWORD=123456</pre></td></tr><tr><td data-num="14"></td><td><pre>      <span class="token comment"># 指定初始化 sql 文件的数据库，简单来书就是新建一个数据库</span></pre></td></tr><tr><td data-num="15"></td><td><pre>      <span class="token punctuation">-</span> MYSQL_DATABASE=my_db</pre></td></tr><tr><td data-num="16"></td><td><pre>      <span class="token punctuation">-</span> TZ=Asia/Shanghai</pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token key atrule">ports</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="18"></td><td><pre>      <span class="token punctuation">-</span> 3301<span class="token punctuation">:</span><span class="token number">3306</span></pre></td></tr></table></figure><h4 id="配置文件-mycnf"><a class="anchor" href="#配置文件-mycnf">#</a> 配置文件 my.cnf</h4><p>5.7：</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>mysql<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment"># 设置 mysql 客户端默认字符集</span></pre></td></tr><tr><td data-num="3"></td><td><pre>default-character-set<span class="token operator">=</span>utf8mb4</pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">[</span>mysqld<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token assign-left variable">datadir</span><span class="token operator">=</span>/var/lib/mysql</pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token assign-left variable">socket</span><span class="token operator">=</span>/var/lib/mysql/mysql.sock</pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre>symbolic-links<span class="token operator">=</span><span class="token number">0</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>log-error<span class="token operator">=</span>/var/log/mysqld.log</pre></td></tr><tr><td data-num="12"></td><td><pre>pid-file<span class="token operator">=</span>/var/run/mysqld/mysqld.pid</pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token comment"># 服务端使用的字符集默认为 8 比特编码的 latin1 字符集</span></pre></td></tr><tr><td data-num="14"></td><td><pre>character-set-server<span class="token operator">=</span>utf8mb4</pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment"># 创建新表时将使用的默认存储引擎</span></pre></td></tr><tr><td data-num="17"></td><td><pre>default-storage-engine<span class="token operator">=</span>INNODB</pre></td></tr></table></figure><p>8.0：</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>mysql<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment"># 设置 mysql 客户端默认字符集</span></pre></td></tr><tr><td data-num="3"></td><td><pre>default-character-set<span class="token operator">=</span>utf8mb4</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">[</span>mysqld<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment"># 允许最大连接数</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token assign-left variable">max_connections</span><span class="token operator">=</span><span class="token number">200</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment"># 服务端使用的字符集默认为 8 比特编码的 latin1 字符集</span></pre></td></tr><tr><td data-num="9"></td><td><pre>character-set-server<span class="token operator">=</span>utf8mb4</pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment"># 创建新表时将使用的默认存储引擎</span></pre></td></tr><tr><td data-num="12"></td><td><pre>default-storage-engine<span class="token operator">=</span>INNODB</pre></td></tr></table></figure><h4 id="问题"><a class="anchor" href="#问题">#</a> 问题</h4><p>1、Can't create/write to file '/var/run/mysqld/mysqld.pid</p><p>去配置文件中找到 errorlog 的地址，查看错误日志</p><img data-src="/DataBase/MySQL/MySQL_Basic/20190602012200812.png"><p>错误原因为：/var/run/mysqld/ 目录的拥有者为 root，mysql 不能在其中创建文件</p><p>使用如下命令修改目录使用者</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 先查看目录是否存在</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">ls</span> <span class="token parameter variable">-ld</span> /var/run/mysqld/</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment"># 权限</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token function">chown</span> mysql.mysql /var/run/mysqld/</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment"># 修改后重启 mysql 服务</span></pre></td></tr><tr><td data-num="6"></td><td><pre>/etc/init.d/mysqld start</pre></td></tr></table></figure><h2 id="查看mysql的安装结果"><a class="anchor" href="#查看mysql的安装结果">#</a> 查看 MySQL 的安装结果</h2><p>1) 安装了 Windows Service：MySQL80，并且已经启动。</p><p>2) 安装了 MySQL 软件。安装位置为：C:\Program Files\MySQL。</p><p>（MySQL 文件下放的是软件的内容）<br>3) 安装了 MySQL 数据文件夹，用来存放 MySQL 基础数据和以后新增的数据。安装位置为 C:\ProgramData\MySQL\MySQL Server 8.0。</p><p>（ProgramData 文件夹可能是隐藏的，显示出来即可）<br>（MySQL 文件下的内容才是真正的 MySQL 中数据）<br>4) 在 MySQL 数据文件夹中有 MySQL 的配置文件：my.ini。它是 MySQL 数据库中使用的配置文件，修改这个文件可以达到更新配置的目的。以下几个配置项需要大家特别理解。<br>² port=3306：监听端口是 3306</p><p>² basedir=&quot;C:/Program Files/MySQL/MySQL Server 8.0/&quot;：软件安装位置</p><p>² datadir=C:/ProgramData/MySQL/MySQL Server 8.0/Data：数据文件夹位置</p><p>² default_authentication_plugin=caching_sha2_password：默认验证插件</p><p>² default-storage-engine=INNODB：默认存储引擎</p><p>（这些内容在 Linux 下可能会手动更改）</p><h1 id="数据库的卸载"><a class="anchor" href="#数据库的卸载">#</a> 数据库的卸载</h1><p>【1】卸载数据库<br>1) 停止 MySQL 服务：在命令行模式下执行 net stop mysql 或者在 Windows 服务窗口下停止服务</p><img data-src="/DataBase/MySQL/MySQL_Basic/image-20221027160328893.png" title="image-20221027160328893"><p>2) 在控制面板中删除 MySQL 软件</p><img data-src="/DataBase/MySQL/MySQL_Basic/image-20221027160335299.png" title="image-20221027160335299"><p>3) 删除软件文件夹：直接删除安装文件夹 C:\Program Files\MySQL，其实此时该文件夹已经被删除或者剩下一个空文件夹。<br>4) 删除数据文件夹：直接删除文件夹 C:\ProgramData\MySQL。此步不要忘记，否则会影响 MySQL 的再次安装。<br><mark>（ProgramData 文件夹可能是隐藏的，显示出来即可）<br>（MySQL 文件下的内容才是真正的 MySQL 中数据）</mark><br>5) 删除 path 环境变量中关于 MySQL 安装路径的配置</p><h1 id="sql语言入门"><a class="anchor" href="#sql语言入门">#</a> SQL 语言入门</h1><h2 id="1sql语言入门"><a class="anchor" href="#1sql语言入门">#</a> 【1】SQL 语言入门</h2><p>​ 我们都知道，<mark>数据库管理人员（DBA）通过数据库管理系统（DBMS）可以对数据库（DB）中的数据进行操作</mark>，但具体是如何操作的呢？这就涉及到我们本节要讲的 SQL 语言。<br>SQL（Structured Query Language）是结构化查询语言的简称，它是一种数据库查询和程序设计语言，同时也是目前使用最广泛的关系型数据库操作语言。在数据库管理系统中，使用 SQL 语言来实现数据的存取、查询、更新等功能。<mark>SQL 是一种非过程化语言，只需提出 “做什么”，而不需要指明 “怎么做”</mark>。<br>​ SQL 是由 IBM 公司在 1974~1979 年之间根据 E.J.Codd 发表的关系数据库理论为基础开发的，其前身是 “SEQUEL”，后更名为 SQL。由于 SQL 语言具有集数据查询、数据操纵、数据定义和数据控制功能于一体，类似自然语言、简单易用以及非过程化等特点，得到了快速的发展，并于 1986 年 10 月，被美国国家标准协会（American National Standards Institute，ANSI）采用为关系数据库管理系统的标准语言，后为国际标准化组织（International Organization for Standardization，ISO）采纳为国际标准。</p><img data-src="/DataBase/MySQL/MySQL_Basic/image-20221027160527233.png" title="image-20221027160527233"><h2 id="2sql语言分为五个部分"><a class="anchor" href="#2sql语言分为五个部分">#</a> 【2】SQL 语言分为五个部分</h2><p>数据查询语言（Data Query Language，DQL）：<font color="red">DQL 主要用于<mark>数据的查询</mark>，其基本结构是使用 SELECT 子句，FROM 子句和 WHERE 子句的组合来查询一条或多条数据。<br>数据操作语言（Data Manipulation Language，DML）：<font color="red">DML</font>主要用于对数据库中的<font color="red">数据进行增加、修改和删除</font>的操作，其主要包括：<br>1) INSERT：增加数据<br>2) UPDATE：修改数据<br>3) DELETE：删除数据<br>数据定义语言（Data Definition Language，DDL）：<font color="red">DDL&lt;/ 主要用针对是<font color="red">数据库对象（数据库、表、索引、视图、触发器、存储过程、函数）进行创建、修改和删除</font>操作。其主要包括：<br>1) CREATE：创建数据库对象<br>2) ALTER：修改数据库对象<br>3) DROP：删除数据库对象<br>数据控制语言（Data Control Language，DCL）：<font color="red">DCL 用来<font color="red">授予或回收访问 数据库的权限</font>，其主要包括：<br>1) GRANT：授予用户某种权限<br>2) REVOKE：回收授予的某种权限</font></font></font></p><p>事务控制语言（Transaction Control Language，TCL）：<font color="red">TCL</font>用于数据库的<font color="red">事务管理</font>。其主要包括：<br>1) START TRANSACTION：开启事务<br>2) COMMIT：提交事务<br>3) ROLLBACK：回滚事务<br>4) SET TRANSACTION：设置事务的属性</p><h2 id="ddl_dml_创建数据库表"><a class="anchor" href="#ddl_dml_创建数据库表">#</a> DDL_DML_创建数据库表</h2><h3 id="1认识数据库表"><a class="anchor" href="#1认识数据库表">#</a> 【1】认识数据库表</h3><p>表（Table）是数据库中数据存储最常见和最简单的一种形式，<mark>数据库可以将复杂的数据结构用较为简单的二维表来表示</mark>。二维表是由行和列组成的，分别都包含着数据，如表所示。</p><img data-src="/DataBase/MySQL/MySQL_Basic/image-20221027160854579.png" title="image-20221027160854579"><p>每个表都是由若干行和列组成的，在数据库中表中的行被称为<mark>记录</mark>，表中的列被称为是这些记录的<mark>字段</mark>。</p><p>记录也被称为一行数据，是表里的一行。在关系型数据库的表里，一行数据是指一条完整的记录。</p><p>字段是表里的一列，用于保存每条记录的特定信息。如上表所示的学生信息表中的字段包括 “学号”、“姓名”、“性别” 和 “年龄”。数据表的一列包含了某个特定字段的全部信息。</p><h3 id="2创建数据库表-t_student"><a class="anchor" href="#2创建数据库表-t_student">#</a> 【2】创建数据库表 t_student</h3><p>建立一张用来存储学生信息的表<br>字段包含学号、姓名、性别，年龄、入学日期、班级，email 等信息<br>学号是主键 = 不能为空 + 唯一<br>姓名不能为空<br>性别默认值是男<br>Email 唯一<br>（1）创建数据库：</p><img data-src="/DataBase/MySQL/MySQL_Basic/image-20221027160930671.png" title="image-20221027160930671"><p>（2）新建查询：</p><img data-src="/DataBase/MySQL/MySQL_Basic/image-20221027160937441.png" title="image-20221027160937441"><p>（3）创建数据库表：</p><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">## 这是一个单行注释</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="3"></td><td><pre>多行注释</pre></td></tr><tr><td data-num="4"></td><td><pre>多行注释</pre></td></tr><tr><td data-num="5"></td><td><pre>多行注释</pre></td></tr><tr><td data-num="6"></td><td><pre>*/</pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="8"></td><td><pre>建立一张用来存储学生信息的表</pre></td></tr><tr><td data-num="9"></td><td><pre>字段包含学号、姓名、性别，年龄、入学日期、班级，email 等信息</pre></td></tr><tr><td data-num="10"></td><td><pre>*/</pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">-- 创建数据库表：</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">create</span> <span class="token keyword">table</span> t_student<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    sno <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">-- 6 显示长度 </span></pre></td></tr><tr><td data-num="14"></td><td><pre>    sname <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">-- 5 个字符</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    sex <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    age <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    enterdate <span class="token keyword">date</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    classname <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    email <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token comment">-- 查看表的结构：展示表的字段详细信息</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token keyword">desc</span> t_student<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token comment">-- 查看表中数据：</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> t_student<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token comment">-- 查看建表语句：</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token keyword">show</span> <span class="token keyword">create</span> <span class="token keyword">table</span> t_student<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="28"></td><td><pre>CREATE TABLE `t_student` (</pre></td></tr><tr><td data-num="29"></td><td><pre>  `sno` int DEFAULT NULL,</pre></td></tr><tr><td data-num="30"></td><td><pre>  `sname` varchar(5) DEFAULT NULL,</pre></td></tr><tr><td data-num="31"></td><td><pre>  `sex` char(1) DEFAULT NULL,</pre></td></tr><tr><td data-num="32"></td><td><pre>  `age` int DEFAULT NULL,</pre></td></tr><tr><td data-num="33"></td><td><pre>  `enterdate` date DEFAULT NULL,</pre></td></tr><tr><td data-num="34"></td><td><pre>  `classname` varchar(10) DEFAULT NULL,</pre></td></tr><tr><td data-num="35"></td><td><pre>  `email` varchar(15) DEFAULT NULL</pre></td></tr><tr><td data-num="36"></td><td><pre>) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci</pre></td></tr><tr><td data-num="37"></td><td><pre>*/</pre></td></tr></table></figure><h2 id="数据库表列类型"><a class="anchor" href="#数据库表列类型">#</a> 数据库表列类型</h2><h3 id="整数类型"><a class="anchor" href="#整数类型">#</a> 整数类型</h3><img data-src="/DataBase/MySQL/MySQL_Basic/image-20221027161024756.png" title="image-20221027161024756"><p>MySQL 支持选择在该类型关键字后面的括号内指定整数值的<mark>显示宽度</mark> (例如，INT (4))。显示宽度并不限制可以在列内保存的值的范围，也不限制超过列的指定宽度的值的显示<br>主键自增：不使用序列，通过 auto_increment，要求是整数类型</p><h3 id="浮点数类型"><a class="anchor" href="#浮点数类型">#</a> 浮点数类型</h3><img data-src="/DataBase/MySQL/MySQL_Basic/image-20221027161031693.png" title="image-20221027161031693"><p>需要注意的是与整数类型不一样的是，浮点数类型的宽度不会自动扩充。 score double (4,1)<br>score double (4,1)-- 小数部分为 1 位，总宽度 4 位，并且不会自动扩充。</p><h3 id="字符串类型"><a class="anchor" href="#字符串类型">#</a> 字符串类型</h3><img data-src="/DataBase/MySQL/MySQL_Basic/image-20221027161037025.png" title="image-20221027161037025"><p>CHAR 和 VARCHAR 类型相似，均用于存于较短的字符串，主要的不同之处在于存储方式。<mark>CHAR 类型长度固定，VARCHAR 类型的长度可变</mark>。<br>因为 VARCHAR 类型能够根据字符串的实际长度来动态改变所占字节的大小，所以在不能明确该字段具体需要多少字符时推荐使用 VARCHAR 类型，这样可以大大地节约磁盘空间、提高存储效率。<br>CHAR 和 VARCHAR 表示的是字符的个数，而不是字节的个数</p><h3 id="日期和时间类型"><a class="anchor" href="#日期和时间类型">#</a> 日期和时间类型</h3><img data-src="/DataBase/MySQL/MySQL_Basic/image-20221027161043560.png" title="image-20221027161043560"><p>TIMESTEMP 类型的数据指定方式与 DATETIME 基本相同，两者的不同之处在于以下几点：<br>(1) 数据的取值范围不同，TIMESTEMP 类型的取值范围更小。<br>(2) 如果我们对 TIMESTAMP 类型的字段没有明确赋值，或是被赋与了 NULL 值，MySQL 会自动将该字段赋值为系统当前的日期与时间。<br>(3) TIMESTEMP 类型还可以使用 CURRENT_TIMESTAMP 来获取系统当前时间。<br>(4) TIMESTEMP 类型有一个很大的特点，那就是时间是根据时区来显示的。例如，在东八区插入的 TIMESTEMP 数据为 2017-07-11 16:43:25，在东七区显示时，时间部分就变成了 15:43:25，在东九区显示时，时间部分就变成了 17:43:25。</p><h2 id="dml_添加数据"><a class="anchor" href="#dml_添加数据">#</a> DML_添加数据</h2><p>注意事项</p><ol><li>int 宽度是显示宽度，如果超过，可以自动增大宽度 int 底层都是 4 个字节</li><li>时间的方式多样 '1256-12-23' &quot;1256/12/23&quot; &quot;1256.12.23&quot;</li><li>字符串不区分单引号和双引号</li><li>如何写入当前的时间 now () , sysdate () , CURRENT_DATE ()</li><li>char varchar 是字符的个数，不是字节的个数，可以使用 binary，varbinary 表示定长和不定长的字节个数。</li><li>如果不是全字段插入数据的话，需要加入字段的名字</li></ol><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">-- 查看表记录：</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> t_student<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">-- 在 t_student 数据库表中插入数据：</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> t_student <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'张三'</span><span class="token punctuation">,</span><span class="token string">'男'</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token string">'2022-5-8'</span><span class="token punctuation">,</span><span class="token string">'软件1班'</span><span class="token punctuation">,</span><span class="token string">'123@126.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> t_student <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10010010</span><span class="token punctuation">,</span><span class="token string">'张三'</span><span class="token punctuation">,</span><span class="token string">'男'</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token string">'2022-5-8'</span><span class="token punctuation">,</span><span class="token string">'软件1班'</span><span class="token punctuation">,</span><span class="token string">'123@126.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> t_student <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'张三'</span><span class="token punctuation">,</span><span class="token string">'男'</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token string">'2022.5.8'</span><span class="token punctuation">,</span><span class="token string">'软件1班'</span><span class="token punctuation">,</span><span class="token string">'123@126.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> t_student <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">"张三"</span><span class="token punctuation">,</span><span class="token string">'男'</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token string">'2022.5.8'</span><span class="token punctuation">,</span><span class="token string">'软件1班'</span><span class="token punctuation">,</span><span class="token string">'123@126.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> t_student <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token string">"张三"</span><span class="token punctuation">,</span><span class="token string">'男'</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'软件1班'</span><span class="token punctuation">,</span><span class="token string">'123@126.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> t_student <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token string">"易烊千玺"</span><span class="token punctuation">,</span><span class="token string">'男'</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'软件1班'</span><span class="token punctuation">,</span><span class="token string">'123@126.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> t_student <span class="token punctuation">(</span>sno<span class="token punctuation">,</span>sname<span class="token punctuation">,</span>enterdate<span class="token punctuation">)</span> <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token string">'李四'</span><span class="token punctuation">,</span><span class="token string">'2023-7-5'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h2 id="dml_修改删除数据"><a class="anchor" href="#dml_修改删除数据">#</a> DML_修改，删除数据</h2><p>注意事项</p><ol><li>关键字，表名，字段名不区分大小写</li><li>默认情况下，内容不区分大小写</li><li>删除操作 from 关键字不可缺少</li><li>修改，删除数据别忘记加限制条件</li></ol><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">-- 修改表中数据</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">update</span> t_student <span class="token keyword">set</span> sex <span class="token operator">=</span> <span class="token string">'女'</span> <span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">update</span> t_student <span class="token keyword">set</span> sex <span class="token operator">=</span> <span class="token string">'男'</span> <span class="token keyword">where</span> sno <span class="token operator">=</span> <span class="token number">10</span> <span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">UPDATE</span> T_STUDENT <span class="token keyword">SET</span> AGE <span class="token operator">=</span> <span class="token number">21</span> <span class="token keyword">WHERE</span> SNO <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">update</span> t_student <span class="token keyword">set</span> CLASSNAME <span class="token operator">=</span> <span class="token string">'java01'</span> <span class="token keyword">where</span> sno <span class="token operator">=</span> <span class="token number">10</span> <span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">update</span> t_student <span class="token keyword">set</span> CLASSNAME <span class="token operator">=</span> <span class="token string">'JAVA01'</span> <span class="token keyword">where</span> sno <span class="token operator">=</span> <span class="token number">9</span> <span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">update</span> t_student <span class="token keyword">set</span> age <span class="token operator">=</span> <span class="token number">29</span> <span class="token keyword">where</span> classname <span class="token operator">=</span> <span class="token string">'java01'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment">-- 删除操作：</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">delete</span> <span class="token keyword">from</span> t_student <span class="token keyword">where</span> sno <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h2 id="ddl_修改删除数据库表"><a class="anchor" href="#ddl_修改删除数据库表">#</a> DDL_修改，删除数据库表</h2><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">-- 查看数据：</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> t_student<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">-- 修改表的结构：</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">-- 增加一列：</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">alter</span> <span class="token keyword">table</span> t_student <span class="token keyword">add</span> score <span class="token keyword">double</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">;</span> <span class="token comment">-- 5: 总位数  2：小数位数 </span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">update</span> t_student <span class="token keyword">set</span> score <span class="token operator">=</span> <span class="token number">123.5678</span> <span class="token keyword">where</span> sno <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">-- 增加一列（放在最前面）</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">alter</span> <span class="token keyword">table</span> t_student <span class="token keyword">add</span> score <span class="token keyword">double</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">first</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment">-- 增加一列（放在 sex 列的后面）</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">alter</span> <span class="token keyword">table</span> t_student <span class="token keyword">add</span> score <span class="token keyword">double</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">after</span> sex<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">-- 删除一列：</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">alter</span> <span class="token keyword">table</span> t_student <span class="token keyword">drop</span> score<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token comment">-- 修改一列：</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">alter</span> <span class="token keyword">table</span> t_student <span class="token keyword">modify</span> score <span class="token keyword">float</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- modify 修改是列的类型的定义，但是不会改变列的名字</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">alter</span> <span class="token keyword">table</span> t_student change score score1 <span class="token keyword">double</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- change 修改列名和列的类型的定义</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment">-- 删除表：</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">drop</span> <span class="token keyword">table</span> t_student<span class="token punctuation">;</span></pre></td></tr></table></figure><h1 id="表的完整性约束"><a class="anchor" href="#表的完整性约束">#</a> 表的完整性约束</h1><p>​ 为防止不符合规范的数据存入数据库，在用户对数据进行插入、修改、删除等操作时，MySQL 提供了一种机制来检查数据库中的数据是否满足规定的条件，<mark>以保证数据库中数据的准确性和一致性</mark>，这种机制就是<mark>完整性约束</mark>。</p><p>MySQL 中主要支持以下几种种完整性约束，如表所示。 其中 Check 约束是 MySQL8 中提供的支持。</p><img data-src="/DataBase/MySQL/MySQL_Basic/image-20221027161557720.png" title="image-20221027161557720"><h2 id="非外键约束"><a class="anchor" href="#非外键约束">#</a> 非外键约束</h2><h3 id="代码演示非外键约束"><a class="anchor" href="#代码演示非外键约束">#</a> 代码演示非外键约束：</h3><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="2"></td><td><pre>建立一张用来存储学生信息的表</pre></td></tr><tr><td data-num="3"></td><td><pre>字段包含学号、姓名、性别，年龄、入学日期、班级，email 等信息</pre></td></tr><tr><td data-num="4"></td><td><pre>约束：</pre></td></tr><tr><td data-num="5"></td><td><pre>建立一张用来存储学生信息的表</pre></td></tr><tr><td data-num="6"></td><td><pre>字段包含学号、姓名、性别，年龄、入学日期、班级，email 等信息</pre></td></tr><tr><td data-num="7"></td><td><pre>【1】学号是主键 = 不能为空 +  唯一 ，主键的作用：可以通过主键查到唯一的一条记录【2】如果主键是整数类型，那么需要自增</pre></td></tr><tr><td data-num="8"></td><td><pre>【3】姓名不能为空</pre></td></tr><tr><td data-num="9"></td><td><pre>【4】Email 唯一</pre></td></tr><tr><td data-num="10"></td><td><pre>【5】性别默认值是男</pre></td></tr><tr><td data-num="11"></td><td><pre>【6】性别只能是男女</pre></td></tr><tr><td data-num="12"></td><td><pre>【7】年龄只能在 18-50 之间</pre></td></tr><tr><td data-num="13"></td><td><pre>*/</pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">-- 创建数据库表：</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">create</span> <span class="token keyword">table</span> t_student<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        sno <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="17"></td><td><pre>        sname <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="18"></td><td><pre>        sex <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">'男'</span> <span class="token keyword">check</span><span class="token punctuation">(</span>sex<span class="token operator">=</span><span class="token string">'男'</span> <span class="token operator">||</span> sex<span class="token operator">=</span><span class="token string">'女'</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        age <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">check</span><span class="token punctuation">(</span>age<span class="token operator">>=</span><span class="token number">18</span> <span class="token operator">and</span> age<span class="token operator">&lt;=</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        enterdate <span class="token keyword">date</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        classname <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        email <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token keyword">unique</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token comment">-- 添加数据：</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token comment">--  1048 - Column'sname' cannot be null 不能为 null</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token comment">-- 3819 - Check constraint 't_student_chk_1' is violated. 违反检查约束</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> t_student <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'张三'</span><span class="token punctuation">,</span><span class="token string">'男'</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token string">'2023-9-1'</span><span class="token punctuation">,</span><span class="token string">'java01班'</span><span class="token punctuation">,</span><span class="token string">'zs@126.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token comment">-- 1062 - Duplicate entry '1' for key 't_student.PRIMARY' 主键重复</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token comment">-- > 1062 - Duplicate entry 'ls@126.com' for key 't_student.email' 违反唯一约束</span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> t_student <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'李四'</span><span class="token punctuation">,</span><span class="token string">'男'</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token string">'2023-9-1'</span><span class="token punctuation">,</span><span class="token string">'java01班'</span><span class="token punctuation">,</span><span class="token string">'ls@126.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> t_student <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">'露露'</span><span class="token punctuation">,</span><span class="token string">'男'</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token string">'2023-9-1'</span><span class="token punctuation">,</span><span class="token string">'java01班'</span><span class="token punctuation">,</span><span class="token string">'ls@126.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token comment">-- 如果主键没有设定值，或者用 null.default 都可以完成主键自增的效果</span></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> t_student <span class="token punctuation">(</span>sname<span class="token punctuation">,</span>enterdate<span class="token punctuation">)</span> <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token string">'菲菲'</span><span class="token punctuation">,</span><span class="token string">'2029-4-5'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> t_student <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">'小明'</span><span class="token punctuation">,</span><span class="token string">'男'</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token string">'2023-9-1'</span><span class="token punctuation">,</span><span class="token string">'java01班'</span><span class="token punctuation">,</span><span class="token string">'xm@126.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> t_student <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token keyword">default</span><span class="token punctuation">,</span><span class="token string">'小刚'</span><span class="token punctuation">,</span><span class="token string">'男'</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token string">'2023-9-1'</span><span class="token punctuation">,</span><span class="token string">'java01班'</span><span class="token punctuation">,</span><span class="token string">'xg@126.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token comment">-- 如果 sql 报错，可能主键就浪费了，后续插入的主键是不连号的，我们主键也不要求连号的</span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> t_student <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">'小明'</span><span class="token punctuation">,</span><span class="token string">'男'</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token string">'2023-9-1'</span><span class="token punctuation">,</span><span class="token string">'java01班'</span><span class="token punctuation">,</span><span class="token string">'oo@126.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token comment">-- 查看数据：</span></pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> t_student<span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="约束从作用上可以分为两类"><a class="anchor" href="#约束从作用上可以分为两类">#</a> 约束从作用上可以分为两类</h3><p>(1) 表级约束：可以约束表中任意一个或多个字段。与列定义相互独立，不包含在列定义中；与定义用‘，’分隔；必须指出要约束的列的名称；</p><p>(2) 列级约束：包含在列定义中，直接跟在该列的其它定义之后 ，用空格分隔；不必指定列名；</p><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">-- 删除表：</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">drop</span> <span class="token keyword">table</span> t_student<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">-- 创建数据库表：</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">create</span> <span class="token keyword">table</span> t_student<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        sno <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="6"></td><td><pre>        sname <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="7"></td><td><pre>        sex <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">'男'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        age <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        enterdate <span class="token keyword">date</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        classname <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        email <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        <span class="token keyword">constraint</span> pk_stu <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>sno<span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">-- pk_stu 主键约束的名字</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token keyword">constraint</span> ck_stu_sex <span class="token keyword">check</span> <span class="token punctuation">(</span>sex <span class="token operator">=</span> <span class="token string">'男'</span> <span class="token operator">||</span> sex <span class="token operator">=</span> <span class="token string">'女'</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token keyword">constraint</span> ck_stu_age <span class="token keyword">check</span> <span class="token punctuation">(</span>age <span class="token operator">>=</span> <span class="token number">18</span> <span class="token operator">and</span> age <span class="token operator">&lt;=</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token keyword">constraint</span> uq_stu_email <span class="token keyword">unique</span> <span class="token punctuation">(</span>email<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token comment">-- 添加数据：</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> t_student <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'张三'</span><span class="token punctuation">,</span><span class="token string">'男'</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token string">'2023-9-1'</span><span class="token punctuation">,</span><span class="token string">'java01班'</span><span class="token punctuation">,</span><span class="token string">'zs@126.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token comment">-- > 3819 - Check constraint 'ck_stu_sex' is violated.</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token comment">-- > 3819 - Check constraint 'ck_stu_age' is violated.</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token comment">-- > 1062 - Duplicate entry 'zs@126.com' for key 't_student.uq_stu_email'</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> t_student <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">'李四'</span><span class="token punctuation">,</span><span class="token string">'男'</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token string">'2023-9-1'</span><span class="token punctuation">,</span><span class="token string">'java01班'</span><span class="token punctuation">,</span><span class="token string">'zs@126.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token comment">-- 查看数据：</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> t_student<span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="在创建表以后添加约束"><a class="anchor" href="#在创建表以后添加约束">#</a> 在创建表以后添加约束：</h3><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">-- 删除表：</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">drop</span> <span class="token keyword">table</span> t_student<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">-- 创建数据库表：</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">create</span> <span class="token keyword">table</span> t_student<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        sno <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="6"></td><td><pre>        sname <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="7"></td><td><pre>        sex <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">'男'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        age <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        enterdate <span class="token keyword">date</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        classname <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        email <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token comment">-- > 1075 - Incorrect table definition; there can be only one auto column and it must be defined as a key</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">-- 错误的解决办法：就是 auto_increment 去掉</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token comment">-- 在创建表以后添加约束：</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">alter</span> <span class="token keyword">table</span> t_student <span class="token keyword">add</span> <span class="token keyword">constraint</span> pk_stu <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>sno<span class="token punctuation">)</span> <span class="token punctuation">;</span> <span class="token comment">-- 主键约束</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">alter</span> <span class="token keyword">table</span> t_student <span class="token keyword">modify</span> sno <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token keyword">auto_increment</span><span class="token punctuation">;</span> <span class="token comment">-- 修改自增条件</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">alter</span> <span class="token keyword">table</span> t_student <span class="token keyword">add</span> <span class="token keyword">constraint</span> ck_stu_sex <span class="token keyword">check</span> <span class="token punctuation">(</span>sex <span class="token operator">=</span> <span class="token string">'男'</span> <span class="token operator">||</span> sex <span class="token operator">=</span> <span class="token string">'女'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">alter</span> <span class="token keyword">table</span> t_student <span class="token keyword">add</span> <span class="token keyword">constraint</span> ck_stu_age <span class="token keyword">check</span> <span class="token punctuation">(</span>age <span class="token operator">>=</span> <span class="token number">18</span> <span class="token operator">and</span> age <span class="token operator">&lt;=</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token keyword">alter</span> <span class="token keyword">table</span> t_student <span class="token keyword">add</span> <span class="token keyword">constraint</span> uq_stu_email <span class="token keyword">unique</span> <span class="token punctuation">(</span>email<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token comment">-- 查看表结构：</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token keyword">desc</span> t_student<span class="token punctuation">;</span></pre></td></tr></table></figure><p>验证约束添加成功：查看表结构：</p><img data-src="/DataBase/MySQL/MySQL_Basic/image-20221027161957221.png" title="image-20221027161957221"><h3 id="总结"><a class="anchor" href="#总结">#</a> 总结：</h3><ol><li><strong>主键约束</strong></li></ol><p>主键约束（PRIMARY KEY，缩写 PK），是数据库中最重要的一种约束，其作用是约束表中的某个字段可以 ==<strong> 唯一标识一条记录</strong> ==。因此，使用主键约束可以快速查找表中的记录。就像人的身份证、学生的学号等等，<strong><mark>设置为主键的字段取值不能重复（唯一），也不能为空（非空）</mark></strong>，否则无法唯一标识一条记录。</p><p><strong><mark>主键可以是单个字段，也可以是多个字段组合</mark></strong>。对于单字段主键的添加可使用表级约束，也可以使用列级约束；而对于多字段主键的添加只能使用表级约束。</p><ol start="2"><li><strong>非空约束</strong></li></ol><p>非空约束（NOT NULL，缩写 NK）规定了一张表中指定的某个字段的值不能为空（NULL）。设置了非空约束的字段，在插入的数据为 NULL 时，数据库会提示错误，导致数据无法插入。</p><p>无论是单个字段还是多个字段非空约束的添加只能使用列级约束（非空约束无表级约束）</p><p><strong>为已存在表中的字段添加非空约束</strong></p><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">alter</span>   <span class="token keyword">table</span> student8 <span class="token keyword">modify</span> stu_sex <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong>使用 ALTER TABLE 语句删除非空约束</strong></p><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">alter</span>  <span class="token keyword">table</span> student8 <span class="token keyword">modify</span> stu_sex <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token boolean">null</span><span class="token punctuation">;</span></pre></td></tr></table></figure><ol start="3"><li><strong>唯一约束</strong></li></ol><p>唯一约束（UNIQUE，缩写 UK）比较简单，它规定了一张表中指定的某个字段的值不能重复，即这一字段的每个值都是唯一的。如果想要某个字段的值不重复，那么就可以为该字段添加为唯一约束。</p><p>无论单个字段还是多个字段唯一约束的添加均可使用列级约束和表级约束</p><ol start="4"><li><strong>检查约束</strong></li></ol><p>检查约束（CHECK）用来限制某个字段的取值范围，可以定义为列级约束，也可以定义为表级约束。MySQL8 开始支持检查约束。</p><ol start="5"><li><strong>默认值约束</strong></li></ol><p>默认值约束（DEFAULT）用来规定字段的默认值。如果某个被设置为 DEFAULT 约束的字段没插入具体值，那么该字段的值将会被默认值填充。</p><p>默认值约束的设置与非空约束一样，也只能使用列级约束。</p><ol start="6"><li><strong>字段值自动增加约束</strong></li></ol><p>自增约束（AUTO_INCREMENT）可以使表中某个字段的值自动增加。一张表中只能有一个自增长字段，并且该字段必须定义了约束（该约束可以是主键约束、唯一约束以及外键约束），如果自增字段没有定义约束，数据库则会提示 “Incorrect table definition; there can be only one auto column and it must be defined as a key” 错误。</p><p>由于自增约束会自动生成唯一的 ID，所以自增约束通常会配合主键使用，并且只适用于整数类型。一般情况下，设置为自增约束字段的值会从 1 开始，每增加一条记录，该字段的值加 1。</p><p><strong>为已存在表中的字段添加自增约束</strong></p><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">/* 创建表 student11*/</span></pre></td></tr><tr><td data-num="2"></td><td><pre> <span class="token keyword">create</span>   <span class="token keyword">table</span> student11 <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="3"></td><td><pre>       stu_id <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>       stu_name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="5"></td><td><pre>       stu_sex <span class="token keyword">varchar</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment">/* 为 student11 表中的主键字段添加自增约束 */</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">alter</span>   <span class="token keyword">table</span> student11 <span class="token keyword">modify</span> stu_id <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">auto_increment</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong>使用 ALTER TABLE 语句删除自增约束</strong></p><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">alter</span>   <span class="token keyword">table</span> studen11 <span class="token keyword">modify</span> stu_id <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h2 id="外键约束"><a class="anchor" href="#外键约束">#</a> 外键约束</h2><h3 id="简介"><a class="anchor" href="#简介">#</a> 简介</h3><p>外键约束（FOREIGN KEY，缩写 FK）是用来实现数据库表的参照完整性的。外键约束可以使两张表紧密的结合起来，特别是针对修改或者删除的级联操作时，会保证数据的完整性。<br>外键是指表中某个字段的值依赖于另一张表中某个字段的值，而被依赖的字段必须具有主键约束或者唯一约束。被依赖的表我们通常称之为父表或者主表，设置外键约束的表称为子表或者从表。</p><p>举个例子：如果想要表示学生和班级的关系，首先要有学生表和班级表两张表，然后学生表中有个字段为 stu_clazz（该字段表示学生所在的班级），而该字段的取值范围由班级表中的主键 cla_no 字段（该字段表示班级编号）的取值决定。那么班级表为主表，学生表为从表，且 stu_clazz 字段是学生表的外键。通过 stu_clazz 字段就建立了学生表和班级表的关系。</p><img data-src="/DataBase/MySQL/MySQL_Basic/image-20221027162602723.png" title="image-20221027162602723"><p>主表（父表）：班级表 - 班级编号 - 主键<br>从表（子表）：学生表 - 班级编号 - 外键</p><h3 id="sql展示"><a class="anchor" href="#sql展示">#</a> sql 展示：</h3><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">-- 先创建父表：班级表：</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">create</span> <span class="token keyword">table</span> t_class<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="3"></td><td><pre>        cno <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>        cname <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        room <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">-- 添加班级数据：</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> t_class <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">'java001'</span><span class="token punctuation">,</span><span class="token string">'r803'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> t_class <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">'java002'</span><span class="token punctuation">,</span><span class="token string">'r416'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> t_class <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">'大数据001'</span><span class="token punctuation">,</span><span class="token string">'r103'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">-- 可以一次性添加多条记录：</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> t_class <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">'java001'</span><span class="token punctuation">,</span><span class="token string">'r803'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">'java002'</span><span class="token punctuation">,</span><span class="token string">'r416'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">'大数据001'</span><span class="token punctuation">,</span><span class="token string">'r103'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token comment">-- 查询班级表：</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> t_class<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token comment">-- 学生表删除：</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">drop</span> <span class="token keyword">table</span> t_student<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token comment">-- 创建子表，学生表：</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">create</span> <span class="token keyword">table</span> t_student<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        sno <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="20"></td><td><pre>        sname <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="21"></td><td><pre>        classno <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>  <span class="token comment">-- 取值参考 t_class 表中的 cno 字段，不要求字段名字完全重复，但是类型长度定义 尽量要求相同。</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token comment">-- 添加学生信息：</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> t_student <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">'张三'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">'李四'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">'王五'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token comment">-- 查看学生表：</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> t_student<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token comment">-- 出现问题：</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token comment">-- 1. 添加一个学生对应的班级编码为 4：</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> t_student <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">'丽丽'</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token comment">-- 2. 删除班级 2：</span></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token keyword">delete</span> <span class="token keyword">from</span> t_class <span class="token keyword">where</span> cno <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token comment">-- 出现问题的原因：</span></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token comment">-- 因为你现在的外键约束，没用语法添加进去，现在只是逻辑上认为班级编号是外键，没有从语法上定义</span></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token comment">-- 解决办法，添加外键约束：</span></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token comment">-- 注意：外键约束只有表级约束，没有列级约束：</span></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token keyword">create</span> <span class="token keyword">table</span> t_student<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="37"></td><td><pre>        sno <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="38"></td><td><pre>        sname <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="39"></td><td><pre>        classno <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">-- 取值参考 t_class 表中的 cno 字段，不要求字段名字完全重复，但是类型长度定义 尽量要求相同。</span></pre></td></tr><tr><td data-num="40"></td><td><pre>                                <span class="token keyword">constraint</span> fk_stu_classno <span class="token keyword">foreign</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>classno<span class="token punctuation">)</span> <span class="token keyword">references</span> t_class <span class="token punctuation">(</span>cno<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="41"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token keyword">create</span> <span class="token keyword">table</span> t_student<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="43"></td><td><pre>        sno <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="44"></td><td><pre>        sname <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="45"></td><td><pre>        classno <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="46"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="47"></td><td><pre><span class="token comment">-- 在创建表以后添加外键约束：</span></pre></td></tr><tr><td data-num="48"></td><td><pre><span class="token keyword">alter</span> <span class="token keyword">table</span> t_student <span class="token keyword">add</span> <span class="token keyword">constraint</span> fk_stu_classno <span class="token keyword">foreign</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>classno<span class="token punctuation">)</span> <span class="token keyword">references</span> t_class <span class="token punctuation">(</span>cno<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="49"></td><td><pre><span class="token comment">-- 上面的两个问题都解决了：</span></pre></td></tr><tr><td data-num="50"></td><td><pre><span class="token comment">-- 添加学生信息：</span></pre></td></tr><tr><td data-num="51"></td><td><pre><span class="token comment">-- > 1452 - Cannot add or update a child row: a foreign key constraint fails (`mytestdb`.`t_student`, CONSTRAINT `fk_stu_classno` FOREIGN KEY (`classno`) REFERENCES `t_class` (`cno`))</span></pre></td></tr><tr><td data-num="52"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> t_student <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">'张三'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">'李四'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">'王五'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="53"></td><td><pre><span class="token comment">-- 删除班级 1：</span></pre></td></tr><tr><td data-num="54"></td><td><pre><span class="token comment">-- 2. 删除班级 2：</span></pre></td></tr><tr><td data-num="55"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> t_student <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">'张三'</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">'李四'</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">'王五'</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="56"></td><td><pre><span class="token comment">-- > 1451 - Cannot delete or update a parent row: a foreign key constraint fails (`mytestdb`.`t_student`, CONSTRAINT `fk_stu_classno` FOREIGN KEY (`classno`) REFERENCES `t_class` (`cno`))</span></pre></td></tr><tr><td data-num="57"></td><td><pre><span class="token keyword">delete</span> <span class="token keyword">from</span> t_class <span class="token keyword">where</span> cno <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="外键约束策略"><a class="anchor" href="#外键约束策略">#</a> 外键约束策略</h3><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">-- 学生表删除：</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">drop</span> <span class="token keyword">table</span> t_student<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">-- 班级表删除：</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">drop</span> <span class="token keyword">table</span> t_class<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">-- 注意：先删除从表，再删除主表。（视频中这个位置笔误，笔记现在已经更正）</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">-- 先创建父表：班级表：</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">create</span> <span class="token keyword">table</span> t_class<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        cno <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        cname <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        room <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment">-- 可以一次性添加多条记录：</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> t_class <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">'java001'</span><span class="token punctuation">,</span><span class="token string">'r803'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">'java002'</span><span class="token punctuation">,</span><span class="token string">'r416'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">'大数据001'</span><span class="token punctuation">,</span><span class="token string">'r103'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">-- 添加学生表，添加外键约束：</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">create</span> <span class="token keyword">table</span> t_student<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        sno <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="17"></td><td><pre>        sname <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="18"></td><td><pre>        classno <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="19"></td><td><pre>                                                                        <span class="token comment">-- 取值参考 t_class 表中的 cno 字段，不要求字段名字完全重复，但是类型长度定义 尽量要求相同。</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token keyword">constraint</span> fk_stu_classno <span class="token keyword">foreign</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>classno<span class="token punctuation">)</span> <span class="token keyword">references</span> t_class <span class="token punctuation">(</span>cno<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token comment">-- 可以一次性添加多条记录：</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> t_student <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">'张三'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">'李四'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">'王五'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">'朱六'</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token comment">-- 查看班级表和学生表：</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> t_class<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> t_student<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token comment">-- 删除班级 2：如果直接删除的话肯定不行因为有外键约束：</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token comment">-- 加入外键策略：</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token comment">-- 策略 1：no action 不允许操作</span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token comment">-- 通过操作 sql 来完成：</span></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token comment">-- 先把班级 2 的学生对应的班级 改为 null </span></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token keyword">update</span> t_student <span class="token keyword">set</span> classno <span class="token operator">=</span> <span class="token boolean">null</span> <span class="token keyword">where</span> classno <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token comment">-- 然后再删除班级 2：</span></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token keyword">delete</span> <span class="token keyword">from</span> t_class <span class="token keyword">where</span> cno <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token comment">-- 策略 2：cascade 级联操作：操作主表的时候影响从表的外键信息：</span></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token comment">-- 先删除之前的外键约束：</span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token keyword">alter</span> <span class="token keyword">table</span> t_student <span class="token keyword">drop</span> <span class="token keyword">foreign</span> <span class="token keyword">key</span> fk_stu_classno<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token comment">-- 重新添加外键约束：</span></pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token keyword">alter</span> <span class="token keyword">table</span> t_student <span class="token keyword">add</span> <span class="token keyword">constraint</span> fk_stu_classno <span class="token keyword">foreign</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>classno<span class="token punctuation">)</span> <span class="token keyword">references</span> t_class <span class="token punctuation">(</span>cno<span class="token punctuation">)</span> <span class="token keyword">on</span> <span class="token keyword">update</span> <span class="token keyword">cascade</span> <span class="token keyword">on</span> <span class="token keyword">delete</span> <span class="token keyword">cascade</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token comment">-- 试试更新：</span></pre></td></tr><tr><td data-num="41"></td><td><pre><span class="token keyword">update</span> t_class <span class="token keyword">set</span> cno <span class="token operator">=</span> <span class="token number">5</span> <span class="token keyword">where</span> cno <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token comment">-- 试试删除：</span></pre></td></tr><tr><td data-num="43"></td><td><pre><span class="token keyword">delete</span> <span class="token keyword">from</span> t_class <span class="token keyword">where</span> cno <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="44"></td><td><pre><span class="token comment">-- 策略 3：set null  置空操作：</span></pre></td></tr><tr><td data-num="45"></td><td><pre><span class="token comment">-- 先删除之前的外键约束：</span></pre></td></tr><tr><td data-num="46"></td><td><pre><span class="token keyword">alter</span> <span class="token keyword">table</span> t_student <span class="token keyword">drop</span> <span class="token keyword">foreign</span> <span class="token keyword">key</span> fk_stu_classno<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="47"></td><td><pre><span class="token comment">-- 重新添加外键约束：</span></pre></td></tr><tr><td data-num="48"></td><td><pre><span class="token keyword">alter</span> <span class="token keyword">table</span> t_student <span class="token keyword">add</span> <span class="token keyword">constraint</span> fk_stu_classno <span class="token keyword">foreign</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>classno<span class="token punctuation">)</span> <span class="token keyword">references</span> t_class <span class="token punctuation">(</span>cno<span class="token punctuation">)</span> <span class="token keyword">on</span> <span class="token keyword">update</span> <span class="token keyword">set</span> <span class="token boolean">null</span> <span class="token keyword">on</span> <span class="token keyword">delete</span> <span class="token keyword">set</span> <span class="token boolean">null</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="49"></td><td><pre><span class="token comment">-- 试试更新：</span></pre></td></tr><tr><td data-num="50"></td><td><pre><span class="token keyword">update</span> t_class <span class="token keyword">set</span> cno <span class="token operator">=</span> <span class="token number">8</span> <span class="token keyword">where</span> cno <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="51"></td><td><pre><span class="token comment">-- 注意：</span></pre></td></tr><tr><td data-num="52"></td><td><pre><span class="token comment">-- 1. 策略 2 级联操作  和  策略 2 的  删除操作  可以混着使用：</span></pre></td></tr><tr><td data-num="53"></td><td><pre><span class="token keyword">alter</span> <span class="token keyword">table</span> t_student <span class="token keyword">add</span> <span class="token keyword">constraint</span> fk_stu_classno <span class="token keyword">foreign</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>classno<span class="token punctuation">)</span> <span class="token keyword">references</span> t_class <span class="token punctuation">(</span>cno<span class="token punctuation">)</span> <span class="token keyword">on</span> <span class="token keyword">update</span> <span class="token keyword">cascade</span> <span class="token keyword">on</span> <span class="token keyword">delete</span> <span class="token keyword">set</span> <span class="token boolean">null</span> <span class="token punctuation">;</span></pre></td></tr><tr><td data-num="54"></td><td><pre><span class="token comment">-- 2. 应用场合：</span></pre></td></tr><tr><td data-num="55"></td><td><pre><span class="token comment">-- （1）朋友圈删除，点赞。留言都删除  --  级联操作</span></pre></td></tr><tr><td data-num="56"></td><td><pre><span class="token comment">-- （2）解散班级，对应的学生 置为班级为 null 就可以了，-- set null</span></pre></td></tr></table></figure><h1 id="ddl和dml的补充"><a class="anchor" href="#ddl和dml的补充">#</a> DDL 和 DML 的补充</h1><h2 id="sql展示-2"><a class="anchor" href="#sql展示-2">#</a> sql 展示：</h2><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">-- 创建表：</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">create</span> <span class="token keyword">table</span> t_student<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="3"></td><td><pre>        sno <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="4"></td><td><pre>        sname <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="5"></td><td><pre>        sex <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">'男'</span> <span class="token keyword">check</span><span class="token punctuation">(</span>sex<span class="token operator">=</span><span class="token string">'男'</span> <span class="token operator">||</span> sex<span class="token operator">=</span><span class="token string">'女'</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        age <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">check</span><span class="token punctuation">(</span>age<span class="token operator">>=</span><span class="token number">18</span> <span class="token operator">and</span> age<span class="token operator">&lt;=</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        enterdate <span class="token keyword">date</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        classname <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        email <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token keyword">unique</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">-- 添加数据：</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> t_student <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">'张三'</span><span class="token punctuation">,</span><span class="token string">'男'</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token string">'2023-9-1'</span><span class="token punctuation">,</span><span class="token string">'java01班'</span><span class="token punctuation">,</span><span class="token string">'zs@126.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> t_student <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">'李四'</span><span class="token punctuation">,</span><span class="token string">'男'</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token string">'2023-9-1'</span><span class="token punctuation">,</span><span class="token string">'java01班'</span><span class="token punctuation">,</span><span class="token string">'ls@126.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> t_student <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">'露露'</span><span class="token punctuation">,</span><span class="token string">'男'</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token string">'2023-9-1'</span><span class="token punctuation">,</span><span class="token string">'java01班'</span><span class="token punctuation">,</span><span class="token string">'ll@126.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token comment">-- 查看学生表：</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> t_student<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token comment">-- 添加一张表：快速添加：结构和数据跟 t_student 都是一致的</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">create</span> <span class="token keyword">table</span> t_student2</pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">as</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> t_student<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> t_student2<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token comment">-- 快速添加，结构跟 t_student 一致，数据没有：</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token keyword">create</span> <span class="token keyword">table</span> t_student3</pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token keyword">as</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> t_student <span class="token keyword">where</span> <span class="token number">1</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> t_student3<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token comment">-- 快速添加：只要部分列，部分数据：</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token keyword">create</span> <span class="token keyword">table</span> t_student4</pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">as</span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token keyword">select</span> sno<span class="token punctuation">,</span>sname<span class="token punctuation">,</span>age <span class="token keyword">from</span> t_student <span class="token keyword">where</span> sno <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> t_student4<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token comment">-- 删除数据操作：清空数据</span></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token keyword">delete</span> <span class="token keyword">from</span> t_student<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token keyword">truncate</span> <span class="token keyword">table</span> t_student<span class="token punctuation">;</span></pre></td></tr></table></figure><h2 id="delete和truncate的区别"><a class="anchor" href="#delete和truncate的区别">#</a> delete 和 truncate 的区别</h2><p>从最终的结果来看，虽然使用 TRUNCATE 操作和使用 DELETE 操作都可以删除表中的全部记录，但是两者还是有很多区别的，其区别主要体现在以下几个方面：</p><ol><li><p>DELETE 为数据操作语言 DML；TRUNCATE 为数据定义语言 DDL。</p></li><li><p>DELETE 操作是将表中所有记录一条一条删除直到删除完；TRUNCATE 操作则是保留了表的结构，重新创建了这个表，所有的状态都相当于新表。因此，TRUNCATE 操作的效率更高。</p></li><li><p>DELETE 操作可以回滚；TRUNCATE 操作会导致隐式提交，因此不能回滚（在第十章中会讲解事务的提交和回滚）。</p></li><li><p>DELETE 操作执行成功后会返回已删除的行数（如删除 4 行记录，则会显示 “Affected rows：4”）；截断操作不会返回已删除的行量，结果通常是 “Affected rows：0”。DELETE 操作删除表中记录后，再次向表中添加新记录时，对于设置有自增约束字段的值会从删除前表中该字段的最大值加 1 开始自增；TRUNCATE 操作则会重新从 1 开始自增。</p></li></ol><h1 id="dql-查询操作"><a class="anchor" href="#dql-查询操作">#</a> DQL - 查询操作</h1><p>表的准备</p><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">-- 准备四张表：dept (部门表),emp (员工表),salgrade (薪资等级表),bonus (奖金表)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">create</span> <span class="token keyword">table</span> DEPT<span class="token punctuation">(</span>  </pre></td></tr><tr><td data-num="3"></td><td><pre>  DEPTNO <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>  </pre></td></tr><tr><td data-num="4"></td><td><pre>  DNAME  <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  </pre></td></tr><tr><td data-num="5"></td><td><pre>  LOC    <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">alter</span> <span class="token keyword">table</span> DEPT  </pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token keyword">add</span> <span class="token keyword">constraint</span> PK_DEPT <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>DEPTNO<span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="9"></td><td><pre>        </pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">create</span> <span class="token keyword">table</span> EMP  </pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">(</span>  </pre></td></tr><tr><td data-num="12"></td><td><pre>  EMPNO    <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>  </pre></td></tr><tr><td data-num="13"></td><td><pre>  ENAME    <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  </pre></td></tr><tr><td data-num="14"></td><td><pre>  JOB      <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  </pre></td></tr><tr><td data-num="15"></td><td><pre>  MGR      <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  </pre></td></tr><tr><td data-num="16"></td><td><pre>  HIREDATE <span class="token keyword">DATE</span><span class="token punctuation">,</span>  </pre></td></tr><tr><td data-num="17"></td><td><pre>  SAL      <span class="token keyword">double</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  </pre></td></tr><tr><td data-num="18"></td><td><pre>  COMM     <span class="token keyword">double</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  </pre></td></tr><tr><td data-num="19"></td><td><pre>  DEPTNO   <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">alter</span> <span class="token keyword">table</span> EMP  </pre></td></tr><tr><td data-num="22"></td><td><pre>  <span class="token keyword">add</span> <span class="token keyword">constraint</span> FK_DEPTNO <span class="token keyword">foreign</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>DEPTNO<span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="23"></td><td><pre>  <span class="token keyword">references</span> DEPT <span class="token punctuation">(</span>DEPTNO<span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="24"></td><td><pre>        </pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token keyword">create</span> <span class="token keyword">table</span> SALGRADE  </pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token punctuation">(</span>  </pre></td></tr><tr><td data-num="27"></td><td><pre>  GRADE <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>  </pre></td></tr><tr><td data-num="28"></td><td><pre>  LOSAL <span class="token keyword">double</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  </pre></td></tr><tr><td data-num="29"></td><td><pre>  HISAL <span class="token keyword">double</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token keyword">create</span> <span class="token keyword">table</span> BONUS  </pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token punctuation">(</span>  </pre></td></tr><tr><td data-num="33"></td><td><pre>  ENAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  </pre></td></tr><tr><td data-num="34"></td><td><pre>  JOB   <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  </pre></td></tr><tr><td data-num="35"></td><td><pre>  SAL   <span class="token keyword">double</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  </pre></td></tr><tr><td data-num="36"></td><td><pre>  COMM  <span class="token keyword">double</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> DEPT <span class="token punctuation">(</span>DEPTNO<span class="token punctuation">,</span> DNAME<span class="token punctuation">,</span> LOC<span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">'ACCOUNTING'</span><span class="token punctuation">,</span> <span class="token string">'NEW YORK'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> DEPT <span class="token punctuation">(</span>DEPTNO<span class="token punctuation">,</span> DNAME<span class="token punctuation">,</span> LOC<span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="41"></td><td><pre><span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token string">'RESEARCH'</span><span class="token punctuation">,</span> <span class="token string">'DALLAS'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> DEPT <span class="token punctuation">(</span>DEPTNO<span class="token punctuation">,</span> DNAME<span class="token punctuation">,</span> LOC<span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="43"></td><td><pre><span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token string">'SALES'</span><span class="token punctuation">,</span> <span class="token string">'CHICAGO'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="44"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> DEPT <span class="token punctuation">(</span>DEPTNO<span class="token punctuation">,</span> DNAME<span class="token punctuation">,</span> LOC<span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="45"></td><td><pre><span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token string">'OPERATIONS'</span><span class="token punctuation">,</span> <span class="token string">'BOSTON'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="46"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> EMP <span class="token punctuation">(</span>EMPNO<span class="token punctuation">,</span> ENAME<span class="token punctuation">,</span> JOB<span class="token punctuation">,</span> MGR<span class="token punctuation">,</span> HIREDATE<span class="token punctuation">,</span> SAL<span class="token punctuation">,</span> COMM<span class="token punctuation">,</span> DEPTNO<span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="47"></td><td><pre><span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">7369</span><span class="token punctuation">,</span> <span class="token string">'SMITH'</span><span class="token punctuation">,</span> <span class="token string">'CLERK'</span><span class="token punctuation">,</span> <span class="token number">7902</span><span class="token punctuation">,</span> <span class="token string">'1980-12-17'</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="48"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> EMP <span class="token punctuation">(</span>EMPNO<span class="token punctuation">,</span> ENAME<span class="token punctuation">,</span> JOB<span class="token punctuation">,</span> MGR<span class="token punctuation">,</span> HIREDATE<span class="token punctuation">,</span> SAL<span class="token punctuation">,</span> COMM<span class="token punctuation">,</span> DEPTNO<span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="49"></td><td><pre><span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">7499</span><span class="token punctuation">,</span> <span class="token string">'ALLEN'</span><span class="token punctuation">,</span> <span class="token string">'SALESMAN'</span><span class="token punctuation">,</span> <span class="token number">7698</span><span class="token punctuation">,</span> <span class="token string">'1981-02-20'</span><span class="token punctuation">,</span> <span class="token number">1600</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="50"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> EMP <span class="token punctuation">(</span>EMPNO<span class="token punctuation">,</span> ENAME<span class="token punctuation">,</span> JOB<span class="token punctuation">,</span> MGR<span class="token punctuation">,</span> HIREDATE<span class="token punctuation">,</span> SAL<span class="token punctuation">,</span> COMM<span class="token punctuation">,</span> DEPTNO<span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="51"></td><td><pre><span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">7521</span><span class="token punctuation">,</span> <span class="token string">'WARD'</span><span class="token punctuation">,</span> <span class="token string">'SALESMAN'</span><span class="token punctuation">,</span> <span class="token number">7698</span><span class="token punctuation">,</span> <span class="token string">'1981-02-22'</span><span class="token punctuation">,</span> <span class="token number">1250</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="52"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> EMP <span class="token punctuation">(</span>EMPNO<span class="token punctuation">,</span> ENAME<span class="token punctuation">,</span> JOB<span class="token punctuation">,</span> MGR<span class="token punctuation">,</span> HIREDATE<span class="token punctuation">,</span> SAL<span class="token punctuation">,</span> COMM<span class="token punctuation">,</span> DEPTNO<span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="53"></td><td><pre><span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">7566</span><span class="token punctuation">,</span> <span class="token string">'JONES'</span><span class="token punctuation">,</span> <span class="token string">'MANAGER'</span><span class="token punctuation">,</span> <span class="token number">7839</span><span class="token punctuation">,</span> <span class="token string">'1981-04-02'</span><span class="token punctuation">,</span> <span class="token number">2975</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="54"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> EMP <span class="token punctuation">(</span>EMPNO<span class="token punctuation">,</span> ENAME<span class="token punctuation">,</span> JOB<span class="token punctuation">,</span> MGR<span class="token punctuation">,</span> HIREDATE<span class="token punctuation">,</span> SAL<span class="token punctuation">,</span> COMM<span class="token punctuation">,</span> DEPTNO<span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="55"></td><td><pre><span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">7654</span><span class="token punctuation">,</span> <span class="token string">'MARTIN'</span><span class="token punctuation">,</span> <span class="token string">'SALESMAN'</span><span class="token punctuation">,</span> <span class="token number">7698</span><span class="token punctuation">,</span> <span class="token string">'1981-09-28'</span><span class="token punctuation">,</span> <span class="token number">1250</span><span class="token punctuation">,</span> <span class="token number">1400</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="56"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> EMP <span class="token punctuation">(</span>EMPNO<span class="token punctuation">,</span> ENAME<span class="token punctuation">,</span> JOB<span class="token punctuation">,</span> MGR<span class="token punctuation">,</span> HIREDATE<span class="token punctuation">,</span> SAL<span class="token punctuation">,</span> COMM<span class="token punctuation">,</span> DEPTNO<span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="57"></td><td><pre><span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">7698</span><span class="token punctuation">,</span> <span class="token string">'BLAKE'</span><span class="token punctuation">,</span> <span class="token string">'MANAGER'</span><span class="token punctuation">,</span> <span class="token number">7839</span><span class="token punctuation">,</span> <span class="token string">'1981-05-01'</span><span class="token punctuation">,</span> <span class="token number">2850</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="58"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> EMP <span class="token punctuation">(</span>EMPNO<span class="token punctuation">,</span> ENAME<span class="token punctuation">,</span> JOB<span class="token punctuation">,</span> MGR<span class="token punctuation">,</span> HIREDATE<span class="token punctuation">,</span> SAL<span class="token punctuation">,</span> COMM<span class="token punctuation">,</span> DEPTNO<span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="59"></td><td><pre><span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">7782</span><span class="token punctuation">,</span> <span class="token string">'CLARK'</span><span class="token punctuation">,</span> <span class="token string">'MANAGER'</span><span class="token punctuation">,</span> <span class="token number">7839</span><span class="token punctuation">,</span> <span class="token string">'1981-06-09'</span><span class="token punctuation">,</span> <span class="token number">2450</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="60"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> EMP <span class="token punctuation">(</span>EMPNO<span class="token punctuation">,</span> ENAME<span class="token punctuation">,</span> JOB<span class="token punctuation">,</span> MGR<span class="token punctuation">,</span> HIREDATE<span class="token punctuation">,</span> SAL<span class="token punctuation">,</span> COMM<span class="token punctuation">,</span> DEPTNO<span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="61"></td><td><pre><span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">7788</span><span class="token punctuation">,</span> <span class="token string">'SCOTT'</span><span class="token punctuation">,</span> <span class="token string">'ANALYST'</span><span class="token punctuation">,</span> <span class="token number">7566</span><span class="token punctuation">,</span> <span class="token string">'1987-04-19'</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="62"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> EMP <span class="token punctuation">(</span>EMPNO<span class="token punctuation">,</span> ENAME<span class="token punctuation">,</span> JOB<span class="token punctuation">,</span> MGR<span class="token punctuation">,</span> HIREDATE<span class="token punctuation">,</span> SAL<span class="token punctuation">,</span> COMM<span class="token punctuation">,</span> DEPTNO<span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="63"></td><td><pre><span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">7839</span><span class="token punctuation">,</span> <span class="token string">'KING'</span><span class="token punctuation">,</span> <span class="token string">'PRESIDENT'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token string">'1981-11-17'</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="64"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> EMP <span class="token punctuation">(</span>EMPNO<span class="token punctuation">,</span> ENAME<span class="token punctuation">,</span> JOB<span class="token punctuation">,</span> MGR<span class="token punctuation">,</span> HIREDATE<span class="token punctuation">,</span> SAL<span class="token punctuation">,</span> COMM<span class="token punctuation">,</span> DEPTNO<span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="65"></td><td><pre><span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">7844</span><span class="token punctuation">,</span> <span class="token string">'TURNER'</span><span class="token punctuation">,</span> <span class="token string">'SALESMAN'</span><span class="token punctuation">,</span> <span class="token number">7698</span><span class="token punctuation">,</span> <span class="token string">'1981-09-08'</span><span class="token punctuation">,</span> <span class="token number">1500</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="66"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> EMP <span class="token punctuation">(</span>EMPNO<span class="token punctuation">,</span> ENAME<span class="token punctuation">,</span> JOB<span class="token punctuation">,</span> MGR<span class="token punctuation">,</span> HIREDATE<span class="token punctuation">,</span> SAL<span class="token punctuation">,</span> COMM<span class="token punctuation">,</span> DEPTNO<span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="67"></td><td><pre><span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">7876</span><span class="token punctuation">,</span> <span class="token string">'ADAMS'</span><span class="token punctuation">,</span> <span class="token string">'CLERK'</span><span class="token punctuation">,</span> <span class="token number">7788</span><span class="token punctuation">,</span> <span class="token string">'1987-05-23'</span><span class="token punctuation">,</span> <span class="token number">1100</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="68"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> EMP <span class="token punctuation">(</span>EMPNO<span class="token punctuation">,</span> ENAME<span class="token punctuation">,</span> JOB<span class="token punctuation">,</span> MGR<span class="token punctuation">,</span> HIREDATE<span class="token punctuation">,</span> SAL<span class="token punctuation">,</span> COMM<span class="token punctuation">,</span> DEPTNO<span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="69"></td><td><pre><span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">7900</span><span class="token punctuation">,</span> <span class="token string">'JAMES'</span><span class="token punctuation">,</span> <span class="token string">'CLERK'</span><span class="token punctuation">,</span> <span class="token number">7698</span><span class="token punctuation">,</span> <span class="token string">'1981-12-03'</span><span class="token punctuation">,</span> <span class="token number">950</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="70"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> EMP <span class="token punctuation">(</span>EMPNO<span class="token punctuation">,</span> ENAME<span class="token punctuation">,</span> JOB<span class="token punctuation">,</span> MGR<span class="token punctuation">,</span> HIREDATE<span class="token punctuation">,</span> SAL<span class="token punctuation">,</span> COMM<span class="token punctuation">,</span> DEPTNO<span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="71"></td><td><pre><span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">7902</span><span class="token punctuation">,</span> <span class="token string">'FORD'</span><span class="token punctuation">,</span> <span class="token string">'ANALYST'</span><span class="token punctuation">,</span> <span class="token number">7566</span><span class="token punctuation">,</span> <span class="token string">'1981-12-03'</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="72"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> EMP <span class="token punctuation">(</span>EMPNO<span class="token punctuation">,</span> ENAME<span class="token punctuation">,</span> JOB<span class="token punctuation">,</span> MGR<span class="token punctuation">,</span> HIREDATE<span class="token punctuation">,</span> SAL<span class="token punctuation">,</span> COMM<span class="token punctuation">,</span> DEPTNO<span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="73"></td><td><pre><span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">7934</span><span class="token punctuation">,</span> <span class="token string">'MILLER'</span><span class="token punctuation">,</span> <span class="token string">'CLERK'</span><span class="token punctuation">,</span> <span class="token number">7782</span><span class="token punctuation">,</span> <span class="token string">'1982-01-23'</span><span class="token punctuation">,</span> <span class="token number">1300</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="74"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> SALGRADE <span class="token punctuation">(</span>GRADE<span class="token punctuation">,</span> LOSAL<span class="token punctuation">,</span> HISAL<span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="75"></td><td><pre><span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">700</span><span class="token punctuation">,</span> <span class="token number">1200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="76"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> SALGRADE <span class="token punctuation">(</span>GRADE<span class="token punctuation">,</span> LOSAL<span class="token punctuation">,</span> HISAL<span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="77"></td><td><pre><span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1201</span><span class="token punctuation">,</span> <span class="token number">1400</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="78"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> SALGRADE <span class="token punctuation">(</span>GRADE<span class="token punctuation">,</span> LOSAL<span class="token punctuation">,</span> HISAL<span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="79"></td><td><pre><span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1401</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="80"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> SALGRADE <span class="token punctuation">(</span>GRADE<span class="token punctuation">,</span> LOSAL<span class="token punctuation">,</span> HISAL<span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="81"></td><td><pre><span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2001</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="82"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> SALGRADE <span class="token punctuation">(</span>GRADE<span class="token punctuation">,</span> LOSAL<span class="token punctuation">,</span> HISAL<span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="83"></td><td><pre><span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3001</span><span class="token punctuation">,</span> <span class="token number">9999</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="84"></td><td><pre><span class="token comment">-- 查看表：</span></pre></td></tr><tr><td data-num="85"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> dept<span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="86"></td><td><pre><span class="token comment">-- 部门表：dept:department 部分 ，loc - location 位置</span></pre></td></tr><tr><td data-num="87"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="88"></td><td><pre><span class="token comment">-- 员工表：emp:employee 员工，mgr :manager 上级领导编号，hiredate 入职日期  firedate 解雇日期 ，common：补助</span></pre></td></tr><tr><td data-num="89"></td><td><pre><span class="token comment">-- deptno 外键 参考  dept - deptno 字段</span></pre></td></tr><tr><td data-num="90"></td><td><pre><span class="token comment">-- mgr 外键  参考  自身表 emp - empno  产生了自关联</span></pre></td></tr><tr><td data-num="91"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> salgrade<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="92"></td><td><pre><span class="token comment">-- losal - lowsal</span></pre></td></tr><tr><td data-num="93"></td><td><pre><span class="token comment">-- hisal - highsal</span></pre></td></tr><tr><td data-num="94"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> bonus<span class="token punctuation">;</span></pre></td></tr></table></figure><h2 id="单表查询"><a class="anchor" href="#单表查询">#</a> 单表查询</h2><h3 id="简单sql-查询"><a class="anchor" href="#简单sql-查询">#</a> 简单 SQL 查询</h3><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">-- 对 emp 表查询：</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span> <span class="token comment">-- * 代表所有数据</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">-- 显示部分列：</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">select</span> empno<span class="token punctuation">,</span>ename<span class="token punctuation">,</span>sal <span class="token keyword">from</span> emp<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">-- 显示部分行：where 子句</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> sal <span class="token operator">></span> <span class="token number">2000</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">-- 显示部分列，部分行：</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">select</span> empno<span class="token punctuation">,</span>ename<span class="token punctuation">,</span>job<span class="token punctuation">,</span>mgr <span class="token keyword">from</span> emp <span class="token keyword">where</span> sal <span class="token operator">></span> <span class="token number">2000</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment">-- 起别名：</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">select</span> empno 员工编号<span class="token punctuation">,</span>ename 姓名<span class="token punctuation">,</span>sal 工资 <span class="token keyword">from</span> emp<span class="token punctuation">;</span> <span class="token comment">-- as 省略，'' 或者 "" 省略了</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">-- as alias 别名</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">select</span> empno <span class="token keyword">as</span> 员工编号<span class="token punctuation">,</span>ename <span class="token keyword">as</span> 姓名<span class="token punctuation">,</span>sal <span class="token keyword">as</span> 工资 <span class="token keyword">from</span> emp<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">select</span> empno <span class="token keyword">as</span> <span class="token string">'员工编号'</span><span class="token punctuation">,</span>ename <span class="token keyword">as</span> <span class="token string">"姓名"</span><span class="token punctuation">,</span>sal <span class="token keyword">as</span> 工资 <span class="token keyword">from</span> emp<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">-- > 1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ' 编号，ename as "姓 名",sal as 工资 from emp' at line 1</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token comment">-- 错误原因：在别名中有特殊符号的时候，'' 或者 "" 不可以省略不写</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">select</span> empno <span class="token keyword">as</span> 员工 编号<span class="token punctuation">,</span>ename <span class="token keyword">as</span> <span class="token string">"姓 名"</span><span class="token punctuation">,</span>sal <span class="token keyword">as</span> 工资 <span class="token keyword">from</span> emp<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token comment">-- 算术运算符：</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">select</span> empno<span class="token punctuation">,</span>ename<span class="token punctuation">,</span>sal<span class="token punctuation">,</span>sal<span class="token operator">+</span><span class="token number">1000</span> <span class="token keyword">as</span> <span class="token string">'涨薪后'</span><span class="token punctuation">,</span>deptno <span class="token keyword">from</span> emp <span class="token keyword">where</span> sal <span class="token operator">&lt;</span> <span class="token number">2500</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">select</span> empno<span class="token punctuation">,</span>ename<span class="token punctuation">,</span>sal<span class="token punctuation">,</span>comm<span class="token punctuation">,</span>sal<span class="token operator">+</span>comm <span class="token keyword">from</span> emp<span class="token punctuation">;</span>  <span class="token comment">-- ？？？后面再说</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token comment">-- 去重操作：</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">select</span> job <span class="token keyword">from</span> emp<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token keyword">select</span> <span class="token keyword">distinct</span> job <span class="token keyword">from</span> emp<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token keyword">select</span> job<span class="token punctuation">,</span>deptno <span class="token keyword">from</span> emp<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token keyword">select</span> <span class="token keyword">distinct</span> job<span class="token punctuation">,</span>deptno <span class="token keyword">from</span> emp<span class="token punctuation">;</span> <span class="token comment">-- 对后面的所有列组合 去重 ，而不是单独的某一列去重</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token comment">-- 排序：</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">order</span> <span class="token keyword">by</span> sal<span class="token punctuation">;</span> <span class="token comment">-- 默认情况下是按照升序排列的</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">order</span> <span class="token keyword">by</span> sal <span class="token keyword">asc</span><span class="token punctuation">;</span> <span class="token comment">-- asc 升序，可以默认不写</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">order</span> <span class="token keyword">by</span> sal <span class="token keyword">desc</span><span class="token punctuation">;</span> <span class="token comment">-- desc 降序</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">order</span> <span class="token keyword">by</span> sal <span class="token keyword">asc</span> <span class="token punctuation">,</span>deptno <span class="token keyword">desc</span><span class="token punctuation">;</span> <span class="token comment">-- 在工资升序的情况下，deptno 按照降序排列</span></pre></td></tr></table></figure><h3 id="where子句"><a class="anchor" href="#where子句">#</a> where 子句</h3><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">-- 指定查询条件使用 where 子句，可以查询符合条件的部分记录。</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">-- 查看 emp 表：</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">-- where 子句：将过滤条件放在 where 子句的后面，可以筛选 / 过滤出我们想要的符合条件的数据：</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">-- where 子句 + 关系运算符</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> deptno <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> deptno <span class="token operator">></span> <span class="token number">10</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> deptno <span class="token operator">>=</span> <span class="token number">10</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> deptno <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> deptno <span class="token operator">&lt;=</span> <span class="token number">10</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> deptno <span class="token operator">&lt;></span> <span class="token number">10</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> deptno <span class="token operator">!=</span> <span class="token number">10</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> job <span class="token operator">=</span> <span class="token string">'CLERK'</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> job <span class="token operator">=</span> <span class="token string">'clerk'</span><span class="token punctuation">;</span> <span class="token comment">-- 默认情况下不区分大小写 </span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> <span class="token keyword">binary</span> job <span class="token operator">=</span> <span class="token string">'clerk'</span><span class="token punctuation">;</span> <span class="token comment">-- binary 区分大小写</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> hiredate <span class="token operator">&lt;</span> <span class="token string">'1981-12-25'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token comment">-- where 子句 + 逻辑运算符：and </span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> sal <span class="token operator">></span> <span class="token number">1500</span> <span class="token operator">and</span> sal <span class="token operator">&lt;</span> <span class="token number">3000</span><span class="token punctuation">;</span>  <span class="token comment">-- (1500,3000)</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> sal <span class="token operator">></span> <span class="token number">1500</span> <span class="token operator">&amp;&amp;</span> sal <span class="token operator">&lt;</span> <span class="token number">3000</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> sal <span class="token operator">></span> <span class="token number">1500</span> <span class="token operator">and</span> sal <span class="token operator">&lt;</span> <span class="token number">3000</span> <span class="token keyword">order</span> <span class="token keyword">by</span> sal<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> sal <span class="token operator">between</span> <span class="token number">1500</span> <span class="token operator">and</span> <span class="token number">3000</span><span class="token punctuation">;</span> <span class="token comment">-- [1500,3000]</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token comment">-- where 子句 + 逻辑运算符：or</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> deptno <span class="token operator">=</span> <span class="token number">10</span> <span class="token operator">or</span> deptno <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> deptno <span class="token operator">=</span> <span class="token number">10</span> <span class="token operator">||</span> deptno <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> deptno <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> job <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token string">'MANAGER'</span><span class="token punctuation">,</span><span class="token string">'CLERK'</span><span class="token punctuation">,</span><span class="token string">'ANALYST'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token comment">-- where 子句 + 模糊查询：</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token comment">-- 查询名字中带 A 的员工  -- % 代表任意多个字符 0,1,2，.....</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> ename <span class="token operator">like</span> <span class="token string">'%A%'</span> <span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token comment">-- - 任意一个字符</span></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> ename <span class="token operator">like</span> <span class="token string">'__A%'</span> <span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token comment">-- 关于 null 的判断：</span></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> comm <span class="token operator">is</span> <span class="token boolean">null</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> comm <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token comment">-- 小括号的使用  ：因为不同的运算符的优先级别不同，加括号为了可读性</span></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> job <span class="token operator">=</span> <span class="token string">'SALESMAN'</span> <span class="token operator">or</span> job <span class="token operator">=</span> <span class="token string">'CLERK'</span> <span class="token operator">and</span> sal <span class="token operator">>=</span><span class="token number">1500</span><span class="token punctuation">;</span> <span class="token comment">-- 先 and 再 or  and > or</span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> job <span class="token operator">=</span> <span class="token string">'SALESMAN'</span> <span class="token operator">or</span> <span class="token punctuation">(</span>job <span class="token operator">=</span> <span class="token string">'CLERK'</span> <span class="token operator">and</span> sal <span class="token operator">>=</span><span class="token number">1500</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> <span class="token punctuation">(</span>job <span class="token operator">=</span> <span class="token string">'SALESMAN'</span> <span class="token operator">or</span> job <span class="token operator">=</span> <span class="token string">'CLERK'</span><span class="token punctuation">)</span> <span class="token operator">and</span> sal <span class="token operator">>=</span><span class="token number">1500</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="使用函数"><a class="anchor" href="#使用函数">#</a> 使用函数</h3><p>​ MySQL 中提供了大量函数来简化用户对数据库的操作，比如字符串的处理、日期的运算、数值的运算等等。使用函数可以大大提高 SELECT 语句操作数据库的能力，同时也给数据的转换和处理提供了方便。 （在 sql 中使用函数）</p><p>​ 函数只是对查询结果中的数据进行处理，不会改变数据库中数据表的值。MySQL 中的函数主要分为单行函数和多行函数两大类，下面我们将详细讲解这两大类函数。</p><p><strong>单行函数</strong></p><p>​ 单行函数是指对每一条记录输入值进行计算，并得到相应的计算结果，然后返回给用户，也就是说，每条记录作为一个输入参数，经过函数计算得到每条记录的计算结果。</p><p>常用的单行函数主要包括字符串函数、数值函数、日期与时间函数、流程函数以及其他函数。</p><p><strong>多行函数</strong></p><p>​ 多行函数是指对一组数据进行运算，针对这一组数据（多行记录）只返回一个结果，也称为分组函数。</p><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">-- 函数举例：</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">select</span> empno<span class="token punctuation">,</span>ename<span class="token punctuation">,</span>lower<span class="token punctuation">(</span>ename<span class="token punctuation">)</span><span class="token punctuation">,</span>upper<span class="token punctuation">(</span>ename<span class="token punctuation">)</span><span class="token punctuation">,</span>sal <span class="token keyword">from</span> emp<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">-- 函数的功能：封装了特定的一些功能，我们直接拿过来使用，可以实现对应的功能</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">-- 函数作用：为了提高 select 的能力</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">-- 注意：函数没有改变数据自身的值，而是在真实数据的上面进行加工处理，展示新的结果而已。</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">select</span> <span class="token function">max</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">min</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">avg</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">-- 函数的分类：</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment">-- lower (ename),upper (ename) ：改变每一条结果，每一条数据对应一条结果  -- 单行函数</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment">-- max (sal),min (sal),count (sal),sum (sal),avg (sal): 多条数据，最终展示一个结果  -- 多行函数</span></pre></td></tr></table></figure><p>PS：除了多行函数（max,min,count,sum,avg），都是单行函数</p><h3 id="group_by分组"><a class="anchor" href="#group_by分组">#</a> group_by 分组</h3><p>【1】group by : 用来进行分组</p><p>【2】sql 展示：</p><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">-- 统计各个部门的平均工资 </span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">select</span> deptno<span class="token punctuation">,</span><span class="token function">avg</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span> <span class="token comment">-- 字段和多行函数不可以同时使用</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">select</span> deptno<span class="token punctuation">,</span><span class="token function">avg</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token keyword">from</span> emp <span class="token keyword">group</span> <span class="token keyword">by</span> deptno<span class="token punctuation">;</span> <span class="token comment">-- 字段和多行函数不可以同时使用，除非这个字段属于分组</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">select</span> deptno<span class="token punctuation">,</span><span class="token function">avg</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token keyword">from</span> emp <span class="token keyword">group</span> <span class="token keyword">by</span> deptno <span class="token keyword">order</span> <span class="token keyword">by</span> deptno <span class="token keyword">desc</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">-- 统计各个岗位的平均工资</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">select</span> job<span class="token punctuation">,</span><span class="token function">avg</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token keyword">from</span> emp <span class="token keyword">group</span> <span class="token keyword">by</span> job<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">select</span> job<span class="token punctuation">,</span>lower<span class="token punctuation">(</span>job<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">avg</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token keyword">from</span> emp <span class="token keyword">group</span> <span class="token keyword">by</span> job<span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="having分组后筛选"><a class="anchor" href="#having分组后筛选">#</a> having 分组后筛选</h3><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">-- 统计各个部门的平均工资，只显示平均工资 2000 以上的  - 分组以后进行二次筛选 having</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">select</span> deptno<span class="token punctuation">,</span><span class="token function">avg</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token keyword">from</span> emp <span class="token keyword">group</span> <span class="token keyword">by</span> deptno <span class="token keyword">having</span> <span class="token function">avg</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">2000</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">select</span> deptno<span class="token punctuation">,</span><span class="token function">avg</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> 平均工资 <span class="token keyword">from</span> emp <span class="token keyword">group</span> <span class="token keyword">by</span> deptno <span class="token keyword">having</span> 平均工资 <span class="token operator">></span> <span class="token number">2000</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">select</span> deptno<span class="token punctuation">,</span><span class="token function">avg</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> 平均工资 <span class="token keyword">from</span> emp <span class="token keyword">group</span> <span class="token keyword">by</span> deptno <span class="token keyword">having</span> 平均工资 <span class="token operator">></span> <span class="token number">2000</span> <span class="token keyword">order</span> <span class="token keyword">by</span> deptno <span class="token keyword">desc</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">-- 统计各个岗位的平均工资，除了 MANAGER</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">-- 方法 1：</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">select</span> job<span class="token punctuation">,</span><span class="token function">avg</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> job <span class="token operator">!=</span> <span class="token string">'MANAGER'</span> <span class="token keyword">group</span> <span class="token keyword">by</span> job<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment">-- 方法 2：</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">select</span> job<span class="token punctuation">,</span><span class="token function">avg</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token keyword">from</span> emp <span class="token keyword">group</span> <span class="token keyword">by</span> job <span class="token keyword">having</span> job <span class="token operator">!=</span> <span class="token string">'MANAGER'</span> <span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token comment">-- where 在分组前进行过滤的，having 在分组后进行后滤。</span></pre></td></tr></table></figure><h3 id="单表查询总结"><a class="anchor" href="#单表查询总结">#</a> 单表查询总结</h3><p>【1】select 语句总结</p><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">select</span> <span class="token keyword">column</span><span class="token punctuation">,</span> group_function<span class="token punctuation">(</span><span class="token keyword">column</span><span class="token punctuation">)</span> </pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> <span class="token keyword">table</span> </pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">[</span><span class="token keyword">where</span> condition<span class="token punctuation">]</span> </pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">[</span><span class="token keyword">group</span> <span class="token keyword">by</span>  group_by_expression<span class="token punctuation">]</span> </pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">[</span><span class="token keyword">having</span> group_condition<span class="token punctuation">]</span> </pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">[</span><span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token keyword">column</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>注意：顺序固定，不可以改变顺序</p><p>【2】select 语句的执行顺序</p><blockquote><p>from	--&gt;	where	--&gt;	group by	--&gt;	select --&gt;	having	--&gt; order by</p></blockquote><p>【3】单表查询练习：</p><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">-- 单表查询练习：</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">-- 列出工资最小值小于 2000 的职位</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">select</span> job<span class="token punctuation">,</span><span class="token function">min</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">from</span> emp</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">group</span> <span class="token keyword">by</span> job</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">having</span> <span class="token function">min</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">2000</span> <span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">-- 列出平均工资大于 1200 元的部门和工作搭配组合</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">select</span> deptno<span class="token punctuation">,</span>job<span class="token punctuation">,</span><span class="token function">avg</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">from</span> emp</pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">group</span> <span class="token keyword">by</span> deptno<span class="token punctuation">,</span>job</pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">having</span> <span class="token function">avg</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1200</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">order</span> <span class="token keyword">by</span> deptno<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token comment">-- 统计 [人数小于 4 的] 部门的平均工资。 </span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">select</span> deptno<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">avg</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">from</span> emp</pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">group</span> <span class="token keyword">by</span> deptno</pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">4</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token comment">-- 统计各部门的最高工资，排除最高工资小于 3000 的部门。</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">select</span> deptno<span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token keyword">from</span> emp </pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">group</span> <span class="token keyword">by</span> deptno</pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token keyword">having</span> <span class="token function">max</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">3000</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h2 id="多表查询"><a class="anchor" href="#多表查询">#</a> 多表查询</h2><h3 id="99语法交叉连接自然连接内连接查询"><a class="anchor" href="#99语法交叉连接自然连接内连接查询">#</a> 99 语法：交叉连接，自然连接，内连接查询</h3><p>【1】多表查询引入：<br>实际开发中往往需要针对两张甚至更多张数据表进行操作，而这多张表之间需要使用主键和外键关联在一起，然后使用连接查询来查询多张表中满足要求的数据记录。</p><p>一条 SQL 语句查询多个表，得到一个结果，包含多个表的数据。效率高。在 SQL99 中，连接查询需要使用 join 关键字实现。</p><p>提供了多种连接查询的类型： cross natural using on</p><p>交叉连接（CROSS JOIN）是对两个或者多个表进行笛卡儿积操作，所谓笛卡儿积就是关系代数里的一个概念，表示两个表中的每一行数据任意组合的结果。比如：有两个表，左表有 m 条数据记录，x 个字段，右表有 n 条数据记录，y 个字段，则执行交叉连接后将返回 m*n 条数据记录，x+y 个字段。笛卡儿积示意图如图所示。</p><img data-src="/DataBase/MySQL/MySQL_Basic/image-20221027163519213.png" title="image-20221027163519213"><p>【2】sql 展示：</p><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">-- 查询员工的编号，姓名，部门编号：</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">select</span> empno<span class="token punctuation">,</span>ename<span class="token punctuation">,</span>deptno <span class="token keyword">from</span> emp<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">-- 查询员工的编号，姓名，部门编号，部门名称：</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span> <span class="token comment">-- 14 条记录</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> dept<span class="token punctuation">;</span> <span class="token comment">-- 4 条记录 </span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">-- 多表查询 ：</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment">-- 交叉连接：cross join</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> </pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">from</span> emp</pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">cross</span> <span class="token keyword">join</span> dept<span class="token punctuation">;</span> <span class="token comment">-- 14*4 = 56 条 笛卡尔乘积 ： 没有实际意义，有理论意义</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> </pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">from</span> emp</pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">join</span> dept<span class="token punctuation">;</span> <span class="token comment">-- cross 可以省略不写，mysql 中可以，oracle 中不可以</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token comment">-- 自然连接：natural join </span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment">-- 优点：自动匹配所有的同名列，同名列只展示一次 ，简单</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> </pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">from</span> emp</pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">natural</span> <span class="token keyword">join</span> dept<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token keyword">select</span> empno<span class="token punctuation">,</span>ename<span class="token punctuation">,</span>sal<span class="token punctuation">,</span>dname<span class="token punctuation">,</span>loc </pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">from</span> emp</pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token keyword">natural</span> <span class="token keyword">join</span> dept<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token comment">-- 缺点： 查询字段的时候，没有指定字段所属的数据库表，效率低</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token comment">-- 解决： 指定表名：</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token keyword">select</span> emp<span class="token punctuation">.</span>empno<span class="token punctuation">,</span>emp<span class="token punctuation">.</span>ename<span class="token punctuation">,</span>emp<span class="token punctuation">.</span>sal<span class="token punctuation">,</span>dept<span class="token punctuation">.</span>dname<span class="token punctuation">,</span>dept<span class="token punctuation">.</span>loc<span class="token punctuation">,</span>dept<span class="token punctuation">.</span>deptno</pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token keyword">from</span> emp</pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token keyword">natural</span> <span class="token keyword">join</span> dept<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token comment">-- 缺点：表名太长</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token comment">-- 解决：表起别名</span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token keyword">select</span> e<span class="token punctuation">.</span>empno<span class="token punctuation">,</span>e<span class="token punctuation">.</span>ename<span class="token punctuation">,</span>e<span class="token punctuation">.</span>sal<span class="token punctuation">,</span>d<span class="token punctuation">.</span>dname<span class="token punctuation">,</span>d<span class="token punctuation">.</span>loc<span class="token punctuation">,</span>d<span class="token punctuation">.</span>deptno</pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token keyword">from</span> emp e</pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token keyword">natural</span> <span class="token keyword">join</span> dept d<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token comment">-- 自然连接 natural join 缺点：自动匹配表中所有的同名列，但是有时候我们希望只匹配部分同名列：</span></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token comment">-- 解决： 内连接 - using 子句：</span></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> </pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token keyword">from</span> emp e</pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token keyword">inner</span> <span class="token keyword">join</span> dept d <span class="token comment">-- inner 可以不写</span></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token keyword">using</span><span class="token punctuation">(</span>deptno<span class="token punctuation">)</span> <span class="token comment">-- 这里不能写 natural join 了，这里是内连接</span></pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token comment">-- using 缺点：关联的字段，必须是同名的 </span></pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token comment">-- 解决： 内连接 - on 子句：</span></pre></td></tr><tr><td data-num="41"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> </pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token keyword">from</span> emp e</pre></td></tr><tr><td data-num="43"></td><td><pre><span class="token keyword">inner</span> <span class="token keyword">join</span> dept d</pre></td></tr><tr><td data-num="44"></td><td><pre><span class="token keyword">on</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>deptno <span class="token operator">=</span> d<span class="token punctuation">.</span>deptno<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="45"></td><td><pre><span class="token comment">-- 多表连接查询的类型： 1. 交叉连接  cross join  2. 自然连接  natural join  </span></pre></td></tr><tr><td data-num="46"></td><td><pre><span class="token comment">-- 3. 内连接 - using 子句   4. 内连接 - on 子句</span></pre></td></tr><tr><td data-num="47"></td><td><pre><span class="token comment">-- 综合看：内连接 - on 子句</span></pre></td></tr><tr><td data-num="48"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> </pre></td></tr><tr><td data-num="49"></td><td><pre><span class="token keyword">from</span> emp e</pre></td></tr><tr><td data-num="50"></td><td><pre><span class="token keyword">inner</span> <span class="token keyword">join</span> dept d</pre></td></tr><tr><td data-num="51"></td><td><pre><span class="token keyword">on</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>deptno <span class="token operator">=</span> d<span class="token punctuation">.</span>deptno<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="52"></td><td><pre><span class="token keyword">where</span> sal <span class="token operator">></span> <span class="token number">3500</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="53"></td><td><pre><span class="token comment">-- 条件：</span></pre></td></tr><tr><td data-num="54"></td><td><pre><span class="token comment">-- 1. 筛选条件  where  having</span></pre></td></tr><tr><td data-num="55"></td><td><pre><span class="token comment">-- 2. 连接条件 on,using,natural </span></pre></td></tr><tr><td data-num="56"></td><td><pre><span class="token comment">-- SQL99 语法 ：筛选条件和连接条件是分开的</span></pre></td></tr></table></figure><h3 id="99语法外连接查询"><a class="anchor" href="#99语法外连接查询">#</a> 99 语法：外连接查询</h3><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">-- inner join - on 子句： 显示的是所有匹配的信息</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> </pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> emp e</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">inner</span> <span class="token keyword">join</span> dept d</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">on</span> e<span class="token punctuation">.</span>deptno <span class="token operator">=</span> d<span class="token punctuation">.</span>deptno<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> dept<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment">-- 问题：</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment">-- 1.40 号部分没有员工，没有显示在查询结果中</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token comment">-- 2. 员工 scott 没有部门，没有显示在查询结果中</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">-- 外连接：除了显示匹配的数据之外，还可以显示不匹配的数据</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment">-- 左外连接： left outer join   -- 左面的那个表的信息，即使不匹配也可以查看出效果</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> </pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">from</span> emp e</pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">left</span> <span class="token keyword">outer</span> <span class="token keyword">join</span> dept d</pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">on</span> e<span class="token punctuation">.</span>deptno <span class="token operator">=</span> d<span class="token punctuation">.</span>deptno<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token comment">-- 右外连接： right outer join   -- 右面的那个表的信息，即使不匹配也可以查看出效果</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> </pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">from</span> emp e</pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token keyword">right</span> <span class="token keyword">outer</span> <span class="token keyword">join</span> dept d</pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">on</span> e<span class="token punctuation">.</span>deptno <span class="token operator">=</span> d<span class="token punctuation">.</span>deptno<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token comment">-- 全外连接  full outer join -- 这个语法在 mysql 中不支持，在 oracle 中支持 -- 展示左，右表全部不匹配的数据 </span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token comment">-- scott ，40 号部门都可以看到</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> </pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token keyword">from</span> emp e</pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token keyword">full</span> <span class="token keyword">outer</span> <span class="token keyword">join</span> dept d</pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token keyword">on</span> e<span class="token punctuation">.</span>deptno <span class="token operator">=</span> d<span class="token punctuation">.</span>deptno<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token comment">-- 解决 mysql 中不支持全外连接的问题：</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> </pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token keyword">from</span> emp e</pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token keyword">left</span> <span class="token keyword">outer</span> <span class="token keyword">join</span> dept d</pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token keyword">on</span> e<span class="token punctuation">.</span>deptno <span class="token operator">=</span> d<span class="token punctuation">.</span>deptno</pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token keyword">union</span> <span class="token comment">-- 并集 去重 效率低</span></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> </pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token keyword">from</span> emp e</pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token keyword">right</span> <span class="token keyword">outer</span> <span class="token keyword">join</span> dept d</pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token keyword">on</span> e<span class="token punctuation">.</span>deptno <span class="token operator">=</span> d<span class="token punctuation">.</span>deptno<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> </pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token keyword">from</span> emp e</pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token keyword">left</span> <span class="token keyword">outer</span> <span class="token keyword">join</span> dept d</pre></td></tr><tr><td data-num="41"></td><td><pre><span class="token keyword">on</span> e<span class="token punctuation">.</span>deptno <span class="token operator">=</span> d<span class="token punctuation">.</span>deptno</pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token keyword">union</span> <span class="token keyword">all</span><span class="token comment">-- 并集 不去重 效率高</span></pre></td></tr><tr><td data-num="43"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> </pre></td></tr><tr><td data-num="44"></td><td><pre><span class="token keyword">from</span> emp e</pre></td></tr><tr><td data-num="45"></td><td><pre><span class="token keyword">right</span> <span class="token keyword">outer</span> <span class="token keyword">join</span> dept d</pre></td></tr><tr><td data-num="46"></td><td><pre><span class="token keyword">on</span> e<span class="token punctuation">.</span>deptno <span class="token operator">=</span> d<span class="token punctuation">.</span>deptno<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="47"></td><td><pre><span class="token comment">-- mysql 中对集合操作支持比较弱，只支持并集操作，交集，差集不支持（oracle 中支持）</span></pre></td></tr><tr><td data-num="48"></td><td><pre><span class="token comment">-- outer 可以省略不写</span></pre></td></tr></table></figure><h3 id="99语法三表连接查询"><a class="anchor" href="#99语法三表连接查询">#</a> 99 语法：三表连接查询</h3><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">-- 查询员工的编号、姓名、薪水、部门编号、部门名称、薪水等级</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> dept<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> salgrade<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">select</span> e<span class="token punctuation">.</span>ename<span class="token punctuation">,</span>e<span class="token punctuation">.</span>sal<span class="token punctuation">,</span>e<span class="token punctuation">.</span>empno<span class="token punctuation">,</span>e<span class="token punctuation">.</span>deptno<span class="token punctuation">,</span>d<span class="token punctuation">.</span>dname<span class="token punctuation">,</span>s<span class="token punctuation">.</span><span class="token operator">*</span> </pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">from</span> emp e</pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">right</span> <span class="token keyword">outer</span> <span class="token keyword">join</span> dept d</pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">on</span> e<span class="token punctuation">.</span>deptno <span class="token operator">=</span> d<span class="token punctuation">.</span>deptno</pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">inner</span> <span class="token keyword">join</span> salgrade s </pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">on</span> e<span class="token punctuation">.</span>sal <span class="token operator">between</span> s<span class="token punctuation">.</span>losal <span class="token operator">and</span> s<span class="token punctuation">.</span>hisal</pre></td></tr></table></figure><h3 id="99语法自连接查询"><a class="anchor" href="#99语法自连接查询">#</a> 99 语法：自连接查询</h3><img data-src="/DataBase/MySQL/MySQL_Basic/image-20221027163636218.png" title="image-20221027163636218"><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">-- 查询员工的编号、姓名、上级编号，上级的姓名</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">select</span> e1<span class="token punctuation">.</span>empno 员工编号<span class="token punctuation">,</span>e1<span class="token punctuation">.</span>ename 员工姓名<span class="token punctuation">,</span>e1<span class="token punctuation">.</span>mgr 领导编号<span class="token punctuation">,</span>e2<span class="token punctuation">.</span>ename 员工领导姓名</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">from</span> emp e1</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">inner</span> <span class="token keyword">join</span> emp e2</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">on</span> e1<span class="token punctuation">.</span>mgr <span class="token operator">=</span> e2<span class="token punctuation">.</span>empno<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">-- 左外连接：</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">select</span> e1<span class="token punctuation">.</span>empno 员工编号<span class="token punctuation">,</span>e1<span class="token punctuation">.</span>ename 员工姓名<span class="token punctuation">,</span>e1<span class="token punctuation">.</span>mgr 领导编号<span class="token punctuation">,</span>e2<span class="token punctuation">.</span>ename 员工领导姓名</pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">from</span> emp e1</pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">left</span> <span class="token keyword">outer</span> <span class="token keyword">join</span> emp e2</pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">on</span> e1<span class="token punctuation">.</span>mgr <span class="token operator">=</span> e2<span class="token punctuation">.</span>empno<span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="92语法多表查询"><a class="anchor" href="#92语法多表查询">#</a> 92 语法：多表查询</h3><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">-- 查询员工的编号，员工姓名，薪水，员工部门编号，部门名称：</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">select</span> e<span class="token punctuation">.</span>empno<span class="token punctuation">,</span>e<span class="token punctuation">.</span>ename<span class="token punctuation">,</span>e<span class="token punctuation">.</span>sal<span class="token punctuation">,</span>e<span class="token punctuation">.</span>deptno<span class="token punctuation">,</span>d<span class="token punctuation">.</span>dname</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> emp e<span class="token punctuation">,</span>dept d</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">-- 相当于 99 语法中的 cross join , 出现笛卡尔积，没有意义</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">select</span> e<span class="token punctuation">.</span>empno<span class="token punctuation">,</span>e<span class="token punctuation">.</span>ename<span class="token punctuation">,</span>e<span class="token punctuation">.</span>sal<span class="token punctuation">,</span>e<span class="token punctuation">.</span>deptno<span class="token punctuation">,</span>d<span class="token punctuation">.</span>dname</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">from</span> emp e<span class="token punctuation">,</span>dept d</pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">where</span> e<span class="token punctuation">.</span>deptno <span class="token operator">=</span> d<span class="token punctuation">.</span>deptno<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment">-- 相当于 99 语法中的 natural join </span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment">-- 查询员工的编号，员工姓名，薪水，员工部门编号，部门名称，查询出工资大于 2000 的员工</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">select</span> e<span class="token punctuation">.</span>empno<span class="token punctuation">,</span>e<span class="token punctuation">.</span>ename<span class="token punctuation">,</span>e<span class="token punctuation">.</span>sal<span class="token punctuation">,</span>e<span class="token punctuation">.</span>deptno<span class="token punctuation">,</span>d<span class="token punctuation">.</span>dname</pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">from</span> emp e<span class="token punctuation">,</span>dept d</pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">where</span> e<span class="token punctuation">.</span>deptno <span class="token operator">=</span> d<span class="token punctuation">.</span>deptno <span class="token operator">and</span> e<span class="token punctuation">.</span>sal <span class="token operator">></span> <span class="token number">2000</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token comment">-- 查询员工的名字，岗位，上级编号，上级名称（自连接）：</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">select</span> e1<span class="token punctuation">.</span>ename<span class="token punctuation">,</span>e1<span class="token punctuation">.</span>job<span class="token punctuation">,</span>e1<span class="token punctuation">.</span>mgr <span class="token punctuation">,</span>e2<span class="token punctuation">.</span>ename </pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">from</span> emp e1<span class="token punctuation">,</span>emp e2</pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">where</span> e1<span class="token punctuation">.</span>mgr <span class="token operator">=</span> e2<span class="token punctuation">.</span>empno<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token comment">-- 查询员工的编号、姓名、薪水、部门编号、部门名称、薪水等级</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">select</span> e<span class="token punctuation">.</span>empno<span class="token punctuation">,</span>e<span class="token punctuation">.</span>ename<span class="token punctuation">,</span>e<span class="token punctuation">.</span>sal<span class="token punctuation">,</span>e<span class="token punctuation">.</span>deptno<span class="token punctuation">,</span>d<span class="token punctuation">.</span>dname<span class="token punctuation">,</span>s<span class="token punctuation">.</span>grade </pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">from</span> emp e<span class="token punctuation">,</span>dept d<span class="token punctuation">,</span>salgrade s</pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token keyword">where</span> e<span class="token punctuation">.</span>deptno <span class="token operator">=</span> d<span class="token punctuation">.</span>deptno <span class="token operator">and</span> e<span class="token punctuation">.</span>sal <span class="token operator">>=</span> s<span class="token punctuation">.</span>losal <span class="token operator">and</span> e<span class="token punctuation">.</span>sal <span class="token operator">&lt;=</span> s<span class="token punctuation">.</span>hisal<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token comment">-- 总结：</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token comment">-- 1.92 语法麻烦 </span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token comment">-- 2.92 语法中 表的连接条件 和  筛选条件  是放在一起的没有分开</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token comment">-- 3.99 语法中提供了更多的查询连接类型：cross,natural,inner,outer</span></pre></td></tr></table></figure><h2 id="子查询"><a class="anchor" href="#子查询">#</a> 子查询</h2><h3 id="不相关子查询"><a class="anchor" href="#不相关子查询">#</a> 不相关子查询</h3><h4 id="什么是子查询"><a class="anchor" href="#什么是子查询">#</a> 什么是子查询？</h4><p>一条 SQL 语句含有多个 select</p><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">-- 引入子查询：</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">-- 查询所有比 “CLARK” 工资高的员工的信息  </span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">-- 步骤 1：“CLARK” 工资</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">select</span> sal <span class="token keyword">from</span> emp <span class="token keyword">where</span> ename <span class="token operator">=</span> <span class="token string">'CLARK'</span>  <span class="token comment">-- 2450</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">-- 步骤 2：查询所有工资比 2450 高的员工的信息  </span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> sal <span class="token operator">></span> <span class="token number">2450</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">-- 两次命令解决问题 --》效率低 ，第二个命令依托于第一个命令，第一个命令的结果给第二个命令使用，但是</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment">-- 因为第一个命令的结果可能不确定要改，所以第二个命令也会导致修改</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment">-- 将步骤 1 和步骤 2 合并 --》子查询：</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> sal <span class="token operator">></span> <span class="token punctuation">(</span><span class="token keyword">select</span> sal <span class="token keyword">from</span> emp <span class="token keyword">where</span> ename <span class="token operator">=</span> <span class="token string">'CLARK'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">-- 一个命令解决问题 --》效率高</span></pre></td></tr></table></figure><h4 id="执行顺序"><a class="anchor" href="#执行顺序">#</a> 执行顺序</h4><p>先执行子查询，再执行外查询；</p><h4 id="不相关子查询-2"><a class="anchor" href="#不相关子查询-2">#</a> 不相关子查询</h4><p>子查询可以独立运行，称为不相关子查询。</p><h4 id="不相关子查询分类"><a class="anchor" href="#不相关子查询分类">#</a> 不相关子查询分类</h4><p>根据子查询的结果行数，可以分为<strong>单行子查询</strong>和<strong>多行子查询</strong>。</p><h4 id="单行子查询"><a class="anchor" href="#单行子查询">#</a> 单行子查询</h4><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">-- 单行子查询：</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">-- 查询工资高于平均工资的雇员名字和工资。</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">select</span> ename<span class="token punctuation">,</span>sal</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">from</span> emp</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">where</span> sal <span class="token operator">></span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token keyword">from</span> emp<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">-- 查询和 CLARK 同一部门且比他工资低的雇员名字和工资。</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">select</span> ename<span class="token punctuation">,</span>sal</pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">from</span> emp</pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">where</span> deptno <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> deptno <span class="token keyword">from</span> emp <span class="token keyword">where</span> ename <span class="token operator">=</span> <span class="token string">'CLARK'</span><span class="token punctuation">)</span> </pre></td></tr><tr><td data-num="10"></td><td><pre>      <span class="token operator">and</span> </pre></td></tr><tr><td data-num="11"></td><td><pre>      sal <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token keyword">select</span> sal <span class="token keyword">from</span> emp <span class="token keyword">where</span> ename <span class="token operator">=</span> <span class="token string">'CLARK'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment">-- 查询职务和 SCOTT 相同，比 SCOTT 雇佣时间早的雇员信息  </span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> </pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">from</span> emp</pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">where</span> job <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> job <span class="token keyword">from</span> emp <span class="token keyword">where</span> ename <span class="token operator">=</span> <span class="token string">'SCOTT'</span><span class="token punctuation">)</span> </pre></td></tr><tr><td data-num="16"></td><td><pre>      <span class="token operator">and</span> </pre></td></tr><tr><td data-num="17"></td><td><pre>      hiredate <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token keyword">select</span> hiredate <span class="token keyword">from</span> emp <span class="token keyword">where</span> ename <span class="token operator">=</span> <span class="token string">'SCOTT'</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h4 id="多行子查询"><a class="anchor" href="#多行子查询">#</a> 多行子查询</h4><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">-- 【1】查询【部门 20 中职务同部门 10 的雇员一样的】雇员信息。</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">-- 查询雇员信息</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">-- 查询部门 20 中的雇员信息</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> deptno <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span><span class="token comment">-- CLERK,MANAGER,ANALYST</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">-- 部门 10 的雇员的职务：</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">select</span> job <span class="token keyword">from</span> emp <span class="token keyword">where</span> deptno <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment">-- MANAGER,PRESIDENT,CLERK</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment">-- 查询部门 20 中职务同部门 10 的雇员一样的雇员信息。</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp </pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">where</span> deptno <span class="token operator">=</span> <span class="token number">20</span> </pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token operator">and</span> job <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> job <span class="token keyword">from</span> emp <span class="token keyword">where</span> deptno <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment">-- > Subquery returns more than 1 row</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp </pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">where</span> deptno <span class="token operator">=</span> <span class="token number">20</span> </pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token operator">and</span> job <span class="token operator">=</span> <span class="token keyword">any</span><span class="token punctuation">(</span><span class="token keyword">select</span> job <span class="token keyword">from</span> emp <span class="token keyword">where</span> deptno <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment">-- 【2】查询工资比所有的 “SALESMAN” 都高的雇员的编号、名字和工资。</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token comment">-- 查询雇员的编号、名字和工资</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">select</span> empno<span class="token punctuation">,</span>ename<span class="token punctuation">,</span>sal <span class="token keyword">from</span> emp</pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token comment">-- “SALESMAN” 的工资：</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token keyword">select</span> sal <span class="token keyword">from</span> emp <span class="token keyword">where</span> job <span class="token operator">=</span> <span class="token string">'SALESMAN'</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token comment">-- 查询工资比所有的 “SALESMAN” 都高的雇员的编号、名字和工资。</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token comment">-- 多行子查询：</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token keyword">select</span> empno<span class="token punctuation">,</span>ename<span class="token punctuation">,</span>sal </pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token keyword">from</span> emp </pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token keyword">where</span> sal <span class="token operator">></span> <span class="token keyword">all</span><span class="token punctuation">(</span><span class="token keyword">select</span> sal <span class="token keyword">from</span> emp <span class="token keyword">where</span> job <span class="token operator">=</span> <span class="token string">'SALESMAN'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token comment">-- 单行子查询：</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token keyword">select</span> empno<span class="token punctuation">,</span>ename<span class="token punctuation">,</span>sal </pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token keyword">from</span> emp </pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">where</span> sal <span class="token operator">></span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">max</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> job <span class="token operator">=</span> <span class="token string">'SALESMAN'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token comment">-- 【3】查询工资低于任意一个 “CLERK” 的工资的雇员信息。  </span></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token comment">-- 查询雇员信息</span></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token comment">-- 查询工资低于任意一个 “CLERK” 的工资的雇员信息</span></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> </pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token keyword">from</span> emp</pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token keyword">where</span> sal <span class="token operator">&lt;</span> <span class="token keyword">any</span><span class="token punctuation">(</span><span class="token keyword">select</span> sal <span class="token keyword">from</span> emp <span class="token keyword">where</span> job <span class="token operator">=</span> <span class="token string">'CLERK'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token operator">and</span> job <span class="token operator">!=</span> <span class="token string">'CLERK'</span></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token comment">-- 单行子查询：</span></pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> </pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token keyword">from</span> emp</pre></td></tr><tr><td data-num="41"></td><td><pre><span class="token keyword">where</span> sal <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">max</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> job <span class="token operator">=</span> <span class="token string">'CLERK'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token operator">and</span> job <span class="token operator">!=</span> <span class="token string">'CLERK'</span></pre></td></tr></table></figure><h3 id="相关子查询"><a class="anchor" href="#相关子查询">#</a> 相关子查询</h3><p>【1】相关的子查询引入：<br><strong>不相关的子查询</strong>：子查询<mark>可以独立运行</mark>，<mark>先运行子查询，再运行外查询</mark>。<br><strong>相关子查询</strong>：子查询<mark>不可以独立运行</mark>，并且<mark>先运行外查询，再运行子查询</mark></p><p>【2】相关的子查询优缺点：<br>好处：简单 功能强大（一些使用不相关子查询不能实现或者实现繁琐的子查询，可以使用相关子查询实现）<br>缺点：稍难理解</p><p>【3】sql 展示：</p><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">-- 【1】查询最高工资的员工  （不相关子查询）</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> sal <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">max</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token keyword">from</span> emp<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">-- 【2】查询本部门最高工资的员工   （相关子查询）</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">-- 方法 1：通过不相关子查询实现：</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> deptno <span class="token operator">=</span> <span class="token number">10</span> <span class="token operator">and</span> sal <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">max</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> deptno <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">union</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> deptno <span class="token operator">=</span> <span class="token number">20</span> <span class="token operator">and</span> sal <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">max</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> deptno <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">union</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> deptno <span class="token operator">=</span> <span class="token number">30</span> <span class="token operator">and</span> sal <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">max</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> deptno <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token comment">-- 缺点：语句比较多，具体到底有多少个部分未知</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">-- 方法 2： 相关子查询</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp e <span class="token keyword">where</span> sal <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">max</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> deptno <span class="token operator">=</span> e<span class="token punctuation">.</span>deptno<span class="token punctuation">)</span> <span class="token keyword">order</span> <span class="token keyword">by</span> deptno</pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token comment">-- 【3】查询工资高于其所在岗位的平均工资的那些员工  （相关子查询）</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">-- 不相关子查询：</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> job <span class="token operator">=</span> <span class="token string">'CLERK'</span> <span class="token operator">and</span> sal <span class="token operator">>=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> job <span class="token operator">=</span> <span class="token string">'CLERK'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">union</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token comment">-- 相关子查询：</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp e <span class="token keyword">where</span> sal <span class="token operator">>=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token keyword">from</span> emp e2 <span class="token keyword">where</span> e2<span class="token punctuation">.</span>job <span class="token operator">=</span> e<span class="token punctuation">.</span>job<span class="token punctuation">)</span></pre></td></tr></table></figure><h1 id="数据库对象"><a class="anchor" href="#数据库对象">#</a> 数据库对象</h1><h2 id="视图"><a class="anchor" href="#视图">#</a> 视图</h2><h3 id="视图的概念"><a class="anchor" href="#视图的概念">#</a> 视图的概念</h3><p>视图（view）是一个从单张或多张基础数据表或其他视图中构建出来的<mark>虚拟表</mark>。同基础表一样，视图中也包含了一系列带有名称的列和行数据，但是<mark>数据库中只是存放视图的定义</mark>，也就是<mark>动态检索数据的查询语句，而并不存放视图中的数据</mark>，这些数据依旧存放于构建视图的基础表中，只有当用户使用视图时才去数据库请求相对应的数据，即视图中的数据是在引用视图时动态生成的。因此视图中的数据依赖于构建视图的基础表，如果<mark>基本表中的数据发生了变化，视图中相应的数据也会跟着改变</mark>。</p><p>PS: 视图本质上就是：一个查询语句，是一个虚拟的表，不存在的表，你查看视图，其实就是查看视图对应的 sql 语句</p><h3 id="视图的好处"><a class="anchor" href="#视图的好处">#</a> 视图的好处</h3><p>简化用户操作：视图可以使用户将注意力集中在所关心地数据上，而不需要关心数据表的结构、与其他表的关联条件以及查询条件等。</p><p>对机密数据提供安全保护：有了视图，就可以在设计数据库应用系统时，对不同的用户定义不同的视图，避免机密数据（如，敏感字段 “salary”）出现在不应该看到这些数据的用户视图上。这样视图就自动提供了对机密数据的安全保护功能</p><h3 id="sql展示-3"><a class="anchor" href="#sql展示-3">#</a> SQL 展示：</h3><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">-- 创建 / 替换单表视图：</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">create</span> <span class="token operator">or</span> <span class="token keyword">replace</span> <span class="token keyword">view</span> myview01</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">as</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">select</span> empno<span class="token punctuation">,</span>ename<span class="token punctuation">,</span>job<span class="token punctuation">,</span>deptno </pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">from</span> emp</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">where</span> deptno <span class="token operator">=</span> <span class="token number">20</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">with</span> <span class="token keyword">check</span> <span class="token keyword">option</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment">-- 查看视图：</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> myview01<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token comment">-- 在视图中插入数据：</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> myview01 <span class="token punctuation">(</span>empno<span class="token punctuation">,</span>ename<span class="token punctuation">,</span>job<span class="token punctuation">,</span>deptno<span class="token punctuation">)</span> <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">9999</span><span class="token punctuation">,</span><span class="token string">'lili'</span><span class="token punctuation">,</span><span class="token string">'CLERK'</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> myview01 <span class="token punctuation">(</span>empno<span class="token punctuation">,</span>ename<span class="token punctuation">,</span>job<span class="token punctuation">,</span>deptno<span class="token punctuation">)</span> <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">8888</span><span class="token punctuation">,</span><span class="token string">'nana'</span><span class="token punctuation">,</span><span class="token string">'CLERK'</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> myview01 <span class="token punctuation">(</span>empno<span class="token punctuation">,</span>ename<span class="token punctuation">,</span>job<span class="token punctuation">,</span>deptno<span class="token punctuation">)</span> <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">7777</span><span class="token punctuation">,</span><span class="token string">'feifei'</span><span class="token punctuation">,</span><span class="token string">'CLERK'</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">-- > 1369 - CHECK OPTION failed 'mytestdb.myview01'</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token comment">-- 创建 / 替换多表视图：</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">create</span> <span class="token operator">or</span> <span class="token keyword">replace</span> <span class="token keyword">view</span> myview02</pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">as</span> </pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">select</span> e<span class="token punctuation">.</span>empno<span class="token punctuation">,</span>e<span class="token punctuation">.</span>ename<span class="token punctuation">,</span>e<span class="token punctuation">.</span>sal<span class="token punctuation">,</span>d<span class="token punctuation">.</span>deptno<span class="token punctuation">,</span>d<span class="token punctuation">.</span>dname</pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">from</span> emp e</pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token keyword">join</span> dept d</pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">on</span> e<span class="token punctuation">.</span>deptno <span class="token operator">=</span> d<span class="token punctuation">.</span>deptno</pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token keyword">where</span> sal <span class="token operator">></span> <span class="token number">2000</span> <span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> myview02<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token comment">-- 创建统计视图：</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token keyword">create</span> <span class="token operator">or</span> <span class="token keyword">replace</span> <span class="token keyword">view</span> myview03</pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token keyword">as</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token keyword">select</span> e<span class="token punctuation">.</span>deptno<span class="token punctuation">,</span>d<span class="token punctuation">.</span>dname<span class="token punctuation">,</span><span class="token function">avg</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">min</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token keyword">from</span> emp e</pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">join</span> dept d</pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token keyword">using</span><span class="token punctuation">(</span>deptno<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token keyword">group</span> <span class="token keyword">by</span> e<span class="token punctuation">.</span>deptno <span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> myview03<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token comment">-- 创建基于视图的视图：</span></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token keyword">create</span> <span class="token operator">or</span> <span class="token keyword">replace</span> <span class="token keyword">view</span> myview04</pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token keyword">as</span></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> myview03 <span class="token keyword">where</span> deptno <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> myview04<span class="token punctuation">;</span></pre></td></tr></table></figure><h2 id="存储过程"><a class="anchor" href="#存储过程">#</a> 存储过程</h2><h3 id="什么是存储过程stored-procedure"><a class="anchor" href="#什么是存储过程stored-procedure">#</a> 什么是存储过程 (Stored Procedure)</h3><p>通过前面章节的学习，我们已经知道 SQL 是一种非常便利的语言。从数据库抽取数据，或者对特定的数据集中更新时，都能通过简洁直观的代码实现。</p><p>但是这个所谓的 “简洁” 也是有限制，SQL 基本是一个命令实现一个处理，是所谓的非程序语言。</p><p>在不能编写流程的情况下，所有的处理只能通过一个个命令来实现。当然，通过使用连接及子查询，即使使用 SQL 的单一命令也能实现一些高级的处理，但是，其局限性是显而易见的。例如，在 SQL 中就很难实现针对不同条件进行不同的处理以及循环等功能。</p><p>这个时候就出现了存储过程这个概念，简单地说，存储过程就是数据库中保存 (Stored) 的一系列 SQL 命令（Procedure）的集合。也可以将其看作相互之间有关系的 SQL 命令组织在一起形成的一个小程序。</p><h3 id="存储过程的优点"><a class="anchor" href="#存储过程的优点">#</a> 存储过程的优点</h3><ol><li><p>提高执行性能。存储过程执行效率之所高，在于普通的 SQL 语句，每次都会对语法分析，编译，执行，而存储过程只是在第一次执行语法分析，编译，执行，以后都是对结果进行调用。</p></li><li><p>可减轻网络负担。使用存储过程，复杂的数据库操作也可以在数据库服务器中完成。只需要从客户端 (或应用程序) 传递给数据库必要的参数就行，比起需要多次传递 SQL 命令本身，这大大减轻了网络负担。</p></li><li><p>可将数据库的处理黑匣子化。应用程序中完全不用考虑存储过程的内部详细处理，只需要知道调用哪个存储过程就可以了</p></li></ol><h3 id="图解"><a class="anchor" href="#图解">#</a> 图解</h3><img data-src="/DataBase/MySQL/MySQL_Basic/image-20221027165008517.png" title="image-20221027165008517"><h3 id="展示存储过程"><a class="anchor" href="#展示存储过程">#</a> 展示存储过程</h3><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">-- 定义一个没有返回值 存储过程</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">-- 实现：模糊查询操作：</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> ename <span class="token operator">like</span> <span class="token string">'%A%'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">create</span> <span class="token keyword">procedure</span> mypro01<span class="token punctuation">(</span>name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">begin</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        <span class="token keyword">if</span> name <span class="token operator">is</span> <span class="token boolean">null</span> <span class="token operator">or</span> name <span class="token operator">=</span> <span class="token string">""</span> <span class="token keyword">then</span></pre></td></tr><tr><td data-num="7"></td><td><pre>                <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        <span class="token keyword">else</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> ename <span class="token operator">like</span> concat<span class="token punctuation">(</span><span class="token string">'%'</span><span class="token punctuation">,</span>name<span class="token punctuation">,</span><span class="token string">'%'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token keyword">end</span> <span class="token keyword">if</span><span class="token punctuation">;</span>	</pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">end</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment">-- 删除存储过程：</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">drop</span> <span class="token keyword">procedure</span> mypro01<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">-- 调用存储过程：</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">call</span> mypro01<span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">call</span> mypro01<span class="token punctuation">(</span><span class="token string">'R'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token comment">-- 定义一个  有返回值的存储过程：</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token comment">-- 实现：模糊查询操作：</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token comment">-- in 参数前面的 in 可以省略不写</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token comment">-- found_rows () mysql 中定义的一个函数，作用返回查询结果的条数</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">create</span> <span class="token keyword">procedure</span> mypro02<span class="token punctuation">(</span><span class="token operator">in</span> name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">out</span> num <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token keyword">begin</span></pre></td></tr><tr><td data-num="23"></td><td><pre>        <span class="token keyword">if</span> name <span class="token operator">is</span> <span class="token boolean">null</span> <span class="token operator">or</span> name <span class="token operator">=</span> <span class="token string">""</span> <span class="token keyword">then</span></pre></td></tr><tr><td data-num="24"></td><td><pre>                <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>        <span class="token keyword">else</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> ename <span class="token operator">like</span> concat<span class="token punctuation">(</span><span class="token string">'%'</span><span class="token punctuation">,</span>name<span class="token punctuation">,</span><span class="token string">'%'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>        <span class="token keyword">end</span> <span class="token keyword">if</span><span class="token punctuation">;</span>	</pre></td></tr><tr><td data-num="28"></td><td><pre>        <span class="token keyword">select</span> found_rows<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">into</span> num<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">end</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token comment">-- -- 调用存储过程：</span></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token keyword">call</span> mypro02<span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token variable">@num</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token keyword">select</span> <span class="token variable">@num</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token keyword">call</span> mypro02<span class="token punctuation">(</span><span class="token string">'R'</span><span class="token punctuation">,</span><span class="token variable">@aaa</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token keyword">select</span> <span class="token variable">@aaa</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h2 id="事务"><a class="anchor" href="#事务">#</a> 事务</h2><h3 id="事务及其特征"><a class="anchor" href="#事务及其特征">#</a> 事务及其特征</h3><p>​	事务（Transaction）是用来维护数据库完整性的，它能够保证一系列的 MySQL 操作要么全部执行，要么全不执行。</p><p>例子 1：<br>举一个例子来进行说明，例如转账操作：A 账户要转账给 B 账户，那么 A 账户上减少的钱数和 B 账户上增加的钱数必须一致，也就是说 A 账户的转出操作和 B 账户的转入操作要么全部执行，要么全不执行；如果其中一个操作出现异常而没有执行的话，就会导致账户 A 和账户 B 的转入转出金额不一致的情况，为而事实上这种情况是不允许发生的，所以为了防止这种情况的发生，需要使用事务处理。</p><p>例子 2：<br>在淘宝购物下订单的时候，商家库存要减少，订单增加记录，付款我的账号少 100 元... 操作要么全部执行，要么全不执行</p><h4 id="事务的概念"><a class="anchor" href="#事务的概念">#</a> 事务的概念</h4><p>事务（Transaction）指的是一个操作序列，该操作序列中的多个操作要么都做，要么都不做，是一个不可分割的工作单位，是数据库环境中的逻辑工作单位，由 DBMS（数据库管理系统）中的事务管理子系统负责事务的处理。<br>目前常用的存储引擎有 InnoDB（MySQL5.5 以后默认的存储引擎）和 MyISAM（MySQL5.5 之前默认的存储引擎），其中 InnoDB 支持事务处理机制，而 MyISAM 不支持。</p><h4 id="事务的特性"><a class="anchor" href="#事务的特性">#</a> 事务的特性</h4><p>事务处理可以确保除非事务性序列内的所有操作都成功完成，否则不会永久更新面向数据的资源。通过将一组相关操作组合为一个要么全部成功要么全部失败的序列，可以简化错误恢复并使应用程序更加可靠。<br>但并不是所有的操作序列都可以称为事务，这是因为一个操作序列要成为事务，必须满足事务的<mark>原子性（Atomicity）</mark>、<mark>一致性（Consistency）</mark>、<mark>隔离性（Isolation）<mark>和</mark>持久性（Durability</mark>）。这四个特性简称为<mark> ACID</mark> 特性。</p><img data-src="/DataBase/MySQL/MySQL_Basic/image-20221027165222975.png" title="image-20221027165222975"><ol><li><p>原子性<br>原子是自然界最小的颗粒，具有不可再分的特性。事务中的所有操作可以看做一个原子，事务是应用中不可再分的最小的逻辑执行体。<br>使用事务对数据进行修改的操作序列，要么全部执行，要么全不执行。通常，某个事务中的操作都具有共同的目标，并且是相互依赖的。如果数据库系统只执行这些操作中的一部分，则可能会破坏事务的总体目标，而原子性消除了系统只处理部分操作的可能性。</p></li><li><p>一致性<br>一致性是指事务执行的结果必须使数据库从一个一致性状态，变到另一个一致性状态。当数据库中只包含事务成功提交的结果时，数据库处于一致性状态。一致性是通过原子性来保证的。<br>例如：在转账时，只有保证转出和转入的金额一致才能构成事务。也就是说事务发生前和发生后，数据的总额依然匹配。</p></li><li><p>隔离性<br>隔离性是指各个事务的执行互不干扰，任意一个事务的内部操作对其他并发的事务，都是隔离的。也就是说：并发执行的事务之间既不能看到对方的中间状态，也不能相互影响。<br>例如：在转账时，只有当 A 账户中的转出和 B 账户中转入操作都执行成功后才能看到 A 账户中的金额减少以及 B 账户中的金额增多。并且其他的事务对于转账操作的事务是不能产生任何影响的。</p></li><li><p>持久性<br>持久性指事务一旦提交，对数据所做的任何改变，都要记录到永久存储器中，通常是保存进物理数据库，即使数据库出现故障，提交的数据也应该能够恢复。但如果是由于外部原因导致的数据库故障，如硬盘被损坏，那么之前提交的数据则有可能会丢失。</p></li></ol><h4 id="sql展示使用事务保证转账安全"><a class="anchor" href="#sql展示使用事务保证转账安全">#</a> sql 展示：使用事务保证转账安全</h4><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">-- 创建账户表：</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">create</span> <span class="token keyword">table</span> account<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="3"></td><td><pre>        id <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>        uname <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        balance <span class="token keyword">double</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">-- 查看账户表：</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> account<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment">-- 在表中插入数据：</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> account <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">'丽丽'</span><span class="token punctuation">,</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">'小刚'</span><span class="token punctuation">,</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">-- 丽丽给小刚 转 200 元：</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">update</span> account <span class="token keyword">set</span> balance <span class="token operator">=</span> balance <span class="token operator">-</span> <span class="token number">200</span> <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">update</span> account <span class="token keyword">set</span> balance <span class="token operator">=</span> balance <span class="token operator">+</span> <span class="token number">200</span> <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">-- 默认一个 DML 语句是一个事务，所以上面的操作执行了 2 个事务。</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">update</span> account <span class="token keyword">set</span> balance <span class="token operator">=</span> balance <span class="token operator">-</span> <span class="token number">200</span> <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">update</span> account <span class="token keyword">set</span> balance <span class="token operator">=</span> balance2 <span class="token operator">+</span> <span class="token number">200</span> <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token comment">-- 必须让上面的两个操作控制在一个事务中：</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token comment">-- 手动开启事务：</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">start</span> <span class="token keyword">transaction</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token keyword">update</span> account <span class="token keyword">set</span> balance <span class="token operator">=</span> balance <span class="token operator">-</span> <span class="token number">200</span> <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">update</span> account <span class="token keyword">set</span> balance <span class="token operator">=</span> balance <span class="token operator">+</span> <span class="token number">200</span> <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token comment">-- 手动回滚：刚才执行的操作全部取消：</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token keyword">rollback</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token comment">-- 手动提交：</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token keyword">commit</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token comment">-- 在回滚和提交之前，数据库中的数据都是操作的缓存中的数据，而不是数据库的真实数据</span></pre></td></tr></table></figure><h3 id="事务并发问题"><a class="anchor" href="#事务并发问题">#</a> 事务并发问题</h3><h4 id="脏读dirty-read"><a class="anchor" href="#脏读dirty-read">#</a> 脏读（Dirty read）</h4><p>当一个事务正在访问数据并且对数据进行了修改，而这种修改还没有提交到数据库中，这时另外一个事务也访问了这个数据，然后使用了这个数据。因为这个数据是还没有提交的数据，那么另外一个事务读到的这个数据是 “脏数据”，依据 “脏数据” 所做的操作可能是不正确的。</p><img data-src="/DataBase/MySQL/MySQL_Basic/image-20221027165426609.png" title="image-20221027165426609"><h4 id="不可重复读"><a class="anchor" href="#不可重复读">#</a> 不可重复读</h4><p>（Unrepeatableread）: 指在一个事务内多次读同一数据。在这个事务还没有结束时，另一个事务也访问该数据。那么，在第一个事务中的两次读数据之间，由于第二个事务的修改导致第一个事务两次读取的数据可能不太一样。这就发生了在一个事务内两次读到的数据是不一样的情况，因此称为不可重复读。</p><img data-src="/DataBase/MySQL/MySQL_Basic/image-20221027165435417.png" title="image-20221027165435417"><h4 id="幻读"><a class="anchor" href="#幻读">#</a> 幻读</h4><p>（Phantom read）: 幻读与不可重复读类似。它发生在一个事务（T1）读取了几行数据，接着另一个并发事务（T2）插入了一些数据时。在随后的查询中，第一个事务（T1）就会发现多了一些原本不存在的记录，就好像发生了幻觉一样，所以称为幻读。</p><img data-src="/DataBase/MySQL/MySQL_Basic/image-20221027165443417.png" title="image-20221027165443417"><h4 id="不可重复度和幻读区别"><a class="anchor" href="#不可重复度和幻读区别">#</a> 不可重复度和幻读区别：</h4><p><strong>不可重复读的重点是修改，幻读的重点在于新增或者删除。</strong></p><p><strong><mark>解决不可重复读的问题只需锁住满足条件的行，解决幻读需要锁表</mark></strong></p><p>例 1（同样的条件，你读取过的数据，再次读取出来发现值不一样了 ）：事务 1 中的 A 先生读取自己的工资为 1000 的操作还没完成，事务 2 中的 B 先生就修改了 A 的工资为 2000，导 致 A 再读自己的工资时工资变为 2000；这就是不可重复读。</p><p>例 2（同样的条件，第 1 次和第 2 次读出来的记录数不一样 ）：假某工资单表中工资大于 3000 的有 4 人，事务 1 读取了所有工资大于 3000 的人，共查到 4 条记录，这时事务 2 又插入了一条工资大于 3000 的记录，事务 1 再次读取时查到的记录就变为了 5 条，这样就导致了幻读</p><h3 id="事务隔离级别"><a class="anchor" href="#事务隔离级别">#</a> 事务隔离级别</h3><p>​	事务的隔离级别用于决定如何控制并发用户读写数据的操作。数据库是允许多用户并发访问的，如果多个用户同时开启事务并对同一数据进行读写操作的话，有可能会出现脏读、不可重复读和幻读问题，所以 MySQL 中提供了四种隔离级别来解决上述问题。</p><p>​	事务的隔离级别从低到高依次为：</p><blockquote><p>READ UNCOMMITTED【<mark><strong>读未提交</strong></mark>】	READ COMMITTED【<strong><mark>读已提交</mark></strong>】</p><p>REPEATABLE READ 【<strong><mark>重复读取</mark></strong>】	SERIALIZABLE 【<strong><mark>串行读取</mark></strong>】</p></blockquote><p>隔离级别越低，越能支持高并发的数据库操作。</p><img data-src="/DataBase/MySQL/MySQL_Basic/image-20221027165638873.png" title="image-20221027165638873"><p>PS：√ 代表会出现问题 ， × 代表不会出现问题 = 解决问题</p><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">-- 查看默认的事务隔离级别  MySQL 默认的是 repeatable read  </span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">select</span> @<span class="token variable">@transaction_isolation</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">-- 设置事务的隔离级别   （设置当前会话的隔离级别）</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">set</span> <span class="token keyword">session</span> <span class="token keyword">transaction</span> <span class="token keyword">isolation</span> <span class="token keyword">level</span> <span class="token keyword">read</span> <span class="token keyword">uncommitted</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">set</span> <span class="token keyword">session</span> <span class="token keyword">transaction</span> <span class="token keyword">isolation</span> <span class="token keyword">level</span> <span class="token keyword">read</span> <span class="token keyword">committed</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">set</span> <span class="token keyword">session</span> <span class="token keyword">transaction</span> <span class="token keyword">isolation</span> <span class="token keyword">level</span> <span class="token keyword">repeatable</span> <span class="token keyword">read</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">set</span> <span class="token keyword">session</span> <span class="token keyword">transaction</span> <span class="token keyword">isolation</span> <span class="token keyword">level</span> <span class="token keyword">serializable</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">start</span> <span class="token keyword">transaction</span> <span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> account <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>​</p><div id="gitalk-container"></div><script src="https://cdn.bootcss.com/blueimp-md5/2.12.0/js/md5.min.js"></script><link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css"><script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script><script>var gitalkConfig={clientID:"6db178ba46c8af8f6a6f",clientSecret:"90f730e5956024596558df00975cd8eae28cae3d",repo:"bk-comment01",owner:"onlymarryu",admin:["onlymarryu"],distractionFreeMode:!1,language:"zh-CN",proxy:"https://gitalk-comments.netlify.app/github_access_token",perPage:15};gitalkConfig.id=md5(location.pathname);var gitalk=new Gitalk(gitalkConfig);gitalk.render("gitalk-container")</script><div class="tags"><a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="tag"><i class="ic i-tag"></i> 数据库</a> <a href="/tags/MySQL/" rel="tag"><i class="ic i-tag"></i> MySQL</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2022-10-29 15:22:12" itemprop="dateModified" datetime="2022-10-29T15:22:12+08:00">2022-10-29</time></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="雾都 微信支付"><p>微信支付</p></div><div><img data-src="/images/alipay.png" alt="雾都 支付宝"><p>支付宝</p></div><div><img data-src="/images/paypal.png" alt="雾都 贝宝"><p>贝宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>雾都 <i class="ic i-at"><em>@</em></i>记录 “美食” 每刻</li><li class="link"><strong>本文链接：</strong> <a href="https://eth168.top/DataBase/MySQL/MySQL_Basic/" title="MySQL 基础">https://eth168.top/DataBase/MySQL/MySQL_Basic/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/ORM/MybatisPlus/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;tva3.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gipewr8iypj20zk0m8b29.jpg" title="MybatisPlus"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> ORM</span><h3>MybatisPlus</h3></a></div><div class="item right"><a href="/Distribution/FastDFS/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;tva3.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1giph4wqtg4j20zk0m8x6p.jpg" title="FastDFS"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> 分布式</span><h3>FastDFS</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-number">1.</span> <span class="toc-text">数据库基本概念</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#mysql%E4%BB%8B%E7%BB%8D"><span class="toc-number">2.</span> <span class="toc-text">MySQL 介绍</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#mysql%E5%AE%89%E8%A3%85"><span class="toc-number">3.</span> <span class="toc-text">MySQL 安装</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%8D%B8%E8%BD%BD%E5%8E%9F%E6%9D%A5%E7%9A%84%E7%89%88%E6%9C%AC"><span class="toc-number">3.1.</span> <span class="toc-text">1、卸载原来的版本</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%9F%A5%E7%9C%8Bmysql%E7%9A%84%E5%AE%89%E8%A3%85%E6%83%85%E5%86%B5"><span class="toc-number">3.1.1.</span> <span class="toc-text">1、查看 mysql 的安装情况</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%88%A0%E9%99%A4%E4%B8%8A%E5%9B%BE%E5%AE%89%E8%A3%85%E7%9A%84%E8%BD%AF%E4%BB%B6"><span class="toc-number">3.1.2.</span> <span class="toc-text">2、删除上图安装的软件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E9%83%BD%E5%88%A0%E9%99%A4%E6%88%90%E5%8A%9F%E4%B9%8B%E5%90%8E%E6%9F%A5%E6%89%BE%E7%9B%B8%E5%85%B3%E7%9A%84mysql%E7%9A%84%E6%96%87%E4%BB%B6"><span class="toc-number">3.1.3.</span> <span class="toc-text">3、都删除成功之后，查找相关的 mysql 的文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%88%A0%E9%99%A4%E5%85%A8%E9%83%A8%E6%96%87%E4%BB%B6"><span class="toc-number">3.1.4.</span> <span class="toc-text">4、删除全部文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E5%86%8D%E6%AC%A1%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4"><span class="toc-number">3.1.5.</span> <span class="toc-text">5、再次执行命令</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%88%A0%E9%99%A4mariadb-libs%E4%B8%8D%E5%8F%AF%E7%9C%81%E7%95%A5"><span class="toc-number">3.2.</span> <span class="toc-text">2、删除 mariadb-libs (不可省略)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%AE%89%E8%A3%85mysql"><span class="toc-number">3.3.</span> <span class="toc-text">3、安装 MySQL</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E8%BE%93%E5%85%A5"><span class="toc-number">3.3.1.</span> <span class="toc-text">1，输入：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%AE%89%E8%A3%85%E6%95%B0%E6%8D%AE%E6%BA%90"><span class="toc-number">3.3.2.</span> <span class="toc-text">2、安装数据源</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%9F%A5%E7%9C%8Bmysql%E6%BA%90%E6%98%AF%E5%90%A6%E5%AE%89%E8%A3%85%E6%88%90%E5%8A%9F"><span class="toc-number">3.3.3.</span> <span class="toc-text">3、查看 mysql 源是否安装成功</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%AE%89%E8%A3%85%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">3.3.4.</span> <span class="toc-text">4、安装数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E5%90%AF%E5%8A%A8mysql"><span class="toc-number">3.3.5.</span> <span class="toc-text">5、启动 mysql</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E6%98%BE%E7%A4%BAmysql%E7%9A%84%E9%9A%8F%E6%9C%BA%E5%AF%86%E7%A0%81"><span class="toc-number">3.3.6.</span> <span class="toc-text">6、显示 mysql 的随机密码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E7%99%BB%E5%BD%95%E5%B9%B6%E4%BF%AE%E6%94%B9mysql%E5%AF%86%E7%A0%81"><span class="toc-number">3.3.7.</span> <span class="toc-text">7、登录并修改 mysql 密码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%85%B6%E4%BB%96%E9%85%8D%E7%BD%AE"><span class="toc-number">3.4.</span> <span class="toc-text">4、其他配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E5%BC%80%E6%9C%BA%E8%87%AA%E5%90%AF"><span class="toc-number">3.4.1.</span> <span class="toc-text">1. 开机自启</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E8%BF%9C%E7%A8%8B%E8%BF%9E%E6%8E%A5"><span class="toc-number">3.4.2.</span> <span class="toc-text">2. 远程连接</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%B8%80-%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E7%94%A8%E6%88%B7-%E6%94%AF%E6%8C%81%E8%BF%9C%E7%A8%8B%E8%BF%9E%E6%8E%A5"><span class="toc-number">3.4.2.1.</span> <span class="toc-text">方法一、创建一个用户 支持远程连接</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%BA%8C-%E8%AE%BE%E7%BD%AEroot%E7%94%A8%E6%88%B7%E6%94%AF%E6%8C%81%E8%BF%9C%E7%A8%8B%E8%BF%9E%E6%8E%A5"><span class="toc-number">3.4.2.2.</span> <span class="toc-text">方法二、设置 root 用户支持远程连接</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E5%AE%89%E8%A3%85%E6%96%B9%E5%BC%8F"><span class="toc-number">3.5.</span> <span class="toc-text">其他安装方式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#docker"><span class="toc-number">3.5.1.</span> <span class="toc-text">docker</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%9F%A5%E8%AF%A2%E9%95%9C%E5%83%8F"><span class="toc-number">3.5.1.1.</span> <span class="toc-text">1、查询镜像</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%8B%89%E5%8F%96%E9%95%9C%E5%83%8F"><span class="toc-number">3.5.1.2.</span> <span class="toc-text">2、拉取镜像</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E6%9E%84%E5%BB%BA%E5%AE%B9%E5%99%A8"><span class="toc-number">3.5.1.3.</span> <span class="toc-text">3、构建容器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E8%BF%9B%E5%85%A5%E5%AE%B9%E5%99%A8"><span class="toc-number">3.5.1.4.</span> <span class="toc-text">4、进入容器</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#docker-compose"><span class="toc-number">3.5.2.</span> <span class="toc-text">docker-compose</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE-docker-comoseyml-%E6%96%87%E4%BB%B6"><span class="toc-number">3.5.2.1.</span> <span class="toc-text">配置 docker-comose.yml 文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-mycnf"><span class="toc-number">3.5.2.2.</span> <span class="toc-text">配置文件 my.cnf</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%97%AE%E9%A2%98"><span class="toc-number">3.5.2.3.</span> <span class="toc-text">问题</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8Bmysql%E7%9A%84%E5%AE%89%E8%A3%85%E7%BB%93%E6%9E%9C"><span class="toc-number">3.6.</span> <span class="toc-text">查看 MySQL 的安装结果</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%8D%B8%E8%BD%BD"><span class="toc-number">4.</span> <span class="toc-text">数据库的卸载</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#sql%E8%AF%AD%E8%A8%80%E5%85%A5%E9%97%A8"><span class="toc-number">5.</span> <span class="toc-text">SQL 语言入门</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1sql%E8%AF%AD%E8%A8%80%E5%85%A5%E9%97%A8"><span class="toc-number">5.1.</span> <span class="toc-text">【1】SQL 语言入门</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2sql%E8%AF%AD%E8%A8%80%E5%88%86%E4%B8%BA%E4%BA%94%E4%B8%AA%E9%83%A8%E5%88%86"><span class="toc-number">5.2.</span> <span class="toc-text">【2】SQL 语言分为五个部分</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ddl_dml_%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8"><span class="toc-number">5.3.</span> <span class="toc-text">DDL_DML_创建数据库表</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E8%AE%A4%E8%AF%86%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8"><span class="toc-number">5.3.1.</span> <span class="toc-text">【1】认识数据库表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8-t_student"><span class="toc-number">5.3.2.</span> <span class="toc-text">【2】创建数据库表 t_student</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8%E5%88%97%E7%B1%BB%E5%9E%8B"><span class="toc-number">5.4.</span> <span class="toc-text">数据库表列类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B4%E6%95%B0%E7%B1%BB%E5%9E%8B"><span class="toc-number">5.4.1.</span> <span class="toc-text">整数类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%AE%E7%82%B9%E6%95%B0%E7%B1%BB%E5%9E%8B"><span class="toc-number">5.4.2.</span> <span class="toc-text">浮点数类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%B1%BB%E5%9E%8B"><span class="toc-number">5.4.3.</span> <span class="toc-text">字符串类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A5%E6%9C%9F%E5%92%8C%E6%97%B6%E9%97%B4%E7%B1%BB%E5%9E%8B"><span class="toc-number">5.4.4.</span> <span class="toc-text">日期和时间类型</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dml_%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE"><span class="toc-number">5.5.</span> <span class="toc-text">DML_添加数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dml_%E4%BF%AE%E6%94%B9%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE"><span class="toc-number">5.6.</span> <span class="toc-text">DML_修改，删除数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ddl_%E4%BF%AE%E6%94%B9%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8"><span class="toc-number">5.7.</span> <span class="toc-text">DDL_修改，删除数据库表</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%A1%A8%E7%9A%84%E5%AE%8C%E6%95%B4%E6%80%A7%E7%BA%A6%E6%9D%9F"><span class="toc-number">6.</span> <span class="toc-text">表的完整性约束</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%9E%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F"><span class="toc-number">6.1.</span> <span class="toc-text">非外键约束</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E6%BC%94%E7%A4%BA%E9%9D%9E%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F"><span class="toc-number">6.1.1.</span> <span class="toc-text">代码演示非外键约束：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BA%A6%E6%9D%9F%E4%BB%8E%E4%BD%9C%E7%94%A8%E4%B8%8A%E5%8F%AF%E4%BB%A5%E5%88%86%E4%B8%BA%E4%B8%A4%E7%B1%BB"><span class="toc-number">6.1.2.</span> <span class="toc-text">约束从作用上可以分为两类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8%E5%88%9B%E5%BB%BA%E8%A1%A8%E4%BB%A5%E5%90%8E%E6%B7%BB%E5%8A%A0%E7%BA%A6%E6%9D%9F"><span class="toc-number">6.1.3.</span> <span class="toc-text">在创建表以后添加约束：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">6.1.4.</span> <span class="toc-text">总结：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F"><span class="toc-number">6.2.</span> <span class="toc-text">外键约束</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-number">6.2.1.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sql%E5%B1%95%E7%A4%BA"><span class="toc-number">6.2.2.</span> <span class="toc-text">sql 展示：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F%E7%AD%96%E7%95%A5"><span class="toc-number">6.2.3.</span> <span class="toc-text">外键约束策略</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ddl%E5%92%8Cdml%E7%9A%84%E8%A1%A5%E5%85%85"><span class="toc-number">7.</span> <span class="toc-text">DDL 和 DML 的补充</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#sql%E5%B1%95%E7%A4%BA-2"><span class="toc-number">7.1.</span> <span class="toc-text">sql 展示：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#delete%E5%92%8Ctruncate%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">7.2.</span> <span class="toc-text">delete 和 truncate 的区别</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#dql-%E6%9F%A5%E8%AF%A2%E6%93%8D%E4%BD%9C"><span class="toc-number">8.</span> <span class="toc-text">DQL - 查询操作</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%95%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="toc-number">8.1.</span> <span class="toc-text">单表查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8D%95sql-%E6%9F%A5%E8%AF%A2"><span class="toc-number">8.1.1.</span> <span class="toc-text">简单 SQL 查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#where%E5%AD%90%E5%8F%A5"><span class="toc-number">8.1.2.</span> <span class="toc-text">where 子句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%87%BD%E6%95%B0"><span class="toc-number">8.1.3.</span> <span class="toc-text">使用函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#group_by%E5%88%86%E7%BB%84"><span class="toc-number">8.1.4.</span> <span class="toc-text">group_by 分组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#having%E5%88%86%E7%BB%84%E5%90%8E%E7%AD%9B%E9%80%89"><span class="toc-number">8.1.5.</span> <span class="toc-text">having 分组后筛选</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E8%A1%A8%E6%9F%A5%E8%AF%A2%E6%80%BB%E7%BB%93"><span class="toc-number">8.1.6.</span> <span class="toc-text">单表查询总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="toc-number">8.2.</span> <span class="toc-text">多表查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#99%E8%AF%AD%E6%B3%95%E4%BA%A4%E5%8F%89%E8%BF%9E%E6%8E%A5%E8%87%AA%E7%84%B6%E8%BF%9E%E6%8E%A5%E5%86%85%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-number">8.2.1.</span> <span class="toc-text">99 语法：交叉连接，自然连接，内连接查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#99%E8%AF%AD%E6%B3%95%E5%A4%96%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-number">8.2.2.</span> <span class="toc-text">99 语法：外连接查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#99%E8%AF%AD%E6%B3%95%E4%B8%89%E8%A1%A8%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-number">8.2.3.</span> <span class="toc-text">99 语法：三表连接查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#99%E8%AF%AD%E6%B3%95%E8%87%AA%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-number">8.2.4.</span> <span class="toc-text">99 语法：自连接查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#92%E8%AF%AD%E6%B3%95%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="toc-number">8.2.5.</span> <span class="toc-text">92 语法：多表查询</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">8.3.</span> <span class="toc-text">子查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8D%E7%9B%B8%E5%85%B3%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">8.3.1.</span> <span class="toc-text">不相关子查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">8.3.1.1.</span> <span class="toc-text">什么是子查询？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F"><span class="toc-number">8.3.1.2.</span> <span class="toc-text">执行顺序</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8D%E7%9B%B8%E5%85%B3%E5%AD%90%E6%9F%A5%E8%AF%A2-2"><span class="toc-number">8.3.1.3.</span> <span class="toc-text">不相关子查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8D%E7%9B%B8%E5%85%B3%E5%AD%90%E6%9F%A5%E8%AF%A2%E5%88%86%E7%B1%BB"><span class="toc-number">8.3.1.4.</span> <span class="toc-text">不相关子查询分类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%95%E8%A1%8C%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">8.3.1.5.</span> <span class="toc-text">单行子查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%9A%E8%A1%8C%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">8.3.1.6.</span> <span class="toc-text">多行子查询</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">8.3.2.</span> <span class="toc-text">相关子查询</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AF%B9%E8%B1%A1"><span class="toc-number">9.</span> <span class="toc-text">数据库对象</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE"><span class="toc-number">9.1.</span> <span class="toc-text">视图</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE%E7%9A%84%E6%A6%82%E5%BF%B5"><span class="toc-number">9.1.1.</span> <span class="toc-text">视图的概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE%E7%9A%84%E5%A5%BD%E5%A4%84"><span class="toc-number">9.1.2.</span> <span class="toc-text">视图的好处</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sql%E5%B1%95%E7%A4%BA-3"><span class="toc-number">9.1.3.</span> <span class="toc-text">SQL 展示：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">9.2.</span> <span class="toc-text">存储过程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8Bstored-procedure"><span class="toc-number">9.2.1.</span> <span class="toc-text">什么是存储过程 (Stored Procedure)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E7%9A%84%E4%BC%98%E7%82%B9"><span class="toc-number">9.2.2.</span> <span class="toc-text">存储过程的优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%BE%E8%A7%A3"><span class="toc-number">9.2.3.</span> <span class="toc-text">图解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B1%95%E7%A4%BA%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">9.2.4.</span> <span class="toc-text">展示存储过程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1"><span class="toc-number">9.3.</span> <span class="toc-text">事务</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1%E5%8F%8A%E5%85%B6%E7%89%B9%E5%BE%81"><span class="toc-number">9.3.1.</span> <span class="toc-text">事务及其特征</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1%E7%9A%84%E6%A6%82%E5%BF%B5"><span class="toc-number">9.3.1.1.</span> <span class="toc-text">事务的概念</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1%E7%9A%84%E7%89%B9%E6%80%A7"><span class="toc-number">9.3.1.2.</span> <span class="toc-text">事务的特性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#sql%E5%B1%95%E7%A4%BA%E4%BD%BF%E7%94%A8%E4%BA%8B%E5%8A%A1%E4%BF%9D%E8%AF%81%E8%BD%AC%E8%B4%A6%E5%AE%89%E5%85%A8"><span class="toc-number">9.3.1.3.</span> <span class="toc-text">sql 展示：使用事务保证转账安全</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1%E5%B9%B6%E5%8F%91%E9%97%AE%E9%A2%98"><span class="toc-number">9.3.2.</span> <span class="toc-text">事务并发问题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%84%8F%E8%AF%BBdirty-read"><span class="toc-number">9.3.2.1.</span> <span class="toc-text">脏读（Dirty read）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8D%E5%8F%AF%E9%87%8D%E5%A4%8D%E8%AF%BB"><span class="toc-number">9.3.2.2.</span> <span class="toc-text">不可重复读</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B9%BB%E8%AF%BB"><span class="toc-number">9.3.2.3.</span> <span class="toc-text">幻读</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8D%E5%8F%AF%E9%87%8D%E5%A4%8D%E5%BA%A6%E5%92%8C%E5%B9%BB%E8%AF%BB%E5%8C%BA%E5%88%AB"><span class="toc-number">9.3.2.4.</span> <span class="toc-text">不可重复度和幻读区别：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB"><span class="toc-number">9.3.3.</span> <span class="toc-text">事务隔离级别</span></a></li></ol></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li class="active"><a href="/DataBase/MySQL/MySQL_Basic/" rel="bookmark" title="MySQL基础">MySQL基础</a></li><li><a href="/DataBase/MySQL/MySQL_Super/" rel="bookmark" title="MySQL调优">MySQL调优</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="雾都" data-src="/images/avatar.jpg"><p class="name" itemprop="name">雾都</p><div class="description" itemprop="description">记录 “美食” 每刻</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">64</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">11</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">21</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL29ubHltYXJyeXU=" title="https:&#x2F;&#x2F;github.com&#x2F;onlymarryu"><i class="ic i-github"></i></span> <span class="exturl item zhihu" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3Blb3BsZS9ydXJpc216aw==" title="https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;rurismzk"><i class="ic i-zhihu"></i></span> <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLyMvbXkvbS9tdXNpYy9wbGF5bGlzdD9pZD0zMTY2MDYwNzkw" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;my&#x2F;m&#x2F;music&#x2F;playlist?id&#x3D;3166060790"><i class="ic i-cloud-music"></i></span> <span class="exturl item weibo" data-url="aHR0cHM6Ly93ZWliby5jb20vYW1laGltZQ==" title="https:&#x2F;&#x2F;weibo.com&#x2F;amehime"><i class="ic i-weibo"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>时间轴</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li><li class="item"><a href="/toolPage/" rel="section"><i class="ic i-feather"></i>MarkDown常用操作</a></li><li class="item"><a href="/projectBuild/" rel="section"><i class="ic i-th"></i>SpringBoot常用配置</a></li></ul></li><li class="item"><a href="/mianshi/" rel="section"><i class="ic i-calendar"></i>面试</a></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>友链</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-calendar"></i>留言</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/ORM/MybatisPlus/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/Distribution/FastDFS/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F/" title="分类于 分布式">分布式</a></div><span><a href="/Distribution/Solr/" title="Solr">Solr</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/JavaSE/" title="分类于 JavaSE">JavaSE</a></div><span><a href="/Java/%E7%AC%AC10%E7%AB%A0_%E5%B8%B8%E7%94%A8%E7%B1%BB/" title="第10章_常用类">第10章_常用类</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E5%B7%A5%E5%85%B7%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85/" title="分类于 工具软件安装">工具软件安装</a></div><span><a href="/tools/tools-All/" title="所有工具安装合集">所有工具安装合集</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E5%B7%A5%E5%85%B7%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85/" title="分类于 工具软件安装">工具软件安装</a></div><span><a href="/tools/Kafka-tool/" title="Kafka">Kafka</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F/" title="分类于 分布式">分布式</a></div><span><a href="/Distribution/zookeeper/" title="Zookeeper">Zookeeper</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" title="分类于 数据库">数据库</a> <i class="ic i-angle-right"></i> <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/MySQL/" title="分类于 MySQL">MySQL</a></div><span><a href="/DataBase/MySQL/MySQL_Basic/" title="MySQL基础">MySQL基础</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" title="分类于 数据库">数据库</a> <i class="ic i-angle-right"></i> <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/MySQL/" title="分类于 MySQL">MySQL</a></div><span><a href="/DataBase/MySQL/MySQL_Super/" title="MySQL调优">MySQL调优</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E5%B7%A5%E5%85%B7%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85/" title="分类于 工具软件安装">工具软件安装</a></div><span><a href="/tools/RabbitMQ-tool/" title="RabbitMQ">RabbitMQ</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/JavaSE/" title="分类于 JavaSE">JavaSE</a></div><span><a href="/Java/%E7%AC%AC15%E7%AB%A0Junit%E6%B3%A8%E8%A7%A3_%E6%9E%9A%E4%B8%BE/" title="第15章Junit注解_枚举">第15章Junit注解_枚举</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F/" title="分类于 分布式">分布式</a></div><span><a href="/Distribution/RabbitMQ/" title="RabbitMQ">RabbitMQ</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">雾都 @ 雾都博客</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">813k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">12:19</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"DataBase/MySQL/MySQL_Basic/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html>