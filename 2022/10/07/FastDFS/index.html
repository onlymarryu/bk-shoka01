<!-- build time:Sat Oct 15 2022 15:53:56 GMT+0800 (中国标准时间) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="记录“美食”每刻" href="http://example.com/rss.xml"><link rel="alternate" type="application/atom+xml" title="记录“美食”每刻" href="http://example.com/atom.xml"><link rel="alternate" type="application/json" title="记录“美食”每刻" href="http://example.com/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="分布式,FastDFS"><link rel="canonical" href="http://example.com/2022/10/07/FastDFS/"><title>FastDFS - FastDFS - 分布式 | 雾都博客 = 记录 “美食” 每刻</title><meta name="generator" content="Hexo 6.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">FastDFS</h1><div class="meta"><span class="item" title="创建时间：2022-10-07 00:00:00"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2022-10-07T00:00:00+08:00">2022-10-07</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>11k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>10 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">雾都博客</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1gipet4bz0yj20zk0m8e81.jpg"></li><li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1giclize41wj20zk0m87gk.jpg"></li><li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1gipexj2jgzj20zk0m8b09.jpg"></li><li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1giciukx8a7j20zk0m8aio.jpg"></li><li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1giclwrdwyaj20zk0m8are.jpg"></li><li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1giph4fomxoj20zk0m8axp.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F/" itemprop="item" rel="index" title="分类于 分布式"><span itemprop="name">分布式</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F/FastDFS/" itemprop="item" rel="index" title="分类于 FastDFS"><span itemprop="name">FastDFS</span></a><meta itemprop="position" content="2"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://example.com/2022/10/07/FastDFS/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="雾都"><meta itemprop="description" content=", 记录 “美食” 每刻"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="记录 “美食” 每刻"></span><div class="body md" itemprop="articleBody"><h1 id="分布式文件存储系统FastDFS"><a href="#分布式文件存储系统FastDFS" class="headerlink" title="分布式文件存储系统FastDFS"></a>分布式文件存储系统FastDFS</h1><h1 id="一、分布式文件存储"><a href="#一、分布式文件存储" class="headerlink" title="一、分布式文件存储"></a>一、分布式文件存储</h1><h2 id="1-分布式文件存储的由来"><a href="#1-分布式文件存储的由来" class="headerlink" title="1.分布式文件存储的由来"></a>1.分布式文件存储的由来</h2><p>&amp;emsp;&amp;emsp;在我们的项目中有很多需要存储的内容出现，比如图片，视频，文件等等，在早期的时候用户量不大，产生的文件也不是很多，这时我们可以把文件和服务程序放在一个服务器中。</p><img data-src="/2022/10/07/FastDFS/66d2beee9a4e47c08aa9552530a9c996.png"><p>&amp;emsp;&amp;emsp;后面随着文件越来越多，服务器的资源会被文件资源大量占据，从而影响到服务器的稳定，这时我们可以单独的把文件服务器拆出来。</p><img data-src="/2022/10/07/FastDFS/8097b0f16465452b9f9b460e2149aa0d.png"><p>&amp;emsp;&amp;emsp;拆解出来后，文件服务的使用不会影响到我们的系统服务的稳定，但是当用户量越来越大，存储的文件就会越来越多，这时如果还是单台的文件服务，比如100T的文件，这时是存储不下去的，这时就产生了我们将的分布式文件存储，</p><img data-src="/2022/10/07/FastDFS/fff16a09675d40ac926d42be9385d461.png"><p>&amp;emsp;&amp;emsp;也就是我们解决如何将这100T的文件分散的存储到各个节点上，然后当我们需要读取文件的时候又能非常快的帮我们把文件找到。这个就是分布式文件系统帮我们解决的问题了。</p><h2 id="2-常见的分布式存储框架"><a href="#2-常见的分布式存储框架" class="headerlink" title="2.常见的分布式存储框架"></a>2.常见的分布式存储框架</h2><p>&amp;emsp;&amp;emsp;接下来我们看看在国内常用的分布式存储的框架选择有哪些</p><table><thead><tr><th>分布式框架</th><th>说明</th></tr></thead><tbody><tr><td>FastDFS</td><td>我们介绍的主角，国产</td></tr><tr><td>HDFS</td><td>Hadoop组件中分布式存储框架</td></tr><tr><td>MinIO</td><td>MinIO是在Apache下的产品，最适合存储非结构化的数据，<br>比如照片，视频，日志文件，备份和容器等。</td></tr><tr><td>阿里云对象存储</td><td>当然我们还可以花费一点费用来使用其他厂商提供的对象存储服务</td></tr></tbody></table><p>&amp;emsp;&amp;emsp;好了就介绍这么几个，其他的我们也用不到了。</p><h1 id="二、FastDFS介绍"><a href="#二、FastDFS介绍" class="headerlink" title="二、FastDFS介绍"></a>二、FastDFS介绍</h1><p>&amp;emsp;&amp;emsp;FastDFS是余庆国人开发的一个开源的轻量级分布式文件系统，它对文件进行管理，功能包括：文件存储、文件同步、文件访问（文件上传、文件下载）等，解决了大容量存储和负载均衡的问题。特别适合以文件为载体的在线服务，如相册网站、视频网站等等。</p><p>&amp;emsp;&amp;emsp;FastDFS为互联网量身定制，充分考虑了冗余备份、负载均衡、线性扩容等机制，并注重高可用、高性能等指标，使用FastDFS很容易搭建一套高性能的文件服务器集群提供文件上传、下载等服务。</p><p>FastDFS的特点：</p><ul><li>FastDFS是一个轻量级的开源分布式文件系统</li><li>FastDFS主要解决了大容量的文件存储和高并发访问的问题，文件存取时实现了负载均衡</li><li>FastDFS实现了软件方式的RAID，可以使用廉价的IDE硬盘进行存储</li><li>支持存储服务器在线扩容</li><li>支持相同内容的文件只保存一份，节约磁盘空间</li><li>FastDFS只能通过Client API访问，不支持POSIX访问方式</li><li>FastDFS特别适合大中型网站使用，用来存储资源文件（如：图片、文档、音频、视频等等）</li></ul><p>架构图：</p><img data-src="/2022/10/07/FastDFS/92362218a5024b7c9e9141b754756b79.png"><p>相关术语讲解：</p><table><thead><tr><th>名词</th><th>描述</th></tr></thead><tbody><tr><td>Tracker Server</td><td>跟踪服务器，主要做调度工作，在访问上起负载均衡的作用。<br>记录storage server的状态，是连接Client和Storage server的枢纽</td></tr><tr><td>Storage Server</td><td>存储服务器，文件和meta data都保存到存储服务器上</td></tr><tr><td>group</td><td>组，也可称为卷。同组内服务器上的文件是完全相同的</td></tr><tr><td>文件标识</td><td>包括两部分：组名和文件名（包含路径）</td></tr><tr><td>meta-data</td><td>文件相关属性，键值对（Key Value Pair）方式，如：width&#x3D;1024,heigth&#x3D;768</td></tr></tbody></table><p>架构解读：</p><ul><li>只有两个角色，tracker server和storage server，不需要存储文件索引信息。</li><li>所有服务器都是对等的，不存在Master-Slave关系。</li><li>存储服务器采用分组方式，同组内存储服务器上的文件完全相同（RAID 1）。</li><li>不同组的storage server之间不会相互通信。</li><li>由storage server主动向tracker server报告状态信息，tracker server之间不会相互通信。</li></ul><h1 id="三、FastDFS安装"><a href="#三、FastDFS安装" class="headerlink" title="三、FastDFS安装"></a>三、FastDFS安装</h1><img data-src="/2022/10/07/FastDFS/b60ca697c06d4425b7cd228b98dc3d19.png"><p>&amp;emsp;&amp;emsp;FastDFS的安装我们还是通过Docker来安装实现吧，直接在Linux上还装还是比较繁琐的，但就学习而言Docker安装还是非常高效的。Docker环境请自行安装哦，不清楚的可以看看我的Docker专题的内容。<a href="Docker%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%96%99" title="Docker学习资料">https://blog.csdn.net/qq_38526573&#x2F;category_9619681.html</a></p><h2 id="1-拉取镜像文件"><a href="#1-拉取镜像文件" class="headerlink" title="1.拉取镜像文件"></a>1.拉取镜像文件</h2><p>&amp;emsp;&amp;emsp;首先我们可以通过 <code>docker search fastdfs</code> 来查询下有哪些镜像文件。</p><img data-src="/2022/10/07/FastDFS/5a06a59eb24d4f9e847a4badeef871ac.png"><p>&amp;emsp;&amp;emsp;我们看到搜索到的镜像还是蛮多的，这里我们使用 <code>delron/fastdfs</code> 你也可以尝试使用其他的镜像来安装，你也可以制作自己的镜像来给别人使用哦，只是不同的镜像在使用的时候配置会有一些不一样，有些镜像没有提供Nginx的相关配置，使用的时候会繁琐一点。接下来通过 <code>docker pull delron/fastdfs</code>命令把镜像拉取下来。</p><pre><code class="shell">docker pull delron/fastdfs
</code></pre><img data-src="/2022/10/07/FastDFS/5e5b85b3dc9a432abf615b27868fc7bf.png"><h2 id="2-构建Tracker服务"><a href="#2-构建Tracker服务" class="headerlink" title="2.构建Tracker服务"></a>2.构建Tracker服务</h2><p>&amp;emsp;&amp;emsp;首先我们需要通过Docker命令来创建Tracker服务。命令为</p><pre><code class="shell">docker run -d --name tracker --network=host -v /mydata/fastdfs/tracker:/var/fdfs delron/fastdfs tracker
</code></pre><p>&amp;emsp;&amp;emsp;tracker服务默认的端口为22122，-v 实现了容器和本地目录的挂载操作。</p><img data-src="/2022/10/07/FastDFS/694d42632bf6410a806df9aa43e836c0.png"><h2 id="3-构建Storage服务"><a href="#3-构建Storage服务" class="headerlink" title="3.构建Storage服务"></a>3.构建Storage服务</h2><p>&amp;emsp;&amp;emsp;接下来创建Storage服务，具体的执行命令如下</p><pre><code class="shell">docker run -d --name storage --network=host  -e TRACKER_SERVER=192.168.1.195:22122 -v /mydata/fastdfs/storage:/var/fdfs -e GROUP_NAME=group1 delron/fastdfs storage
</code></pre><p>&amp;emsp;&amp;emsp;在执行上面命令的时候要注意对应的修改下，其中TRACKER_SERVER中的ip要修改为你的Tracker服务所在的服务IP地址。</p><img data-src="/2022/10/07/FastDFS/dc2bdf85d0f24fe18a32efbe4caa2d27.png"><p>&amp;emsp;&amp;emsp;默认情况下在Storage服务中是帮我们安装了Nginx服务的，相关的端口为</p><table><thead><tr><th>服务</th><th>默认端口</th></tr></thead><tbody><tr><td>tracker</td><td>22122</td></tr><tr><td>storage</td><td>23000</td></tr><tr><td>Nginx</td><td>8888</td></tr></tbody></table><p>&amp;emsp;&amp;emsp;当然如果你发现这些相关的端口被占用了，或者想要对应的修改端口信息也可以的。要修改你可以先进入容器中查看下相关的配置文件信息。</p><img data-src="/2022/10/07/FastDFS/da5cc21445e840baa85580ba420db94d.png"><p>&amp;emsp;&amp;emsp;然后查看storage.conf文件</p><img data-src="/2022/10/07/FastDFS/63862499980b408195291de047048566.png"><p>&amp;emsp;&amp;emsp;这个是storage监听的Nginx的端口8888，如果要修改那么我们还需要修改Nginx中的服务配置，这块的配置在 <code>/usr/local/nginx/conf</code>目录下</p><img data-src="/2022/10/07/FastDFS/f866c08177be4fd48bfd9a582ec78779.png"><p>&amp;emsp;&amp;emsp;查看下文件</p><img data-src="/2022/10/07/FastDFS/dc7c5888363a400b9308f3ba64cca9ac.png"><p>所以要修改端口号的话，这两个位置都得修改了。当然本文我们就使用默认的端口号来使用了。</p><h2 id="4-测试图片上传"><a href="#4-测试图片上传" class="headerlink" title="4.测试图片上传"></a>4.测试图片上传</h2><p>&amp;emsp;&amp;emsp;好了，安装我们已经完成了，那么到底是否可以使用呢？我们来测试下。首先在虚拟机的&#x2F;mydata&#x2F;fastdfs&#x2F;storage下保存一张图片。</p><img data-src="/2022/10/07/FastDFS/ff2ea2626bb34acd810fbb8d9438129a.png"><p>&amp;emsp;&amp;emsp;然后我们再进入到storage容器中。并且进入到 <code>/var/fdfs</code>目录下,可以看到我们挂载的文件了</p><img data-src="/2022/10/07/FastDFS/cb8a96fb9bb644328880ca70378a7fc2.png"><p>&amp;emsp;&amp;emsp;然后执行如下命令即可完成图片的上传操作</p><pre><code class="shell">/usr/bin/fdfs_upload_file /etc/fdfs/client.conf 1.jpg
</code></pre><img data-src="/2022/10/07/FastDFS/0fd0e82898bb45178eca4eef9a412745.png"><p>&amp;emsp;&amp;emsp;通过上面的提示我们看到文件上传成功了，而且返回了文件在storage中存储的信息。这时我们就可以通过这个信息来拼接访问的地址在浏览器中访问了：<span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguNTYuMTAwOjg4ODgvZ3JvdXAxL00wMC8wMC8wMC93S2c0WkdIY0tMU0FYaWJhQUFlek11VXJsUzgyMzUuanBn">http://192.168.56.100:8888/group1/M00/00/00/wKg4ZGHcKLSAXibaAAezMuUrlS8235.jpg</span></p><img data-src="/2022/10/07/FastDFS/b34e823e956f410297bfd1218ebc0231.png"><p>&amp;emsp;&amp;emsp;好了到这儿FastDFS的服务安装成功了。</p><h1 id="四、客户端操作"><a href="#四、客户端操作" class="headerlink" title="四、客户端操作"></a>四、客户端操作</h1><h2 id="1-Fastdfs-java-client"><a href="#1-Fastdfs-java-client" class="headerlink" title="1.Fastdfs-java-client"></a>1.Fastdfs-java-client</h2><p>&amp;emsp;&amp;emsp;首先我们来看下如何实现FastDFS中提供的JavaAPI来直接实现对应的文件上传和下载操作。</p><h3 id="1-1-文件上传"><a href="#1-1-文件上传" class="headerlink" title="1.1 文件上传"></a>1.1 文件上传</h3><p>&amp;emsp;&amp;emsp;先来看下文件上传的流程</p><img data-src="/2022/10/07/FastDFS/c1da19dbbe994f55b20371ba0806d694.png"><p>&amp;emsp;&amp;emsp;上传流程的文字梳理为：</p><ol><li>客户端访问Tracker</li><li>Tracker 返回Storage的ip和端口</li><li>客户端直接访问Storage，把文件内容和元数据发送过去。</li><li>Storage返回文件存储id。包含了组名和文件名</li></ol><p>&amp;emsp;&amp;emsp;首先创建一个普通的maven项目，然后引入对应的依赖</p><pre><code class="xml">&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;cn.bestwu&lt;/groupId&gt;
        &lt;artifactId&gt;fastdfs-client-java&lt;/artifactId&gt;
        &lt;version&gt;1.27&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;
        &lt;artifactId&gt;commons-lang3&lt;/artifactId&gt;
        &lt;version&gt;3.4&lt;/version&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;
</code></pre><p>&amp;emsp;&amp;emsp;然后编写FastDFS的配置文件，内容如下：注意ip修改为你自己对应的ip即可</p><pre><code class="xml">connect_timeout = 10
network_timeout = 30
charset = UTF-8
http.tracker_http_port = 8080
tracker_server = 192.168.56.100:22122
</code></pre><img data-src="/2022/10/07/FastDFS/3c54c7b41f2a4ac2b420b65beafd10d2.png"><p>&amp;emsp;&amp;emsp;然后导入对应的工具类，在工具类中完成了StorageClient的实例化，并提供了相关的上传和下载的方法。</p><pre><code class="java">package com.bobo.fastdfs.config;

import org.apache.commons.lang3.StringUtils;
import org.csource.common.NameValuePair;
import org.csource.fastdfs.*;

import java.io.*;

public class FastDFSClient &#123;
    private static final String CONF_FILENAME = Thread.currentThread().getContextClassLoader().getResource(&quot;&quot;).getPath() + &quot;fdfs_client.conf&quot;;

    private static StorageClient storageClient = null;

    /**
     * 只加载一次.
     */
    static &#123;
        try &#123;
            ClientGlobal.init(CONF_FILENAME);
            TrackerClient trackerClient = new TrackerClient(ClientGlobal.g_tracker_group);
            TrackerServer trackerServer = trackerClient.getConnection();
            StorageServer storageServer = trackerClient.getStoreStorage(trackerServer);
            storageClient = new StorageClient(trackerServer, storageServer);
        &#125; catch (Exception e) &#123;
            e.printStackTrace();
        &#125;
    &#125;

    /**
     *
     * @param inputStream
     *    上传的文件输入流
     * @param fileName
     *    上传的文件原始名
     * @return
     */
    public static String[] uploadFile(InputStream inputStream, String fileName) &#123;
        try &#123;
            // 文件的元数据
            NameValuePair[] meta_list = new NameValuePair[2];
            // 第一组元数据，文件的原始名称
            meta_list[0] = new NameValuePair(&quot;file name&quot;, fileName);
            // 第二组元数据
            meta_list[1] = new NameValuePair(&quot;file length&quot;, inputStream.available()+&quot;&quot;);
            // 准备字节数组
            byte[] file_buff = null;
            if (inputStream != null) &#123;
                // 查看文件的长度
                int len = inputStream.available();
                // 创建对应长度的字节数组
                file_buff = new byte[len];
                // 将输入流中的字节内容，读到字节数组中。
                inputStream.read(file_buff);
            &#125;
            // 上传文件。参数含义：要上传的文件的内容（使用字节数组传递），上传的文件的类型（扩展名），元数据
            String[] fileids = storageClient.upload_file(file_buff, getFileExt(fileName), meta_list);
            return fileids;
        &#125; catch (Exception ex) &#123;
            ex.printStackTrace();
            return null;
        &#125;
    &#125;

    /**
     *
     * @param file
     *            文件
     * @param fileName
     *            文件名
     * @return 返回Null则为失败
     */
    public static String[] uploadFile(File file, String fileName) &#123;
        FileInputStream fis = null;
        try &#123;
            NameValuePair[] meta_list = null; // new NameValuePair[0];
            fis = new FileInputStream(file);
            byte[] file_buff = null;
            if (fis != null) &#123;
                int len = fis.available();
                file_buff = new byte[len];
                fis.read(file_buff);
            &#125;

            String[] fileids = storageClient.upload_file(file_buff, getFileExt(fileName), meta_list);
            return fileids;
        &#125; catch (Exception ex) &#123;
            return null;
        &#125;finally&#123;
            if (fis != null)&#123;
                try &#123;
                    fis.close();
                &#125; catch (IOException e) &#123;
                    e.printStackTrace();
                &#125;
            &#125;
        &#125;
    &#125;

    /**
     * 根据组名和远程文件名来删除一个文件
     *
     * @param groupName
     *            例如 &quot;group1&quot; 如果不指定该值，默认为group1
     * @param remoteFileName
     *            例如&quot;M00/00/00/wKgxgk5HbLvfP86RAAAAChd9X1Y736.jpg&quot;
     * @return 0为成功，非0为失败，具体为错误代码
     */
    public static int deleteFile(String groupName, String remoteFileName) &#123;
        try &#123;
            int result = storageClient.delete_file(groupName == null ? &quot;group1&quot; : groupName, remoteFileName);
            return result;
        &#125; catch (Exception ex) &#123;
            return 0;
        &#125;
    &#125;

    /**
     * 修改一个已经存在的文件
     *
     * @param oldGroupName
     *            旧的组名
     * @param oldFileName
     *            旧的文件名
     * @param file
     *            新文件
     * @param fileName
     *            新文件名
     * @return 返回空则为失败
     */
    public static String[] modifyFile(String oldGroupName, String oldFileName, File file, String fileName) &#123;
        String[] fileids = null;
        try &#123;
            // 先上传
            fileids = uploadFile(file, fileName);
            if (fileids == null) &#123;
                return null;
            &#125;
            // 再删除
            int delResult = deleteFile(oldGroupName, oldFileName);
            if (delResult != 0) &#123;
                return null;
            &#125;
        &#125; catch (Exception ex) &#123;
            return null;
        &#125;
        return fileids;
    &#125;

    /**
     * 文件下载
     *
     * @param groupName 卷名
     * @param remoteFileName 文件名
     * @return 返回一个流
     */
    public static InputStream downloadFile(String groupName, String remoteFileName) &#123;
        try &#123;
            byte[] bytes = storageClient.download_file(groupName, remoteFileName);
            InputStream inputStream = new ByteArrayInputStream(bytes);
            return inputStream;
        &#125; catch (Exception ex) &#123;
            return null;
        &#125;
    &#125;

    public static NameValuePair[] getMetaDate(String groupName, String remoteFileName)&#123;
        try&#123;
            NameValuePair[] nvp = storageClient.get_metadata(groupName, remoteFileName);
            return nvp;
        &#125;catch(Exception ex)&#123;
            ex.printStackTrace();
            return null;
        &#125;
    &#125;

    /**
     * 获取文件后缀名（不带点）.
     *
     * @return 如：&quot;jpg&quot; or &quot;&quot;.
     */
    private static String getFileExt(String fileName) &#123;
        if (StringUtils.isBlank(fileName) || !fileName.contains(&quot;.&quot;)) &#123;
            return &quot;&quot;;
        &#125; else &#123;
            return fileName.substring(fileName.lastIndexOf(&quot;.&quot;) + 1); // 不带最后的点
        &#125;
    &#125;

&#125;
</code></pre><p>&amp;emsp;&amp;emsp;然后我们就可以来测试上传的操作了。</p><pre><code class="java">    public static void main(String[] args) &#123;
        try &#123;
            File file = new File(&quot;D:/2.jpg&quot;);
            InputStream is = new FileInputStream(file);
            String fileName = UUID.randomUUID().toString()+&quot;.jpg&quot;;
            String[] result = FastDFSClient.uploadFile(is, fileName);
            System.out.println(Arrays.toString(result));
        &#125; catch (Exception e) &#123;
            e.printStackTrace();
        &#125;
    &#125;
</code></pre><img data-src="/2022/10/07/FastDFS/6d7d9ff0b42e4e1daae06e47dab3793f.png"><p>访问即可：<span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguNTYuMTAwOjg4ODgvZ3JvdXAxL00wMC8wMC8wMC93S2c0WkdIY1VFNkFaQTJVQUFXOGRJWDVwNTAzNzQuanBn">http://192.168.56.100:8888/group1/M00/00/00/wKg4ZGHcUE6AZA2UAAW8dIX5p50374.jpg</span></p><p>&amp;emsp;&amp;emsp;返回后的字符串的结构说明</p><img data-src="/2022/10/07/FastDFS/5cec7e1344324b8dbd8050715d40b32f.png"><h3 id="1-2-文件下载"><a href="#1-2-文件下载" class="headerlink" title="1.2 文件下载"></a>1.2 文件下载</h3><p>&amp;emsp;&amp;emsp;文件下载的流程，如下</p><img data-src="/2022/10/07/FastDFS/04cba11544044479996f178ed8e41768.png"><p>&amp;emsp;&amp;emsp;文件下载的流程为：</p><ol><li>client询问tracker需要下载的文件的storage，参数为文件的标识(group加文件名)。</li><li>tracker根据客户端的参数返回一台可用的storage。</li><li>client根据返回的storage直接完成对应的文件的下载。</li></ol><p>&amp;emsp;&amp;emsp;有了上面的基础，文件下载就非常简单了，我们只需要根据前面上传的文件的group和文件的存储路径就可以通过StorageClient中提供的downloadFile方法把对应的文件下载下来了，具体的代码如下</p><pre><code class="java">    /**
     * 文件下载
     */
    public static void downloadFile()&#123;
        try &#123;
            InputStream is = FastDFSClient
                    .downloadFile(&quot;group1&quot;, &quot;M00/00/00/wKg4ZGHcUE6AZA2UAAW8dIX5p50374.jpg&quot;);
            OutputStream os = new FileOutputStream(new File(&quot;D:/12.jpg&quot;));
            int index = 0 ;
            while((index = is.read())!=-1)&#123;
                os.write(index);
            &#125;
            os.flush();
            os.close();
            is.close();
        &#125; catch (Exception e) &#123;
            e.printStackTrace();
        &#125;
    &#125;
</code></pre><p>注意：StorageClient是线程不安全的。那么我们的解决方案</p><ol><li>对文件的操作的每个方法我们做同步处理</li><li>每次操作文件的时候我们都获取一个新的StorageClient对象</li></ol><p>第一种方式效率肯定是最低的，第二种方式每次都要建立新的连接效率同样的会受到影响，这时最好的方式其实是把StorageClient交给我们自定义的连接池来管理</p><h2 id="2-SpringBoot整合"><a href="#2-SpringBoot整合" class="headerlink" title="2.SpringBoot整合"></a>2.SpringBoot整合</h2><p>&amp;emsp;&amp;emsp;我们在实际工作中基本都是和SpringBoot整合在一起来使用的，那么我们就来看看FastDFS是如何在SpringBoot项目中来使用的。首先创建一个普通的SpringBoot项目，然后导入fastdfs-spring-boot-starter这个依赖。</p><pre><code class="xml">    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
            &lt;scope&gt;test&lt;/scope&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;com.luhuiguo&lt;/groupId&gt;
            &lt;artifactId&gt;fastdfs-spring-boot-starter&lt;/artifactId&gt;
            &lt;version&gt;0.2.0&lt;/version&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
</code></pre><p>&amp;emsp;&amp;emsp;既然是一个starter，那么必然会在spring.factories文件中提供对应的自动配置类。</p><img data-src="/2022/10/07/FastDFS/807e18ab743d4dcea0128bfc9f967a22.png"><p>&amp;emsp;&amp;emsp;可以看到给我们提供的配置类为FdfsAutoConfiguration进入后可以看到帮我们注入了很多的核心对象。</p><img data-src="/2022/10/07/FastDFS/74a13becccb94ff8841c542cf0b9ce98.png"><p>&amp;emsp;&amp;emsp;然后可以看到系统提供的配置信息，前缀为 <code>fdfs</code></p><img data-src="/2022/10/07/FastDFS/ef9e211d1145444c8b8348d2e73a6a76.png"><p>&amp;emsp;&amp;emsp;然后我们就可以在application.properties中配置FastDFS的配置信息了。</p><img data-src="/2022/10/07/FastDFS/aa2dde964afc4909a7214239a269b65b.png"><p>&amp;emsp;&amp;emsp;配置完成后我们就可以测试文件的上传下载操作了</p><pre><code class="java">@SpringBootTest
class FastDfsSpringBootApplicationTests &#123;

    @Autowired
    public FastFileStorageClient storageClient;


    @Test
    void contextLoads() throws Exception&#123;
        File file = new File(&quot;d:\\2.jpg&quot;);
        StorePath path = storageClient.uploadFile(null,new FileInputStream(file),file.length(),file.getName());
        System.out.println(path.getFullPath());
    &#125;

&#125;
</code></pre><p>文件操作成功</p><img data-src="/2022/10/07/FastDFS/781603ff01b4486c8775ee45639420f4.png"><div class="tags"><a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F/" rel="tag"><i class="ic i-tag"></i> 分布式</a> <a href="/tags/FastDFS/" rel="tag"><i class="ic i-tag"></i> FastDFS</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2022-10-07 23:16:33" itemprop="dateModified" datetime="2022-10-07T23:16:33+08:00">2022-10-07</time></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="雾都 微信支付"><p>微信支付</p></div><div><img data-src="/images/alipay.png" alt="雾都 支付宝"><p>支付宝</p></div><div><img data-src="/images/paypal.png" alt="雾都 贝宝"><p>贝宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>雾都 <i class="ic i-at"><em>@</em></i>记录 “美食” 每刻</li><li class="link"><strong>本文链接：</strong> <a href="http://example.com/2022/10/07/FastDFS/" title="FastDFS">http://example.com/2022/10/07/FastDFS/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2022/10/07/MySQL_Super/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1giclimtf7dj20zk0m8qav.jpg" title="MySQL高级部分"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> MySQL</span><h3>MySQL高级部分</h3></a></div><div class="item right"><a href="/2022/10/07/Dubbo/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1giph4lm9i7j20zk0m84qp.jpg" title="Dubbo"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> Dubbo</span><h3>Dubbo</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%86%E5%B8%83%E5%BC%8F%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8%E7%B3%BB%E7%BB%9FFastDFS"><span class="toc-number">1.</span> <span class="toc-text">分布式文件存储系统FastDFS</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%88%86%E5%B8%83%E5%BC%8F%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8"><span class="toc-number">2.</span> <span class="toc-text">一、分布式文件存储</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%88%86%E5%B8%83%E5%BC%8F%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8%E7%9A%84%E7%94%B1%E6%9D%A5"><span class="toc-number">2.1.</span> <span class="toc-text">1.分布式文件存储的由来</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%B8%B8%E8%A7%81%E7%9A%84%E5%88%86%E5%B8%83%E5%BC%8F%E5%AD%98%E5%82%A8%E6%A1%86%E6%9E%B6"><span class="toc-number">2.2.</span> <span class="toc-text">2.常见的分布式存储框架</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E3%80%81FastDFS%E4%BB%8B%E7%BB%8D"><span class="toc-number">3.</span> <span class="toc-text">二、FastDFS介绍</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%E3%80%81FastDFS%E5%AE%89%E8%A3%85"><span class="toc-number">4.</span> <span class="toc-text">三、FastDFS安装</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%8B%89%E5%8F%96%E9%95%9C%E5%83%8F%E6%96%87%E4%BB%B6"><span class="toc-number">4.1.</span> <span class="toc-text">1.拉取镜像文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%9E%84%E5%BB%BATracker%E6%9C%8D%E5%8A%A1"><span class="toc-number">4.2.</span> <span class="toc-text">2.构建Tracker服务</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%9E%84%E5%BB%BAStorage%E6%9C%8D%E5%8A%A1"><span class="toc-number">4.3.</span> <span class="toc-text">3.构建Storage服务</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E6%B5%8B%E8%AF%95%E5%9B%BE%E7%89%87%E4%B8%8A%E4%BC%A0"><span class="toc-number">4.4.</span> <span class="toc-text">4.测试图片上传</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%93%8D%E4%BD%9C"><span class="toc-number">5.</span> <span class="toc-text">四、客户端操作</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Fastdfs-java-client"><span class="toc-number">5.1.</span> <span class="toc-text">1.Fastdfs-java-client</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="toc-number">5.1.1.</span> <span class="toc-text">1.1 文件上传</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD"><span class="toc-number">5.1.2.</span> <span class="toc-text">1.2 文件下载</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-SpringBoot%E6%95%B4%E5%90%88"><span class="toc-number">5.2.</span> <span class="toc-text">2.SpringBoot整合</span></a></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li class="active"><a href="/2022/10/07/FastDFS/" rel="bookmark" title="FastDFS">FastDFS</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="雾都" data-src="/images/avatar.jpg"><p class="name" itemprop="name">雾都</p><div class="description" itemprop="description">记录 “美食” 每刻</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">57</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">36</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">24</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL29ubHltYXJyeXU=" title="https:&#x2F;&#x2F;github.com&#x2F;onlymarryu"><i class="ic i-github"></i></span> <span class="exturl item CSDN" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0JraG9sZT9zcG09MTAwMC4yMTE1LjMwMDEuNTM0Mw==" title="https:&#x2F;&#x2F;blog.csdn.net&#x2F;Bkhole?spm&#x3D;1000.2115.3001.5343"><i class="ic i-CSDN"></i></span> <span class="exturl item fengye" data-url="aHR0cHM6Ly9jbG91ZC5meW5vdGUuY29tL2VkaXQ/bmlkPTExMzc5NiZpZD0xNTY3NTI4MDE2MzQ1NTYzMTM2JnQ9MTY2NTgxNjM0NTU4Nw==" title="https:&#x2F;&#x2F;cloud.fynote.com&#x2F;edit?nid&#x3D;113796&amp;id&#x3D;1567528016345563136&amp;t&#x3D;1665816345587"><i class="ic i-fengye"></i></span> <span class="exturl item yuque" data-url="aHR0cHM6Ly93d3cueXVxdWUuY29tL2Rhc2hib2FyZC9yZWNlbnQ=" title="https:&#x2F;&#x2F;www.yuque.com&#x2F;dashboard&#x2F;recent"><i class="ic i-yuque"></i></span> <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLyMvbXkvbS9tdXNpYy9wbGF5bGlzdD9pZD0zMTY2MDYwNzkw" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;my&#x2F;m&#x2F;music&#x2F;playlist?id&#x3D;3166060790"><i class="ic i-cloud-music"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>friends</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2022/10/07/MySQL_Super/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2022/10/07/Dubbo/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" title="分类于 数据库">数据库</a> <i class="ic i-angle-right"></i> <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/" title="分类于 Redis">Redis</a></div><span><a href="/2022/10/07/Redis/" title="Redis基础">Redis基础</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/" title="分类于 基础使用">基础使用</a></div><span><a href="/2022/10/14/Docsify/" title="MySQL基础">MySQL基础</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/JavaSE/" title="分类于 JavaSE">JavaSE</a> <i class="ic i-angle-right"></i> <a href="/categories/JavaSE/Junit%E6%B3%A8%E8%A7%A3-%E6%9E%9A%E4%B8%BE/" title="分类于 Junit 注解_枚举">Junit 注解_枚举</a></div><span><a href="/2022/10/07/%E7%AC%AC15%E7%AB%A0Junit%E6%B3%A8%E8%A7%A3_%E6%9E%9A%E4%B8%BE/" title="第15章Junit注解_枚举">第15章Junit注解_枚举</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F/" title="分类于 分布式">分布式</a> <i class="ic i-angle-right"></i> <a href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F/Solr/" title="分类于 Solr">Solr</a></div><span><a href="/2022/10/07/Solr/" title="Solr">Solr</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/JavaSE/" title="分类于 JavaSE">JavaSE</a> <i class="ic i-angle-right"></i> <a href="/categories/JavaSE/%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/" title="分类于 流程控制">流程控制</a></div><span><a href="/2022/10/07/%E7%AC%AC4%E7%AB%A0_%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/" title="第4章_流程控制">第4章_流程控制</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E5%B7%A5%E5%85%B7%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85/" title="分类于 工具软件安装">工具软件安装</a></div><span><a href="/2022/10/15/JRebel-tool/" title="JRebel安装">JRebel安装</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F/" title="分类于 分布式">分布式</a> <i class="ic i-angle-right"></i> <a href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F/Dubbo/" title="分类于 Dubbo">Dubbo</a></div><span><a href="/2022/10/07/Dubbo/" title="Dubbo">Dubbo</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/JavaSE/" title="分类于 JavaSE">JavaSE</a> <i class="ic i-angle-right"></i> <a href="/categories/JavaSE/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/" title="分类于 面向对象">面向对象</a></div><span><a href="/2022/10/07/%E7%AC%AC8%E7%AB%A0_%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/" title="第8章_面向对象">第8章_面向对象</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/JavaSE/" title="分类于 JavaSE">JavaSE</a> <i class="ic i-angle-right"></i> <a href="/categories/JavaSE/%E5%B8%B8%E7%94%A8%E7%B1%BB/" title="分类于 常用类">常用类</a></div><span><a href="/2022/10/07/%E7%AC%AC10%E7%AB%A0_%E5%B8%B8%E7%94%A8%E7%B1%BB/" title="第10章_常用类">第10章_常用类</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E5%B7%A5%E5%85%B7%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85/" title="分类于 工具软件安装">工具软件安装</a></div><span><a href="/2022/10/15/docker-tool/" title="docker安装">docker安装</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">雾都 @ 雾都博客</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">766k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">11:36</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2022/10/07/FastDFS/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,audio:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->