---
title: è®¾è®¡æ¨¡å¼
date: 2022-4-21
categories: 
  - è®¾è®¡æ¨¡å¼
tags:
  - è®¾è®¡æ¨¡å¼
---


valine:
  placeholder: "1. æé—®å‰è¯·å…ˆä»”ç»†é˜…è¯»æœ¬æ–‡æ¡£âš¡\n2. é¡µé¢æ˜¾ç¤ºé—®é¢˜ğŸ’¥ï¼Œè¯·æä¾›æ§åˆ¶å°æˆªå›¾ğŸ“¸æˆ–è€…æ‚¨çš„æµ‹è¯•ç½‘å€\n3. å…¶ä»–ä»»ä½•æŠ¥é”™ğŸ’£ï¼Œè¯·æä¾›è¯¦ç»†æè¿°å’Œæˆªå›¾ğŸ“¸ï¼Œç¥é£Ÿç”¨æ„‰å¿«ğŸ’ª"

# è°ˆè°ˆä½ å¯¹è®¾è®¡æ¨¡å¼çš„ç†è§£

1.é¦–å…ˆè°ˆè®¾è®¡æ¨¡å¼çš„ä½œç”¨ï¼šç»éªŒçš„ä¼ æ‰¿ï¼Œæé«˜äº†è½¯ä»¶å¤ç”¨çš„æ°´å¹³ï¼Œæœ€ç»ˆè¾¾åˆ°æé«˜è½¯ä»¶å¼€å‘æ•ˆç‡

**äº”å¤§åŸåˆ™**

| è®¾è®¡åŸåˆ™                    | ç®€å•è¯´æ˜                                                     |
| --------------------------- | :----------------------------------------------------------- |
| å•ä¸€èŒè´£                    | ä¸€ä¸ªç±»åªè´Ÿè´£ä¸€é¡¹èŒè´£                                         |
| é‡Œæ°æ›¿æ¢åŸåˆ™                | å­ç±»å¯ä»¥æ‰©å±•çˆ¶ç±»çš„åŠŸèƒ½ï¼Œä½†ä¸èƒ½æ”¹å˜çˆ¶ç±»åŸæœ‰çš„åŠŸèƒ½             |
| ä¾èµ–å€’ç½®åŸåˆ™                | è¦ä¾èµ–äºæŠ½è±¡ï¼Œä¸è¦ä¾èµ–äºå…·ä½“ï¼Œæ ¸å¿ƒæ€æƒ³æ˜¯**é¢å‘æ¥å£ç¼–ç¨‹**     |
| æ¥å£éš”ç¦»åŸåˆ™                | å»ºç«‹å•ä¸€æ¥å£ï¼Œä¸è¦å»ºç«‹åºå¤§è‡ƒè‚¿çš„æ¥å£ï¼Œå°½é‡ç»†åŒ–æ¥å£ï¼Œæ¥å£ä¸­çš„æ–¹æ³•å°½é‡å°‘ |
| è¿ªç±³ç‰¹æ³•åˆ™ ï¼ˆæœ€å°‘çŸ¥é“åŸåˆ™ï¼‰ | ä¸€ä¸ªå¯¹è±¡åº”è¯¥å¯¹å…¶ä»–å¯¹è±¡ä¿æŒæœ€å°‘çš„äº†è§£                         |
| å¼€é—­åŸåˆ™                    | å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­                                       |

2.è®¾è®¡æ¨¡å¼çš„åˆ†ç±»

![image.png](DesignMode/2014caaf469649d1a3c84a582ef7319b.png)

3.åˆ›å»ºå‹æ¨¡å¼ï¼šéƒ½æ˜¯ç”¨æ¥å¸®åŠ©æˆ‘ä»¬åˆ›å»ºå¯¹è±¡çš„ï¼

![image.png](DesignMode/c6b87746e9884c22b56ca99bc265c496.png)

4.ç»“æ„æ€§æ¨¡å¼:å…³æ³¨å¯¹è±¡å’Œç±»çš„ç»„ç»‡

![image.png](DesignMode/6b8dffa88b924af6ba3664386d6a9f0a.png)

5.è¡Œä¸ºå‹æ¨¡å¼:å…³æ³¨ç³»ç»Ÿä¸­å¯¹è±¡ä¹‹é—´çš„ç›¸äº’äº¤æ¢ï¼Œç ”ç©¶ç³»ç»Ÿåœ¨è¿è¡Œæ—¶å¯¹è±¡ä¹‹é—´çš„ç›¸äº’é€šä¿¡å’Œåä½œï¼Œè¿›ä¸€æ­¥æ˜ç¡®å¯¹è±¡çš„èŒè´£ï¼Œå…±æœ‰11ä¸­æ¨¡å¼

![image.png](DesignMode/9bfe35ab4a494cc4ae84a20ee9e30a5c.png)



# ä¸€ã€åˆ›å»ºå‹æ¨¡å¼



## 1.å•ä¾‹æ¨¡å¼

ä½œç”¨ï¼šå•ä¾‹æ¨¡å¼çš„æ ¸å¿ƒæ˜¯**ä¿è¯ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶ä¸”æä¾›ä¸€ä¸ªè®¿é—®å®ä¾‹çš„å…¨å±€è®¿é—®ç‚¹ã€‚**

| å®ç°æ–¹å¼     | ä¼˜ç¼ºç‚¹                                  |
| ------------ | :-------------------------------------- |
| é¥¿æ±‰å¼       | çº¿ç¨‹å®‰å…¨ï¼Œè°ƒç”¨æ•ˆç‡é«˜ ï¼Œä½†æ˜¯ä¸èƒ½å»¶è¿ŸåŠ è½½ |
| æ‡’æ±‰å¼       | çº¿ç¨‹å®‰å…¨ï¼Œè°ƒç”¨æ•ˆç‡ä¸é«˜ï¼Œèƒ½å»¶è¿ŸåŠ è½½      |
| åŒé‡æ£€æµ‹é”å¼ | åœ¨æ‡’æ±‰å¼çš„åŸºç¡€ä¸Šè§£å†³å¹¶å‘é—®é¢˜            |
| é™æ€å†…éƒ¨ç±»å¼ | çº¿ç¨‹å®‰å…¨ï¼Œèµ„æºåˆ©ç”¨ç‡é«˜ï¼Œå¯ä»¥å»¶æ—¶åŠ è½½    |
| æšä¸¾å•ä¾‹     | çº¿ç¨‹å®‰å…¨ï¼Œè°ƒç”¨æ•ˆç‡é«˜ï¼Œä½†æ˜¯ä¸èƒ½å»¶è¿ŸåŠ è½½  |

### é¥¿æ±‰å¼

ä¹Ÿå°±æ˜¯ç±»åŠ è½½çš„æ—¶å€™ç«‹å³å®ä¾‹åŒ–å¯¹è±¡ï¼Œå®ç°çš„æ­¥éª¤æ˜¯å…ˆç§æœ‰åŒ–æ„é€ æ–¹æ³•ï¼Œå¯¹å¤–æä¾›å”¯ä¸€çš„é™æ€å…¥å£æ–¹æ³•ï¼Œå®ç°å¦‚ä¸‹

```java
/**
 * å•ä¾‹æ¨¡å¼ï¼šé¥¿æ±‰å¼
 *
 */
public class SingletonInstance1 {
	// å£°æ˜æ­¤ç±»å‹çš„å˜é‡ï¼Œå¹¶å®ä¾‹åŒ–ï¼Œå½“è¯¥ç±»è¢«åŠ è½½çš„æ—¶å€™å°±å®Œæˆäº†å®ä¾‹åŒ–å¹¶ä¿å­˜åœ¨äº†å†…å­˜ä¸­
	private final static SingletonInstance1 instance = new SingletonInstance1();

	// ç§æœ‰åŒ–æ‰€æœ‰çš„æ„é€ æ–¹æ³•,é˜²æ­¢ç›´æ¥é€šè¿‡newå…³é”®å­—å®ä¾‹åŒ–
	private SingletonInstance1(){}
	// å¯¹å¤–æä¾›ä¸€ä¸ªè·å–å®ä¾‹çš„é™æ€æ–¹æ³•
	public static SingletonInstance1 getInstance(){
		return instance;
	}
}

```

é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼ä»£ç ä¸­ï¼Œstaticå˜é‡ä¼šåœ¨ç±»è£…è½½æ—¶åˆå§‹åŒ–ï¼Œæ­¤æ—¶ä¹Ÿä¸ä¼šæ¶‰åŠå¤šä¸ªçº¿ç¨‹å¯¹è±¡è®¿é—®è¯¥å¯¹è±¡çš„é—®é¢˜ã€‚è™šæ‹Ÿæœºä¿è¯åªä¼šè£…è½½ä¸€æ¬¡è¯¥ç±»ï¼Œè‚¯å®šä¸ä¼šå‘ç”Ÿå¹¶å‘è®¿é—®çš„é—®é¢˜ã€‚å› æ­¤ï¼Œå¯ä»¥çœç•¥synchronizedå…³é”®å­—

é—®é¢˜ï¼šå¦‚æœåªæ˜¯åŠ è½½æœ¬ç±»ï¼Œè€Œä¸æ˜¯è¦è°ƒç”¨getInstance()ï¼Œç”šè‡³æ°¸è¿œæ²¡æœ‰è°ƒç”¨ï¼Œåˆ™ä¼šé€ æˆèµ„æºæµªè´¹ï¼

```java
/**
 * å•ä¾‹æ¨¡å¼ï¼šé¥¿æ±‰å¼
 *
 */
public class SingletonInstance1 {
    private byte[] b1 = new byte[1024*1024];
    private byte[] b2 = new byte[1024*1024];
    private byte[] b3 = new byte[1024*1024];
	// å£°æ˜æ­¤ç±»å‹çš„å˜é‡ï¼Œå¹¶å®ä¾‹åŒ–ï¼Œå½“è¯¥ç±»è¢«åŠ è½½çš„æ—¶å€™å°±å®Œæˆäº†å®ä¾‹åŒ–å¹¶ä¿å­˜åœ¨äº†å†…å­˜ä¸­
	private final static SingletonInstance1 instance = new SingletonInstance1();

	// ç§æœ‰åŒ–æ‰€æœ‰çš„æ„é€ æ–¹æ³•,é˜²æ­¢ç›´æ¥é€šè¿‡newå…³é”®å­—å®ä¾‹åŒ–
	private SingletonInstance1(){}
	// å¯¹å¤–æä¾›ä¸€ä¸ªè·å–å®ä¾‹çš„é™æ€æ–¹æ³•
	public static SingletonInstance1 getInstance(){
		return instance;
	}
}
```

### æ‡’æ±‰å¼

```java
/**
 * å•ä¾‹æ¨¡å¼ï¼šæ‡’æ±‰å¼
 *
 */
public class SingletonInstance2 {
	// å£°æ˜æ­¤ç±»å‹çš„å˜é‡,ä½†æ²¡æœ‰å®ä¾‹åŒ–
	private static SingletonInstance2 instance = null;

	// ç§æœ‰åŒ–æ‰€æœ‰çš„æ„é€ æ–¹æ³•,é˜²æ­¢ç›´æ¥é€šè¿‡newå…³é”®å­—å®ä¾‹åŒ–
	private SingletonInstance2(){}
	// å¯¹å¤–æä¾›ä¸€ä¸ªè·å–å®ä¾‹çš„é™æ€æ–¹æ³•ï¼Œä¸ºäº†æ•°æ®å®‰å…¨æ·»åŠ synchronizedå…³é”®å­—
	public static synchronized SingletonInstance2 getInstance(){
		if(instance == null){
			// å½“instanceä¸ä¸ºç©ºçš„æ—¶å€™æ‰å®ä¾‹åŒ–
			instance = new SingletonInstance2();
		}
		return instance;
	}
}

```

&emsp;&emsp;æ­¤ç§æ–¹å¼åœ¨ç±»åŠ è½½åå¦‚æœæˆ‘ä»¬ä¸€ç›´æ²¡æœ‰è°ƒç”¨getInstanceæ–¹æ³•ï¼Œé‚£ä¹ˆå°±ä¸ä¼šå®ä¾‹åŒ–å¯¹è±¡ã€‚å®ç°äº†å»¶è¿ŸåŠ è½½ï¼Œä½†æ˜¯å› ä¸ºåœ¨æ–¹æ³•ä¸Šæ·»åŠ äº†synchronizedå…³é”®å­—ï¼Œæ¯æ¬¡è°ƒç”¨getInstanceæ–¹æ³•éƒ½ä¼šåŒæ­¥ï¼Œæ‰€ä»¥å¯¹æ€§èƒ½çš„å½±å“æ¯”è¾ƒå¤§ã€‚

### åŒé‡æ£€æµ‹é”

```java
/**
 * å•ä¾‹æ¨¡å¼ï¼šæ‡’æ±‰å¼
 * åŒé‡æ£€æµ‹æœºåˆ¶
 *
 */
public class SingletonInstance3 {
	// å£°æ˜æ­¤ç±»å‹çš„å˜é‡,ä½†æ²¡æœ‰å®ä¾‹åŒ–
	private static volatile  SingletonInstance3 instance = null;

	// ç§æœ‰åŒ–æ‰€æœ‰çš„æ„é€ æ–¹æ³•,é˜²æ­¢ç›´æ¥é€šè¿‡newå…³é”®å­—å®ä¾‹åŒ–
	private SingletonInstance3(){}
	// å¯¹å¤–æä¾›ä¸€ä¸ªè·å–å®ä¾‹çš„é™æ€æ–¹æ³•ï¼Œ
	public static  SingletonInstance3 getInstance(){
		if(instance == null){
			synchronized(SingletonInstance3.class){
				if(instance == null){
                    // 1.åˆ†é…å†…å­˜ç©ºé—´  2. æ‰§è¡Œæ„é€ æ–¹æ³•ï¼Œå®ä¾‹åŒ–å¯¹è±¡ 3.æŠŠè¿™ä¸ªå¯¹è±¡èµ‹å€¼ç»™è¿™ä¸ªç©ºé—´
                    // å¦‚æœä¸åŠ volatile ä¼šæ‰§è¡Œé‡æ’åº 1 3 2 
					instance = new SingletonInstance3();
				}
			}
		}
		return instance;
	}
}

```

ä¸åŠ volatileæœ‰æŒ‡ä»¤é‡æ’åºçš„é—®é¢˜ã€‚æ·»åŠ åå¯ä»¥è§£å†³ã€‚

### é™æ€å†…éƒ¨ç±»

```java
/**
 * é™æ€å†…éƒ¨ç±»å®ç°æ–¹å¼
 *
 */
public class SingletonInstance4 {
	// é™æ€å†…éƒ¨ç±»
	public static class SingletonClassInstance{
		// å£°æ˜å¤–éƒ¨ç±»å‹çš„é™æ€å¸¸é‡
		public static final SingletonInstance4 instance = new SingletonInstance4();
	}
	// ç§æœ‰åŒ–æ„é€ æ–¹æ³•
	private SingletonInstance4(){}

	// å¯¹å¤–æä¾›çš„å”¯ä¸€è·å–å®ä¾‹çš„æ–¹æ³•
	public static SingletonInstance4 getInstance(){
		return SingletonClassInstance.instance;
	}
}

```

### æšä¸¾å•ä¾‹

```java
/**
 * å•ä¾‹æ¨¡å¼ï¼šæšä¸¾æ–¹å¼å®ç°
 *
 */
public enum SingletonInstance5 {

	// å®šä¹‰ä¸€ä¸ªæšä¸¾å…ƒç´ ï¼Œåˆ™è¿™ä¸ªå…ƒç´ å°±ä»£è¡¨äº†SingletonInstance5çš„å®ä¾‹
	INSTANCE;

	public void singletonOperation(){
		// åŠŸèƒ½å¤„ç†
	}
}

```

## 2.æ€ä¹ˆè§£å†³åå°„çˆ†ç ´å•ä¾‹

&emsp;&emsp;åœ¨å•ä¾‹ä¸­æˆ‘ä»¬å®šä¹‰çš„ç§æœ‰çš„æ„é€ å™¨ï¼Œä½†æ˜¯æˆ‘ä»¬çŸ¥é“åå°„æ˜¯å¯ä»¥æ“ä½œç§æœ‰çš„å±æ€§å’Œæ–¹æ³•çš„ï¼Œè¿™æ—¶æˆ‘ä»¬åº”è¯¥æ€ä¹ˆå¤„ç†ï¼Ÿ

```java
public static void main(String[] args) throws Exception, IllegalAccessException {
	SingletonInstance1 s1 = SingletonInstance1.getInstance();
	// åå°„æ–¹å¼è·å–å®ä¾‹
	Class c1 = SingletonInstance1.class;
	Constructor constructor = c1.getDeclaredConstructor(null);
	constructor.setAccessible(true);
	SingletonInstance1 s2 = (SingletonInstance1)constructor.newInstance(null);
	System.out.println(s1);
	System.out.println(s2);
}

```

è¾“å‡ºç»“æœ

```txt
com.dpb.single.SingletonInstance1@15db9742
com.dpb.single.SingletonInstance1@6d06d69c

```

äº§ç”Ÿäº†ä¸¤ä¸ªå¯¹è±¡ï¼Œå’Œå•ä¾‹çš„è®¾è®¡åˆè¡·è¿èƒŒäº†ã€‚
è§£å†³çš„æ–¹å¼æ˜¯åœ¨æ— å‚æ„é€ æ–¹æ³•ä¸­æ‰‹åŠ¨æŠ›å‡ºå¼‚å¸¸æ§åˆ¶,æˆ–è€…å£°æ˜ä¸€ä¸ªå…¨å±€å˜é‡æ¥æ§åˆ¶ã€‚

```java
// ç§æœ‰åŒ–æ‰€æœ‰çš„æ„é€ æ–¹æ³•,é˜²æ­¢ç›´æ¥é€šè¿‡newå…³é”®å­—å®ä¾‹åŒ–
private SingletonInstance2(){
	if(instance != null){
		// åªèƒ½æœ‰ä¸€ä¸ªå®ä¾‹å­˜åœ¨ï¼Œå¦‚æœå†æ¬¡è°ƒç”¨è¯¥æ„é€ æ–¹æ³•å°±æŠ›å‡ºå¼‚å¸¸ï¼Œé˜²æ­¢åå°„æ–¹å¼å®ä¾‹åŒ–
		throw new RuntimeException("å•ä¾‹æ¨¡å¼åªèƒ½åˆ›å»ºä¸€ä¸ªå¯¹è±¡");
	}
}

```

ä¸Šé¢è¿™ç§æ–¹å¼æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ååºåˆ—åŒ–çš„æ–¹å¼æ¥ç ´è§£

```java
public static void main(String[] args) throws Exception, IllegalAccessException {
	SingletonInstance2 s1 = SingletonInstance2.getInstance();
	// å°†å®ä¾‹å¯¹è±¡åºåˆ—åŒ–åˆ°æ–‡ä»¶ä¸­
	ObjectOutputStream oos = new ObjectOutputStream(
			new FileOutputStream("c:/tools/a.txt"));
	oos.writeObject(s1);
	oos.flush();
	oos.close();
	// å°†å®ä¾‹ä»æ–‡ä»¶ä¸­ååºåˆ—åŒ–å‡ºæ¥
	ObjectInputStream ois = new ObjectInputStream(
			new FileInputStream("c:/tools/a.txt"));
	SingletonInstance2 s2 = (SingletonInstance2) ois.readObject();
	ois.close();
	System.out.println(s1);
	System.out.println(s2);
}

```

æˆ‘ä»¬åªéœ€è¦åœ¨å•ä¾‹ç±»ä¸­é‡å†™readResolveæ–¹æ³•å¹¶åœ¨è¯¥æ–¹æ³•ä¸­è¿”å›å•ä¾‹å¯¹è±¡å³å¯ï¼Œå¦‚ä¸‹:

```java
package com.dpb.single;

import java.io.ObjectStreamException;
import java.io.Serializable;

/**
 * å•ä¾‹æ¨¡å¼ï¼šæ‡’æ±‰å¼
 *
 */
public class SingletonInstance2 implements Serializable{

	// å£°æ˜æ­¤ç±»å‹çš„å˜é‡,ä½†æ²¡æœ‰å®ä¾‹åŒ–
	private static SingletonInstance2 instance = null;

	// ç§æœ‰åŒ–æ‰€æœ‰çš„æ„é€ æ–¹æ³•,é˜²æ­¢ç›´æ¥é€šè¿‡newå…³é”®å­—å®ä¾‹åŒ–
	private SingletonInstance2(){
		if(instance != null){
			// åªèƒ½æœ‰ä¸€ä¸ªå®ä¾‹å­˜åœ¨ï¼Œå¦‚æœå†æ¬¡è°ƒç”¨è¯¥æ„é€ æ–¹æ³•å°±æŠ›å‡ºå¼‚å¸¸ï¼Œé˜²æ­¢åå°„æ–¹å¼å®ä¾‹åŒ–
			throw new RuntimeException("å•ä¾‹æ¨¡å¼åªèƒ½åˆ›å»ºä¸€ä¸ªå¯¹è±¡");
		}
	}
	// å¯¹å¤–æä¾›ä¸€ä¸ªè·å–å®ä¾‹çš„é™æ€æ–¹æ³•ï¼Œä¸ºäº†æ•°æ®å®‰å…¨æ·»åŠ synchronizedå…³é”®å­—
	public static synchronized SingletonInstance2 getInstance(){
		if(instance == null){
			// å½“instanceä¸ä¸ºç©ºçš„æ—¶å€™æ‰å®ä¾‹åŒ–
			instance = new SingletonInstance2();
		}
		return instance;
	}
	// é‡å†™è¯¥æ–¹æ³•ï¼Œé˜²æ­¢åºåˆ—åŒ–å’Œååºåˆ—åŒ–è·å–å®ä¾‹
	private Object readResolve() throws ObjectStreamException{
		return instance;
	}
}

```

è¯´æ˜:readResolveæ–¹æ³•æ˜¯åŸºäºå›è°ƒçš„ï¼Œååºåˆ—åŒ–æ—¶ï¼Œå¦‚æœå®šä¹‰äº†readResolve()åˆ™ç›´æ¥è¿”å›æ­¤æ–¹æ³•æŒ‡å®šçš„å¯¹è±¡ï¼Œè€Œä¸éœ€è¦åœ¨åˆ›å»ºæ–°çš„å¯¹è±¡ï¼

## 3.è¯´è¯´ä½ åœ¨å“ªäº›æ¡†æ¶ä¸­çœ‹åˆ°äº†å•ä¾‹çš„è®¾è®¡

1.Springä¸­çš„Beanå¯¹è±¡ï¼Œé»˜è®¤æ˜¯å•ä¾‹æ¨¡å¼

2.ç›¸å…³çš„å·¥å‚å¯¹è±¡éƒ½æ˜¯å•ä¾‹ï¼Œæ¯”å¦‚ï¼šMyBatisä¸­çš„SqlSessionFactoryï¼ŒSpringä¸­çš„BeanFactory

3.ä¿å­˜ç›¸å…³é…ç½®ä¿¡æ¯çš„éƒ½æ˜¯å•ä¾‹ï¼Œæ¯”å¦‚ï¼šMyBatisä¸­çš„Configurationå¯¹è±¡ï¼ŒSpringBootä¸­çš„å„ä¸ªXXXAutoConfigurationå¯¹è±¡ç­‰

4.åº”ç”¨ç¨‹åºçš„æ—¥å¿—åº”ç”¨ï¼Œä¸€èˆ¬éƒ½ä¼šé€šè¿‡å•ä¾‹æ¥å®ç°

5.æ•°æ®åº“è¿æ¥æ± çš„è®¾è®¡ä¹Ÿæ˜¯å•ä¾‹æ¨¡å¼

## 4.å·¥å‚æ¨¡å¼

&emsp;&emsp;å·¥å‚æ¨¡å¼çš„ä½œç”¨æ˜¯å¸®åŠ©æˆ‘ä»¬åˆ›å»ºå¯¹è±¡ï¼Œæˆ‘ä»¬ä¸ç”¨è‡ªå·±æ¥åˆ›å»ºï¼Œæ ¹æ®éœ€è¦åˆ›å»ºçš„å¯¹è±¡çš„å¤æ‚åº¦æˆ‘ä»¬å¯ä»¥æŠŠå·¥å‚æ¨¡å¼åˆ†ä¸ºç®€å•å·¥å‚ï¼Œå·¥å‚æ–¹æ³•å’ŒæŠ½è±¡å·¥å‚ã€‚

![image.png](DesignMode/95f501de57d3451faf9228414dc6f75f.png)

### 4.1 ç®€å•å·¥å‚

&emsp;&emsp;ç®€å•å·¥å‚æ¨¡å¼åˆç§°ä¸ºé™æ€å·¥å‚æ–¹æ³•ï¼Œä»–å¯ä»¥æ ¹æ®ä¸åŒçš„å‚æ•°è€Œè¿”å›ä¸åŒçš„å®ä¾‹ï¼Œç®€å•å·¥å‚æ¨¡å¼ä¸“é—¨å®šä¹‰ä¸€ä¸ªç±»æ¥è´Ÿè´£åˆ›å»ºå…¶ä»–ç±»çš„å®ä¾‹ï¼Œè¢«åˆ›å»ºçš„å®ä¾‹é€šå¸¸éƒ½å…·æœ‰å…±åŒçš„çˆ¶ç±»ã€‚

JDKä¸­çš„ç®€å•å·¥å‚åº”ç”¨ï¼šDataFormat

![image.png](DesignMode/4fdddcfbf8784080a3706158f6945e9a.png)

è‡ªå·±å†™ä¸€ä¸ªç®€å•å·¥å‚çš„æ¡ˆä¾‹

![image.png](DesignMode/de2237eb14fe491fbd38c5a815fa7c27.png)

```java
/**
 * ç®€å•å·¥å‚
 */
public class SimpleFactory {

    public static void main(String[] args) {
        // æ ¹æ®å¯¹åº”çš„ç±»å‹è¿”å›ç›¸å…³äº§å“
        CarFactory.createCar("å¥¥è¿ª").run();
        CarFactory.createCar("Byd").run();
    }
}

// å®šä¹‰å…¬å…±çš„æ¥å£
interface Car{
    void run();
}

class Audi implements Car{
    @Override
    public void run() {
        System.out.println("å¥¥è¿ªåœ¨è·‘...");
    }
}

class Byd implements Car{
    @Override
    public void run() {
        System.out.println("Bydåœ¨è·‘...");
    }
}

// åˆ›å»ºå¯¹åº”çš„ç®€å•å·¥å‚ç±»
class CarFactory{
    public static Car createCar(String type){
        if("å¥¥è¿ª".equals(type)){
            return new Audi();
        }else if("Byd".equals(type)){
            return new Byd();
        }else{
            throw new RuntimeException("è¯¥äº§å“ä¸èƒ½ç”Ÿäº§");
        }
    }
}
```

æˆ‘ä»¬å¯ä»¥å‘ç°ç®€å•å·¥å‚å¯¹äºæ–°å¢äº§å“æ˜¯æ— èƒ½ä¸ºåŠ›çš„ï¼ä¸ä¿®æ”¹åŸæœ‰ä»£ç æ ¹æœ¬å°±æ²¡åŠæ³•æ‰©å±•!!!

### 4.2 å·¥å‚æ–¹æ³•

&emsp;&emsp;é’ˆå¯¹äºç®€å•å·¥å‚çš„çŸ­æ¿ï¼Œå¼•å‡ºäº†å·¥å‚æ–¹æ³•æ¨¡å¼ï¼Œå®šä¹‰ä¸€ä¸ªç”¨æˆ·åˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œè®©å­ç±»å†³å®šå®ä¾‹åŒ–å“ªä¸ªç±»ï¼Œå·¥å‚æ–¹æ³•ä½¿ä¸€ä¸ªç±»çš„å®ä¾‹åŒ–å»¶è¿Ÿåˆ°äº†å…¶å­ç±»ä¸­ã€‚

![image.png](DesignMode/cedbded5fc4543eb80dd3663bbe814c7.png)

ä»£ç å®ç°ï¼š

```java
/**
 * å·¥å‚æ–¹æ³•æ¨¡å¼
 */
public class FactoryMethod {

    public static void main(String[] args) {
        new AudiCarFactory().createCar().run();
        new BydCarFactory().createCar().run();
    }


    public static interface  Car{
        public void run();
    }

    public static class Byd implements Car{
        @Override
        public void run() {
            System.out.println("æ¯”äºšè¿ª...");
        }
    }

    public static class Audi implements Car{
        @Override
        public void run() {
            System.out.println("å¥¥è¿ª...");
        }
    }

    public static interface CarFactory{
        public Car createCar();
    }

    // æ‰©å±•çš„å·¥å‚
    public static class AudiCarFactory implements CarFactory{
        @Override
        public Car createCar() {
            return new Audi();
        }
    }

    public static class BydCarFactory implements CarFactory{
        @Override
        public Car createCar() {
            return new Byd();
        }
    }
}
```

ç®€å•å·¥å‚å’Œå·¥å‚æ–¹æ³•æ¨¡å¼çš„å¯¹æ¯”

1. ç®€å•å·¥å‚åªæœ‰ä¸€ä¸ªå·¥å‚ï¼Œè€Œå·¥å‚æ–¹æ³•æœ‰å¤šä¸ªå·¥å‚
2. ç®€å•å·¥å‚ä¸æ”¯æŒæ‰©å±•ï¼Œè€Œå·¥å‚æ–¹æ³•æ”¯æŒæ‰©å±•ï¼Œæ‰©å±•çš„æ–¹å¼å°±æ˜¯æ·»åŠ å¯¹åº”çš„å·¥å‚ç±»å³å¯
3. ç®€å•å·¥å‚ä»£ç å¤æ‚åº¦ä½ï¼Œå·¥å‚æ–¹æ³•ä»£ç å¤æ‚åº¦é«˜
4. ...

### 4.3 æŠ½è±¡å·¥å‚

&emsp;&emsp;ä¸Šé¢çš„ä¸¤ç§æ–¹å¼å®ç°çš„å·¥å‚éƒ½æ˜¯ç”Ÿäº§åŒä¸€å¤§ç±»çš„äº§å“ï¼Œå¦‚æœè¦å®ç°ç”Ÿäº§ä¸åŒç±»å‹çš„äº§å“è¿™æ—¶æˆ‘ä»¬å°±å¯ä»¥ç”¨æŠ½è±¡å·¥å‚æ¨¡å¼æ¥å®ç°ã€‚

![image.png](DesignMode/185ba2bc37394c47ae8f62390d019829.png)

ä»£ç å®ç°ï¼š

```java
/**
 * æŠ½è±¡å·¥å‚ï¼šå¤šä¸ªäº§å“æ—
 */
public class AbstractFactory {

    public static void main(String[] args) {
        Car car = new LuxuryEngineCarFacory().createCar();
        Engine engine = new LuxuryEngineCarFacory().createEngine();
        car.run();
        engine.run();
    }

    // æŠ½è±¡å·¥å‚
    public static interface AbstarctComponentFactory{
        Car createCar();
        Engine createEngine();
    }

    public static class LuxuryEngineCarFacory implements AbstarctComponentFactory{
        @Override
        public Engine createEngine() {
            return new LuxuryEngineFactory().createEngine();
        }

        @Override
        public Car createCar() {
            return new BydCarFactory().createCar();
        }
    }

    public static class LowEngineCarFacory implements AbstarctComponentFactory{
        @Override
        public Car createCar() {
            return new AudiCarFactory().createCar();
        }

        @Override
        public Engine createEngine() {
            return new LowEngineFactory().createEngine();
        }
    }

    // æ±½è½¦äº§å“æ—
    public static interface  Car{
        public void run();
    }

    public static class Byd implements Car {
        @Override
        public void run() {
            System.out.println("æ¯”äºšè¿ª...");
        }
    }

    public static class Audi implements Car {
        @Override
        public void run() {
            System.out.println("å¥¥è¿ª...");
        }
    }

    public static interface CarFactory{
        public Car createCar();
    }

    // æ‰©å±•çš„å·¥å‚
    public static class AudiCarFactory implements CarFactory {
        @Override
        public Car createCar() {
            return new Audi();
        }
    }

    public static class BydCarFactory implements  CarFactory{
        @Override
        public Car createCar() {
            return new Byd();
        }
    }

    // å‘åŠ¨æœºäº§å“æ—
    public static interface Engine{
        public void run();
    }

    public static class LuxuryEngine implements Engine{
        @Override
        public void run() {
            System.out.println("è±ªåç‰ˆå‘åŠ¨æœº...");
        }
    }

    public static class LowEngine implements Engine{
        @Override
        public void run() {
            System.out.println("ä½é…ç‰ˆå‘åŠ¨æœº...");
        }
    }

    public static interface EngineFactory{
        public Engine createEngine();
    }

    public static class LuxuryEngineFactory implements EngineFactory{
        @Override
        public Engine createEngine() {
            return new LuxuryEngine();
        }
    }

    public static class LowEngineFactory implements EngineFactory{
        @Override
        public Engine createEngine() {
            return new LowEngine();
        }
    }
}

```

ä¸‰è€…çš„å¯¹æ¯”ï¼š

1. ç®€å•å·¥å‚æ¨¡å¼(é™æ€å·¥å‚æ¨¡å¼) ï¼šè™½ç„¶æŸç§ç¨‹åº¦ä¸ç¬¦åˆè®¾è®¡åŸåˆ™ï¼Œä½†å®é™…ä½¿ç”¨æœ€å¤šã€‚
2. å·¥å‚æ–¹æ³•æ¨¡å¼ï¼šä¸ä¿®æ”¹å·²æœ‰ç±»çš„å‰æä¸‹ï¼Œé€šè¿‡å¢åŠ æ–°çš„å·¥å‚ç±»å®ç°æ‰©å±•ã€‚
3. æŠ½è±¡å·¥å‚æ¨¡å¼ï¼šä¸å¯ä»¥å¢åŠ äº§å“ï¼Œå¯ä»¥å¢åŠ äº§å“æ—ï¼

## 5.å»ºé€ è€…æ¨¡å¼

&emsp;&emsp;å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬æ‰€éœ€è¦çš„å¯¹è±¡æ„å»ºæ—¶éå¸¸å¤æ‚ï¼Œä¸”æœ‰å¾ˆå¤šæ­¥éª¤éœ€è¦å¤„ç†æ—¶ï¼Œè¿™æ—¶å»ºé€ è€…æ¨¡å¼å°±å¾ˆé€‚åˆã€‚æ¯”å¦‚MyBatisä¸­çš„SqlSessionFactoryå¯¹è±¡çš„åˆ›å»ºï¼Œæˆ‘ä»¬ä¸å…‰è¦åˆ›å»ºSqlSessionFactoryæœ¬èº«çš„å¯¹è±¡ï¼Œè¿˜æœ‰å®ŒæˆMyBatisçš„å…¨å±€é…ç½®æ–‡ä»¶å’Œæ˜ å°„æ–‡ä»¶çš„åŠ è½½è§£ææ“ä½œï¼Œä¹‹åæŠŠè§£æå‡ºæ¥çš„ä¿¡æ¯ç»‘å®šåœ¨SqlSessionFactoryå¯¹è±¡ä¸­ï¼Œ

![image.png](DesignMode/21221aa599f9428083bc92d81ac151d2.png)

ç›´æ¥å‚è€ƒMyBatisçš„ä»£ç å³å¯

![image.png](DesignMode/6d7aec1477204d9397cf5b59a1f2ad65.png)

æ‰€ä»¥å»ºé€ è€…æ¨¡å¼çš„ä½œç”¨å°±æ˜¯å¸®åŠ©æˆ‘ä»¬è§£å†³äº†å¤æ‚å¯¹è±¡çš„åˆ›å»º



å»ºé€ è€…æ¨¡å¼å’Œå·¥å‚æ¨¡å¼çš„åŒºåˆ«ï¼š

* å…³æ³¨çš„ç»´åº¦æ˜¯ä¸ä¸€æ ·çš„
* å·¥å‚æ¨¡å¼åˆ›å»ºå¯¹è±¡ new å‡ºæ¥
* å»ºé€ è€…æ¨¡å¼å…³æ³¨çš„æ˜¯å¯¹è±¡åˆ›å»ºçš„æœ¬èº«



## 6.åŸå‹æ¨¡å¼

&emsp;&emsp;åœ¨javaä¸­æˆ‘ä»¬çŸ¥é“é€šè¿‡newå…³é”®å­—åˆ›å»ºçš„å¯¹è±¡æ˜¯éå¸¸ç¹ççš„(ç±»åŠ è½½åˆ¤æ–­ï¼Œå†…å­˜åˆ†é…ï¼Œåˆå§‹åŒ–ç­‰)ï¼Œåœ¨æˆ‘ä»¬éœ€è¦å¤§é‡å¯¹è±¡çš„æƒ…å†µä¸‹ï¼ŒåŸå‹æ¨¡å¼å°±æ˜¯æˆ‘ä»¬å¯ä»¥è€ƒè™‘å®ç°çš„æ–¹å¼ã€‚
&emsp;&emsp;åŸå‹æ¨¡å¼æˆ‘ä»¬ä¹Ÿç§°ä¸ºå…‹éš†æ¨¡å¼ï¼Œå³ä¸€ä¸ªæŸä¸ªå¯¹è±¡ä¸ºåŸå‹å…‹éš†å‡ºæ¥ä¸€ä¸ªä¸€æ¨¡ä¸€æ ·çš„å¯¹è±¡ï¼Œè¯¥å¯¹è±¡çš„å±æ€§å’ŒåŸå‹å¯¹è±¡ä¸€æ¨¡ä¸€æ ·ã€‚è€Œä¸”å¯¹äºåŸå‹å¯¹è±¡æ²¡æœ‰ä»»ä½•å½±å“ã€‚åŸå‹æ¨¡å¼çš„å…‹éš†æ–¹å¼æœ‰ä¸¤ç§ï¼šæµ…å…‹éš†å’Œæ·±åº¦å…‹éš†.

| åŸå‹æ¨¡å¼ | è¯´æ˜                                                         |
| -------- | :----------------------------------------------------------- |
| æµ…å…‹éš†   | åªæ˜¯æ‹·è´æœ¬å¯¹è±¡,å…¶å¯¹è±¡å†…éƒ¨çš„æ•°ç»„ã€å¼•ç”¨å¯¹è±¡ç­‰éƒ½ä¸æ‹·è´ï¼Œ``è¿˜æ˜¯æŒ‡å‘åŸç”Ÿå¯¹è±¡çš„å†…éƒ¨å…ƒç´ åœ°å€ |
| æ·±åº¦å…‹éš† | æ·±å¤åˆ¶æŠŠè¦å¤åˆ¶çš„å¯¹è±¡æ‰€å¼•ç”¨çš„å¯¹è±¡éƒ½å¤åˆ¶äº†ä¸€é                 |

### 6.1 æµ…å…‹éš†

&emsp;&emsp;è¢«å¤åˆ¶å¯¹è±¡çš„æ‰€æœ‰å˜é‡éƒ½å«æœ‰ä¸åŸæ¥çš„å¯¹è±¡ç›¸åŒçš„å€¼ï¼Œè€Œæ‰€æœ‰çš„å¯¹å…¶ä»–å¯¹è±¡çš„å¼•ç”¨ä»ç„¶æŒ‡å‘åŸæ¥çš„å¯¹è±¡ã€‚æ¢è¨€ä¹‹ï¼Œæµ…å¤åˆ¶ä»…ä»…å¤åˆ¶æ‰€è€ƒè™‘çš„å¯¹è±¡ï¼Œè€Œä¸å¤åˆ¶å®ƒæ‰€å¼•ç”¨çš„å¯¹è±¡ã€‚ Objectç±»æä¾›çš„æ–¹æ³•clone=åªæ˜¯æ‹·è´æœ¬å¯¹è±¡= ï¼Œ =å…¶å¯¹è±¡å†…éƒ¨çš„æ•°ç»„ã€å¼•ç”¨å¯¹è±¡ç­‰éƒ½ä¸æ‹·è´= ï¼Œè¿˜æ˜¯æŒ‡å‘åŸç”Ÿå¯¹è±¡çš„å†…éƒ¨å…ƒç´ åœ°å€.

&emsp;&emsp;è¢«å…‹éš†çš„å¯¹è±¡å¿…é¡»Cloneable,Serializableè¿™ä¸¤ä¸ªæ¥å£;

```java
package com.bobo.prototype;

import java.io.Serializable;
import java.util.Date;

public class User implements Cloneable, Serializable {

    private String name;

    private Date birth;

    private int age;

    /**
     * å®ç°å…‹éš†çš„æ–¹æ³•
     * @return
     * @throws CloneNotSupportedException
     */
    @Override
    protected Object clone() throws CloneNotSupportedException {
        return super.clone();
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public Date getBirth() {
        return birth;
    }

    public void setBirth(Date birth) {
        this.birth = birth;
    }

    public int getAge() {
        return age;
    }

    public void setAge(int age) {
        this.age = age;
    }

    public static void main(String[] args) throws Exception {
        // åˆ›å»ºä¸€ä¸ªæ™®é€šå¯¹è±¡
        Date date =  new Date(666666);
        User user = new User();
        user.setName("æ³¢æ³¢çƒ¤é¸­");
        user.setAge(18);
        user.setBirth(date);
        System.out.println("åŸå‹å¯¹è±¡çš„å±æ€§ï¼š" + user);
        // å…‹éš†å¯¹è±¡
        User cloneUser = (User) user.clone();
        System.out.println("å…‹éš†çš„å¯¹è±¡çš„å±æ€§ï¼š" + cloneUser);
        // ä¿®æ”¹åŸå‹å¯¹è±¡çš„å±æ€§
        date.setTime(12345677);
        // ä¿®æ”¹å…‹éš†å¯¹è±¡çš„å±æ€§
        cloneUser.setName("æ³¢å“¥");
        System.out.println("åŸå‹å¯¹è±¡çš„å±æ€§ï¼š" + user);
        System.out.println("å…‹éš†çš„å¯¹è±¡çš„å±æ€§ï¼š" + cloneUser);
    }

    @Override
    public String toString() {
        return "User{" +
                "name='" + name + '\'' +
                ", birth=" + birth +
                ", age=" + age +
                '}';
    }
}

```

è¾“å‡ºç»“æœ

![image.png](DesignMode/6443e2d851514225a9253ca8d26de73f.png)

æµ…å…‹éš†çš„é—®é¢˜:è™½ç„¶äº§ç”Ÿäº†ä¸¤ä¸ªå®Œå…¨ä¸åŒçš„å¯¹è±¡ï¼Œä½†æ˜¯è¢«å¤åˆ¶çš„å¯¹è±¡çš„æ‰€æœ‰å˜é‡éƒ½å«æœ‰ä¸åŸæ¥çš„å¯¹è±¡ç›¸åŒçš„å€¼ï¼Œè€Œæ‰€æœ‰çš„å¯¹å…¶ä»–å¯¹è±¡çš„å¼•ç”¨éƒ½ä»ç„¶æŒ‡å‘åŸæ¥çš„å¯¹è±¡ã€‚![image.png](DesignMode/05ad80babac04b43956010b8244cd85b.png)

### 6.2 æ·±åº¦å…‹éš†

&emsp;&emsp;è¢«å¤åˆ¶å¯¹è±¡çš„æ‰€æœ‰å˜é‡éƒ½å«æœ‰ä¸åŸæ¥çš„å¯¹è±¡ç›¸åŒçš„å€¼ï¼Œé™¤å»é‚£äº›å¼•ç”¨å…¶ä»–å¯¹è±¡çš„å˜é‡ã€‚é‚£äº›å¼•ç”¨å…¶ä»–å¯¹è±¡çš„å˜é‡å°†æŒ‡å‘è¢«å¤åˆ¶è¿‡çš„æ–°å¯¹è±¡ï¼Œè€Œä¸å†æ˜¯åŸæœ‰çš„é‚£äº›è¢«å¼•ç”¨çš„å¯¹è±¡ã€‚æ¢è¨€ä¹‹ï¼Œæ·±å¤åˆ¶æŠŠè¦å¤åˆ¶çš„å¯¹è±¡æ‰€å¼•ç”¨çš„å¯¹è±¡éƒ½å¤åˆ¶äº†ä¸€éã€‚
å®ç°çš„æ•ˆæœæ˜¯:

![image.png](DesignMode/6fdf967a6fc74e8690b75e3bb3640b7c.png)

æ·±åº¦å…‹éš†(deep clone)æœ‰ä¸¤ç§å®ç°æ–¹å¼ï¼Œç¬¬ä¸€ç§æ˜¯åœ¨æµ…å…‹éš†çš„åŸºç¡€ä¸Šå®ç°ï¼Œç¬¬äºŒç§æ˜¯é€šè¿‡åºåˆ—åŒ–å’Œååºåˆ—åŒ–å®ç°ï¼Œæˆ‘ä»¬åˆ†åˆ«æ¥ä»‹ç»

æ–¹å¼ä¸€ï¼šåœ¨æµ…å…‹éš†çš„åŸºç¡€ä¸Šå®ç°

```java
    /**
     * å®ç°å…‹éš†çš„æ–¹æ³•
     * @return
     * @throws CloneNotSupportedException
     */
    @Override
    protected Object clone() throws CloneNotSupportedException {
        User user = (User) super.clone();
        // å®ç°æ·±åº¦å…‹éš†
        user.birth = (Date) this.birth.clone();
        return user;
    }
```

![image.png](DesignMode/1ba148deb0244a4dbfef33a8f1b3bcbd.png)

æ–¹å¼äºŒï¼šåºåˆ—åŒ–å’Œååºåˆ—åŒ–

| åç§°     | è¯´æ˜                         |
| -------- | :--------------------------- |
| åºåˆ—åŒ–   | æŠŠå¯¹è±¡è½¬æ¢ä¸ºå­—èŠ‚åºåˆ—çš„è¿‡ç¨‹ã€‚ |
| ååºåˆ—åŒ– | æŠŠå­—èŠ‚åºåˆ—æ¢å¤ä¸ºå¯¹è±¡çš„è¿‡ç¨‹ã€‚ |

```java
public static void main(String[] args) throws CloneNotSupportedException, Exception {
	Date date =  new Date(1231231231231l);
	User user = new User();
	user.setName("æ³¢æ³¢çƒ¤é¸­");
	user.setAge(18);
	user.setBirth(date);
	System.out.println("-----åŸå‹å¯¹è±¡çš„å±æ€§------");
	System.out.println(user);

	//ä½¿ç”¨åºåˆ—åŒ–å’Œååºåˆ—åŒ–å®ç°æ·±å¤åˆ¶
	ByteArrayOutputStream bos = new ByteArrayOutputStream();
	ObjectOutputStream    oos = new ObjectOutputStream(bos);
	oos.writeObject(user);
	byte[] bytes = bos.toByteArray();

	ByteArrayInputStream  bis = new ByteArrayInputStream(bytes);
	ObjectInputStream	  ois = new ObjectInputStream(bis);

	//å…‹éš†å¥½çš„å¯¹è±¡ï¼
	User user1 = (User) ois.readObject();   

	// ä¿®æ”¹åŸå‹å¯¹è±¡çš„å€¼
	date.setTime(221321321321321l);
	System.out.println(user.getBirth());

	System.out.println("------å…‹éš†å¯¹è±¡çš„å±æ€§-------");
	System.out.println(user1);
}

```





## 7.è°ˆè°ˆä½ å¯¹åˆ›å»ºå‹æ¨¡å¼çš„ç†è§£

&emsp;&emsp;Javaçš„23ç§è®¾è®¡æ¨¡å¼åˆ†ä¸º3ç±»ï¼Œåˆ†åˆ«æ˜¯

![image.png](DesignMode/e7bfebaff043483eae41837038342d60.png)

è€Œåˆ›å»ºå‹æ¨¡å¼ä¸­æœ‰åŒ…å«çš„å¦‚ä¸‹çš„ç›¸å…³æ¨¡å¼ï¼š

![image.png](DesignMode/370c67f33136431c8c3b4ab9f9e46445.png)

è€Œæ¯ä¸ªè®¾è®¡æ¨¡å¼çš„ä½œç”¨å¦‚ä¸‹ï¼š

![image.png](DesignMode/19e2c33ad56e4b2cb22b3447fcf0e6a5.png)



# äºŒã€ç»“æ„æ€§æ¨¡å¼





## 1.ä»£ç†æ¨¡å¼

### 1.1 ä»£ç†æ¨¡å¼çš„ä½œç”¨

&emsp;&emsp;ä»£ç†æ¨¡å¼çš„ä½œç”¨æ˜¯é€šè¿‡ä»£ç†å¯¹è±¡æ¥å¢å¼ºç›®æ ‡å¯¹è±¡çš„åŠŸèƒ½ã€‚åˆ©ç”¨çš„æ˜¯AOPæ¨ªåˆ‡çš„æ€æƒ³ã€‚

### 1.2 ä»£ç†æ¨¡å¼çš„å®ç°æ–¹å¼

&emsp;&emsp;ä»£ç†æ¨¡å¼çš„å®ç°æ–¹å¼æœ‰ä¸‰ç§ï¼šé™æ€ä»£ç†ï¼ŒåŠ¨æ€ä»£ç†(JDKåŠ¨æ€ä»£ç†å’ŒCGLIBåŠ¨æ€ä»£ç†)

![image.png](DesignMode/ff3031b921b948338282ee57ee510c84.png)

#### 1.2.1 é™æ€ä»£ç†

æˆ‘ä»¬å…ˆå£°æ˜æ¥å£å’Œç›®æ ‡å®ç°ç±»

```java
/**
 * å®šä¹‰å…¬å…±æ¥å£
 */
public interface SomeService {
    String doSome();
}
```

ç›®æ ‡ç±»

```java
/**
 * ç›®æ ‡å¯¹è±¡ target
 */
public class SomeServiceImpl implements SomeService {
    @Override
    public String doSome() {
        System.out.println("ç›®æ ‡å¯¹è±¡ï¼šdoSome()" );
        return "hello ...";
    }
}
```

ç„¶ååˆ›å»ºå¯¹åº”çš„ä»£ç†ç±»

```java
/**
 * ä»£ç†ç±»
 *     å¢å¼ºå®ç°ç±»
 *     å’Œå®ç°ç±»å®ç°åŒä¸€ä¸ªæ¥å£
 */
public class SomeProxy implements SomeService{

    private SomeService target;

    public SomeProxy(SomeService target){
        this.target = target;
    }

    /**
     * å¢å¼ºçš„æ–¹æ³•
     * @return
     */
    @Override
    public String doSome() {
        System.out.println("ç›®æ ‡æ–¹æ³•æ‰§è¡Œä¹‹å‰...");
        String s = target.doSome();
        System.out.println("ç›®æ ‡æ–¹æ³•æ‰§è¡Œä¹‹å...");
        return s.toUpperCase();
    }
}
```

ç„¶åæµ‹è¯•å®ç°

```java
public class MainTest {
    public static void main(String[] args) {
        SomeService some = new SomeServiceImpl();
        SomeProxy proxy = new SomeProxy(some);
        System.out.println(proxy.doSome());
    }
}
```

å¯¹åº”çš„è¾“å‡ºç»“æœ

```java
ç›®æ ‡æ–¹æ³•æ‰§è¡Œä¹‹å‰...
ç›®æ ‡å¯¹è±¡ï¼šdoSome()
ç›®æ ‡æ–¹æ³•æ‰§è¡Œä¹‹å...
HELLO ...
```

å¯ä»¥çœ‹åˆ°ä»£ç†å¯¹è±¡å®ç°äº†ç›®æ ‡å¯¹è±¡çš„è°ƒç”¨ï¼ŒåŒæ—¶å¢å¼ºäº†ç›®æ ‡å¯¹è±¡çš„åŠŸèƒ½ã€‚

#### 1.2.2 JDKåŠ¨æ€ä»£ç†

&emsp;&emsp;ä¸Šé¢çš„é™æ€ä»£ç†æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨çš„åˆ›å»ºä¸€ä¸ªå¯¹åº”çš„ä»£ç†æ¥å®ç°ï¼Œä¸æ˜¯å¤ªçµæ´»ï¼Œé’ˆå¯¹ç›®æ ‡å¯¹è±¡æœ‰å®ç°ç›¸å…³æ¥å£çš„æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨JDKåŠ¨æ€ä»£ç†ã€‚

```java
public class JdkDynamicProxy {

    /**
     * JDKåŠ¨æ€ä»£ç†ï¼šç›®æ ‡å¯¹è±¡å¿…é¡»å®ç°ç›¸å…³çš„æ¥å£
     * @param args
     */
    public static void main(String[] args) {
        SomeService target = new SomeServiceImpl();
        SomeService proxy = (SomeService) Proxy.newProxyInstance(JdkDynamicProxy.class.getClassLoader(), // ç±»åŠ è½½å™¨
                target.getClass().getInterfaces() // ç›®æ ‡å¯¹è±¡å®ç°çš„ç›¸å…³æ¥å£
                , new InvocationHandler() { // ä»£ç†å¯¹è±¡çš„å›è°ƒæ–¹æ³•
                    @Override
                    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {
                        System.out.println("before...");
                        Object invoke = method.invoke(target, args);
                        System.out.println("end...");
                        if (invoke != null) {
                            return invoke.toString().toUpperCase();
                        }
                        return null;
                    }
                });
        // é€šè¿‡ä»£ç†å¯¹è±¡æ¥æ‰§è¡Œ
        System.out.println("proxy.doSome() = " + proxy.doSome());

    }
}
```

è¾“å‡ºç»“æ„

```
before...
ç›®æ ‡å¯¹è±¡ï¼šdoSome()
end...
proxy.doSome() = HELLO ...
```

#### 1.2.3 CGLIBåŠ¨æ€ä»£ç†

&emsp;&emsp;å¦‚æœç›®æ ‡å¯¹è±¡å®ç°äº†å¯¹åº”çš„æ¥å£æˆ‘ä»¬å¯ä»¥é€šè¿‡JDKåŠ¨æ€ä»£ç†çš„æ–¹å¼æ¥å®ç°ï¼Œä½†å¦‚æœç›®æ ‡å¯¹è±¡æ²¡æœ‰å®ç°ä»»ä½•çš„æ¥å£ï¼Œè¿™æ—¶æˆ‘ä»¬åªèƒ½é€šè¿‡CGLIBåŠ¨æ€ä»£ç†æ¥å®ç°äº†ï¼Œè¿™æ—¶æˆ‘ä»¬éœ€è¦å•ç‹¬å¼•å…¥cglibçš„ä¾èµ–

```java
public class CGLIBDynamicProxy {

    /**
     * CGLIBåŠ¨æ€ä»£ç†
     * @param args
     */
    public static void main(String[] args) {
        SomeService target = new SomeServiceImpl();
        SomeServiceImpl proxy = new MethodInterceptor() {

            /**
             * åˆ›å»º CGLIB ä»£ç†å¯¹è±¡çš„æ–¹æ³•
             * @return
             */
            public SomeServiceImpl createProxy() {
                // åˆ›å»ºå¢å¼ºå™¨
                Enhancer e = new Enhancer();
                // æŒ‡å®šçˆ¶ç±»
                e.setSuperclass(target.getClass());
                // æŒ‡å®šå›è°ƒæ¥å£å¯¹è±¡
                e.setCallback(this);
                // åˆ›å»ºCGLIBä»£ç†å¯¹è±¡
                return (SomeServiceImpl) e.create();
            }

            /**
             * æ‹¦æˆªå›è°ƒçš„æ–¹æ³•
             */
            @Override
            public Object intercept(Object o, Method method, Object[] objects, MethodProxy methodProxy) throws Throwable {
                System.out.println("cglib -- befor" );
                Object res = method.invoke(target, args);
                System.out.println("cglib -- end");
                return res.toString().toUpperCase();
            }
        }.createProxy();
        System.out.println("proxy.doSome() = " + proxy.doSome());
    }
}
```

è¾“å‡ºçš„ç»“æœ

```
cglib -- befor
ç›®æ ‡å¯¹è±¡ï¼šdoSome()
cglib -- end
proxy.doSome() = HELLO ...
```

## 2.é€‚é…å™¨æ¨¡å¼

### 2.1 é€‚é…å™¨çš„ä½œç”¨

&emsp;&emsp;é€‚é…å™¨æ¨¡å¼çš„ä½œç”¨æ˜¯æŠŠä¸¤ä¸ªä¸å…¼å®¹çš„å¯¹è±¡é€šè¿‡é€‚é…å™¨èƒ½å¤Ÿè¿æ¥èµ·æ¥å·¥ä½œã€‚

![image.png](DesignMode/4f1b8160dfaf4de6816c2d7bc7c79ed3.png)

### 2.2 å…·ä½“æ¡ˆä¾‹åˆ†æ

&emsp;&emsp;ä»¥MyBatisä¸­çš„æ—¥å¿—æ¨¡å—ä¸ºä¾‹æ¥ä»‹ç»ã€‚å¸¸è§çš„æ—¥å¿—æ¡†æ¶æœ‰log4j,log4j2,slf4j,logbakç­‰ï¼Œä½†æ˜¯æ¯ç§æ—¥å¿—æ¡†æ¶ä¸­çš„æ—¥å¿—çº§åˆ«éƒ½æœ‰å·®å¼‚ã€‚

log4j2çš„æ¥å£ï¼š

![image.png](DesignMode/97882ce34e7c45b38a242335fee35136.png)

slf4jçš„æ¥å£

![image.png](DesignMode/2e0b96e4f72b4d4cb1da9ef190e06f7e.png)

ä¹Ÿå°±æ˜¯å¯ä»¥çœ‹åˆ°ä¸åŒçš„æ—¥å¿—æ¡†æ¶é‡Œé¢æ‰€å®šä¹‰çš„æ—¥å¿—çº§åˆ«å’Œå¯¹åº”çš„æ–¹æ³•éƒ½æœ‰åŒºåˆ«ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„æ¡†æ¶æ€ä¹ˆæ¥ç»Ÿä¸€ä½¿ç”¨è¿™äº›æ—¥å¿—æ¡†æ¶å‘¢ï¼Ÿåœ¨MyBatisä¸­é€šè¿‡å®šä¹‰äº†ä¸€ä¸ªæ—¥å¿—æ¥å£ï¼Œå®šä¹‰äº†æ—¥å¿—å…·æœ‰çš„çº§åˆ«å’Œæ–¹æ³•ã€‚

![image.png](DesignMode/13b885d6a2e742c8902a41cca65a77f3.png)

é‚£è¿™æ—¶å€™æˆ‘ä»¬å°±å‘ç°å…·ä½“çš„æ—¥å¿—æ¡†æ¶å’Œè¿™ä¸ªæ¥å£å…¶å®æ˜¯æ²¡æœ‰åŠæ³•ç›´æ¥æ¥ä½¿ç”¨çš„ã€‚

![image.png](DesignMode/5394d7aab0b9407bb44e7a43b5a46c35.png)

è¿™æ—¶æˆ‘ä»¬å°±éœ€è¦é€šè¿‡å¯¹åº”çš„é€‚é…å™¨æ¥å¤„ç†è¿™ç§æƒ…å†µï¼Œä»¥Slf4Jä¸ºä¾‹ã€‚

![image.png](DesignMode/cc1a1999be144995bbdfd0d52af15aa1.png)

## 3.è£…é¥°è€…æ¨¡å¼

### 3.1 è£…é¥°è€…æ¨¡å¼çš„ä½œç”¨

&emsp;&emsp;è£…é¥°è€…æ¨¡å¼åˆç§°ä¸ºåŒ…è£…æ¨¡å¼([Wrapper](https://so.csdn.net/so/search?q=Wrapper&spm=1001.2101.3001.7020)),ä½œç”¨æ˜¯ç”¨æ¥åŠ¨æ€çš„ä¸ºä¸€ä¸ªå¯¹è±¡å¢åŠ æ–°çš„åŠŸèƒ½ã€‚è£…é¥°æ¨¡å¼æ˜¯ä¸€ç§ç”¨äºä»£æ›¿ç»§æ‰¿çš„æŠ€æœ¯ï¼Œ æ— é¡»é€šè¿‡ç»§æ‰¿å¢åŠ å­ç±»å°±èƒ½æ‰©å±•å¯¹è±¡çš„æ–°åŠŸèƒ½ ã€‚ä½¿ç”¨å¯¹è±¡çš„å…³è”å…³ç³»ä»£æ›¿ç»§æ‰¿å…³ç³»ï¼Œæ›´åŠ çµæ´»ï¼ŒåŒæ—¶é¿å…ç±»å‹ä½“ç³»çš„å¿«é€Ÿè†¨èƒ€ã€‚

![image.png](DesignMode/3d6542b45adc4fc1954b5a32e0cefe0b.png)

### 3.2 è£…é¥°è€…æ¨¡å¼çš„åº”ç”¨

&emsp;&emsp;è£…é¥°è€…æ¨¡å¼çš„åº”ç”¨åœºæ™¯è¿˜æ˜¯éå¸¸å¤šçš„ï¼Œæ¯”å¦‚

* IOæµä¸­çš„FileInputStreamï¼ŒFileOutputStreamç­‰
* Springä¸­çš„å„ç§Wrapper
* MyBatisä¸­çš„ç¼“å­˜è®¾è®¡

æˆ‘ä»¬ä»¥MyBatisä¸­çš„ç¼“å­˜å®ä¾‹ä¸ºä¾‹æ¥çœ‹çœ‹å…¶å…·ä½“çš„å®ç°ã€‚

é¦–å…ˆæ˜¯Cacheæ¥å£

![image.png](DesignMode/4fd123c411d44b9b9be4b6fc042cd1a0.png)

ç„¶åæ˜¯PerpetualCacheå®ç°ï¼šä»…ä»…å®ç°äº†æ•°æ®åŸºäºå†…å­˜çš„è¯»å†™æ“ä½œã€‚åŠŸèƒ½å•ä¸€ã€‚

![image.png](DesignMode/64a1d022065f46d5ad8f05fa0a884130.png)

è£…é¥°ç±»ï¼šç„¶ååœ¨MyBatisä¸­ç»™æˆ‘ä»¬æä¾›äº†å¾ˆå¤šçš„è£…é¥°ç±»ã€‚

![image.png](DesignMode/b6a6d87b24bb40d08c86267957622a18.png)

æ¯ä¸ªè£…é¥°ç±»éƒ½æœ‰è‡ªå·±çš„ä½œç”¨

* BlockingCacheï¼šé˜»å¡çš„
* LruCache:æ ¹æ®Lruè§„åˆ™æ¥æ·˜æ±°ç¼“å­˜æ•°æ®
* FifoCacheï¼šæ ¹æ®FIFOè§„åˆ™æ¥æ·˜æ±°ç¼“å­˜æ•°æ®
* ....

æºç ä¸­çš„è£…é¥°ï¼š

![image.png](DesignMode/15cfb22ba61c4fc9a3c0ee7db595d8b7.png)

![image.png](DesignMode/7379277ae49d422cbfe571f0852af446.png)

| æ¯”è¾ƒ | è¯´æ˜                                                         |
| ---- | :----------------------------------------------------------- |
| ä¼˜ç‚¹ | 1. æ‰©å±•å¯¹è±¡åŠŸèƒ½ï¼Œæ¯”ç»§æ‰¿çµæ´»ï¼Œä¸ä¼šå¯¼è‡´ç±»ä¸ªæ•°æ€¥å‰§å¢åŠ <br />2. å¯ä»¥å¯¹ä¸€ä¸ªå¯¹è±¡è¿›è¡Œå¤šæ¬¡è£…é¥°,åˆ›é€ å‡ºä¸åŒè¡Œä¸ºçš„ç»„åˆ,å¾—åˆ°åŠŸèƒ½æ›´åŠ å¼ºå¤§çš„å¯¹è±¡<br />3. å…·ä½“æ„å»ºç±»å’Œå…·ä½“è£…é¥°ç±»å¯ä»¥ç‹¬ç«‹å˜åŒ–,&#x3c;br />ç”¨æˆ·å¯ä»¥æ ¹æ®éœ€è¦è‡ªå·±å¢åŠ æ–°çš„å…·ä½“æ„ä»¶å­ç±»å’Œå…·ä½“è£…é¥°å­ç±»ã€‚ |
| ç¼ºç‚¹ | 1.  äº§ç”Ÿå¾ˆå¤šå°å¯¹è±¡ã€‚å¤§é‡å°å¯¹è±¡å æ®å†…å­˜ï¼Œä¸€å®šç¨‹åº¦ä¸Šå½±å“æ€§èƒ½ã€‚<br />2. è£…é¥°æ¨¡å¼æ˜“äºå‡ºé”™ï¼Œè°ƒè¯•æ’æŸ¥æ¯”è¾ƒéº»çƒ¦ã€‚ |

## 4.ç»„åˆæ¨¡å¼

### 4.1 ç»„åˆæ¨¡å¼çš„ä½œç”¨

&emsp;&emsp;å…¶å®è§£å†³çš„æ˜¯å¯¹è±¡ä¸å¯¹è±¡ä¹‹é—´çš„åŒ…å«å…³ç³»ã€‚ä¹Ÿå°±æ˜¯ éƒ¨åˆ†-æ•´ä½“ çš„å±‚æ¬¡ç»“æ„ã€‚

### 4.2 ç»„åˆæ¨¡å¼çš„åº”ç”¨

&emsp;&emsp;ç»„åˆæ¨¡å¼åœ¨é…ç½®æ–‡ä»¶çš„åŠ è½½è§£æä¸­å…¶å®ä¼šç”¨çš„ç›¸å¯¹æ¯”è¾ƒå¤šã€‚ä»¥SpringSecurityçš„é…ç½®æ–‡ä»¶ä¸ºä¾‹

![image.png](DesignMode/451caf5510724dbdb8781edc504a3108.png)

ä¸Šé¢æ˜¯å…·ä½“çš„å®šä¹‰

![image.png](DesignMode/225305de9e79499b9858fdf0954bee43.png)

åº”ç”¨

![image.png](DesignMode/f27879a6ed534ecda344e3c8033e8b66.png)

## 5.é—¨é¢æ¨¡å¼

&emsp;&emsp;é—¨é¢æ¨¡å¼ä¹Ÿç§°ä¸ºå¤–è§‚æ¨¡å¼ï¼Œä»–éšè—äº†ç³»ç»Ÿçš„å¤æ‚æ€§ï¼Œå¹¶å‘å®¢æˆ·ç«¯æä¾›äº†ä¸€ä¸ªå¯ä»¥è®¿é—®ç³»ç»Ÿçš„æ¥å£ã€‚è¿™ç§ç±»å‹çš„è®¾è®¡æ¨¡å¼å±äºç»“æ„æ€§æ¨¡å¼ã€‚ä¸ºå­ç³»ç»Ÿä¸­çš„ä¸€ç»„æ¥å£æä¾›äº†ä¸€ä¸ªç»Ÿä¸€çš„è®¿é—®æ¥å£ï¼Œè¿™ä¸ªæ¥å£ä½¿å¾—å­ç³»ç»Ÿæ›´å®¹æ˜“è¢«è®¿é—®æˆ–è€…ä½¿ç”¨ã€‚

![image.png](DesignMode/d7cbb356c586445cbae588a9c6944c48.png)

&emsp;&emsp;å…·ä½“çš„ä¾‹å­æ¯”å¦‚ï¼šMyBatisä¸­çš„SqlSessionæ¥å£ï¼Œå¯¹å¤–æä¾›äº†æ•°æ®åº“æ“ä½œçš„ç›¸å…³åŠŸèƒ½ï¼Œå…·ä½“çš„å®ç°ç»†èŠ‚å¯¹è°ƒç”¨è€…æ˜¯éšè—çš„ï¼Œè¿™ç§æ¨¡å¼åœ¨å®é™…é¡¹ç›®å’Œæ¡†æ¶ä¸­å¾ˆé¢‘ç¹

## 6.æ¡¥æ¥æ¨¡å¼

&emsp;&emsp;æ¡¥æ¥æ¨¡å¼çš„å‡ºç°æ˜¯æ›¿ä»£æ‰å¤šå±‚ç»§æ‰¿çš„é—®é¢˜ã€‚æé«˜äº†ç³»ç»Ÿçš„æ‰©å±•æ€§ã€‚

![image.png](DesignMode/689902586ed3400e808b3cdaf88a93de.png)

å…·ä½“çš„åº”ç”¨æ¯”å¦‚JDBCä¸­çš„DriverManagerå…¶å®æœ‰ç”¨åˆ°æ¡¥æ¥æ¨¡å¼ï¼Œä¸åŒçš„æ•°æ®åº“å‚å•†å¯¹åº”ä¸åŒçš„é©±åŠ¨å’Œè¿æ¥

## 7.äº«å…ƒæ¨¡å¼

&emsp;&emsp;è¿™ä¸ªé—®é¢˜ç›¸å¯¹æ¥è¯´æ¯”è¾ƒå†·é—¨ï¼Œç”¨åˆ°çš„ä¹Ÿæ¯”è¾ƒå°‘ï¼Œä¸»è¦æ˜¯é’ˆå¯¹å†…å­˜è¿™å—çš„èŠ‚çœå¤„ç†ï¼Œå¦‚æœæœ‰å¾ˆå¤šä¸ªå®Œå…¨ç›¸åŒæˆ–ç›¸ä¼¼çš„å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡äº«å…ƒæ¨¡å¼ï¼ŒèŠ‚çœå†…å­˜.

äº«å…ƒæ¨¡å¼ä»¥å…±äº«çš„æ–¹å¼é«˜æ•ˆåœ°æ”¯æŒå¤§é‡ç»†ç²’åº¦å¯¹è±¡çš„é‡ç”¨ã€‚

äº«å…ƒå¯¹è±¡èƒ½åšåˆ°å…±äº«çš„å…³é”®æ˜¯åŒºåˆ†äº†å†…éƒ¨çŠ¶æ€å’Œå¤–éƒ¨çŠ¶æ€ã€‚
â€¢  **å†…éƒ¨çŠ¶æ€** ï¼šå¯ä»¥å…±äº«ï¼Œä¸ä¼šéšç¯å¢ƒå˜åŒ–è€Œæ”¹å˜
â€¢  **å¤–éƒ¨çŠ¶æ€** ï¼šä¸å¯ä»¥å…±äº«ï¼Œä¼šéšç¯å¢ƒå˜åŒ–è€Œæ”¹å˜

æ¯”å¦‚ä»¥å›´æ£‹ä¸ºä¾‹:

![image.png](DesignMode/ed27059ad63b4d408568033cd3d18998.png)

![image.png](DesignMode/d2cd6a9f545e4f09af78a4e4f3c09677.png)



# ä¸‰ã€è¡Œä¸ºå‹æ¨¡å¼

&emsp;&emsp;è¡Œä¸ºå‹æ¨¡å¼å…³æ³¨çš„æ˜¯å¯¹è±¡ä¹‹é—´çš„é€šä¿¡ï¼Œä¹Ÿå°±æ˜¯æè¿°å¤šä¸ªç±»æˆ–è€…å¯¹è±¡ä¹‹é—´ï¼Œé€šè¿‡åä½œå…±åŒå®Œæˆä¸€ä¸ªä»»åŠ¡ã€‚ä¸»è¦æ¶‰åŠçš„æ˜¯ **å¯¹è±¡** å’Œ **ç®—æ³•**ä¹‹é—´èŒè´£çš„åˆ†é…ã€‚

è¡Œä¸ºå‹æ¨¡å¼åˆ†ä¸ºä¸¤ç±»ï¼š

* ç±»è¡Œä¸ºæ¨¡å¼ï¼š é€šè¿‡ç»§æ‰¿æœºåˆ¶æ¥åœ¨ç±»é—´åˆ†æ´¾è¡Œä¸ºã€‚ ä¸»è¦æ˜¯é€šè¿‡å¤šæ€æ¥åˆ†é…çˆ¶ç±»å’Œå­ç±»çš„èŒè´£
* å¯¹è±¡è¡Œä¸ºæ¨¡å¼ï¼š é€šè¿‡ç»„åˆæˆ–èšåˆï¼Œåœ¨å¯¹è±¡é—´åˆ†æ´¾è¡Œä¸ºã€‚é€šè¿‡å¯¹è±¡å…³è”ç­‰æ–¹å¼æ¥åˆ†é…ç±»çš„èŒè´£ã€‚

![image.png](DesignMode/44e5adf5c4a2487584f3b072b4a19d8a.png)

## 1.è§£é‡Šå™¨æ¨¡å¼

### 1.1 è§£é‡Šå™¨æ¨¡å¼çš„ä½œç”¨

&emsp;&emsp;è§£é‡Šå™¨æ¨¡å¼åœ¨ä¸šåŠ¡å¼€å‘é¢æ˜¯å¾ˆå°‘æ¥è§¦åˆ°çš„ã€‚ä¸»è¦çš„ä½œç”¨æ˜¯å®šä¹‰çš„è§£é‡Šå™¨æ¥è§£æå„ç§è¡¨è¾¾å¼ï¼Œæ¯”å¦‚SQLè¯­å¥ï¼ŒSPELè¡¨è¾¾å¼ï¼Œæƒé™æ³¨è§£ä¸­çš„è¡¨è¾¾å¼ hasAnyRole('ROLE_ADMIN')ç­‰ã€‚

### 1.2 è§£é‡Šå™¨çš„åº”ç”¨

&emsp;&emsp;æ¯”è¾ƒå¸¸è§çš„åº”ç”¨æ¯”å¦‚Springä¸­çš„é’ˆå¯¹SPELè¡¨è¾¾å¼åšçš„è§£æå¤„ç†

```java
    public static void main(String[] args) {
        SpelExpressionParser parser = new SpelExpressionParser();
        Expression expression = parser.parseExpression("500-100*2+60");
        Object value = expression.getValue();
        System.out.println("value = " + value);
    }
```



## 2.æ¨¡æ¿æ¨¡å¼

### 2.1 æ¨¡æ¿æ¨¡å¼çš„ä½œç”¨

&emsp;&emsp;æ¨¡æ¿æ¨¡å¼æ˜¯ä¸€ç§ç›¸å¯¹ç®€å•çš„è®¾è®¡æ¨¡å¼ã€‚ä½œç”¨æ˜¯åœ¨çˆ¶ç±»ä¸­å›ºå®šç¨‹åºçš„æ‰§è¡Œé¡ºåºï¼Œå…·ä½“çš„å®ç°åœ¨å­ç±»ä¸­å®ç°ã€‚æ¯”å¦‚é“¶è¡Œå®šä¹‰æ¯ä¸ªäººå»é“¶è¡Œå¼€æˆ·çš„æµç¨‹ï¼Œ

1. å–å·
2. å¡«å†™å•å­
3. ç­‰å¾…
4. åŠç†ä¸šåŠ¡
5. ç»“æŸ

ç„¶åæ¯ä¸ªäººæ¥å¼€æˆ·éƒ½ä¼šèµ°è¿™ä¸ªæµç¨‹ï¼Œåªæ˜¯æ¯ä¸ªäººçš„å…·ä½“æ“ä½œå†…å®¹ä¼šæœ‰åŒºåˆ«


### 2.2 æ¨¡æ¿æ¨¡å¼çš„åº”ç”¨

&emsp;&emsp;æ¨¡æ¿æ¨¡å¼çš„åº”ç”¨å°±æ¯”è¾ƒå¤šå¦‚ä¸‹ï¼š

1. Servletä¸­çš„doGetå’ŒdoPostæ–¹æ³•
2. Springä¸­çš„JdbcTemplate
3. MyBatisä¸­çš„Executorå¤„ç†
4. .....



## 3.è´£ä»»é“¾æ¨¡å¼

### 3.1 è´£ä»»é“¾æ¨¡å¼çš„ä½œç”¨

&emsp;&emsp;å°†èƒ½å¤Ÿå¤„ç†åŒä¸€ç±»è¯·æ±‚çš„å¯¹è±¡è¿æˆä¸€æ¡é“¾ï¼Œæ‰€æäº¤çš„è¯·æ±‚æ²¿ç€é“¾ä¼ é€’ï¼Œé“¾ä¸Šçš„å¯¹è±¡é€ä¸ªåˆ¤æ–­æ˜¯å¦æœ‰èƒ½åŠ›å¤„ç†è¯¥è¯·æ±‚ï¼Œå¦‚æœèƒ½åˆ™å¤„ç†ï¼Œå¦‚æœä¸èƒ½åˆ™ä¼ é€’ç»™é“¾ä¸Šçš„ä¸‹ä¸€ä¸ªå¯¹è±¡å¤„ç†ã€‚

![image.png](DesignMode/4c895e3c35f0466b8832bfaf6d4aa9f2.png)


### 3.2 è´£ä»»é“¾æ¨¡å¼çš„åº”ç”¨

&emsp;&emsp;è´£ä»»é“¾æ¨¡å¼çš„åº”ç”¨åœºæ™¯æ¯”è¾ƒå¤šï¼Œå¯¹å¤§å®¶æ¥è¯´å°è±¡æ¯”è¾ƒæ·±åˆ»çš„åº”è¯¥æ˜¯SpringSecurityä¸­çš„å¤„ç†è¯·æ±‚çš„è¿‡æ»¤å™¨é“¾äº†ã€‚

![image.png](DesignMode/627ec42ef657483289810bcd60d202d4.png)

&emsp;&emsp;å¯ä»¥å’Œé¢è¯•å®˜å…·ä½“èŠä¸‹SpringSecurityä¸­çš„è¿™å—è®¾è®¡ã€‚å½“ç„¶è¿˜æœ‰ä¸€äº›å…¶ä»–çš„ä¹Ÿå¯èŠæ¯”å¦‚ï¼š

1. Javaä¸­ï¼Œå¼‚å¸¸æœºåˆ¶å°±æ˜¯ä¸€ç§è´£ä»»é“¾æ¨¡å¼ã€‚ä¸€ä¸ªtryå¯ä»¥å¯¹åº”å¤šä¸ªcatchï¼Œå½“ç¬¬ä¸€ä¸ªcatchä¸åŒ¹é…ç±»å‹ï¼Œåˆ™è‡ªåŠ¨è·³åˆ°ç¬¬äºŒä¸ªcatch.
2. Javascriptè¯­è¨€ä¸­ï¼Œäº‹ä»¶çš„å†’æ³¡å’Œæ•è·æœºåˆ¶ã€‚Javaè¯­è¨€ä¸­ï¼Œäº‹ä»¶çš„å¤„ç†é‡‡ç”¨è§‚å¯Ÿè€…æ¨¡å¼ã€‚
3. SpringMVCä¸­ï¼Œæ‹¦æˆªå™¨çš„è°ƒç”¨ä¹Ÿæ˜¯å…¸å‹çš„è´£ä»»é“¾æ¨¡å¼
4. åŒæ ·çš„Servletä¸­çš„è¿‡æ»¤å™¨é“¾åŒæ ·æ˜¯è´£ä»»é“¾æ¨¡å¼çš„å®ç°ã€‚


## 4.è§‚å¯Ÿè€…æ¨¡å¼

### 4.1 è§‚å¯Ÿè€…æ¨¡å¼çš„ä½œç”¨

&emsp;&emsp;å»ºç«‹å¯¹è±¡ä¸å¯¹è±¡ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œä¸€ä¸ªå¯¹è±¡å‘ç”Ÿæ”¹å˜æ—¶ï¼Œä¼šè‡ªåŠ¨é€šçŸ¥å…¶ä»–å¯¹è±¡ã€‚è¿™ä¸ªåœºæ™¯ä¸­ï¼Œå‘ç”Ÿæ”¹å˜çš„å¯¹è±¡è¢«ç§°ä¸ºè§‚å¯Ÿç›®æ ‡ï¼Œè¢«é€šçŸ¥çš„å¯¹è±¡ç§°ä¸ºè§‚å¯Ÿè€…ã€‚ä¸€ä¸ªè§‚å¯Ÿç›®æ ‡å¯ä»¥æœ‰å¤šä¸ªè§‚å¯Ÿè€…ï¼Œè€Œè¿™äº›è§‚å¯Ÿè€…ä¹‹é—´å¯ä»¥æ²¡æœ‰è”ç³»ï¼Œå¯ä»¥æ ¹æ®éœ€è¦å¢åŠ æˆ–åˆ é™¤è§‚å¯Ÿè€…ã€‚

![image.png](DesignMode/28ad3ed5e28f41a69a490ee02fa0bb25.png)


### 4.2 è§‚å¯Ÿè€…æ¨¡å¼çš„åº”ç”¨

&emsp;&emsp;è§‚å¯Ÿè€…æ¨¡å¼åœ¨Javaç¼–ç¨‹ä¸­ç”¨åˆ°æœ€å¤šçš„å¯èƒ½å°±æ˜¯äº‹ä»¶æ¨¡å—çš„å¤„ç†ï¼Œå¯ä»¥å’Œé¢è¯•å®˜è¯¦ç»†çš„èŠä¸‹Springçš„äº‹ä»¶ç®¡ç†æœºåˆ¶æˆ–è€…SpringBootçš„äº‹ä»¶å¤„ç†æœºåˆ¶ã€‚æˆ‘ä»¬ä»¥SpringBootçš„äº‹ä»¶æœºåˆ¶ä¸ºä¾‹æ¥è¯´æ˜

https://blog.csdn.net/qq_38526573/article/details/122143258 å•ç‹¬é€šè¿‡ä¸€ç¯‡æ–‡ç« æ¥è¯´æ˜äº‹ä»¶çš„æœ¬è´¨ã€‚



## 5.ç­–ç•¥æ¨¡å¼

### 5.1 ç­–ç•¥æ¨¡å¼çš„ä½œç”¨

&emsp;&emsp;ç­–ç•¥æ¨¡å¼çš„ä½œç”¨å°±æ˜¯æˆ‘ä»¬æƒ³è¦å®ç°æŸä¸ªç›®çš„ï¼Œå®ç°çš„æ–¹å¼å¯ä»¥æœ‰å¾ˆå¤šç§ï¼Œé‚£ä¹ˆè¿™é‡Œçš„æ¯ä¸€ç§å®ç°æ–¹å¼éƒ½å¯ä»¥ç§°ä¸ºä¸€ç§ç­–ç•¥ã€‚æ¯”å¦‚ï¼š

![image.png](DesignMode/22ad4a07e93c4074ac60ae1c7924452a.png)


&emsp;&emsp;æˆ‘ä»¬å¯ä»¥å°†æ¯ä¸€ç§äº¤é€šæ–¹å¼éƒ½å°è£…ä¸ºä¸€ä¸ªç‹¬ç«‹çš„ç±»ï¼Œè¿™å°±æ˜¯ä¸€ç§ç­–ç•¥ã€‚ä¸ºäº†ä¿è¯ç­–ç•¥çš„ä¸€è‡´æ€§ï¼Œè¿˜å¯ä»¥ç”¨ä¸€ä¸ªæŠ½è±¡çš„äº¤é€šæ–¹å¼ç±» æ¥ åšäº¤é€šæ–¹å¼çš„å®šä¹‰ã€‚


### 5.2 ç­–ç•¥æ¨¡å¼çš„åº”ç”¨

&emsp;&emsp;ç­–ç•¥æ¨¡å¼åœ¨å®é™…å¼€å‘ä¸­ç”¨åˆ°çš„åŒæ ·ä¼šæ¯”è¾ƒå¤šã€‚

1. AOP ä¸­æ ¹æ®ä¸åŒçš„ç­–ç•¥å¯ä»¥é€šè¿‡JDKåŠ¨æ€ä»£ç†æˆ–è€…CGLIBä»£ç†æ¥åˆ›å»ºä»£ç†å¯¹è±¡
2. Springæ¡†æ¶ä¸­çš„Resourcesæ¥å£ï¼Œèµ„æºè®¿é—®çš„ç­–ç•¥
3. Servletä¸­çš„serviceæ–¹æ³•ï¼Œä¼šæ ¹æ®å®¢æˆ·ç«¯çš„ä¸åŒæäº¤æ–¹å¼æ¥è°ƒç”¨å¯¹åº”çš„doGetæˆ–è€…doPostæ–¹æ³•æ¥å¤„ç†è¯·æ±‚
4. Shiroä¸­çš„å¤šRealmè®¤è¯ä¸­ï¼Œæ ¹æ®æˆ‘ä»¬ä¸åŒçš„é…ç½®å¯ä»¥ä½¿ç”¨æ‰€æœ‰Realmè®¤è¯é€šè¿‡æˆ–è€…å…¶ä¸­ä¸€ä¸ªè®¤è¯é€šè¿‡ç­‰
5. SpringSecurityä¸­çš„Authenticationå¯¹è±¡çš„å­˜å‚¨æ–¹å¼
6. .......


## 6.è¿­ä»£å™¨æ¨¡å¼

### 6.1 è¿­ä»£å™¨æ¨¡å¼çš„ä½œç”¨

åœºæ™¯ï¼šè®¿é—®èšåˆå¯¹è±¡ä¸­çš„å„ä¸ªå…ƒç´ çš„æ—¶å€™ï¼Œæ¯”å¦‚é“¾è¡¨çš„éå†ã€‚æˆ‘ä»¬ä¸€èˆ¬æ˜¯å°†éå†çš„æ–¹æ³•ä¹Ÿæ”¾åœ¨é“¾è¡¨ç±»ä¸­ã€‚ä½†æ˜¯å¦‚æœéœ€è¦ä¿®æ”¹éå†æ–¹æ³•ï¼Œå°±éœ€è¦ä¿®æ”¹é“¾è¡¨ç±»çš„ä»£ç ï¼Œè¿èƒŒäº†å¼€é—­åŸåˆ™ã€‚

è¿­ä»£å™¨æ¨¡å¼å°±æ˜¯åœ¨å®¢æˆ·è®¿é—®å’Œèšåˆç±»ä¹‹é—´æ’å…¥ä¸€ä¸ªè¿­ä»£å™¨ï¼Œè¿™æ ·å°±å°†**èšåˆå¯¹è±¡** å’Œ **éå†æ–¹æ³•**è§£è€¦äº†ï¼Œå¹¶ä¸”å¯¹å¤–éšè—å…¶å®ç°ç»†èŠ‚ã€‚

![image.png](DesignMode/8a9095d4fbe04245b476ca16250ab2eb.png)


### 6.2 è¿­ä»£å™¨æ¨¡å¼çš„åº”ç”¨

1. JDKä¸­çš„List/Seté›†åˆä¸­çš„è¿­ä»£å™¨
2. ......



## 7.ä¸­ä»‹è€…æ¨¡å¼

### 7.1 ä¸­ä»‹åˆ™æ¨¡å¼çš„ä½œç”¨

&emsp;&emsp;å¯¹è±¡ä¹‹é—´å…·æœ‰å¾ˆå¼ºçš„å…³è”æ€§ï¼Œè€Œä¸”æœ‰å¤§é‡çš„ç›¸äº’è°ƒç”¨ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœä¸€ä¸ªå¯¹è±¡å‘ç”Ÿäº†å˜åŒ–ï¼Œå°±éœ€è¦è¿½è¸ªè¯¥å¯¹è±¡å…³è”çš„å…¶ä»–å¯¹è±¡ï¼Œå¹¶è¿›è¡Œç›¸åº”çš„å¤„ç†ï¼Œè¿™å°±å˜å¾—å¾ˆå¤æ‚ã€‚è€Œä¸­ä»‹è€…æ¨¡å¼ï¼Œå°±æ˜¯ç”¨ä¸€ä¸ªä¸­ä»‹è€…å¯¹è±¡æ¥å°è£…ä¸€ç³»åˆ—çš„å¯¹è±¡äº¤äº’ï¼Œä¸­ä»‹è€…ä½¿å„å¯¹è±¡ä¸éœ€è¦æ˜¾å¼çš„ç›¸äº’å¼•ç”¨ï¼Œè¿™å°±ä½¿å¾—ç³»ç»Ÿå˜å¾—ä½è€¦åˆã€‚æ¯”å¦‚ï¼š

![image.png](DesignMode/bfe0f0f3fbff44e7ad83bc64c9637758.png)

å‡å¦‚æ²¡æœ‰æ€»ç»ç†ã€‚ä¸‹é¢ä¸‰ä¸ªéƒ¨é—¨ï¼šè´¢åŠ¡éƒ¨ã€å¸‚åœºéƒ¨ã€ç ”å‘éƒ¨ã€‚è´¢åŠ¡éƒ¨è¦å‘å·¥èµ„ï¼Œè®©å¤§å®¶æ ¸å¯¹å…¬å¸éœ€è¦è·Ÿå¸‚åœºéƒ¨å’Œç ”å‘éƒ¨éƒ½é€šæ°”ï¼›å¸‚åœºéƒ¨è¦æ¥ä¸ªæ–°é¡¹ç›®ï¼Œéœ€è¦ç ”å‘éƒ¨å¤„ç†æŠ€æœ¯ã€éœ€è¦è´¢åŠ¡éƒ¨å‡ºèµ„é‡‘ã€‚å¸‚åœºéƒ¨è·Ÿå„ä¸ªéƒ¨é—¨æ‰“äº¤é“ã€‚ è™½ç„¶åªæœ‰ä¸‰ä¸ªéƒ¨é—¨ï¼Œä½†æ˜¯å…³ç³»éå¸¸ä¹±ã€‚

![image.png](DesignMode/af819fcb665d4aacacc4af386c9b3f8e.png)


å®é™…ä¸Šï¼Œå…¬å¸éƒ½æœ‰æ€»ç»ç†ã€‚å„ä¸ªéƒ¨é—¨æœ‰ä»€ä¹ˆäº‹æƒ…éƒ½é€šæŠ¥åˆ°æ€»ç»ç†è¿™é‡Œï¼Œæ€»ç»ç†å†é€šçŸ¥å„ä¸ªç›¸å…³éƒ¨é—¨ã€‚


### 7.2 ä¸­ä»‹åˆ™æ¨¡å¼çš„åº”ç”¨

1. MVCæ¨¡å¼ä¸­çš„Cï¼Œæ§åˆ¶å™¨å°±æ˜¯ä¸€ä¸ªä¸­ä»‹è€…å¯¹è±¡ï¼ŒMå’ŒVéƒ½å’ŒCæ‰“äº¤é“
2. ä»£ç†å¯¹è±¡ä¸­çš„invokeæ–¹æ³•ï¼Œå®¢æˆ·ç«¯å’Œç›®æ ‡å¯¹è±¡éƒ½æ˜¯é€šè¿‡invokeæ¥æ‰“äº¤åˆ°çš„ã€‚
3. .....


## 8.çŠ¶æ€æ¨¡å¼

åœºæ™¯ï¼š å¦‚æœä¸€ä¸ªå¯¹è±¡çš„è¡Œä¸ºä¼šæ ¹æ® å…¶æŸä¸ªå±æ€§çš„å˜åŒ–è€Œä¸åŒï¼Œé‚£è¿™ä¸ªå±æ€§å°±å¯ä»¥è¢«ç§°ä¸ºè¯¥å¯¹è±¡çš„çŠ¶æ€ã€‚è¿™æ ·çš„å¯¹è±¡ä¹Ÿè¢«ç§°ä¸ºæœ‰çŠ¶æ€å¯¹è±¡ï¼ˆstatefulï¼‰ã€‚å¦‚æœè¿™æ ·çš„å¯¹è±¡å› ä¸ºæŸäº›äº‹ä»¶ï¼Œå…¶å†…éƒ¨çŠ¶æ€å‘ç”Ÿäº†æ”¹å˜ï¼Œé‚£ä¹ˆç³»ç»Ÿçš„è¡Œä¸ºä¹Ÿè¦éšä¹‹å‘ç”Ÿå˜åŒ–çš„è¯ï¼Œå°±å¯ä»¥ä½¿ç”¨çŠ¶æ€æ¨¡å¼ã€‚


## 9.å‘½ä»¤æ¨¡å¼

åœºæ™¯ï¼šè¯·æ±‚çš„å‘é€è€…å’Œæ¥æ”¶è€…ä¹‹é—´è§£è€¦ï¼Œè®©å¯¹è±¡ä¹‹é—´çš„è°ƒç”¨å…³ç³»æ›´åŠ çµæ´»ã€‚å‘é€è€…å’Œæ¥æ”¶è€…ä¹‹é—´æ²¡æœ‰ç›´æ¥çš„å¼•ç”¨å…³ç³»ï¼Œå‘é€è¯·æ±‚çš„å¯¹è±¡åªéœ€è¦çŸ¥é“å¦‚ä½•å‘é€ï¼Œè€Œä¸å¿…å…³å¿ƒå¦‚ä½•å®Œæˆè¯·æ±‚ã€‚


## 10.å¤‡å¿˜å½•æ¨¡å¼

åœºæ™¯ï¼šè®°å½•ä¸€ä¸ªå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œå½“ç”¨æˆ·åæ‚”æ—¶èƒ½æ’¤é”€å½“å‰çš„æ“ä½œï¼Œæ˜¯æ•°æ®æ¢å¤åˆ°å®ƒåŸæ¥çš„çŠ¶æ€ã€‚æ¯”å¦‚æˆ‘ä»¬ç¼–ç¨‹çš„æ—¶å€™ï¼Œctrl+z å°±æ˜¯æ’¤é”€å½“å‰æ“ä½œï¼Œæ¢å¤åˆ°ä¿®æ”¹å‰çš„çŠ¶æ€ã€‚åˆå«å¿«ç…§æ¨¡å¼ã€‚



## 11.è®¿é—®è€…æ¨¡å¼

åœºæ™¯ï¼šæœ‰äº›é›†åˆå¯¹è±¡ä¸­ä¼šæœ‰å¤šç§ä¸åŒçš„å…ƒç´ ï¼Œæ¯ç§å…ƒç´ éƒ½æœ‰ä¸åŒçš„è®¿é—®è€… å’Œ å¤„ç†æ–¹å¼ã€‚è¿™ç§è¢«å¤„ç†çš„æ•°æ®å…ƒç´ ç›¸å¯¹ç¨³å®šï¼Œä½†æ˜¯å¤„ç†æ–¹å¼æ¯”è¾ƒå¤šæ ·çš„æƒ…å†µï¼Œå¯ä»¥ç”¨è®¿é—®è€…æ¨¡å¼æ¥å¤„ç†ã€‚

è®¿é—®è€…æ¨¡å¼å°†æ•°æ®ç»“æ„ä¸­çš„å„å…ƒç´ çš„æ“ä½œåˆ†ç¦»å‡ºæ¥ï¼Œå°è£…æˆç‹¬ç«‹çš„ç±»ï¼Œä½¿å…¶åœ¨ä¸æ”¹å˜æ•°æ®ç»“æ„çš„å‰æä¸‹ï¼Œå¯ä»¥æ·»åŠ ä½œç”¨äºè¿™äº›å…ƒç´ çš„æ–°æ“ä½œã€‚ä¸ºæ•°æ®ç»“æ„ä¸­çš„æ¯ä¸ªå…ƒç´ æä¾›å¤šç§è®¿é—®æ–¹å¼ã€‚



