{
    "version": "https://jsonfeed.org/version/1",
    "title": "记录“美食”每刻",
    "subtitle": "",
    "icon": "http://yoursite.com/images/favicon.ico",
    "description": "记录“美食”每刻",
    "home_page_url": "http://yoursite.com",
    "items": [
        {
            "id": "http://yoursite.com/interview/JVM/",
            "url": "http://yoursite.com/interview/JVM/",
            "title": "JVM常见面试题",
            "date_published": "2022-10-28T16:00:00.000Z",
            "content_html": "<h2 id=\"什么是jvm\"><a class=\"anchor\" href=\"#什么是jvm\">#</a> 什么是 JVM</h2>\n<p>JVM 是 java 代码运行的平台，他帮助我们的代码一次编译到处运行</p>\n<h2 id=\"类加载过程\"><a class=\"anchor\" href=\"#类加载过程\">#</a> 类加载过程</h2>\n<p>字节码 ——&gt; ClassLoader 类加载 ——&gt; Linking （ 格式检查、 静态成员变量附默认值、resolution [符号引用 ——&gt; 直接引用]）——&gt; init 初始化 ——&gt;  UIsing 对象使用  ——&gt;  GC 回收</p>\n<h2 id=\"双亲委派是什么\"><a class=\"anchor\" href=\"#双亲委派是什么\">#</a> 双亲委派是什么？</h2>\n<p>我们在加载一个类对象的时候，要经过类加载器。</p>\n<p>类加载器分为 4 种 ，分别为：自定义类加载器（ConsumerClassLoader）、系统类加载器（APP）【classpath】、扩展类加载器（ex）【找的是 JAVA_HOME/jre/lib】、启动类加载器（bootstrap）【找的是 JAVA_HOME/lib】</p>\n<p>我们加载的时候，一般都是从最下方的自定义加载器向上查找到启动类加载器，当然前提是有自定义类加载器，加载过程中会首先判断这个类加载器是否能存在这个类的缓存，存在就直接返回结果，不存在它就会向上委托，交由上层加载器加载，直至启动类加载器，如果这里也没有缓存，就要自己生成了，这时候启动类加载器就开始判断他是否可以生成，能生成就直接返回结果即可，不能生成就委托与下层加载器，直至生成，如果最后了都没找到可以生成这个类的类加载器就返回 <code>Class Not Found Exception</code></p>\n<h2 id=\"如何打破双亲委派\"><a class=\"anchor\" href=\"#如何打破双亲委派\">#</a> 如何打破双亲委派？</h2>\n<p>JDK1.2 之前，自定义 ClassLoader 都必须重写 loadClass ()</p>\n<p>ThreadContextClassLoader 可以实现基础类调用实现类代码，通过 thread.setContextClassLoader 指定</p>\n<p>简单来说就是用自定义的 ClassLoader 即可，但是大多是情况不建议打破</p>\n<h2 id=\"jvm的内存模型\"><a class=\"anchor\" href=\"#jvm的内存模型\">#</a> JVM 的内存模型</h2>\n<ol>\n<li>\n<p>PC 程序计数器：记录程序运行到哪里一步，只增不减</p>\n</li>\n<li>\n<p>JVM 栈：存储基本类型和引用地址</p>\n</li>\n<li>\n<p>本地方法栈（不关注）</p>\n</li>\n<li>\n<p>堆：存储所有的引用类型</p>\n</li>\n<li>\n<p>方法区：</p>\n<ul>\n<li>\n<p>在 jdk  &lt;=  1.7 ：永久区，永久代</p>\n<p>本质上，方法区和永久代并不等价，永久代的数据在 FUllGC 也会删除，他不会，所以会导致 OOM。</p>\n<p>大小启动的时候指定，不能变</p>\n</li>\n<li>\n<p>在 jdk  》  1.8 ：元数据区，元空间</p>\n<p>元空间不再虚拟机设置的内存当中，而是使用本地内存。在 FULLGC 也会删除。</p>\n<p>不设定的话，最大就是物理内存</p>\n</li>\n</ul>\n</li>\n</ol>\n<h2 id=\"jvm中那些是线程独享那些是共享的\"><a class=\"anchor\" href=\"#jvm中那些是线程独享那些是共享的\">#</a> JVM 中那些是线程独享，那些是共享的？</h2>\n<ol>\n<li>JVM 中 每个线程都有一个 PC、JVM stack 、NMS</li>\n<li>JVM 中 所有线程共享 ：堆内存，方法区</li>\n</ol>\n<h2 id=\"永久区和元空间的区别\"><a class=\"anchor\" href=\"#永久区和元空间的区别\">#</a> 永久区和元空间的区别</h2>\n<ol>\n<li>字符串常量池 ——&gt; 永久代有；元空间 没有，放在了堆内存中</li>\n<li>GC——&gt; 永久代不会被 FullGC  ; 会被 FUGC</li>\n<li>内存：永久代启动时设定，且不能改；元空间时代不设定最大就是物理内存</li>\n</ol>\n<h2 id=\"如何确定一个垃圾\"><a class=\"anchor\" href=\"#如何确定一个垃圾\">#</a> 如何确定一个垃圾</h2>\n<p>如果这个内存没有任何的引用，他就是一个垃圾</p>\n<ol start=\"9\">\n<li>确认垃圾的方式\n<ol>\n<li>根的可达性分析</li>\n<li>引用计数法</li>\n</ol>\n</li>\n</ol>\n<p>解释：</p>\n<ul>\n<li>\n<p>根的可达性分析，可选择作为根的：</p>\n<p>(1). <span class=\"exturl\" data-url=\"aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/cT0lRTglOTklOUElRTYlOEIlOUYlRTYlOUMlQkEmYW1wO3NwbT0xMDAxLjIxMDEuMzAwMS43MDIw\">虚拟机</span>栈（栈帧中的局部变量区，也叫做局部变量表）中引用的对象。</p>\n<p>(2). 方法区中的类静态属性引用的对象。</p>\n<p>(3). 方法区中常量引用的对象。</p>\n<p>(4). 本地方法栈中 JNI (<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/cT1OYXRpdmUmYW1wO3NwbT0xMDAxLjIxMDEuMzAwMS43MDIw\">Native</span> 方法) 引用的对象。</p>\n<p><strong>基本思路</strong>：通过一系列名为”GC Roots” 的对象作为起始点，从这些节点开始向下搜索，搜索所走过的路径称为引用链 (Reference Chain)，当一个对象到 GC Roots 没有任何引用链相连时，则证明此对象是不可用的</p>\n</li>\n<li>\n<p>引用计数法</p>\n<p>其实就是去看这个对象是否被引用没有被引用那就是垃圾，最简单的</p>\n</li>\n</ul>\n<h2 id=\"常见的垃圾回收算法\"><a class=\"anchor\" href=\"#常见的垃圾回收算法\">#</a> 常见的垃圾回收算法</h2>\n<ol>\n<li>标记清除</li>\n<li>标记复制算法</li>\n<li>标记整理</li>\n</ol>\n<p>具体解释：</p>\n<ul>\n<li>\n<p>标记清除</p>\n<p>标记清除简单来看就是两步，标记和清除，是垃圾就标记，然后清理掉，简单粗暴，但是有个问题就是导致我们的空间碎片化，位置不连续。</p>\n</li>\n<li>\n<p>标记复制算法</p>\n<p>同样两步，这个标记前将我们的空间分成两部分，将垃圾和非垃圾的标记出来，然后分别放入我们之前划分好的空间，这样就避免了空间碎片化的问题，但是有一个新问题，我们浪费了空间。</p>\n</li>\n<li>\n<p>标记整理、标记压缩</p>\n<p>步骤同复制算法一致，但是后续步骤不是直接对可回收对象进行清理，而是让所有存活的对象都向一端移动，然后直接清理掉端边界以外的内存。</p>\n<p>其实上述过程相对 &quot;复制算法&quot; 来讲，少了一个 &quot; 保留区，但是要多出一个临时空间，要保证被使用的对象要存活。老年代一般不这样做。</p>\n</li>\n</ul>\n\n<div id=\"gitalk-container\"></div>\n<script src=\"https://cdn.bootcss.com/blueimp-md5/2.12.0/js/md5.min.js\"></script><link rel=\"stylesheet\" href=\"https://unpkg.com/gitalk/dist/gitalk.css\"><script src=\"https://unpkg.com/gitalk/dist/gitalk.min.js\"></script>\n\n\t\t<script>\n\t\tvar gitalkConfig = {\"clientID\":\"6db178ba46c8af8f6a6f\",\"clientSecret\":\"90f730e5956024596558df00975cd8eae28cae3d\",\"repo\":\"bk-comment01\",\"owner\":\"onlymarryu\",\"admin\":[\"onlymarryu\"],\"distractionFreeMode\":false,\"language\":\"zh-CN\",\"proxy\":\"https://gitalk-comments.netlify.app/github_access_token\",\"perPage\":15};\n\t    gitalkConfig.id = md5(location.pathname);\n\t\tvar gitalk = new Gitalk(gitalkConfig);\n\t    gitalk.render(\"gitalk-container\");\n\t    </script>",
            "tags": [
                ".面试题",
                "面试题"
            ]
        },
        {
            "id": "http://yoursite.com/toolsPage/%E5%B8%B8%E7%94%A8Typeroa%E6%A0%BC%E5%BC%8F/",
            "url": "http://yoursite.com/toolsPage/%E5%B8%B8%E7%94%A8Typeroa%E6%A0%BC%E5%BC%8F/",
            "title": "常用Typeroa格式",
            "date_published": "2022-10-28T16:00:00.000Z",
            "content_html": "<h1 id=\"改变字体颜色\"><a class=\"anchor\" href=\"#改变字体颜色\">#</a> 改变字体颜色</h1>\n<figure class=\"highlight html\"><figcaption data-lang=\"HTML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>font</span> <span class=\"token attr-name\">color</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">size</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>5px<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">></span></span>12313132132121213213212132<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>font</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>颜色自己填、大小默认 5px，可以自己修改，常用色：</p>\n<ul>\n<li><font color=\"red\" size=\"5px\" >红色</font></li>\n</ul>\n<figure class=\"highlight html\"><figcaption data-lang=\"HTML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>font</span> <span class=\"token attr-name\">color</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>red<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">size</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>5px<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">></span></span>12313132132121213213212132<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>font</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><ul>\n<li><font color=\"#1BD665\" size=\"5px\" >绿色</font></li>\n</ul>\n<figure class=\"highlight html\"><figcaption data-lang=\"HTML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>font</span> <span class=\"token attr-name\">color</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>#1BD665<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">size</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>5px<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">></span></span>12313132132121213213212132<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>font</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><ul>\n<li><font color=\"blue\" size=\"5px\" >蓝色</font></li>\n</ul>\n<figure class=\"highlight html\"><figcaption data-lang=\"HTML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>font</span> <span class=\"token attr-name\">color</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>blue<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">size</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>5px<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">></span></span>12313132132121213213212132<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>font</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><h1 id=\"图片-内容居中\"><a class=\"anchor\" href=\"#图片-内容居中\">#</a> 图片、内容居中</h1>\n<div style=\" align-items: Center;justify-content: center;\" >\n    <img data-src=\"https://cdn.jsdelivr.net/gh/onlymarryu/typora-ims-test@master/123.png\" >\n</div>\n<figure class=\"highlight html\"><figcaption data-lang=\"HTML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token special-attr\"><span class=\"token attr-name\">style</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span> align-items: Center;justify-content: center;<span class=\"token punctuation\">\"</span></span></span> <span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><h1 id=\"内容文本内折叠\"><a class=\"anchor\" href=\"#内容文本内折叠\">#</a> 内容文本内折叠</h1>\n<p><mark><strong>注意：目前，只有 Chrome 和 Safari 6 支持 details 标签。</strong></mark></p>\n<details>     \n    <summary>标题1</summary>\n    <p >内容 1 </p>\n    <p >内容 2 </p>\n    <p >内容 3 </p>\n    <p >内容 4 </p>\n    <p >内容 5 </p>\n</details>\n<figure class=\"highlight html\"><figcaption data-lang=\"HTML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>details</span><span class=\"token punctuation\">></span></span>     </pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>summary</span><span class=\"token punctuation\">></span></span>标题1<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>summary</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span> <span class=\"token punctuation\">></span></span>内容 1 <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span> <span class=\"token punctuation\">></span></span>内容 2 <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span> <span class=\"token punctuation\">></span></span>内容 3 <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span> <span class=\"token punctuation\">></span></span>内容 4 <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span> <span class=\"token punctuation\">></span></span>内容 5 <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>details</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure>\n<div id=\"gitalk-container\"></div>\n<script src=\"https://cdn.bootcss.com/blueimp-md5/2.12.0/js/md5.min.js\"></script><link rel=\"stylesheet\" href=\"https://unpkg.com/gitalk/dist/gitalk.css\"><script src=\"https://unpkg.com/gitalk/dist/gitalk.min.js\"></script>\n\n\t\t<script>\n\t\tvar gitalkConfig = {\"clientID\":\"6db178ba46c8af8f6a6f\",\"clientSecret\":\"90f730e5956024596558df00975cd8eae28cae3d\",\"repo\":\"bk-comment01\",\"owner\":\"onlymarryu\",\"admin\":[\"onlymarryu\"],\"distractionFreeMode\":false,\"language\":\"zh-CN\",\"proxy\":\"https://gitalk-comments.netlify.app/github_access_token\",\"perPage\":15};\n\t    gitalkConfig.id = md5(location.pathname);\n\t\tvar gitalk = new Gitalk(gitalkConfig);\n\t    gitalk.render(\"gitalk-container\");\n\t    </script>",
            "tags": []
        },
        {
            "id": "http://yoursite.com/Distribution/zookeeper/",
            "url": "http://yoursite.com/Distribution/zookeeper/",
            "title": "Zookeeper",
            "date_published": "2022-10-28T12:37:30.000Z",
            "content_html": "<h1 id=\"课程内容的介绍\"><a class=\"anchor\" href=\"#课程内容的介绍\">#</a> 课程内容的介绍</h1>\n<ol>\n<li>Zookeeper 的介绍和安装</li>\n<li>Zookeeper 客户端使用</li>\n<li>ZookeeperJavaAPI 使用</li>\n</ol>\n<h1 id=\"一-zookeeper的介绍和安装\"><a class=\"anchor\" href=\"#一-zookeeper的介绍和安装\">#</a> 一、Zookeeper 的介绍和安装</h1>\n<h2 id=\"1-为什么要使用zookeeper\"><a class=\"anchor\" href=\"#1-为什么要使用zookeeper\">#</a> 1. 为什么要使用 Zookeeper</h2>\n<p>​       我们为了学习 Dubbo，而在 dubbo 中需要一个注册中心，而 Zookeeper 是我们在使用 Dubbo 是官方推荐的注册中心，所以我们先来介绍 Zookeeper</p>\n<img data-src=\"/Distribution/zookeeper/image-20210226191457919.png\" class=\"\" title=\"image-20210226191457919\">\n<img data-src=\"/Distribution/zookeeper/image-20210226191530528.png\" class=\"\" title=\"image-20210226191530528\">\n<h2 id=\"2-zookeeper介绍\"><a class=\"anchor\" href=\"#2-zookeeper介绍\">#</a> 2. Zookeeper 介绍</h2>\n<img data-src=\"/Distribution/zookeeper/image-20210226192111730.png\" class=\"\" title=\"image-20210226192111730\">\n<h3 id=\"21-zookeeper概述\"><a class=\"anchor\" href=\"#21-zookeeper概述\">#</a> 2.1 Zookeeper 概述</h3>\n<p>ZooKeeper 是一个分布式的，开放源码的分布式应用程序协调服务，是 Google 的 Chubby 一个开源的实现，是 Hadoop 和 Hbase 的重要组件。它是一个为分布式应用提供一致性服务的软件，提供的功能包括：配置维护、域名服务、分布式同步、组服务等。<br />\n  Zookeeper 是一个分布式协调服务；就是为用户的分布式应用程序提供协调服务</p>\n<table>\n<thead>\n<tr>\n<th>序号</th>\n<th>功能</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>为别的分布式程序服务的</td>\n</tr>\n<tr>\n<td>2</td>\n<td>本身就是一个分布式程序</td>\n</tr>\n<tr>\n<td>3</td>\n<td>主从协调 服务器节点动态上下线 统一配置管理 分布式共享锁 统一名称服务</td>\n</tr>\n<tr>\n<td>4</td>\n<td>管理 (存储，读取) 用户程序提交的数据 并为用户程序提供数据节点监听服务</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"22-zookeeper的集群机制\"><a class=\"anchor\" href=\"#22-zookeeper的集群机制\">#</a> 2.2 Zookeeper 的集群机制</h3>\n<p>Zookeeper 是为其他分布式程序提供服务的，所以本身自己不能随便就挂了，所以 zookeeper 自身的集群机制就很重要。zookeeper 的集群机制采用的是<strong>半数存活机制</strong>，也就是整个集群节点中有半数以上的节点存活，那么整个集群环境可用。这也就是说们的集群节点最好是奇数个节点。</p>\n<p><strong>Zookeeper 集群节点的角色</strong></p>\n<p><strong>Leader</strong></p>\n<p>Leader 服务器是 Zookeeper 集群工作的核心，其主要工作如下</p>\n<ol>\n<li>事务请求的唯一调度和处理者，保证集群事务处理的顺序性。</li>\n<li>集群内部各服务器的调度者</li>\n</ol>\n<p><strong>Follower</strong></p>\n<p>Follower 是 Zookeeper 集群的跟随者，其主要工作如下</p>\n<ol>\n<li>处理客户端非事务性请求（读取数据），转发事务请求给 Leader 服务器。</li>\n<li>参与事务请求 Proposal 的投票。</li>\n<li>参与 Leader 选举投票。</li>\n</ol>\n<p><strong>Observer</strong><br />\n  Observer 充当观察者角色，观察 Zookeeper 集群的最新状态变化并将这些状态同步过来，其对于非事务请求可以进行独立处理，对于事务请求，则会转发给 Leader 服务器进行处理。Observer 不会参与任何形式的投票，包括事务请求 Proposal 的投票和 Leader 选举投票</p>\n<h2 id=\"3-集群环境准备\"><a class=\"anchor\" href=\"#3-集群环境准备\">#</a> 3. 集群环境准备</h2>\n<p>​       通过上面的介绍我们了解到 zookeeper 的集群环境应该配置奇数个节点，所以我们在本文中搭建的 zookeeper 环境准备在 3 个节点上搭建。接下来我们介绍下需要准备的环境。</p>\n<h3 id=\"31-准备3个节点\"><a class=\"anchor\" href=\"#31-准备3个节点\">#</a> 3.1 准备 3 个节点</h3>\n<p>​     准备 3 个 centos7.0 的虚拟机节点，并且安装配置好 JDK 版本最好是 8. 不清楚的可参考此地址<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NTI2NTczL2FydGljbGUvZGV0YWlscy84Njc3NzE2Mw==\"> Linux 之 jdk 安装</span>，并配置好相关的网络配置。</p>\n<table>\n<thead>\n<tr>\n<th>ip</th>\n<th>主机名</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>192.168.100.120</td>\n<td>bobo01</td>\n</tr>\n<tr>\n<td>192.168.100.121</td>\n<td>bobo02</td>\n</tr>\n<tr>\n<td>192.168.100.122</td>\n<td>bobo03</td>\n</tr>\n</tbody>\n</table>\n<p>通过 VMware 的克隆或者直接复制文件夹的方式来创建另外两个新的节点</p>\n<h3 id=\"32-网络配置\"><a class=\"anchor\" href=\"#32-网络配置\">#</a> 3.2 网络配置</h3>\n<p>修改 ifcfg-ens33 配置文件</p>\n<img data-src=\"/Distribution/zookeeper/image-20210228125047032.png\" class=\"\" title=\"image-20210228125047032\">\n<p>重启网络服务</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">service</span> network restart</pre></td></tr></table></figure><p>ping 测试</p>\n<img data-src=\"/Distribution/zookeeper/image-20210228125219258.png\" class=\"\" title=\"image-20210228125219258\">\n<p>三个节点的网络配置都 ok 的化我们就可以通过 XShell 来连接了</p>\n<h3 id=\"33-节点的映射关系\"><a class=\"anchor\" href=\"#33-节点的映射关系\">#</a> 3.3 节点的映射关系</h3>\n<p>每个节点设置相应的 ip 和主机名的映射关系，方便集群环境的部署</p>\n<p>修改 hosts 配置文件中的信息</p>\n<img data-src=\"/Distribution/zookeeper/image-20210228130055348.png\" class=\"\" title=\"image-20210228130055348\">\n<h3 id=\"34-配置免密登录\"><a class=\"anchor\" href=\"#34-配置免密登录\">#</a> 3.4 配置免密登录</h3>\n<p>生成公钥和私钥</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>ssh-keygen</pre></td></tr></table></figure><p>输入命令后根据提示，四次回车即可</p>\n<img data-src=\"/Distribution/zookeeper/image-20210228130543258.png\" class=\"\" title=\"image-20210228130543258\">\n<p>发送公钥给需要免密登录的节点</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>ssh-copy-id bobo01</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>ssh-copy-id bobo02</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>ssh-copy-id bobo03</pre></td></tr></table></figure><img data-src=\"/Distribution/zookeeper/image-20210228130833067.png\" class=\"\" title=\"image-20210228130833067\">\n<p>节点和节点发送文件通过 scp 命令实现</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">scp</span> <span class=\"token parameter variable\">-r</span> b.txt bobo01:/root/</pre></td></tr></table></figure><img data-src=\"/Distribution/zookeeper/image-20210228131239060.png\" class=\"\" title=\"image-20210228131239060\">\n<h3 id=\"35-关闭防火墙\"><a class=\"anchor\" href=\"#35-关闭防火墙\">#</a> 3.5 关闭防火墙</h3>\n<p>查看防火墙状态</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>firewall-cmd <span class=\"token parameter variable\">--state</span></pre></td></tr></table></figure><p>停止防火墙</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>systemctl stop firewall.service</pre></td></tr></table></figure><p>禁止开机启动</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>systemctl disable firewall.service</pre></td></tr></table></figure><h2 id=\"4-zookeeper集群环境搭建\"><a class=\"anchor\" href=\"#4-zookeeper集群环境搭建\">#</a> 4. Zookeeper 集群环境搭建</h2>\n<h3 id=\"41-获取安装文件\"><a class=\"anchor\" href=\"#41-获取安装文件\">#</a> 4.1 获取安装文件</h3>\n<p>下载地址:<span class=\"exturl\" data-url=\"aHR0cHM6Ly9taXJyb3JzLmJmc3UuZWR1LmNuL2FwYWNoZS96b29rZWVwZXIv\">https://mirrors.bfsu.edu.cn/apache/zookeeper/</span></p>\n<p>通过 wget 命令将安装文件下载到 opt 目录下</p>\n<p>注意：</p>\n<p>apache-zookeeper-3.5.9-bin.tar.gz 和 apache-zookeeper-3.5.9.tar.gz 的区别 -bin 是编译后的文件 我们用这个</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">wget</span> https://mirrors.bfsu.edu.cn/apache/zookeeper/zookeeper-3.5.9/apache-zookeeper-3.5.9-bin.tar.gz</pre></td></tr></table></figure><img data-src=\"/Distribution/zookeeper/image-20210228135143823.png\" class=\"\" title=\"image-20210228135143823\">\n<p>解压缩文件</p>\n<img data-src=\"/Distribution/zookeeper/image-20210228135240561.png\" class=\"\" title=\"image-20210228135240561\">\n<p>进入 Zookeeper 目录</p>\n<img data-src=\"/Distribution/zookeeper/image-20210228135417463.png\" class=\"\" title=\"image-20210228135417463\">\n<h3 id=\"42-修改配置\"><a class=\"anchor\" href=\"#42-修改配置\">#</a> 4.2 修改配置</h3>\n<p>修改 zoo.cfg 文件，系统默认的名称是 zoo_smple.cfg 我们需要重命名为 zoo.cfg</p>\n<img data-src=\"/Distribution/zookeeper/image-20210228135552375.png\" class=\"\" title=\"image-20210228135552375\">\n<p>修改 cfg 的内容</p>\n<p>修改了两块：</p>\n<p>1 是 Zookeeper 中存储数据的文件夹，还有就是 Zookeeper 集群环境节点信息</p>\n<img data-src=\"/Distribution/zookeeper/image-20210228135948719.png\" class=\"\" title=\"image-20210228135948719\">\n<p>配置 myid 文件</p>\n<p>​     我们需要在 Zookeeper 的数据存储的目录中创建一个 myid 文件，文件中的内容只有一行信息，即表示我们集群几点的标识，范围是 1-255，每个节点的 myid 的数字和我们在 zoo.cfg 中配置的 server. 数字是对应的</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">1</span></pre></td></tr></table></figure><h3 id=\"43-分发文件\"><a class=\"anchor\" href=\"#43-分发文件\">#</a> 4.3 分发文件</h3>\n<p>​     当我们配置好了一个 Zookeeper 节点后，我们就可以将 Zookeeper 文件夹分发给其他几个节点了</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">scp</span> <span class=\"token parameter variable\">-r</span> zookeeper bobo02:<span class=\"token variable\"><span class=\"token variable\">`</span><span class=\"token builtin class-name\">pwd</span><span class=\"token variable\">`</span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">scp</span> <span class=\"token parameter variable\">-r</span> zookeeper bobo03:<span class=\"token variable\"><span class=\"token variable\">`</span><span class=\"token builtin class-name\">pwd</span><span class=\"token variable\">`</span></span></pre></td></tr></table></figure><p>分发成功后我们需要修改各个节点中的 myid 的信息为配置文件中对应的数字</p>\n<h3 id=\"44-启动测试\"><a class=\"anchor\" href=\"#44-启动测试\">#</a> 4.4 启动测试</h3>\n<p>整个集群环境都配置好了之后我们就可以测试启动了</p>\n<p>启动命令</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>./bin/zkServer.sh start</pre></td></tr></table></figure><p>当我们仅仅启动一个节点的时候，因为半数存活机制，3 个节点只启动一个节点是没有效果的，</p>\n<img data-src=\"/Distribution/zookeeper/image-20210228151546411.png\" class=\"\" title=\"image-20210228151546411\">\n<p>当我们启动第二个节点后发现集群环境可以使用了</p>\n<img data-src=\"/Distribution/zookeeper/image-20210228151658522.png\" class=\"\" title=\"image-20210228151658522\">\n<p>然后第一个节点的状态也改变了</p>\n<img data-src=\"/Distribution/zookeeper/image-20210228151723421.png\" class=\"\" title=\"image-20210228151723421\">\n<p>然后再把第三个节点也启动起来</p>\n<img data-src=\"/Distribution/zookeeper/image-20210228151751891.png\" class=\"\" title=\"image-20210228151751891\">\n<h2 id=\"5-zookeeper的选举机制\"><a class=\"anchor\" href=\"#5-zookeeper的选举机制\">#</a> 5. Zookeeper 的选举机制</h2>\n<p>为什么要进行 Leader 选举？<br />\nLeader 主要作用是保证分布式数据一致性，即每个节点的存储的数据同步。遇到以下两种情况需要进行 Leader 选举</p>\n<ul>\n<li>服务器初始化启动</li>\n<li>服务器运行期间无法和 Leader 保持连接，Leader 节点崩溃，逻辑时钟崩溃。</li>\n</ul>\n<h3 id=\"51-服务器初始化时leader选举\"><a class=\"anchor\" href=\"#51-服务器初始化时leader选举\">#</a> 5.1 服务器初始化时 Leader 选举</h3>\n<p>Zookeeper 由于其自身的性质，一般建议选取奇数个节点进行搭建分布式服务器集群。以 3 个节点组成的服务器集群为例，说明服务器初始化时的选举过程。启动第一台安装 Zookeeper 的节点时，无法单独进行选举，启动第二台时，两节点之间进行通信，开始选举 Leader。</p>\n<ol>\n<li>\n<p>每个 Server 投出一票。他们两都选自己为 Leader，投票的内容为（SID，ZXID）。<br />\nSID 即 Server 的 id，安装 zookeeper 时配置文件中所配置的 myid；ZXID，事务 id，<br />\n为节点的更新程度，ZXID 越大，代表 Server 对 Znode 的操作越新。由于服务器初始化，<br />\n每个 Sever 上的 Znode 为 0，所以 Server1 投的票为（1,0），Server2 为（2,0）。<br />\n两 Server 将各自投票发给集群中其他机器。</p>\n</li>\n<li>\n<p>每个 Server 接收来自其他 Server 的投票。集群中的每个 Server 先判断投票有效性，<br />\n如检查是不是本轮的投票，是不是来 Looking 状态的服务器投的票。</p>\n</li>\n<li>\n<p>对投票结果进行处理。先了解下处理规则</p>\n</li>\n</ol>\n<ul>\n<li>\n<p>首先对比 ZXID。ZXID 大的服务器优先作为 Leader</p>\n</li>\n<li>\n<p>若 ZXID 相同，比如初始化的时候，每个 Server 的 ZXID 都为 0，</p>\n</li>\n<li>\n<p>就会比较 myid，myid 大的选出来做 Leader。</p>\n<p>对于 Server 而言，他接受到的投票为（2,0），因为自身的票为（1,0），所以此时它会选举 Server2 为 Leader，<br />\n将自己的更新为（2,0）。而 Server2 收到的投票为 Server1 的（1,0）由于比他自己小，<br />\nServer2 的投票不变。Server1 和 Server2 再次将票投出，投出的票都为（2,0）。</p>\n</li>\n</ul>\n<ol start=\"4\">\n<li>\n<p>统计投票。每次投票之后，服务器都会统计投票信息，如果判定某个 Server 有过半的票数投它，<br />\n那么该 Server 将会作为 Leader。对于 Server1 和 Server2 而言，统计出已经有两台机器接收了（2,0）的投票信息，<br />\n此时认为选出了 Leader。</p>\n</li>\n<li>\n<p>改变服务器状态。当确定了 Leader 之后，每个 Server 更新自己的状态，<br />\nLeader 将状态更新为 Leading，Follower 将状态更新为 Following。</p>\n</li>\n</ol>\n<img data-src=\"/Distribution/zookeeper/image-20210301104123274.png\" class=\"\" title=\"image-20210301104123274\">\n<h3 id=\"52-服务器运行期间的leader选举\"><a class=\"anchor\" href=\"#52-服务器运行期间的leader选举\">#</a> 5.2 服务器运行期间的 Leader 选举</h3>\n<p>Zookeeper 运行期间，如果有新的 Server 加入，或者非 Leader 的 Server 宕机，那么 Leader 将会同步数据到新 Server 或者寻找其他备用 Server 替代宕机的 Server。若 Leader 宕机，此时集群暂停对外服务，开始在内部选举新的 Leader。假设当前集群中有 Server1、Server2、Server3 三台服务器，Server2 为当前集群的 Leader，由于意外情况，Server2 宕机了，便开始进入选举状态。过程如下</p>\n<ol>\n<li>\n<p>变更状态。其他的非 Observer 服务器将自己的状态改变为 Looking，开始进入 Leader 选举。</p>\n</li>\n<li>\n<p>每个 Server 发出一个投票（myid，ZXID），由于此集群已经运行过，所以每个 Server 上的 ZXID 可能不同。<br />\n假设 Server1 的 ZXID 为 145，Server3 的为 122，第一轮投票中，Server1 和 Server3 都投自己，<br />\n票分别为（1，145）、（3,122）, 将自己的票发送给集群中所有机器。</p>\n</li>\n<li>\n<p>每个 Server 接收接收来自其他 Server 的投票，接下来的步骤与初始化时相同。</p>\n</li>\n</ol>\n<h1 id=\"二-zookeeper客户端使用\"><a class=\"anchor\" href=\"#二-zookeeper客户端使用\">#</a> 二、Zookeeper 客户端使用</h1>\n<h2 id=\"1-配置zookeeper的环境变量\"><a class=\"anchor\" href=\"#1-配置zookeeper的环境变量\">#</a> 1. 配置 Zookeeper 的环境变量</h2>\n<p>​     为了简化我们每次操作 Zookeeper 而不用进入到 Zookeeper 的安装目录，我们可以将 Zookeeper 的安装信息配置到系统的环境变量中</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">vim</span> /etc/profile</pre></td></tr></table></figure><p>添加的内容</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">ZOOKEPPER_HOME</span><span class=\"token operator\">=</span>/opt/zookeeper</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\"><span class=\"token environment constant\">PATH</span></span><span class=\"token operator\">=</span><span class=\"token environment constant\">$PATH</span><span class=\"token builtin class-name\">:</span><span class=\"token variable\">$ZOOKEEPER_HOME</span>/bin</pre></td></tr></table></figure><p>执行 source 命令</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">source</span> /etc/profile</pre></td></tr></table></figure><p>我们就可以在节点的任意位置操作 Zookeeper 了</p>\n<p>通过 scp 命令将 profile 文件发送到其他几个节点上</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">scp</span> /etc/profile bobo02:/etc/</pre></td></tr></table></figure><h2 id=\"2客户端连接\"><a class=\"anchor\" href=\"#2客户端连接\">#</a> 2. 客户端连接</h2>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL3huLS1iaW56a0NsaS13MzlsdzE0bGxrM2NqYmJ0ODhxZzdhLnNo\">通过 bin 目录下的 zkCli.sh</span> 命令连接即可</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>zkCli.sh</pre></td></tr></table></figure><img data-src=\"/Distribution/zookeeper/image-20210301110004402.png\" class=\"\" title=\"image-20210301110004402\">\n<p>zkCli.sh 默认连接的是当前节点的 Zookeeper 节点，如果我们要连接其他节点执行如下命令即可</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>zkCli.sh <span class=\"token parameter variable\">-timeout</span> <span class=\"token number\">5000</span> <span class=\"token parameter variable\">-server</span> bobo02:2181</pre></td></tr></table></figure><img data-src=\"/Distribution/zookeeper/image-20210301110253746.png\" class=\"\" title=\"image-20210301110253746\">\n<h2 id=\"3数据操作\"><a class=\"anchor\" href=\"#3数据操作\">#</a> 3. 数据操作</h2>\n<h3 id=\"31-zookeeper的数据结构\"><a class=\"anchor\" href=\"#31-zookeeper的数据结构\">#</a> 3.1 Zookeeper 的数据结构</h3>\n<ol>\n<li>层次化的目录结构，命名符合常规文件系统规范</li>\n<li>每个节点在 Zookeeper 中叫做 znode，并且有一个唯一的路径标识</li>\n<li>节点 znode 可以包含数据和子节点（但是 EPHEMERAL 类型的节点不能有子节点）</li>\n<li>客户端应用可以在节点上设置监听器</li>\n</ol>\n<img data-src=\"/Distribution/zookeeper/image-20210301113558950.png\" class=\"\" title=\"image-20210301113558950\">\n<h3 id=\"32-节点类型\"><a class=\"anchor\" href=\"#32-节点类型\">#</a> 3.2 节点类型</h3>\n<p><strong>1).znode 有两种类型：</strong></p>\n<p>短暂性（ephemeral）（断开连接自己删除）<br />\n持久性（persistent）（断开连接不删除）</p>\n<p><strong>2).znode 有四种形式的目录节点（默认是 persistent）如下</strong></p>\n<table>\n<thead>\n<tr>\n<th>序号</th>\n<th>节点类型</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>PERSISTENT</td>\n<td>持久节点</td>\n</tr>\n<tr>\n<td>2</td>\n<td>PERSISTENT_SEQUENTIAL</td>\n<td>持久有序节点</td>\n</tr>\n<tr>\n<td>3</td>\n<td>EPHEMERAL</td>\n<td>短暂节点</td>\n</tr>\n<tr>\n<td>4</td>\n<td>EPHEMERAL_SEQUENTIAL</td>\n<td>短暂有序节点</td>\n</tr>\n</tbody>\n</table>\n<p>​         创建 znode 时设置顺序标识，znode 名称后会附加一个值，顺序号是一个单调递增的计数器，有父节点维护<br />\n在分布式系统中，顺序号可以被用于为所有的事件进行全局排序，这样客户端可以通过顺序号推断事件的顺序</p>\n<h3 id=\"33-常用命令\"><a class=\"anchor\" href=\"#33-常用命令\">#</a> 3.3 常用命令</h3>\n<p>​       Zookeeper 作为 Dubbo 的注册中心用来保存我们各个服务的节点信息，显示 Zookeeper 是可以实现输出的存储操作的，我们来看下 Zookeeper 中存储操作的基本命令</p>\n<img data-src=\"/Distribution/zookeeper/image-20210301115013270.png\" class=\"\" title=\"image-20210301115013270\">\n<p><strong>ls</strong></p>\n<p>​    ls 用来查看某个节点下的子节点信息</p>\n<img data-src=\"/Distribution/zookeeper/image-20210301114751517.png\" class=\"\" title=\"image-20210301114751517\">\n<p>增强的命令，查看节点下的子节点及当前节点的属性信息 ls2 或者 ls -s 命令</p>\n<img data-src=\"/Distribution/zookeeper/image-20210301114914215.png\" class=\"\" title=\"image-20210301114914215\">\n<p><strong>create</strong></p>\n<p>​     创建节点信息</p>\n<img data-src=\"/Distribution/zookeeper/image-20210301114945149.png\" class=\"\" title=\"image-20210301114945149\">\n<p><strong>get</strong></p>\n<p>​    get 命令用来查看节点的数据</p>\n<img data-src=\"/Distribution/zookeeper/image-20210301115127622.png\" class=\"\" title=\"image-20210301115127622\">\n<p>如果要查看节点的属性信息那么我们可以通过 get -s 来实现</p>\n<img data-src=\"/Distribution/zookeeper/image-20210301115623726.png\" class=\"\" title=\"image-20210301115623726\">\n<p><strong>delete</strong></p>\n<p>​    delete 只能删除没有子节点的节点要删除非空节点可以通过 rmr 或者 deleteall 命令实现</p>\n<img data-src=\"/Distribution/zookeeper/image-20210301115752831.png\" class=\"\" title=\"image-20210301115752831\">\n<p><strong>set</strong></p>\n<p>​    set 命令可以用来修改节点的内容。</p>\n<img data-src=\"/Distribution/zookeeper/image-20210301115841724.png\" class=\"\" title=\"image-20210301115841724\">\n<h3 id=\"34-事件监听\"><a class=\"anchor\" href=\"#34-事件监听\">#</a> 3.4 事件监听</h3>\n<h4 id=\"341-数据改变的监听\"><a class=\"anchor\" href=\"#341-数据改变的监听\">#</a> 3.4.1 数据改变的监听</h4>\n<p>​      监听某个节点的数据内容变化，通过 get 命令 带 -w 参数即可，在 3.4 版本的 Zookeeper 中是通过 <code>get path watch</code>  来说实现监控的</p>\n<img data-src=\"/Distribution/zookeeper/image-20210301135116352.png\" class=\"\" title=\"image-20210301135116352\">\n<p>然后我们在其他节点上修改 app1 节点的数据，会触监听事件</p>\n<img data-src=\"/Distribution/zookeeper/image-20210301135159833.png\" class=\"\" title=\"image-20210301135159833\">\n<img data-src=\"/Distribution/zookeeper/image-20210301135216095.png\" class=\"\" title=\"image-20210301135216095\">\n<p>注意监听一次节点只会触发一次，如果要实现多次监听，那么可以在触发事件的处理函数中再次追加对节点的监听操作</p>\n<h4 id=\"342-子节点的改变\"><a class=\"anchor\" href=\"#342-子节点的改变\">#</a> 3.4.2 子节点的改变</h4>\n<p>​     监听节点下面的子节点的改变。</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>zk: localhost:2181<span class=\"token punctuation\">(</span>CONNECTED<span class=\"token punctuation\">)</span> <span class=\"token number\">14</span><span class=\"token punctuation\">]</span> <span class=\"token function\">ls</span> <span class=\"token parameter variable\">-w</span> /app1</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr></table></figure><p>触发</p>\n<img data-src=\"/Distribution/zookeeper/image-20210301135538966.png\" class=\"\" title=\"image-20210301135538966\">\n<img data-src=\"/Distribution/zookeeper/image-20210301135629103.png\" class=\"\" title=\"image-20210301135629103\">\n<h1 id=\"三-zookeeper-java-api使用\"><a class=\"anchor\" href=\"#三-zookeeper-java-api使用\">#</a> 三、Zookeeper Java API 使用</h1>\n<p>​    介绍如何通过 Java 代码来操作 Zookeeper 中的数据</p>\n<p>在 Zookeeper 的安装目录下是提供的有相关的 Jar 依赖的</p>\n<img data-src=\"/Distribution/zookeeper/image-20210301141050300.png\" class=\"\" title=\"image-20210301141050300\">\n<p>但是我们对于 Maven 构建项目已经习惯而且是主流，那么我们可以通过 maven 坐标来管理</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependencies</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.apache.zookeeper<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>zookeeper<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>3.5.9<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>com.github.sgroschupf<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>zkclient<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>0.1<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>junit<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>junit<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>4.12<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependencies</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><h2 id=\"1连接zk服务\"><a class=\"anchor\" href=\"#1连接zk服务\">#</a> 1. 连接 ZK 服务</h2>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>zookeeper<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">WatchedEvent</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>zookeeper<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Watcher</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>zookeeper<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">ZooKeeper</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>junit<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Test</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>io<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">IOException</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Test1</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> connectString <span class=\"token operator\">=</span> <span class=\"token string\">\"192.168.100.121:2181,192.168.122:2181,192.168.100.122:2181\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">int</span> sessionTimeOut <span class=\"token operator\">=</span> <span class=\"token number\">5000</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>     * 连接 Zookeeper 服务端</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">test1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token class-name\">ZooKeeper</span> zooKeeper <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ZooKeeper</span><span class=\"token punctuation\">(</span>connectString<span class=\"token punctuation\">,</span> sessionTimeOut<span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Watcher</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>            <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>             * 触发监听事件的回调方法</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>             * @param watchedEvent</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>             */</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>            <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>            <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">process</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">WatchedEvent</span> watchedEvent<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>                <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"触发了.....\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"--->\"</span> <span class=\"token operator\">+</span> zooKeeper<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><img data-src=\"/Distribution/zookeeper/image-20210301141935591.png\" class=\"\" title=\"image-20210301141935591\">\n<h2 id=\"2-基本操作\"><a class=\"anchor\" href=\"#2-基本操作\">#</a> 2 基本操作</h2>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">package</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>bobo<span class=\"token punctuation\">.</span>test</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">jdk<span class=\"token punctuation\">.</span>nashorn<span class=\"token punctuation\">.</span>internal<span class=\"token punctuation\">.</span>ir<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">CallNode</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>zookeeper<span class=\"token punctuation\">.</span></span><span class=\"token operator\">*</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>zookeeper<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Stat</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>junit<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Before</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>junit<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Test</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>io<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">IOException</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">List</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Test1</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> connectString <span class=\"token operator\">=</span> <span class=\"token string\">\"192.168.100.121:2181,192.168.122:2181,192.168.100.122:2181\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">int</span> sessionTimeOut <span class=\"token operator\">=</span> <span class=\"token number\">10000</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token class-name\">ZooKeeper</span> zooKeeper <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>     * 连接 Zookeeper 服务端</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token annotation punctuation\">@Before</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">test1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        zooKeeper <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ZooKeeper</span><span class=\"token punctuation\">(</span>connectString<span class=\"token punctuation\">,</span> sessionTimeOut<span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Watcher</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>            <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"27\"></td><td><pre>             * 触发监听事件的回调方法</pre></td></tr><tr><td data-num=\"28\"></td><td><pre>             * @param watchedEvent</pre></td></tr><tr><td data-num=\"29\"></td><td><pre>             */</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>            <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>            <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">process</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">WatchedEvent</span> watchedEvent<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>                <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"触发了.....\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token comment\">//System.out.println(\"--->\" + zooKeeper);</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"39\"></td><td><pre>     * 创建节点</pre></td></tr><tr><td data-num=\"40\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    <span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">createNode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>        <span class=\"token class-name\">String</span> path <span class=\"token operator\">=</span> zooKeeper<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/apptest\"</span> <span class=\"token comment\">// 节点路径</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>                <span class=\"token punctuation\">,</span><span class=\"token string\">\"HelloZookeeper\"</span><span class=\"token punctuation\">.</span><span class=\"token function\">getBytes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 节点的数据</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>                <span class=\"token punctuation\">,</span> <span class=\"token class-name\">ZooDefs<span class=\"token punctuation\">.</span>Ids</span><span class=\"token punctuation\">.</span><span class=\"token constant\">OPEN_ACL_UNSAFE</span> <span class=\"token comment\">// 权限</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>        <span class=\"token punctuation\">,</span> <span class=\"token class-name\">CreateMode</span><span class=\"token punctuation\">.</span><span class=\"token constant\">PERSISTENT</span> <span class=\"token comment\">// 节点类型</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"52\"></td><td><pre>     * 判断节点是否存在</pre></td></tr><tr><td data-num=\"53\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>    <span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">exist</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span>  <span class=\"token class-name\">Exception</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>        <span class=\"token comment\">//true 表示的是使用 Zookeeper 中的 watch</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>        <span class=\"token class-name\">Stat</span> stat <span class=\"token operator\">=</span> zooKeeper<span class=\"token punctuation\">.</span><span class=\"token function\">exists</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/apptest\"</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>stat <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>            <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"节点存在\"</span><span class=\"token operator\">+</span> stat<span class=\"token punctuation\">.</span><span class=\"token function\">getNumChildren</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>            <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"节点不存在 ....\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"66\"></td><td><pre>     * 获取某个节点下面的所有的子节点</pre></td></tr><tr><td data-num=\"67\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>    <span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">getChildrens</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>        <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> childrens <span class=\"token operator\">=</span> zooKeeper<span class=\"token punctuation\">.</span><span class=\"token function\">getChildren</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/app1\"</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> children <span class=\"token operator\">:</span> childrens<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>            <span class=\"token comment\">// System.out.println(children);</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>            <span class=\"token comment\">// 获取子节点中的数据</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>            <span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> data <span class=\"token operator\">=</span> zooKeeper<span class=\"token punctuation\">.</span><span class=\"token function\">getData</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/app1/\"</span> <span class=\"token operator\">+</span> children<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>            <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>children<span class=\"token operator\">+</span><span class=\"token string\">\":\"</span> <span class=\"token operator\">+</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"80\"></td><td><pre>     * 修改节点的内容</pre></td></tr><tr><td data-num=\"81\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>    <span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">setData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>        <span class=\"token comment\">//-1 不指定版本 自动维护</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>        <span class=\"token class-name\">Stat</span> stat <span class=\"token operator\">=</span> zooKeeper<span class=\"token punctuation\">.</span><span class=\"token function\">setData</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/app1/a1\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"666666\"</span><span class=\"token punctuation\">.</span><span class=\"token function\">getBytes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>stat<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre></pre></td></tr><tr><td data-num=\"89\"></td><td><pre></pre></td></tr><tr><td data-num=\"90\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"91\"></td><td><pre>     * 删除节点</pre></td></tr><tr><td data-num=\"92\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>    <span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">deleteNode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"95\"></td><td><pre>        zooKeeper<span class=\"token punctuation\">.</span><span class=\"token function\">delete</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/app1\"</span><span class=\"token punctuation\">,</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"96\"></td><td><pre>        </pre></td></tr><tr><td data-num=\"97\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre></pre></td></tr><tr><td data-num=\"99\"></td><td><pre></pre></td></tr><tr><td data-num=\"100\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"3-事件监听处理\"><a class=\"anchor\" href=\"#3-事件监听处理\">#</a> 3 事件监听处理</h2>\n<p>​        Java 程序如何监听 Zookeeper 中的数据的变化？</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>     * 监听 Node 节点下的子节点的变化</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">nodeChildrenChange</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> list <span class=\"token operator\">=</span> zooKeeper<span class=\"token punctuation\">.</span><span class=\"token function\">getChildren</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/app1\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Watcher</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>             *              None(-1),</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>             *             NodeCreated(1),</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>             *             NodeDeleted(2),</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>             *             NodeDataChanged(3),</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>             *             NodeChildrenChanged(4),</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>             *             DataWatchRemoved(5),</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>             *             ChildWatchRemoved(6);</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>             * @param watchedEvent</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>             */</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">process</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">WatchedEvent</span> watchedEvent<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>                <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"--->\"</span><span class=\"token operator\">+</span> watchedEvent<span class=\"token punctuation\">.</span><span class=\"token function\">getType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> s <span class=\"token operator\">:</span> list<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>            <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token class-name\">Thread</span><span class=\"token punctuation\">.</span><span class=\"token function\">sleep</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">.</span><span class=\"token constant\">MAX_VALUE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"31\"></td><td><pre>     * 监听节点内容变更</pre></td></tr><tr><td data-num=\"32\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">nodeDataChanged</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> data <span class=\"token operator\">=</span> zooKeeper<span class=\"token punctuation\">.</span><span class=\"token function\">getData</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/app1/a1\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Watcher</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>            <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>            <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">process</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">WatchedEvent</span> watchedEvent<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>                <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"--->\"</span> <span class=\"token operator\">+</span> watchedEvent<span class=\"token punctuation\">.</span><span class=\"token function\">getType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"--->\"</span> <span class=\"token operator\">+</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        <span class=\"token class-name\">Thread</span><span class=\"token punctuation\">.</span><span class=\"token function\">sleep</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">.</span><span class=\"token constant\">MAX_VALUE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h1 id=\"四-zookeeper实现分布式锁\"><a class=\"anchor\" href=\"#四-zookeeper实现分布式锁\">#</a> 四、Zookeeper 实现分布式锁</h1>\n<h2 id=\"分布式锁\"><a class=\"anchor\" href=\"#分布式锁\">#</a> 分布式锁</h2>\n<p>排他锁、共享锁</p>\n<h3 id=\"排他锁\"><a class=\"anchor\" href=\"#排他锁\">#</a> 排他锁</h3>\n<p>排他锁（Exclusive Locks），又被称为写锁或独占锁，如果事务 T1 对数据对象 O1 加上排他锁，那么整个加锁期间，只允许事务 T1 对 O1 进行读取和更新操作，其他任何事务都不能进行读或写。</p>\n<p>实现方式在下面的 <code>Zookeeper</code>  实现分布式锁中有具体讲解， <code>Zookeeper</code>  实现分布式锁就是一个排它锁</p>\n<h3 id=\"共享锁\"><a class=\"anchor\" href=\"#共享锁\">#</a> 共享锁</h3>\n<p>共享锁（Shared Locks），又称读锁。如果事务 T1 对数据对象 O1 加上了共享锁，那么当前事务只能对 O1 进行读取操作，其他事务也只能对这个数据对象加共享锁，直到该数据对象上的所有共享锁都释放。</p>\n<p><strong>实现方式：</strong></p>\n<p>1、客户端调用 create 方法创建类似定义锁方式的临时顺序节点。</p>\n<img data-src=\"/Distribution/zookeeper/lock-01.png\" class=\"\" title=\"img\">\n<p>2、客户端调用 getChildren 接口来获取所有已创建的子节点列表。</p>\n<p>3、判断是否获得锁</p>\n<ul>\n<li>对于读请求：如果所有比自己小的子节点都是读请求或者没有比自己序号小的子节点，表明已经成功获取共享锁，同时开始执行度逻辑。</li>\n<li>对于写请求：如果自己不是序号最小的子节点，那么就进入等待。</li>\n</ul>\n<p>4、如果没有获取到共享锁，读请求向比自己序号小的最后一个写请求节点注册 watcher 监听，写请求向比自己序号小的最后一个节点注册 watcher 监听。</p>\n<h3 id=\"概念总结\"><a class=\"anchor\" href=\"#概念总结\">#</a> 概念总结</h3>\n<ul>\n<li>\n<p>对于排他锁而言</p>\n<p>只监听自己前面的人，前面没人才能拿到锁资源</p>\n</li>\n<li>\n<p>对于共享锁 (读写锁)</p>\n<ol>\n<li>\n<p>序号越大越可能是读锁</p>\n</li>\n<li>\n<p>写锁的序号最小</p>\n</li>\n</ol>\n</li>\n</ul>\n<h3 id=\"操作事例\"><a class=\"anchor\" href=\"#操作事例\">#</a> 操作事例</h3>\n<p><strong>实际开发过程中，可以 curator 工具包封装的 API 帮助我们实现分布式锁。</strong></p>\n<p>curator 的几种锁方案 ：</p>\n<ul>\n<li>1、<strong>InterProcessMutex</strong>：分布式可重入排它锁</li>\n<li>2、<strong>InterProcessSemaphoreMutex</strong>：分布式排它锁</li>\n<li>3、<strong>InterProcessReadWriteLock</strong>：分布式读写锁</li>\n</ul>\n<p>引入依赖：</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">&lt;!-- curator-framework 自带 Zookeeper --></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.apache.curator<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>curator-framework<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>4.2.0<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>exclusions</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>exclusion</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.apache.zookeeper<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>zookeeper<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>exclusion</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>exclusions</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token comment\">&lt;!-- curator-recipes --></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.apache.curator<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>curator-recipes<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>4.2.0<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>exclusions</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>exclusion</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.apache.curator<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>curator-framework<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>exclusion</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>exclusions</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>测试用例：</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>curator<span class=\"token punctuation\">.</span>framework<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">CuratorFramework</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>curator<span class=\"token punctuation\">.</span>framework<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">CuratorFrameworkFactory</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>curator<span class=\"token punctuation\">.</span>framework<span class=\"token punctuation\">.</span>recipes<span class=\"token punctuation\">.</span>locks<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">InterProcessMutex</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>curator<span class=\"token punctuation\">.</span>framework<span class=\"token punctuation\">.</span>recipes<span class=\"token punctuation\">.</span>locks<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">InterProcessReadWriteLock</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>curator<span class=\"token punctuation\">.</span>framework<span class=\"token punctuation\">.</span>recipes<span class=\"token punctuation\">.</span>locks<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">InterProcessSemaphoreMutex</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>curator<span class=\"token punctuation\">.</span>retry<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">ExponentialBackoffRetry</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">InterprocessLock</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span>  <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token class-name\">CuratorFramework</span> zkClient <span class=\"token operator\">=</span> <span class=\"token function\">getZkClient</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token class-name\">String</span> lockPath <span class=\"token operator\">=</span> <span class=\"token string\">\"/lock\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token class-name\">InterProcessMutex</span> lock <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">InterProcessMutex</span><span class=\"token punctuation\">(</span>zkClient<span class=\"token punctuation\">,</span> lockPath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token class-name\">InterProcessSemaphoreMutex</span> lock1 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">InterProcessSemaphoreMutex</span><span class=\"token punctuation\">(</span>zkClient<span class=\"token punctuation\">,</span> lockPath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token class-name\">InterProcessMutex</span> read  <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">InterProcessReadWriteLock</span><span class=\"token punctuation\">(</span>zkClient<span class=\"token punctuation\">,</span>lockPath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">readLock</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token class-name\">InterProcessMutex</span> write <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">InterProcessReadWriteLock</span><span class=\"token punctuation\">(</span>zkClient<span class=\"token punctuation\">,</span>lockPath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">writeLock</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token comment\">// 模拟线程抢锁</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            <span class=\"token comment\">// 分布式可重入排它锁</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>            <span class=\"token comment\">// new Thread(new TestThread(i, lock)).start();</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>            <span class=\"token comment\">// 分布式排它锁</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>            <span class=\"token keyword\">new</span> <span class=\"token class-name\">Thread</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">TestInterProcessSemaphoreMutex</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> lock1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token comment\">// 模拟线程抢锁</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token comment\">// 读书数量为 i , 写锁数量为 j</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">,</span>j <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> j<span class=\"token operator\">&lt;</span><span class=\"token number\">3</span> <span class=\"token operator\">||</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">5</span> <span class=\"token punctuation\">;</span>j<span class=\"token operator\">++</span><span class=\"token punctuation\">,</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>            <span class=\"token comment\">// if (j&lt;3) new Thread(new TestThreadSharedLockOnWriter(i + 1, write)).start();</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>           <span class=\"token comment\">// new Thread( new TestThreadSharedLockOnRead(i + 1, read)).start();</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>            <span class=\"token comment\">// new Thread(new TestThreadSharedLockOnWriter(i + 1, write)).start();</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre></pre></td></tr><tr><td data-num=\"35\"></td><td><pre></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    <span class=\"token keyword\">static</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">TestInterProcessMutex</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">Runnable</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        <span class=\"token keyword\">private</span> <span class=\"token class-name\">Integer</span> threadFlag<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>        <span class=\"token keyword\">private</span> <span class=\"token class-name\">InterProcessMutex</span> lock<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        <span class=\"token keyword\">private</span> <span class=\"token class-name\">InterProcessSemaphoreMutex</span> lock1<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>        <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>        <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>            <span class=\"token function\">testInterProcessMutex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>        <span class=\"token keyword\">public</span> <span class=\"token class-name\">TestInterProcessMutex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>        <span class=\"token keyword\">public</span> <span class=\"token class-name\">TestInterProcessMutex</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Integer</span> threadFlag<span class=\"token punctuation\">,</span> <span class=\"token class-name\">InterProcessMutex</span> lock<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>threadFlag <span class=\"token operator\">=</span> threadFlag<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>lock <span class=\"token operator\">=</span> lock<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>        <span class=\"token keyword\">public</span> <span class=\"token class-name\">TestInterProcessMutex</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Integer</span> threadFlag<span class=\"token punctuation\">,</span> <span class=\"token class-name\">InterProcessSemaphoreMutex</span> lock1<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>threadFlag <span class=\"token operator\">=</span> threadFlag<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>lock1 <span class=\"token operator\">=</span> lock1<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">testInterProcessMutex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>            <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>                lock<span class=\"token punctuation\">.</span><span class=\"token function\">acquire</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>                <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"第\"</span><span class=\"token operator\">+</span>threadFlag<span class=\"token operator\">+</span><span class=\"token string\">\"线程获取到了锁\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>                <span class=\"token comment\">// 等到 1 秒后释放锁</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>                <span class=\"token class-name\">Thread</span><span class=\"token punctuation\">.</span><span class=\"token function\">sleep</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>                e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">finally</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>                <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>                    lock<span class=\"token punctuation\">.</span><span class=\"token function\">release</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>                    e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>    <span class=\"token keyword\">static</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">TestInterProcessSemaphoreMutex</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">Runnable</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>        <span class=\"token keyword\">private</span> <span class=\"token class-name\">Integer</span> threadFlag<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>        <span class=\"token keyword\">private</span> <span class=\"token class-name\">InterProcessSemaphoreMutex</span> lock<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>        <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>        <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>            <span class=\"token function\">testInterProcessSemaphoreMutex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre></pre></td></tr><tr><td data-num=\"88\"></td><td><pre>        <span class=\"token keyword\">public</span> <span class=\"token class-name\">TestInterProcessSemaphoreMutex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre></pre></td></tr><tr><td data-num=\"91\"></td><td><pre>        <span class=\"token keyword\">public</span> <span class=\"token class-name\">TestInterProcessSemaphoreMutex</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Integer</span> threadFlag<span class=\"token punctuation\">,</span> <span class=\"token class-name\">InterProcessSemaphoreMutex</span> lock<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"92\"></td><td><pre>            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>threadFlag <span class=\"token operator\">=</span> threadFlag<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>lock <span class=\"token operator\">=</span> lock<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"95\"></td><td><pre>        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">testInterProcessSemaphoreMutex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"96\"></td><td><pre>            <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"97\"></td><td><pre>                lock<span class=\"token punctuation\">.</span><span class=\"token function\">acquire</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre>                <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"第\"</span><span class=\"token operator\">+</span>threadFlag<span class=\"token operator\">+</span><span class=\"token string\">\"线程获取到了锁\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"99\"></td><td><pre>                <span class=\"token comment\">// 等到 1 秒后释放锁</span></pre></td></tr><tr><td data-num=\"100\"></td><td><pre>                <span class=\"token class-name\">Thread</span><span class=\"token punctuation\">.</span><span class=\"token function\">sleep</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"101\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"102\"></td><td><pre>                e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"103\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">finally</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"104\"></td><td><pre>                <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"105\"></td><td><pre>                    lock<span class=\"token punctuation\">.</span><span class=\"token function\">release</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"106\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"107\"></td><td><pre>                    e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"108\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"109\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"110\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"111\"></td><td><pre></pre></td></tr><tr><td data-num=\"112\"></td><td><pre></pre></td></tr><tr><td data-num=\"113\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"114\"></td><td><pre>    <span class=\"token keyword\">static</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">TestThreadSharedLockOnRead</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">Runnable</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"115\"></td><td><pre>        <span class=\"token keyword\">private</span> <span class=\"token class-name\">Integer</span> threadFlag<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"116\"></td><td><pre>        <span class=\"token keyword\">private</span> <span class=\"token class-name\">InterProcessMutex</span> lock2<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"117\"></td><td><pre></pre></td></tr><tr><td data-num=\"118\"></td><td><pre>        <span class=\"token keyword\">public</span> <span class=\"token class-name\">TestThreadSharedLockOnRead</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"119\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"120\"></td><td><pre></pre></td></tr><tr><td data-num=\"121\"></td><td><pre>        <span class=\"token keyword\">public</span> <span class=\"token class-name\">TestThreadSharedLockOnRead</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Integer</span> threadFlag<span class=\"token punctuation\">,</span> <span class=\"token class-name\">InterProcessMutex</span> lock2<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"122\"></td><td><pre>            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>threadFlag <span class=\"token operator\">=</span> threadFlag<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"123\"></td><td><pre>            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>lock2 <span class=\"token operator\">=</span> lock2<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"124\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"125\"></td><td><pre></pre></td></tr><tr><td data-num=\"126\"></td><td><pre>        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">testInterProcessReadWriteLockOnRead</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"127\"></td><td><pre>            <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"128\"></td><td><pre>                lock2<span class=\"token punctuation\">.</span><span class=\"token function\">acquire</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"129\"></td><td><pre>                <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"读锁----第\"</span><span class=\"token operator\">+</span>threadFlag<span class=\"token operator\">+</span><span class=\"token string\">\"线程获取到了锁\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"130\"></td><td><pre>                <span class=\"token comment\">// 等到 1 秒后释放锁</span></pre></td></tr><tr><td data-num=\"131\"></td><td><pre>                <span class=\"token class-name\">Thread</span><span class=\"token punctuation\">.</span><span class=\"token function\">sleep</span><span class=\"token punctuation\">(</span><span class=\"token number\">5000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"132\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"133\"></td><td><pre>                e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"134\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">finally</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"135\"></td><td><pre>                <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"136\"></td><td><pre>                    lock2<span class=\"token punctuation\">.</span><span class=\"token function\">release</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"137\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"138\"></td><td><pre>                    e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"139\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"140\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"141\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"142\"></td><td><pre></pre></td></tr><tr><td data-num=\"143\"></td><td><pre>        <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"144\"></td><td><pre>        <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"145\"></td><td><pre>            <span class=\"token function\">testInterProcessReadWriteLockOnRead</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"146\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"147\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"148\"></td><td><pre>    <span class=\"token keyword\">static</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">TestThreadSharedLockOnWriter</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">Runnable</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"149\"></td><td><pre>        <span class=\"token keyword\">private</span> <span class=\"token class-name\">Integer</span> threadFlag<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"150\"></td><td><pre>        <span class=\"token keyword\">private</span> <span class=\"token class-name\">InterProcessMutex</span> lock2<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"151\"></td><td><pre></pre></td></tr><tr><td data-num=\"152\"></td><td><pre>        <span class=\"token keyword\">public</span> <span class=\"token class-name\">TestThreadSharedLockOnWriter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"153\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"154\"></td><td><pre></pre></td></tr><tr><td data-num=\"155\"></td><td><pre>        <span class=\"token keyword\">public</span> <span class=\"token class-name\">TestThreadSharedLockOnWriter</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Integer</span> threadFlag<span class=\"token punctuation\">,</span> <span class=\"token class-name\">InterProcessMutex</span> lock2<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"156\"></td><td><pre>            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>threadFlag <span class=\"token operator\">=</span> threadFlag<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"157\"></td><td><pre>            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>lock2 <span class=\"token operator\">=</span> lock2<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"158\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"159\"></td><td><pre></pre></td></tr><tr><td data-num=\"160\"></td><td><pre>        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">testInterProcessReadWriteLockOnWriter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"161\"></td><td><pre>            <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"162\"></td><td><pre>                lock2<span class=\"token punctuation\">.</span><span class=\"token function\">acquire</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"163\"></td><td><pre>                <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"写锁----第\"</span><span class=\"token operator\">+</span>threadFlag<span class=\"token operator\">+</span><span class=\"token string\">\"线程获取到了锁\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"164\"></td><td><pre>                <span class=\"token comment\">// 等到 1 秒后释放锁</span></pre></td></tr><tr><td data-num=\"165\"></td><td><pre>                <span class=\"token class-name\">Thread</span><span class=\"token punctuation\">.</span><span class=\"token function\">sleep</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"166\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"167\"></td><td><pre>                e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"168\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">finally</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"169\"></td><td><pre>                <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"170\"></td><td><pre>                    lock2<span class=\"token punctuation\">.</span><span class=\"token function\">release</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"171\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"172\"></td><td><pre>                    e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"173\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"174\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"175\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"176\"></td><td><pre></pre></td></tr><tr><td data-num=\"177\"></td><td><pre>        <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"178\"></td><td><pre>        <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"179\"></td><td><pre>            <span class=\"token function\">testInterProcessReadWriteLockOnWriter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"180\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"181\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"182\"></td><td><pre></pre></td></tr><tr><td data-num=\"183\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"184\"></td><td><pre>     * 建立连接</pre></td></tr><tr><td data-num=\"185\"></td><td><pre>     * @return</pre></td></tr><tr><td data-num=\"186\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"187\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">CuratorFramework</span> <span class=\"token function\">getZkClient</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"188\"></td><td><pre>        <span class=\"token class-name\">String</span> zkServerAddress <span class=\"token operator\">=</span> <span class=\"token string\">\"39.103.208.148:2181\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"189\"></td><td><pre>        <span class=\"token class-name\">ExponentialBackoffRetry</span> retryPolicy <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ExponentialBackoffRetry</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"190\"></td><td><pre>        <span class=\"token class-name\">CuratorFramework</span> zkClient <span class=\"token operator\">=</span> <span class=\"token class-name\">CuratorFrameworkFactory</span><span class=\"token punctuation\">.</span><span class=\"token function\">builder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"191\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">connectString</span><span class=\"token punctuation\">(</span>zkServerAddress<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"192\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">sessionTimeoutMs</span><span class=\"token punctuation\">(</span><span class=\"token number\">5000</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"193\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">connectionTimeoutMs</span><span class=\"token punctuation\">(</span><span class=\"token number\">5000</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"194\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">retryPolicy</span><span class=\"token punctuation\">(</span>retryPolicy<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"195\"></td><td><pre>                <span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"196\"></td><td><pre>        zkClient<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"197\"></td><td><pre>        <span class=\"token keyword\">return</span> zkClient<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"198\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"199\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"介绍\"><a class=\"anchor\" href=\"#介绍\">#</a> 介绍</h2>\n<p>​   <code>[Zookeeper</code>  能实现分布式锁，是因为它有一个特性，就是<mark>多个线程去 Zookeeper 里面去创建同一个节点的时候，只会有一个线程执行成功</mark>。（<strong>默认公平锁，也叫排它锁</strong>）</p>\n<p><strong>锁可理解为 ZooKeeper 上的一个节点</strong></p>\n<ul>\n<li>当需要获取锁时，就在这个锁节点下创建一个临时顺序节点。当存在多个客户端同时来获取锁，就按顺序依次创建多个临时顺序节点，但只有排列序号是第一的那个节点能获取锁成功，其他节点则按顺序分别监听前一个节点的变化，当被监听者释放锁时，监听者就可以马上获得锁。</li>\n<li>当释放锁时，只需要将会话关闭，临时节点就删除了，即释放了锁。如果万一客户端获取到锁之后突然挂掉（Session 连接断开），那么这个临时节点也会自动删除掉。</li>\n</ul>\n<h2 id=\"具体实现\"><a class=\"anchor\" href=\"#具体实现\">#</a> 具体实现</h2>\n<p>实现有两种方案：</p>\n<ul>\n<li>基于临时节点实现，会产生羊群效应，<strong>不推荐</strong>。</li>\n<li>基于临时顺序节点实现。<strong>推荐</strong></li>\n</ul>\n<p>一般我们认为，<font color=red>ZooKeeper 的分布式锁是基于临时顺序节点，然后通过监听机制来实现的</font>。即方案 2。</p>\n<p>基于临时节点实现:</p>\n<p>1、实现思路</p>\n<div style=\" align-items: Center;justify-content: center;\" ><img data-src=\"zookeeper/4dafb20334a545b39c52b1fc64eb46e1.png\"></div>\n<p><strong>锁节点</strong>：即锁对象</p>\n<p><strong>获取锁</strong>：锁请求者加锁，则创建锁节点。</p>\n<ul>\n<li>如果创建成功，那么加锁成功，</li>\n<li>如果创建失败，那么加锁失败，则等待获取锁（等待获取锁成功的客户端释放锁）。注意：这里锁请求者监听的都是 锁节点的删除操作。</li>\n</ul>\n<p><strong>释放锁</strong>：只需要将会话关闭，临时节点就删除了，即释放了锁。</p>\n<p><strong>羊群效应</strong>：如果所有的锁请求者都来监听锁持有者，当锁持有者的节点被删除以后，所有的锁请求者都会通知到，即都会同时去竞争锁，但是只有一个锁请求者能拿到锁。这就是羊群效应 (<strong>非公平锁</strong>)。</p>\n<h2 id=\"代码实现\"><a class=\"anchor\" href=\"#代码实现\">#</a> 代码实现</h2>\n<p>参考分布式锁中的代码实现</p>\n<ul>\n<li>Zookeeper 中多用 <strong>InterProcessMutex</strong>（分布式可重入排它锁）</li>\n</ul>\n<h2 id=\"参考\"><a class=\"anchor\" href=\"#参考\">#</a> 参考</h2>\n<p>菜鸟教程：<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cucnVub29iLmNvbS93M2Nub3RlL3pvb2tlZXBlci1sb2Nrcy5odG1s\">https://www.runoob.com/w3cnote/zookeeper-locks.html</span></p>\n<p>Charge8：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyNDAyODU0L2FydGljbGUvZGV0YWlscy8xMjQ5MzY4OTU=\">https://blog.csdn.net/qq_42402854/article/details/124936895</span></p>\n\n<div id=\"gitalk-container\"></div>\n<script src=\"https://cdn.bootcss.com/blueimp-md5/2.12.0/js/md5.min.js\"></script><link rel=\"stylesheet\" href=\"https://unpkg.com/gitalk/dist/gitalk.css\"><script src=\"https://unpkg.com/gitalk/dist/gitalk.min.js\"></script>\n\n\t\t<script>\n\t\tvar gitalkConfig = {\"clientID\":\"6db178ba46c8af8f6a6f\",\"clientSecret\":\"90f730e5956024596558df00975cd8eae28cae3d\",\"repo\":\"bk-comment01\",\"owner\":\"onlymarryu\",\"admin\":[\"onlymarryu\"],\"distractionFreeMode\":false,\"language\":\"zh-CN\",\"proxy\":\"https://gitalk-comments.netlify.app/github_access_token\",\"perPage\":15};\n\t    gitalkConfig.id = md5(location.pathname);\n\t\tvar gitalk = new Gitalk(gitalkConfig);\n\t    gitalk.render(\"gitalk-container\");\n\t    </script>",
            "tags": [
                "分布式",
                "分布式",
                "中间件"
            ]
        },
        {
            "id": "http://yoursite.com/tools/tools-All/",
            "url": "http://yoursite.com/tools/tools-All/",
            "title": "所有工具安装合集",
            "date_published": "2022-10-15T06:00:00.000Z",
            "content_html": "<div align='center' ><font size='70'>工具安装</font></div>\n# 目录\n<p>[TOC]</p>\n<h1 id=\"注解\"><a class=\"anchor\" href=\"#注解\">#</a> 注解：</h1>\n<ul>\n<li>\n<p>——1 .x：单机安装</p>\n</li>\n<li>\n<p>——2 .x：Docker 安装</p>\n</li>\n<li>\n<p>X ：方式 X  ,default=1 不写</p>\n</li>\n<li>\n<p><strong>注所有所需文件均可在 gitee 上找到</strong></p>\n</li>\n</ul>\n<h1 id=\"\"><a class=\"anchor\" href=\"#\">#</a> ———————————————</h1>\n<h1 id=\"path-linux\"><a class=\"anchor\" href=\"#path-linux\">#</a> PATH---------Linux</h1>\n<h2 id=\"linux\"><a class=\"anchor\" href=\"#linux\">#</a> Linux</h2>\n<h3 id=\"centos-7\"><a class=\"anchor\" href=\"#centos-7\">#</a> CentOS--7</h3>\n<p><strong>1. 下载镜像文件</strong></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9taXJyb3JzLnR1bmEudHNpbmdodWEuZWR1LmNuLw==\"> 清华大学开源软件镜像站</span></p>\n<p><strong>2. 开始安装</strong></p>\n<img data-src=\"/tools/tools-All/1646489101763.png\" class=\"\">\n<img data-src=\"/tools/tools-All/1646489187835.png\" class=\"\">\n<img data-src=\"/tools/tools-All/1646489210450.png\" class=\"\">\n<img data-src=\"/tools/tools-All/1646489375149.png\" class=\"\">\n<img data-src=\"/tools/tools-All/1646489450527.png\" class=\"\">\n<p><strong>3. 开始进去虚拟机配置我们的软件</strong></p>\n<p><strong>3.1 语言</strong></p>\n<img data-src=\"/tools/tools-All/1646489591914.png\" class=\"\">\n<p><strong>3.2 时区、软件选择</strong></p>\n<p>软件选择：按照自己的需求选，第一次多选也不要少选</p>\n<img data-src=\"/tools/tools-All/1646489600666.png\" class=\"\">\n<p>4. 硬、软配置完成，开始安装，同时要创建管理员 Root 和 基础用户</p>\n\n\n<p>5. 安装成功</p>\n\n<p><strong>系统配置</strong></p>\n<div name=\"Linux_install_centos7\">进入系统后~</div>\n1、首先配置网络\n<p>要先切换到 root 用户上去，不然没权限。</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>方式一</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token parameter variable\">-i</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>password:当前普通用户密码</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>方式二</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">su</span> -</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>password：root用户密码</pre></td></tr></table></figure><p>将  **ONBOOT ** 改为 yes ：</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">vim</span> /etc/sysconfig/network-scripts/ifcfg-ens33</pre></td></tr></table></figure>\n<p>重启网络</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># CentOS6</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">service</span> network restart</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">#CentOS7</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>systemlctl restart network </pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\"># 检查是否通畅</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">ping</span> <span class=\"token number\">114.114</span>.114.114</pre></td></tr></table></figure><p>2、 安装 net-tools 和 vim（<strong>有的话可直接跳过</strong>）</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>yum <span class=\"token function\">install</span> <span class=\"token parameter variable\">-y</span> net-tools <span class=\"token function\">vim</span></pre></td></tr></table></figure><p>检查自己的 ip</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">ifconfig</span></pre></td></tr></table></figure>\n<p>3 启动 sshd 服务</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">service</span> sshd start</pre></td></tr></table></figure><div name=\"Linux_minInstall_4\"></div >\n4、修改登录，让Root用户直接登录\n<p><a href=\"#problem-6\">具体步骤</a></p>\n<div name=\"Linux_minInstall_5\"></div >\n5、修改DNS连接,让xshell访问快一点\n<p><a href=\"#problem-5\">具体步骤</a></p>\n<p>6、 <strong>关闭指定端口防火墙：</strong></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>systemctl status firewalld  </pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">#开启 80 端口</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>firewall-cmd <span class=\"token parameter variable\">--zone</span><span class=\"token operator\">=</span>public --add-port<span class=\"token operator\">=</span><span class=\"token number\">80</span>/tcp <span class=\"token parameter variable\">--permanent</span>  </pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">#开启 3306 端口</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>firewall-cmd <span class=\"token parameter variable\">--zone</span><span class=\"token operator\">=</span>public --add-port<span class=\"token operator\">=</span><span class=\"token number\">3306</span>/tcp <span class=\"token parameter variable\">--permanent</span>  </pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\">#重启防火墙：</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>firewall-cmd <span class=\"token parameter variable\">--reload</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>关闭防火墙 ，重启失效<span class=\"token punctuation\">(</span>Linux系统一重启Linux中的防火墙又会被开起<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token function\">service</span> firewalld stop</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>禁用防火墙，永久有效</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>systemctl disable firewalld 或者  systemctl disable firewalld.service</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>启动防火墙 <span class=\"token punctuation\">(</span>对禁用的防火墙进行启动<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>systemctl <span class=\"token builtin class-name\">enable</span> firewalld</pre></td></tr></table></figure><h2 id=\"docker安装\"><a class=\"anchor\" href=\"#docker安装\">#</a> Docker 安装</h2>\n<p>docker 官网，自己选定自己的 Linux 版本，按照官方文档配置即可，以下 CentOS7 的</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9kb2NzLmRvY2tlci5jb20vZW5naW5lL2luc3RhbGwvY2VudG9zLw==\">https://docs.docker.com/engine/install/centos/</span></p>\n<h4 id=\"1-卸载原有的环境\"><a class=\"anchor\" href=\"#1-卸载原有的环境\">#</a> 1、卸载原有的环境：</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">sudo</span> yum remove <span class=\"token function\">docker</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>                  docker-client <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>                  docker-client-latest <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>                  docker-common <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>                  docker-latest <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>                  docker-latest-logrotate <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>                  docker-logrotate <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>                  docker-selinux <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>                  docker-engine-selinux <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>                  docker-engine</pre></td></tr></table></figure><h4 id=\"2-安装对应的依赖环境和镜像地址\"><a class=\"anchor\" href=\"#2-安装对应的依赖环境和镜像地址\">#</a> 2、安装对应的依赖环境和镜像地址</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">sudo</span> yum <span class=\"token function\">install</span> <span class=\"token parameter variable\">-y</span> yum-utils</pre></td></tr></table></figure><p>官方安装 (慢)</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">sudo</span> yum-config-manager <span class=\"token punctuation\">\\</span> --add-repo <span class=\"token punctuation\">\\</span> https://download.docker.com/linux/centos/docker-ce.repo</pre></td></tr></table></figure><p>安装过慢设置镜像</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">sudo</span> yum-config-manager <span class=\"token punctuation\">\\</span> --add-repo <span class=\"token punctuation\">\\</span> http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</pre></td></tr></table></figure><h4 id=\"3-直接安装docker-ce\"><a class=\"anchor\" href=\"#3-直接安装docker-ce\">#</a> 3、直接安装 docker CE</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">sudo</span> yum <span class=\"token function\">install</span> <span class=\"token parameter variable\">-y</span> docker-ce docker-ce-cli containerd.io</pre></td></tr></table></figure><p>报错时，大概率为<strong>镜像仓库问题</strong> ，直接执行 <strong>步骤五</strong> 的补充，再安装</p>\n<h4 id=\"4-启动docker服务\"><a class=\"anchor\" href=\"#4-启动docker服务\">#</a> 4、启动 docker 服务</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>systemctl start <span class=\"token function\">docker</span></pre></td></tr></table></figure><h4 id=\"5-查看docker的版本\"><a class=\"anchor\" href=\"#5-查看docker的版本\">#</a> 5、查看 docker 的版本</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> version</pre></td></tr></table></figure><p>** 补充：通过官方的镜像地址下载 docker 会比较慢， **</p>\n<ul>\n<li>配置阿里云的镜像地址： <strong>经历过 3 的镜像库问题也就是配置阿里云镜像地址</strong></li>\n</ul>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</pre></td></tr></table></figure><ul>\n<li>yum 更新下即可：</li>\n</ul>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>yum makecache fast</pre></td></tr></table></figure><h4 id=\"6-开机启动docker\"><a class=\"anchor\" href=\"#6-开机启动docker\">#</a> 6、开机启动 docker</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">sudo</span> systemctl <span class=\"token builtin class-name\">enable</span> <span class=\"token function\">docker</span></pre></td></tr></table></figure><ul>\n<li>补充：docker pull 下载镜像太慢，更换源进行网络加速的解决方案</li>\n</ul>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>步骤1：</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">mkdir</span> <span class=\"token parameter variable\">-p</span> /etc/docker</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>步骤2：</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">tee</span> /etc/docker/daemon.json <span class=\"token operator\">&lt;&lt;-</span><span class=\"token string\">'EOF'</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>&#123;</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  \"registry-mirrors\": [\"https://glhlrb75.mirror.aliyuncs.com\"]</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>&#125;</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>EOF</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>或者（老师的）</pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">tee</span> /etc/docker/daemon.json <span class=\"token operator\">&lt;&lt;-</span><span class=\"token string\">'EOF'</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>&#123; </pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t\"registry-mirrors\": [\"https://v9j5rufo.mirror.aliyuncs.com\"] </pre></td></tr><tr><td data-num=\"14\"></td><td><pre>&#125;</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>EOF</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>步骤3：</pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token function\">sudo</span> systemctl daemon-reload</pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>步骤4：</pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token function\">sudo</span> systemctl restart <span class=\"token function\">docker</span></pre></td></tr></table></figure><h4 id=\"7-使用\"><a class=\"anchor\" href=\"#7-使用\">#</a> 7、使用</h4>\n<p><a href=\"https://blog.csdn.net/qq_25760623/article/details/88657491\"><strong>阿里云安装 docker：</strong></a></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI1NzYwNjIzL2FydGljbGUvZGV0YWlscy84ODY1NzQ5MQ==\">https://blog.csdn.net/qq_25760623/article/details/88657491</span></p>\n<h2 id=\"docker-compose安装\"><a class=\"anchor\" href=\"#docker-compose安装\">#</a> Docker-Compose 安装</h2>\n<h3 id=\"方式一\"><a class=\"anchor\" href=\"#方式一\">#</a> 方式一</h3>\n<p>官网地址：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9kb2NzLmRvY2tlci5jb20vY29tcG9zZQ==\">https://docs.docker.com/compose</span></p>\n<p><strong>推荐</strong>： 国内地址：<span class=\"exturl\" data-url=\"aHR0cDovL2dldC5kYW9jbG91ZC5pby8jaW5zdGFsbC1jb21wb3Nl\">http://get.daocloud.io/#install-compose</span></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">curl</span> <span class=\"token parameter variable\">-L</span> <span class=\"token string\">\"https://github.com/docker/compose/releases/download/1.29.2/docker- compose-<span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">uname</span> <span class=\"token parameter variable\">-s</span><span class=\"token variable\">)</span></span>-<span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">uname</span> <span class=\"token parameter variable\">-m</span><span class=\"token variable\">)</span></span>\"</span> <span class=\"token parameter variable\">-o</span> /usr/local/bin/docker-compose</pre></td></tr></table></figure><p>速度比较慢的话使用下面的地址：</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">curl</span> <span class=\"token parameter variable\">-L</span> https://get.daocloud.io/docker/compose/releases/download/1.25.0/docker- compose-<span class=\"token variable\"><span class=\"token variable\">`</span><span class=\"token function\">uname</span> <span class=\"token parameter variable\">-s</span><span class=\"token variable\">`</span></span>-<span class=\"token variable\"><span class=\"token variable\">`</span><span class=\"token function\">uname</span> <span class=\"token parameter variable\">-m</span><span class=\"token variable\">`</span></span> <span class=\"token operator\">></span> /usr/local/bin/docker-compose</pre></td></tr></table></figure><p>修改文件夹权限</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">chmod</span> +x /usr/local/bin/docker-compose</pre></td></tr></table></figure><p>建立软连接</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">ln</span> <span class=\"token parameter variable\">-s</span> /usr/local/bin/docker-compose /usr/bin/docker-compose</pre></td></tr></table></figure><p>校验是否安装成功</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker-compose</span> <span class=\"token parameter variable\">--version</span></pre></td></tr></table></figure><h3 id=\"方式二\"><a class=\"anchor\" href=\"#方式二\">#</a> 方式二</h3>\n<p><strong>手动下载 docker-compose 到本地，然后上传到 linux 服务器的 /usr/local/bin 路径下</strong></p>\n<p>（1）百度网盘：链接: <span class=\"exturl\" data-url=\"aHR0cHM6Ly9wYW4uYmFpZHUuY29tL3MvMW9fMlhzSUxmd2NBN21Sbi1mN0Exd0E=\">https://pan.baidu.com/s/1o_2XsILfwcA7mRn-f7A1wA</span> 提取码: qiue  —— 网盘中 docker-compose 版本：2.2.2</p>\n<p>（2）也可以去 GitHub 上下：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2RvY2tlci9jb21wb3NlL3JlbGVhc2Vz\">https://github.com/docker/compose/releases</span></p>\n<p><img data-src=\"https://tools-All2020.cnblogs.com/blog/1376119/202112/1376119-20211222005944642-1364547608.png\" alt=\"img\" /></p>\n<ol start=\"5\">\n<li>重命名：</li>\n</ol>\n<p>mv docker-compose-linux-x86_64 docker-compose</p>\n<ol start=\"6\">\n<li>授权：</li>\n</ol>\n<p>chmod +x ./docker-compose</p>\n<ol start=\"7\">\n<li>查看版本：</li>\n</ol>\n<p>docker-compose --version</p>\n<p><img data-src=\"https://tools-All2020.cnblogs.com/blog/1376119/202112/1376119-20211222005757511-1189151957.png\" alt=\"img\" /></p>\n<h3 id=\"升级方式三\"><a class=\"anchor\" href=\"#升级方式三\">#</a> 升级（方式三）</h3>\n<ul>\n<li>下载，命令如下👇：</li>\n</ul>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">curl</span> <span class=\"token parameter variable\">-L</span> https://get.daocloud.io/docker/compose/releases/download/1.26.2/docker-compose-<span class=\"token variable\"><span class=\"token variable\">`</span><span class=\"token function\">uname</span> <span class=\"token parameter variable\">-s</span><span class=\"token variable\">`</span></span>-<span class=\"token variable\"><span class=\"token variable\">`</span><span class=\"token function\">uname</span> <span class=\"token parameter variable\">-m</span><span class=\"token variable\">`</span></span> <span class=\"token operator\">></span> /usr/local/bin/docker-compose</pre></td></tr></table></figure><blockquote>\n<p>因 Github 国内访问不太稳定所以使用 DaoCloud 提供加速：<span class=\"exturl\" data-url=\"aHR0cDovL2dldC5kYW9jbG91ZC5pby8jaW5zdGFsbC1jb21wb3Nl\">链接</span>，你<strong>可以通过 URL 中的版本号，自定义下载你所需要的版本文件。</strong></p>\n</blockquote>\n<ul>\n<li>对命令进行一个授权</li>\n</ul>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">chmod</span> +x /usr/local/bin/docker-compose</pre></td></tr></table></figure><ul>\n<li>查看 compose 版本命令</li>\n</ul>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker-compose</span> <span class=\"token parameter variable\">--version</span></pre></td></tr></table></figure><ul>\n<li>卸载</li>\n</ul>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">rm</span> /usr/local/bin/docker-compose</pre></td></tr></table></figure><h2 id=\"python升级\"><a class=\"anchor\" href=\"#python升级\">#</a> Python 升级</h2>\n<h4 id=\"一-查看当前python版本\"><a class=\"anchor\" href=\"#一-查看当前python版本\">#</a> 一、<strong>查看当前 python 版本</strong></h4>\n<pre><code>[root@ansible ~]# python -V\nPython 2.7.5\n</code></pre>\n<h4 id=\"二-下载新的python包并安装\"><a class=\"anchor\" href=\"#二-下载新的python包并安装\">#</a> 二、<strong>下载新的 python 包并安装</strong></h4>\n<p>​\t进入 python 官网（<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cucHl0aG9uLm9yZw==\">https://www.python.org</span>），选择需要的版本。此处我选择当前最新版本 Python3.6.1</p>\n<pre><code>yum install gcc gcc-c++ -y\n\nwget https://www.python.org/ftp/python/3.7.3/Python-3.7.3.tar.xz\n\ntar xvf Python-3.7.3.tar.xz \n\ncd Python-3.7.3/\n\n ./configure\n \nmake\n\nmake install\n</code></pre>\n<h4 id=\"三-验证\"><a class=\"anchor\" href=\"#三-验证\">#</a> 三、<strong>验证</strong></h4>\n<pre><code>#python -V     #一个是旧版本，一个是新版本\nPython 2.7.5\n# python3 -V\nPython 3.7.3\n</code></pre>\n<h4 id=\"四-设置3x为默认版本\"><a class=\"anchor\" href=\"#四-设置3x为默认版本\">#</a> 四、<strong>设置 3.X 为默认版本</strong></h4>\n<p>​\t查看 Python 的路径，在 /usr/bin 下面。可以看到 python 链接的是 python 2.7，所以，执行 python 就相当于执行 python 2.7。</p>\n<pre><code>[root@ansible ~]# ls -al /usr/bin | grep python\n-rwxr-xr-x.   1 root root       11232 Dec  2  2016 abrt-action-analyze-python\nlrwxrwxrwx.   1 root root           7 May 26  2017 python -&gt; python2\nlrwxrwxrwx.   1 root root           9 May 26  2017 python2 -&gt; python2.7\n-rwxr-xr-x.   1 root root        7136 Nov  6  2016 python2.7\n</code></pre>\n<p>将原来 python 的软链接重命名：</p>\n<pre><code>  mv /usr/bin/python /usr/bin/python.bak\n</code></pre>\n<p>将 python 链接至 python3：</p>\n<pre><code>  ln -s /usr/local/bin/python3 /usr/bin/python\n</code></pre>\n<h4 id=\"五-配置yum\"><a class=\"anchor\" href=\"#五-配置yum\">#</a> 五、<strong>配置 yum</strong></h4>\n<p>​\t升级 Python 之后，由于将默认的 python 指向了 python3，yum 不能正常使用，需要编辑 yum 的配置文件，此时：</p>\n<pre><code>[root@ansible-admin Python-3.7.3]# yum list\n  File &quot;/usr/bin/yum&quot;, line 30\n    except KeyboardInterrupt, e:\n\nSyntaxError: invalid syntax\n</code></pre>\n<p>​\t修改 /usr/bin/yum 和 /usr/libexec/urlgrabber-ext-down，将 #!/usr/bin/python 改为 #!/usr/bin/python2.7，保存退出即可。</p>\n<blockquote>\n<p>vim /usr/bin/yum</p>\n<p>vim /usr/libexec/urlgrabber-ext-down</p>\n</blockquote>\n<div name=\"jdk_install\"></div>\n## jdk安装\n<h4 id=\"1-下载对应的版本\"><a class=\"anchor\" href=\"#1-下载对应的版本\">#</a> 1、下载对应的版本</h4>\n<p><strong>1.1 下载 Linux 对应版本的 JDK</strong></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>getconf  LONG_BIT</pre></td></tr></table></figure><p><strong>1.2 下载压缩文件</strong></p>\n<blockquote>\n<p>jdk-8u261-linux-x64.tar.gz</p>\n</blockquote>\n<h4 id=\"2-解压压缩文件\"><a class=\"anchor\" href=\"#2-解压压缩文件\">#</a> 2、解压压缩文件</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">tar</span> <span class=\"token parameter variable\">-xvf</span>   jdk-8u261-linux-x64.tar.gz  <span class=\"token parameter variable\">-C</span>  /usr/local/</pre></td></tr></table></figure><h4 id=\"3-配置环境变量\"><a class=\"anchor\" href=\"#3-配置环境变量\">#</a> 3、配置环境变量</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">vim</span>  /etc/profile</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">#自己选定的目录</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">JAVA_HOME</span><span class=\"token operator\">=</span>/usr/local/jdk1.8.0_261</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">CLASSPATH</span><span class=\"token operator\">=</span>.:<span class=\"token variable\">$JAVA_HOME</span>/lib/dt.jar:<span class=\"token variable\">$JAVA_HOME</span>/lib/tools.jar</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\"><span class=\"token environment constant\">PATH</span></span><span class=\"token operator\">=</span><span class=\"token environment constant\">$PATH</span><span class=\"token builtin class-name\">:</span><span class=\"token variable\">$JAVA_HOME</span>/bin</pre></td></tr></table></figure><h4 id=\"4-使用环境变量生效\"><a class=\"anchor\" href=\"#4-使用环境变量生效\">#</a> 4、使用环境变量生效</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">source</span> /etc/profile</pre></td></tr></table></figure><p><a href=\"#perblem-1\">长久生效</a></p>\n<h4 id=\"5-测试jdk是否安装成功\"><a class=\"anchor\" href=\"#5-测试jdk是否安装成功\">#</a> 5、测试 JDK 是否安装成功</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">java</span> <span class=\"token parameter variable\">-version</span></pre></td></tr></table></figure><h2 id=\"tomcat安装\"><a class=\"anchor\" href=\"#tomcat安装\">#</a> Tomcat 安装</h2>\n<h3 id=\"1\"><a class=\"anchor\" href=\"#1\">#</a> ——1</h3>\n<h4 id=\"1-下载linux对应版本的tomcat\"><a class=\"anchor\" href=\"#1-下载linux对应版本的tomcat\">#</a> 1、下载 Linux 对应版本的 Tomcat</h4>\n<p>​\t  下载压缩文件     apache-tomcat-7.0.68.tar.gz</p>\n<h4 id=\"2-解压压缩文件-2\"><a class=\"anchor\" href=\"#2-解压压缩文件-2\">#</a> 2、解压压缩文件</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">tar</span> <span class=\"token parameter variable\">-xvf</span>   apache-tomcat-7.0.68.tar.gz <span class=\"token parameter variable\">-C</span> /usr/local/  <span class=\"token comment\">#解压到的路径</span></pre></td></tr></table></figure><h4 id=\"3-配置环境变量-2\"><a class=\"anchor\" href=\"#3-配置环境变量-2\">#</a> 3、配置环境变量</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">vim</span>  /etc/profile</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">#自己定义为位置</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">CATALINA_BASE</span><span class=\"token operator\">=</span>/usr/local/apache-tomcat-7.0.68</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\"><span class=\"token environment constant\">PATH</span></span><span class=\"token operator\">=</span><span class=\"token variable\">$CATALINA_BASE</span>/bin:<span class=\"token environment constant\">$PATH</span></pre></td></tr></table></figure><h4 id=\"4-使用环境变量生效-2\"><a class=\"anchor\" href=\"#4-使用环境变量生效-2\">#</a> 4、使用环境变量生效</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">source</span> /etc/profile</pre></td></tr></table></figure><h4 id=\"5-启动tomcat服务\"><a class=\"anchor\" href=\"#5-启动tomcat服务\">#</a> 5、启动 Tomcat 服务</h4>\n<ul>\n<li>注：要是远程访问你关注防火墙问题</li>\n</ul>\n<p>启动 Tomcat 服务：</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>/usr/local/apache-tomcat-7.0.68/bin./startup.sh</pre></td></tr></table></figure><p>启动 Tomcat 并输出启动日志 :</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>/usr/local/apache-tomcat-7.0.68/bin/startup.sh <span class=\"token operator\">&amp;</span> <span class=\"token function\">tail</span> <span class=\"token parameter variable\">-f</span>  /usr/local/apache-tomcat-7.0.68/logs/catalina.out</pre></td></tr></table></figure><div name=\"mysql_install\">\n<h2 id=\"mysql-安装\"><a class=\"anchor\" href=\"#mysql-安装\">#</a> MySQL 安装</h2>\n<h3 id=\"1-2\"><a class=\"anchor\" href=\"#1-2\">#</a> ——1</h3>\n<h4 id=\"1-卸载原来的版本\"><a class=\"anchor\" href=\"#1-卸载原来的版本\">#</a> 1、卸载原来的版本</h4>\n<h5 id=\"1-查看mysql的安装情况\"><a class=\"anchor\" href=\"#1-查看mysql的安装情况\">#</a> 1、查看 mysql 的安装情况</h5>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">rpm</span> <span class=\"token parameter variable\">-qa</span> <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> <span class=\"token parameter variable\">-i</span> mysql</pre></td></tr></table></figure><img data-src=\"/tools/tools-All/1570605325400.png\" class=\"\">\n<h5 id=\"2-删除上图安装的软件\"><a class=\"anchor\" href=\"#2-删除上图安装的软件\">#</a> 2、删除上图安装的软件</h5>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">rpm</span> <span class=\"token parameter variable\">-ev</span> <span class=\"token parameter variable\">--nodeps</span> mysql57-community-release-el5-7.noarch</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">rpm</span> <span class=\"token parameter variable\">-ev</span> <span class=\"token parameter variable\">--nodeps</span> mysql-community-server-5.7.18-1.el5.x86_64</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">rpm</span> <span class=\"token parameter variable\">-ev</span> <span class=\"token parameter variable\">--nodeps</span> mysql-community-client-5.7.18-1.el5.x86_64</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">rpm</span> <span class=\"token parameter variable\">-ev</span> <span class=\"token parameter variable\">--nodeps</span> mysql-community-libs-5.7.18-1.el5.x86_64</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">rpm</span> <span class=\"token parameter variable\">-ev</span> <span class=\"token parameter variable\">--nodeps</span> mysql-community-common-5.7.18-1.el5.x86_64</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">rpm</span> <span class=\"token parameter variable\">-ev</span> <span class=\"token parameter variable\">--nodeps</span> mysql-5.7.18-1.el5.x86_64</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">rpm</span> <span class=\"token parameter variable\">-ev</span> <span class=\"token parameter variable\">--nodeps</span> mysql-community-libs-compat-5.7.18-1.el5.x86_64</pre></td></tr></table></figure><h5 id=\"3-都删除成功之后查找相关的mysql的文件\"><a class=\"anchor\" href=\"#3-都删除成功之后查找相关的mysql的文件\">#</a> 3、都删除成功之后，查找相关的 mysql 的文件</h5>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">find</span> / <span class=\"token parameter variable\">-name</span> mysql</pre></td></tr></table></figure><img data-src=\"/tools/tools-All/1570605553095.png\" class=\"\">\n<h5 id=\"4-删除全部文件\"><a class=\"anchor\" href=\"#4-删除全部文件\">#</a> 4、删除全部文件</h5>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">rm</span> <span class=\"token parameter variable\">-rf</span> /etc/selinux/targeted/active/modules/100/mysql</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">rm</span> <span class=\"token parameter variable\">-rf</span> /root/mysql</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">rm</span> <span class=\"token parameter variable\">-rf</span> /root/mysql/data/mysql</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">rm</span> <span class=\"token parameter variable\">-rf</span> /var/lib/mysql</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">rm</span> <span class=\"token parameter variable\">-rf</span> /var/lib/mysql/mysql</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">rm</span> <span class=\"token parameter variable\">-rf</span> /usr/share/mysql</pre></td></tr></table></figure><h5 id=\"5-再次执行命令\"><a class=\"anchor\" href=\"#5-再次执行命令\">#</a> 5、再次执行命令</h5>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">rpm</span> <span class=\"token parameter variable\">-qa</span> <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> <span class=\"token parameter variable\">-i</span> mysql</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">#如果没有显式则表示卸载完成</span></pre></td></tr></table></figure><h4 id=\"2-删除mariadb-libs不可省略\"><a class=\"anchor\" href=\"#2-删除mariadb-libs不可省略\">#</a> 2、删除 mariadb-libs (不可省略)</h4>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 检查 mariadb-libs</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">rpm</span> -qa<span class=\"token operator\">|</span><span class=\"token function\">grep</span> mariadb</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 卸载 mariadb-libs</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>yum remove mariadb-libs</pre></td></tr></table></figure><h4 id=\"3-安装mysql\"><a class=\"anchor\" href=\"#3-安装mysql\">#</a> 3、安装 MySQL</h4>\n<h5 id=\"1输入\"><a class=\"anchor\" href=\"#1输入\">#</a> 1，输入：</h5>\n<p>wegt <span class=\"exturl\" data-url=\"aHR0cHM6Ly9kZXYubXlzcWwuY29tL2dldC9teXNxbCVFNyU4OSU4OCVFNiU5QyVBQyVFNSU4RiVCNy1jb21tdW5pdHktcmVsZWFzZS1lbCVFNSVBNCVBNyVFNyU4OSU4OCVFNiU5QyVBQy0lRTUlQjAlOEYlRTclODklODglRTYlOUMlQUMubm9hcmNoLnJwbQ==\">https://dev.mysql.com/get/mysql 版本号 - community-release-el 大版本 - 小版本.noarch.rpm</span></p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">wget</span> https://dev.mysql.com/get/mysql57-community-release-el5-7.noarch.rpm</pre></td></tr></table></figure><h5 id=\"2-安装数据源\"><a class=\"anchor\" href=\"#2-安装数据源\">#</a> 2、安装数据源</h5>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>yum <span class=\"token function\">install</span> <span class=\"token parameter variable\">-y</span> mysql57-community-release-el5-7.noarch.rpm</pre></td></tr></table></figure><h5 id=\"3-查看mysql源是否安装成功\"><a class=\"anchor\" href=\"#3-查看mysql源是否安装成功\">#</a> 3、查看 mysql 源是否安装成功</h5>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>yum repolist enabled <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> <span class=\"token string\">\"mysql.*-community.*\"</span></pre></td></tr></table></figure><h5 id=\"4-安装数据库\"><a class=\"anchor\" href=\"#4-安装数据库\">#</a> 4、安装数据库</h5>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>yum <span class=\"token function\">install</span> <span class=\"token parameter variable\">-y</span>  mysql-community-server</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 如果过期可以在运行安装程序之前导入密钥，有了就不用了</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">rpm</span> <span class=\"token parameter variable\">--import</span> https://repo.mysql.com/RPM-GPG-KEY-mysql-2022</pre></td></tr></table></figure><h5 id=\"5-启动mysql\"><a class=\"anchor\" href=\"#5-启动mysql\">#</a> 5、启动 mysql</h5>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># centos7</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>systemctl restart mysqld</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>systemctl status mysqld</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\"># centos6</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">service</span> mysqld start</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token function\">service</span> mysqld status</pre></td></tr></table></figure><h5 id=\"6-显示mysql的随机密码\"><a class=\"anchor\" href=\"#6-显示mysql的随机密码\">#</a> 6、显示 mysql 的随机密码</h5>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">grep</span> <span class=\"token string\">'temporary password'</span> /var/log/mysqld.log</pre></td></tr></table></figure><img data-src=\"/tools/tools-All/image-20220827193405451.png\" class=\"\">\n<h5 id=\"7-登录并修改mysql密码\"><a class=\"anchor\" href=\"#7-登录并修改mysql密码\">#</a> 7、登录并修改 mysql 密码</h5>\n<p>登录：mysql -u root -p   \t\t然后输入上面生成的密码</p>\n<p><strong><em>修改自定义密码，设置新的密码，进入操作页面，修改密码策略可以修改成你想要的</em></strong></p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">-- ALTER USER 'root'@'localhost' IDENTIFIED BY ' 密码 ';</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">ALTER</span> <span class=\"token keyword\">USER</span> <span class=\"token string\">'root'</span><span class=\"token variable\">@'localhost'</span> IDENTIFIED <span class=\"token keyword\">BY</span> <span class=\"token string\">'Root_21root'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">ALTER</span> <span class=\"token keyword\">USER</span> <span class=\"token string\">'root'</span><span class=\"token variable\">@'localhost'</span> IDENTIFIED <span class=\"token keyword\">BY</span> <span class=\"token string\">'root'</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p><strong><em>失败了的话就修改策略，将策略降低一下就可以了</em></strong></p>\n<p>查看密码策略：</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">SHOW</span> VARIABLES <span class=\"token operator\">LIKE</span> <span class=\"token string\">'%password%'</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>修改密码策略</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">-- 修改密码长度：（长度）</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">set</span> <span class=\"token keyword\">global</span> validate_password_length<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">-- 修改密码等级：（等级）</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">set</span> <span class=\"token keyword\">global</span> validate_password_policy<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h4 id=\"4-其他配置\"><a class=\"anchor\" href=\"#4-其他配置\">#</a> 4、其他配置</h4>\n<h5 id=\"1远程连接\"><a class=\"anchor\" href=\"#1远程连接\">#</a> 1. 远程连接</h5>\n<h6 id=\"方法一-创建一个用户-支持远程连接\"><a class=\"anchor\" href=\"#方法一-创建一个用户-支持远程连接\">#</a> 方法一、创建一个用户 支持远程连接</h6>\n<p>①登录 ：mysql -u root -p</p>\n<p>②创建用户： create user 'aaa'@'%' identified by '123456';</p>\n<p>③授权所有权限给 user 这个新用户 ：grant all on <em>.</em> to 'aaa'@'%';</p>\n<p>④退出 mysql：quit;</p>\n<h6 id=\"方法二-设置root用户支持远程连接\"><a class=\"anchor\" href=\"#方法二-设置root用户支持远程连接\">#</a> 方法二、设置 root 用户支持远程连接</h6>\n<p>①登录：mysql -u root -p （ 注：系统提示输入数据库 root 用户的密码，输入完成后即进入 mysql 控制台，这个命令的第一个 mysql 是执行命令，第二个 mysql 是系统数据名称，不一样的。）</p>\n<p>②设置权限：</p>\n<p>赋予权限格式： grant 权限 on 数据库对象 to 用户 @IP (或者相应正则)</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">-- 新建用户规则或者直接修改 root 用户的规则 ，2 选一</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">use</span> mysql<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">-- 这里表示赋予该用户所有数据库所有表（*.* 表示所有表），% 表示所有 IP 地址。</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">GRANT</span> <span class=\"token keyword\">ALL</span> <span class=\"token keyword\">PRIVILEGES</span> <span class=\"token keyword\">ON</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">.</span><span class=\"token operator\">*</span> <span class=\"token keyword\">TO</span> <span class=\"token string\">'root'</span><span class=\"token variable\">@'%'</span> IDENTIFIED <span class=\"token keyword\">BY</span> <span class=\"token string\">'123456'</span> <span class=\"token keyword\">WITH</span> <span class=\"token keyword\">GRANT</span> <span class=\"token keyword\">OPTION</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">-- 使 root 能再任何 host 访问</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">update</span> <span class=\"token keyword\">user</span> <span class=\"token keyword\">set</span> host <span class=\"token operator\">=</span> <span class=\"token string\">'%'</span> <span class=\"token keyword\">where</span> <span class=\"token keyword\">user</span> <span class=\"token operator\">=</span> <span class=\"token string\">'root'</span><span class=\"token punctuation\">;</span>      </pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\">-- 刷新</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>FLUSH <span class=\"token keyword\">PRIVILEGES</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>③查看：</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">use</span> mysql<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">SELECT</span> HOST<span class=\"token punctuation\">,</span><span class=\"token keyword\">USER</span> <span class=\"token keyword\">FROM</span> <span class=\"token keyword\">USER</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><img data-src=\"/tools/tools-All/920952e9041b4af1a8a49eb64e0f4430.jpeg\" class=\"\">\n<p>④退出 mysql：quit;</p>\n<h5 id=\"2开机自启\"><a class=\"anchor\" href=\"#2开机自启\">#</a> 2. 开机自启</h5>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 开机启动</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>systemctl <span class=\"token builtin class-name\">enable</span> mysql</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 关闭自动启动</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>systemctl disable mysqld</pre></td></tr></table></figure><h3 id=\"2\"><a class=\"anchor\" href=\"#2\">#</a> ——2</h3>\n<h4 id=\"1-查询镜像\"><a class=\"anchor\" href=\"#1-查询镜像\">#</a> 1、查询镜像</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> search mysql</pre></td></tr></table></figure><h4 id=\"2-拉取镜像\"><a class=\"anchor\" href=\"#2-拉取镜像\">#</a> 2、拉取镜像</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> pull mysql:5.7</pre></td></tr></table></figure><h4 id=\"3-构建容器\"><a class=\"anchor\" href=\"#3-构建容器\">#</a> 3、构建容器</h4>\n<p>先自己创建配置文件基础模板（<strong>要是后期要修改配置文件必须加入 模板中的两个元素，不然容器启动会出错</strong>）</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">mkdir</span> <span class=\"token parameter variable\">-p</span> /root/mysql/conf</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">vim</span>  /root/mysql/conf/my.cnf</pre></td></tr></table></figure><p><strong>模板内容：</strong></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># Copyright (c) 2016, 2021, Oracle and/or its affiliates.</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">#</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># This program is free software; you can redistribute it and/or modify</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># it under the terms of the GNU General Public License, version 2.0,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># as published by the Free Software Foundation.</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">#</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\"># This program is also distributed with certain software (including</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\"># but not limited to OpenSSL) that is licensed under separate terms,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\"># as designated in a particular file or component or in included license</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\"># documentation.  The authors of MySQL hereby grant you an additional</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\"># permission to link the program and your derivative works with the</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\"># separately licensed software that they have included with MySQL.</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\">#</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\"># This program is distributed in the hope that it will be useful,</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token comment\"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token comment\"># GNU General Public License, version 2.0, for more details.</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token comment\">#</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token comment\"># You should have received a copy of the GNU General Public License</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token comment\"># along with this program; if not, write to the Free Software</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token comment\"># Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301 USA</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token operator\">!</span>includedir /etc/mysql/conf.d/</pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token operator\">!</span>includedir /etc/mysql/mysql.conf.d/</pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token punctuation\">[</span>mysql<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>default-character-set<span class=\"token operator\">=</span>utf8</pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token punctuation\">[</span>mysqld<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token assign-left variable\">character_set_server</span><span class=\"token operator\">=</span>utf8</pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token assign-left variable\">init_connect</span><span class=\"token operator\">=</span><span class=\"token string\">'SET NAMES utf8'</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>lower_case_table_names <span class=\"token operator\">=</span> <span class=\"token number\">1</span></pre></td></tr></table></figure><p><strong>构建容器</strong></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> run <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token parameter variable\">-p</span> <span class=\"token number\">3306</span>:3306 <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token parameter variable\">-v</span> /root/mysql/data:/var/lib/mysql <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token parameter variable\">-v</span> /root/mysql/logs:/logs <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token parameter variable\">-v</span> /root/mysql/conf/my.cnf:/etc/mysql/my.cnf <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token parameter variable\">-e</span> <span class=\"token assign-left variable\">MYSQL_ROOT_PASSWORD</span><span class=\"token operator\">=</span>root <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token parameter variable\">--name</span> mysql <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token parameter variable\">--hostname</span> node1 <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token parameter variable\">--restart</span><span class=\"token operator\">=</span>always <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token parameter variable\">-d</span> mysql:5.7</pre></td></tr></table></figure><p><strong>注</strong>：出错时将本地映射文件检查一下，要是不需要配置，只需映射直接删掉就可，以后再改配置文件</p>\n<h4 id=\"4-进入容器\"><a class=\"anchor\" href=\"#4-进入容器\">#</a> 4、进入容器</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> <span class=\"token builtin class-name\">exec</span> <span class=\"token parameter variable\">-it</span> mysql /bin/bash</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>或者</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">docker</span> <span class=\"token builtin class-name\">exec</span> <span class=\"token parameter variable\">-it</span> mysql mysql <span class=\"token parameter variable\">-uroot</span> <span class=\"token parameter variable\">-p</span></pre></td></tr></table></figure><h4 id=\"5-查看远程连接\"><a class=\"anchor\" href=\"#5-查看远程连接\">#</a> 5、查看远程连接</h4>\n<p>还有一些方法也可以试一下</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">1</span>.赋予权限格式：grant 权限 on 数据库对象 to 用户@IP<span class=\"token punctuation\">(</span>或者相应正则<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>　　　　注：可以赋予select,delete,update,insert,index等权限精确到某一个数据库某一个表。</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>　　　　GRANT ALL PRIVILEGES ON *.* TO <span class=\"token string\">'用户名'</span>@<span class=\"token string\">'%'</span> IDENTIFIED BY <span class=\"token string\">'密码'</span> WITH GRANT OPTION<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t  GRANT ALL PRIVILEGES ON *.* TO <span class=\"token string\">'root'</span>@<span class=\"token string\">'%'</span> IDENTIFIED BY <span class=\"token string\">'123456'</span> WITH GRANT OPTION<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>　　　　这里表示赋予该用户所有数据库所有表（*.*表示所有表），%表示所有IP地址。</pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token number\">2</span>.刷新权限：FLUSH PRIVILEGES<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token number\">3</span>.查看权限：select user,host from mysql.user<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>二.意外</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>　　<span class=\"token number\">1</span>.配置文件种指定了blind-address：</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>　　　　查看Mysql配置文件种（一般是/etc/my.cnf种）是否指定了blind-address，这表示只能是某个或某几个ip能连接。如果有就将它注释了，前面加<span class=\"token comment\">#号注释。然后从启 mysql。</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    　重启mysql：service mysqld restart,如果安装的是Mariadb（我的就是）,则需要使用systemctl restart mariadb.service</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    　</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token number\">2</span>.防火墙的原因：</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>　　　　可能会报：ERROR <span class=\"token number\">2003</span> <span class=\"token punctuation\">(</span>HY000<span class=\"token punctuation\">)</span>: Can<span class=\"token string\">'t connect to MySQL server on '</span>你要连接的IP<span class=\"token string\">' (111)。</pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>　　　　原因：1.可能是Mysql端口不对（默认是3306），只需加参数 -P 你的端口指定就行；</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>　　　　</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>　　　2.还有可能是有防火墙阻止，可以通过telnet来测试（可以直接关闭防火墙）。</pre></td></tr><tr><td data-num=\"25\"></td><td><pre>　　　　　　　　　　防火墙相关命令：</pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>　　　　　　　　　　　　（1）查看防火墙状态：service  iptables status或者systemctl status firewalld或者firewall-cmd --state</pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>　　　　　　　　　　　　（2）暂时关闭防火墙：systemctl stop firewalld或者service  iptables stop或者systemctl stop firewalld.service</pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>　　　　　　　　　　　　（3）永久关闭防火墙：systemctl disable firewalld或者chkconfig iptables off或者systemctl disable firewalld.service</pre></td></tr><tr><td data-num=\"32\"></td><td><pre></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>　　　　　　　　　　　　（4）重启防火墙：systemctl enable firewalld或者service iptables restart  或者systemctl restart firewalld.service</pre></td></tr><tr><td data-num=\"34\"></td><td><pre></pre></td></tr><tr><td data-num=\"35\"></td><td><pre> 　　　　　　　　　　　　 (5)永久关闭后重启：chkconfig iptables on</pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>　　</pre></td></tr><tr><td data-num=\"38\"></td><td><pre></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>　　3.端口未开启：（我遇到的就是这个原因）</pre></td></tr><tr><td data-num=\"40\"></td><td><pre>　　　　　　Mysql：ERROR 2003 (HY000) 110（连接超时）</pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>　　　　　　查看你的服务器是否把对应端口打开，未打开启动就行了。　</pre></td></tr><tr><td data-num=\"43\"></td><td><pre>　　　　　　</pre></td></tr><tr><td data-num=\"44\"></td><td><pre>   4.Navicat连接MySQL，出现2059 - authentication plugin '</span>caching_sha2_password<span class=\"token string\">'的解决方案</pre></td></tr><tr><td data-num=\"45\"></td><td><pre>  \t</pre></td></tr><tr><td data-num=\"46\"></td><td><pre>  \t0先进入容器，</pre></td></tr><tr><td data-num=\"47\"></td><td><pre>  \tdocker exec -it mysql mysql -uroot -p</pre></td></tr><tr><td data-num=\"48\"></td><td><pre>  \t</pre></td></tr><tr><td data-num=\"49\"></td><td><pre>  \t1#修改加密规则password是自己的密码，root也是登陆账户，下同。</pre></td></tr><tr><td data-num=\"50\"></td><td><pre>  \tuse mysql;</pre></td></tr><tr><td data-num=\"51\"></td><td><pre>    ALTER USER '</span>root<span class=\"token string\">'@'</span>localhost<span class=\"token string\">' IDENTIFIED BY '</span>root<span class=\"token string\">' PASSWORD EXPIRE NEVER; </pre></td></tr><tr><td data-num=\"52\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"53\"></td><td><pre>\t2 #更新一下用户的密码 </pre></td></tr><tr><td data-num=\"54\"></td><td><pre>\tALTER USER '</span>root<span class=\"token string\">'@'</span>localhost<span class=\"token string\">' IDENTIFIED WITH mysql_native_password BY '</span>root<span class=\"token string\">';</pre></td></tr><tr><td data-num=\"55\"></td><td><pre>\t</pre></td></tr><tr><td data-num=\"56\"></td><td><pre>\t3#刷新权限 </pre></td></tr><tr><td data-num=\"57\"></td><td><pre>\tFLUSH PRIVILEGES; </pre></td></tr><tr><td data-num=\"58\"></td><td><pre>\t</pre></td></tr><tr><td data-num=\"59\"></td><td><pre>\t4#更新一下用户的密码</pre></td></tr><tr><td data-num=\"60\"></td><td><pre>\tALTER USER '</span>root<span class=\"token string\">'@'</span>%<span class=\"token string\">' IDENTIFIED WITH mysql_native_password BY '</span>root'<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"21\"><a class=\"anchor\" href=\"#21\">#</a> ——2.1</h3>\n<p>前提安装了 docker-compose，配置  docker-comose.yml 文件</p>\n<p>5.7：</p>\n<figure class=\"highlight yml\"><figcaption data-lang=\"YAML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"3.0\"</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token key atrule\">mysql8</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> mysql<span class=\"token punctuation\">:</span>5.7.32</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token key atrule\">container_name</span><span class=\"token punctuation\">:</span> my_db57</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token key atrule\">restart</span><span class=\"token punctuation\">:</span> always</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      <span class=\"token punctuation\">-</span> ./db<span class=\"token punctuation\">:</span>/var/lib/mysql</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      <span class=\"token punctuation\">-</span> ./conf/my.cnf<span class=\"token punctuation\">:</span>/etc/my.cnf</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      <span class=\"token comment\"># 数据库初始化脚本，当 Mysql 容器首次启动时，会在 /docker-entrypoint-initdb.d 目录下扫描 .sh，.sql，.sql.gz 类型的文件。如果这些类型的文件存在，将执行它们来初始化一个数据库；</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token punctuation\">-</span> ./init/<span class=\"token punctuation\">:</span>/docker<span class=\"token punctuation\">-</span>entrypoint<span class=\"token punctuation\">-</span>initdb.d/</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      <span class=\"token punctuation\">-</span> MYSQL_ROOT_PASSWORD=123456</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>      <span class=\"token comment\"># 指定初始化 sql 文件的数据库，简单来书就是新建一个数据库</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>      <span class=\"token punctuation\">-</span> MYSQL_DATABASE=my_db</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>      <span class=\"token punctuation\">-</span> TZ=Asia/Shanghai</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>      <span class=\"token punctuation\">-</span> 3311<span class=\"token punctuation\">:</span><span class=\"token number\">3306</span></pre></td></tr></table></figure><p>8.0</p>\n<figure class=\"highlight yml\"><figcaption data-lang=\"YAML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"3.0\"</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token key atrule\">mysql8</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> mysql<span class=\"token punctuation\">:</span>8.0.25</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token key atrule\">container_name</span><span class=\"token punctuation\">:</span> my_db8</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token key atrule\">restart</span><span class=\"token punctuation\">:</span> always</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      <span class=\"token punctuation\">-</span> ./db<span class=\"token punctuation\">:</span>/var/lib/mysql</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      <span class=\"token punctuation\">-</span> ./conf/my.cnf<span class=\"token punctuation\">:</span>/etc/my.cnf</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      <span class=\"token comment\"># 数据库初始化脚本，当 Mysql 容器首次启动时，会在 /docker-entrypoint-initdb.d 目录下扫描 .sh，.sql，.sql.gz 类型的文件。如果这些类型的文件存在，将执行它们来初始化一个数据库；</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token punctuation\">-</span> ./init/<span class=\"token punctuation\">:</span>/docker<span class=\"token punctuation\">-</span>entrypoint<span class=\"token punctuation\">-</span>initdb.d/</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      <span class=\"token punctuation\">-</span> MYSQL_ROOT_PASSWORD=123456</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>      <span class=\"token comment\"># 指定初始化 sql 文件的数据库，简单来书就是新建一个数据库</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>      <span class=\"token punctuation\">-</span> MYSQL_DATABASE=my_db</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>      <span class=\"token punctuation\">-</span> TZ=Asia/Shanghai</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>      <span class=\"token punctuation\">-</span> 3301<span class=\"token punctuation\">:</span><span class=\"token number\">3306</span></pre></td></tr></table></figure><p>配置文件 my.cnf</p>\n<p>5.7：</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>mysql<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># 设置 mysql 客户端默认字符集</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>default-character-set<span class=\"token operator\">=</span>utf8mb4</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">[</span>mysqld<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token assign-left variable\">datadir</span><span class=\"token operator\">=</span>/var/lib/mysql</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token assign-left variable\">socket</span><span class=\"token operator\">=</span>/var/lib/mysql/mysql.sock</pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>symbolic-links<span class=\"token operator\">=</span><span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>log-error<span class=\"token operator\">=</span>/var/log/mysqld.log</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>pid-file<span class=\"token operator\">=</span>/var/run/mysqld/mysqld.pid</pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\"># 服务端使用的字符集默认为 8 比特编码的 latin1 字符集</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>character-set-server<span class=\"token operator\">=</span>utf8mb4</pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token comment\"># 创建新表时将使用的默认存储引擎</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>default-storage-engine<span class=\"token operator\">=</span>INNODB</pre></td></tr></table></figure><p>8.0：</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>mysql<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># 设置 mysql 客户端默认字符集</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>default-character-set<span class=\"token operator\">=</span>utf8mb4</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">[</span>mysqld<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># 允许最大连接数</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token assign-left variable\">max_connections</span><span class=\"token operator\">=</span><span class=\"token number\">200</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\"># 服务端使用的字符集默认为 8 比特编码的 latin1 字符集</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>character-set-server<span class=\"token operator\">=</span>utf8mb4</pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\"># 创建新表时将使用的默认存储引擎</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>default-storage-engine<span class=\"token operator\">=</span>INNODB</pre></td></tr></table></figure><h3 id=\"问题\"><a class=\"anchor\" href=\"#问题\">#</a> 问题</h3>\n<p>1、Can't create/write to file '/var/run/mysqld/mysqld.pid</p>\n<p>去配置文件中找到 errorlog 的地址，查看错误日志</p>\n<img data-src=\"/tools/tools-All/20190602012200812.png\" class=\"\">\n<p>错误原因为：/var/run/mysqld/ 目录的拥有者为 root，mysql 不能在其中创建文件</p>\n<p>使用如下命令修改目录使用者</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 先查看目录是否存在</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">ls</span> <span class=\"token parameter variable\">-ld</span> /var/run/mysqld/</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 权限</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">chown</span> mysql.mysql /var/run/mysqld/</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># 修改后重启 mysql 服务</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>/etc/init.d/mysqld start</pre></td></tr></table></figure><h2 id=\"fastdfs安装\"><a class=\"anchor\" href=\"#fastdfs安装\">#</a> FastDFS 安装</h2>\n<h3 id=\"1-3\"><a class=\"anchor\" href=\"#1-3\">#</a> ——1</h3>\n<h4 id=\"1安装fastdfs依赖\"><a class=\"anchor\" href=\"#1安装fastdfs依赖\">#</a> 1. 安装 FastDFS 依赖</h4>\n<p>FastDFS 是 C 语言开发的应用。安装必须使用 make , cmake 和 gcc 编译器。</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>yum <span class=\"token function\">install</span> <span class=\"token parameter variable\">-y</span> <span class=\"token function\">make</span> cmake gcc gcc-c++</pre></td></tr></table></figure><h4 id=\"2-上传并解压libfastcommon-master\"><a class=\"anchor\" href=\"#2-上传并解压libfastcommon-master\">#</a> 2 上传并解压 libfastcommon-master</h4>\n<p>​\t上传 libfastcommon-master 到 /usr/local/tmp 下。 libfastcommon 是从 FastDFS 和 FastDHT 中提取出来的公共 C 函数库</p>\n<p>​\t解压 libfastcommon-master.zip 由于是 zip 文件所以要使用 unzip 命令</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">cd</span> /usr/local/tmp</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token function\">unzip</span> libfastcommon-master.zip</pre></td></tr></table></figure><h4 id=\"3-编译并安装\"><a class=\"anchor\" href=\"#3-编译并安装\">#</a> 3 编译并安装</h4>\n<p>​\tlibfastcommon 没有提供 make 命令安装文件。使用的是 shell 脚本执行编译和安装。shell 脚本为 <span class=\"exturl\" data-url=\"aHR0cDovL21ha2Uuc2g=\">make.sh</span></p>\n<p>​\t进入解压后的文件</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">cd</span> libfastcommon-master</pre></td></tr></table></figure><p>​\t编译</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>./make.sh</pre></td></tr></table></figure><p>​\t安装</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>./make.sh <span class=\"token function\">install</span></pre></td></tr></table></figure><p>​\t有固定的默认安装位置。在 /usr/lib64 和  /usr/include/fastcommon 两个目录中</p>\n<h4 id=\"4-创建软连接\"><a class=\"anchor\" href=\"#4-创建软连接\">#</a> 4 创建软连接</h4>\n<p>​\t 因为 FastDFS 主程序设置的 lib 目录是 /usr/local/lib， 所以需要创建软连接</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">ln</span> <span class=\"token parameter variable\">-s</span> /user/lib64/libfastcommon.so /usr/local/lib/libfastcommon.so</pre></td></tr><tr><td data-num=\"2\"></td><td><pre> <span class=\"token function\">ln</span> <span class=\"token parameter variable\">-s</span> /usr/local/lib64/libfdfsclient.so /usr/local/lib/libfdfsclient.so</pre></td></tr></table></figure><h4 id=\"5-上传并解压fastdfs主程序\"><a class=\"anchor\" href=\"#5-上传并解压fastdfs主程序\">#</a> 5 上传并解压 FastDFS 主程序</h4>\n<p>​\t 上传 FastDFS_v5.08.tar.gz 到 /usr/local/tmp 下后解压</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">cd</span> /usr/local/tmp</pre></td></tr><tr><td data-num=\"2\"></td><td><pre> <span class=\"token function\">tar</span> zxf FastDFS_v5.08.tar.gz</pre></td></tr></table></figure><h4 id=\"6-编译并安装fastdfs\"><a class=\"anchor\" href=\"#6-编译并安装fastdfs\">#</a> 6 编译并安装 FastDFS</h4>\n<p>​\t进入到解压后的 FastDFS 文件中</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">cd</span> FastDFS</pre></td></tr></table></figure><p>​\t编译</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>./make.sh</pre></td></tr></table></figure><p>​\t安装</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>./make.sh <span class=\"token function\">install</span></pre></td></tr></table></figure><p>​\t安装后 FastDFS 主程序所在的位置是</p>\n<p>​\t/usr/bin  可执行文件所在的位置</p>\n<p>​\t/etc/fdfs  配置文件所在的位置</p>\n<p>​\t/usr/bin  主程序代码所在位置</p>\n<p>​\t/usr/include/fastdfs 包含一些插件组所在的位置</p>\n<h4 id=\"7-配置tracker\"><a class=\"anchor\" href=\"#7-配置tracker\">#</a> 7 配置 tracker</h4>\n<h5 id=\"71-复制配置文件\"><a class=\"anchor\" href=\"#71-复制配置文件\">#</a> 7.1 复制配置文件</h5>\n<p>​\t进入到 /etc/fdfs 中 ， 把 tracker 配置文件复制一份</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">cd</span> /etc/fdfs</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token function\">cp</span> tracker.conf.sample tracker.conf</pre></td></tr></table></figure><h5 id=\"72-创建数据目录\"><a class=\"anchor\" href=\"#72-创建数据目录\">#</a> 7.2 创建数据目录</h5>\n<p>​\t创建放置 tracker 数据的目录</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">mkdir</span> <span class=\"token parameter variable\">-p</span> /usr/local/fastdfs/tracker</pre></td></tr></table></figure><h5 id=\"73-修改配置文件\"><a class=\"anchor\" href=\"#73-修改配置文件\">#</a> 7.3 修改配置文件</h5>\n<p>​\t修改 tracker.conf 设置 tracker 内容存储目录</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token assign-left variable\">base_path</span><span class=\"token operator\">=</span>/usr/local/fastdfs/tracker</pre></td></tr><tr><td data-num=\"2\"></td><td><pre> <span class=\"token function\">vim</span> tracker.conf</pre></td></tr></table></figure><p>默认端口 22122   不需要修改</p>\n<h5 id=\"74-启动服务\"><a class=\"anchor\" href=\"#74-启动服务\">#</a> 7.4 启动服务</h5>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">service</span> fdfs_trackerd start</pre></td></tr></table></figure><p>​\t启动成功后， 配置文件中 base_path 指向的目录出现 FastDFS 服务相关数据目录 (data 目录， logs 目录)</p>\n<h5 id=\"75-查看服务运行状态\"><a class=\"anchor\" href=\"#75-查看服务运行状态\">#</a> 7.5 查看服务运行状态</h5>\n<pre><code>  service fdfs_trackerd status\n</code></pre>\n<p>​\t如果显示 is running 表示正常运行。</p>\n<h5 id=\"76-关闭防火墙\"><a class=\"anchor\" href=\"#76-关闭防火墙\">#</a> 7.6 关闭防火墙</h5>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">service</span> iptables stop</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token function\">chkconfig</span> iptables off</pre></td></tr></table></figure><h4 id=\"8-配置storage\"><a class=\"anchor\" href=\"#8-配置storage\">#</a> 8 配置 storage</h4>\n<p>storage 可以和 tracker 不在同一台服务器上。示例中把 storage 和 tracker 安装在同一台服务器上了。</p>\n<h5 id=\"81-复制配置文件\"><a class=\"anchor\" href=\"#81-复制配置文件\">#</a> 8.1 复制配置文件</h5>\n<p>​\t进入到 /etc/fdfs, 把 storage 配置文件复制一份</p>\n<pre><code> cd /etc/fdfs\n cp storage.conf.sample storage.conf\n</code></pre>\n<h5 id=\"82-创建目录\"><a class=\"anchor\" href=\"#82-创建目录\">#</a> 8.2 创建目录</h5>\n<p>​\t 创建两个目录， 把 base 用于存储基础数据和日志，store 用于存储上传数据。</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">mkdir</span> <span class=\"token parameter variable\">-p</span> /usr/local/fastdfs/storage/base</pre></td></tr><tr><td data-num=\"2\"></td><td><pre> <span class=\"token function\">mkdir</span> <span class=\"token parameter variable\">-p</span> /usr/local/fastdfs/storage/store</pre></td></tr></table></figure><h5 id=\"83-修改配置文件\"><a class=\"anchor\" href=\"#83-修改配置文件\">#</a> 8.3 修改配置文件</h5>\n<p>​\tstorage.conf 配置文件用于描述存储服务的行为，需要进行下述修改</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">vim</span> /etc/fdfs/storage.conf</pre></td></tr></table></figure><p>​\t配置内容如下：</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token assign-left variable\">base_path</span><span class=\"token operator\">=</span>/usr/local/fastdfs/storage/base</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token assign-left variable\">store_path0</span><span class=\"token operator\">=</span>/usr/local/fastdfs/storage/store</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token assign-left variable\">tracker_server</span><span class=\"token operator\">=</span>tracker 服务IP：22122</pre></td></tr></table></figure><p>​\tbase_path - 基础路径。用于保存 storage server 基础数据内容和日志内容的目录。</p>\n<p>​\tstore_path0 - 存储路径。是用于保存 FastDFS 中存储文件的目录，就是要创建 256*256 个子目录的位置。</p>\n<p>​\tbase_path 和 store_path0 可以使用同一个目录。</p>\n<p>​\ttracker_server - 跟踪服务器位置。就是跟踪服务器的 IP 和端口。</p>\n<p>​\t启动服务</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">service</span> fdfs_storaged start</pre></td></tr></table></figure><p>​\t启动成功后，配置文件中 base_path 指向的目录中出现 FastDFS 服务相关数据目录（data 目录、logs 目录）配置文件中的 store_path0 指向的目录中同样出现 FastDFS 存储相关数据录（data 目录）。其中 $store_path0/data/ 目录中默认创建若干子孙目录（两级目录层级总计 256*256 个目录），是用于存储具体文件数据的。</p>\n<p>​\tStorage 服务器启动比较慢，因为第一次启动的时候，需要创建 256*256 个目录。</p>\n<p>​\t查看启动状态</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">service</span> fdfs_storaged status</pre></td></tr></table></figure><h3 id=\"2-2\"><a class=\"anchor\" href=\"#2-2\">#</a> ——2</h3>\n<img data-src=\"/tools/tools-All/b60ca697c06d4425b7cd228b98dc3d19.png\" class=\"\">\n<p>  FastDFS 的安装我们还是通过 Docker 来安装实现吧，直接在 Linux 上还装还是比较繁琐的，但就学习而言 Docker 安装还是非常高效的。Docker 环境请自行安装哦，不清楚的可以看看我的 Docker 专题的内容。<a href=\"Docker%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%96%99\" title=\"Docker学习资料\">https://blog.csdn.net/qq_38526573/category_9619681.html</a></p>\n<h4 id=\"1拉取镜像文件\"><a class=\"anchor\" href=\"#1拉取镜像文件\">#</a> 1. 拉取镜像文件</h4>\n<p>  首先我们可以通过  <code>docker search fastdfs</code>  来查询下有哪些镜像文件。</p>\n<img data-src=\"/tools/tools-All/5a06a59eb24d4f9e847a4badeef871ac.png\" class=\"\">\n<p>  我们看到搜索到的镜像还是蛮多的，这里我们使用  <code>delron/fastdfs</code>  你也可以尝试使用其他的镜像来安装，你也可以制作自己的镜像来给别人使用哦，只是不同的镜像在使用的时候配置会有一些不一样，有些镜像没有提供 Nginx 的相关配置，使用的时候会繁琐一点。接下来通过  <code>docker pull delron/fastdfs</code>  命令把镜像拉取下来。</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> pull delron/fastdfs</pre></td></tr></table></figure><img data-src=\"/tools/tools-All/5e5b85b3dc9a432abf615b27868fc7bf.png\" class=\"\">\n<h4 id=\"2构建tracker服务\"><a class=\"anchor\" href=\"#2构建tracker服务\">#</a> 2. 构建 Tracker 服务</h4>\n<p>  首先我们需要通过 Docker 命令来创建 Tracker 服务。命令为</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> run <span class=\"token parameter variable\">-d</span> <span class=\"token parameter variable\">--name</span> tracker <span class=\"token parameter variable\">--network</span><span class=\"token operator\">=</span>host <span class=\"token parameter variable\">-v</span> /mydata/fastdfs/tracker:/var/fdfs delron/fastdfs tracker</pre></td></tr></table></figure><p>  tracker 服务默认的端口为 22122，-v 实现了容器和本地目录的挂载操作。</p>\n<img data-src=\"/tools/tools-All/694d42632bf6410a806df9aa43e836c0.png\" class=\"\">\n<h4 id=\"3构建storage服务\"><a class=\"anchor\" href=\"#3构建storage服务\">#</a> 3. 构建 Storage 服务</h4>\n<p>  接下来创建 Storage 服务，具体的执行命令如下</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> run <span class=\"token parameter variable\">-d</span> <span class=\"token parameter variable\">--name</span> storage <span class=\"token parameter variable\">--network</span><span class=\"token operator\">=</span>host  <span class=\"token parameter variable\">-e</span> <span class=\"token assign-left variable\">TRACKER_SERVER</span><span class=\"token operator\">=</span><span class=\"token number\">192.168</span>.1.195:22122 <span class=\"token parameter variable\">-v</span> /mydata/fastdfs/storage:/var/fdfs <span class=\"token parameter variable\">-e</span> <span class=\"token assign-left variable\">GROUP_NAME</span><span class=\"token operator\">=</span>group1 delron/fastdfs storage</pre></td></tr></table></figure><p>  在执行上面命令的时候要注意对应的修改下，其中 TRACKER_SERVER 中的 ip 要修改为你的 Tracker 服务所在的服务 IP 地址。</p>\n<img data-src=\"/tools/tools-All/dc2bdf85d0f24fe18a32efbe4caa2d27.png\" class=\"\">\n<p>  默认情况下在 Storage 服务中是帮我们安装了 Nginx 服务的，相关的端口为</p>\n<table>\n<thead>\n<tr>\n<th>服务</th>\n<th>默认端口</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>tracker</td>\n<td>22122</td>\n</tr>\n<tr>\n<td>storage</td>\n<td>23000</td>\n</tr>\n<tr>\n<td>Nginx</td>\n<td>8888</td>\n</tr>\n</tbody>\n</table>\n<p>  当然如果你发现这些相关的端口被占用了，或者想要对应的修改端口信息也可以的。要修改你可以先进入容器中查看下相关的配置文件信息。</p>\n<img data-src=\"/tools/tools-All/da5cc21445e840baa85580ba420db94d.png\" class=\"\">\n<p>  然后查看 storage.conf 文件</p>\n<img data-src=\"/tools/tools-All/63862499980b408195291de047048566.png\" class=\"\">\n<p>  这个是 storage 监听的 Nginx 的端口 8888，如果要修改那么我们还需要修改 Nginx 中的服务配置，这块的配置在  <code>/usr/local/nginx/conf</code>  目录下</p>\n<img data-src=\"/tools/tools-All/f866c08177be4fd48bfd9a582ec78779.png\" class=\"\">\n<p>  查看下文件</p>\n<img data-src=\"/tools/tools-All/dc7c5888363a400b9308f3ba64cca9ac.png\" class=\"\">\n<p>所以要修改端口号的话，这两个位置都得修改了。当然本文我们就使用默认的端口号来使用了。</p>\n<h4 id=\"4测试图片上传\"><a class=\"anchor\" href=\"#4测试图片上传\">#</a> 4. 测试图片上传</h4>\n<p>  好了，安装我们已经完成了，那么到底是否可以使用呢？我们来测试下。首先在虚拟机的 /mydata/fastdfs/storage 下保存一张图片。</p>\n<img data-src=\"/tools/tools-All/ff2ea2626bb34acd810fbb8d9438129a.png\" class=\"\">\n<p>  然后我们再进入到 storage 容器中。并且进入到  <code>/var/fdfs</code>  目录下，可以看到我们挂载的文件了</p>\n<img data-src=\"/tools/tools-All/cb8a96fb9bb644328880ca70378a7fc2.png\" class=\"\">\n<p>  然后执行如下命令即可完成图片的上传操作</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>/usr/bin/fdfs_upload_file /etc/fdfs/client.conf <span class=\"token number\">1</span>.jpg</pre></td></tr></table></figure><img data-src=\"/tools/tools-All/0fd0e82898bb45178eca4eef9a412745.png\" class=\"\">\n<p>  通过上面的提示我们看到文件上传成功了，而且返回了文件在 storage 中存储的信息。这时我们就可以通过这个信息来拼接访问的地址在浏览器中访问了：<span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguNTYuMTAwOjg4ODgvZ3JvdXAxL00wMC8wMC8wMC93S2c0WkdIY0tMU0FYaWJhQUFlek11VXJsUzgyMzUuanBn\">http://192.168.56.100:8888/group1/M00/00/00/wKg4ZGHcKLSAXibaAAezMuUrlS8235.jpg</span></p>\n<img data-src=\"/tools/tools-All/b34e823e956f410297bfd1218ebc0231.png\" class=\"\">\n<p>  好了到这儿 FastDFS 的服务安装成功了。</p>\n<div name=\"nginx_install_1\" ></div>\n## nginx安装\n<div name=\"nginx_install_2\">\n<h3 id=\"2-3\"><a class=\"anchor\" href=\"#2-3\">#</a> ——2</h3>\n<h4 id=\"1-拉取镜像\"><a class=\"anchor\" href=\"#1-拉取镜像\">#</a> 1、拉取镜像</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> pull nginx:1.16.1</pre></td></tr></table></figure><h4 id=\"2-创建挂载数据卷\"><a class=\"anchor\" href=\"#2-创建挂载数据卷\">#</a> 2、创建挂载数据卷</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">mkdir</span> <span class=\"token parameter variable\">-p</span> /root/nginx/conf</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">vim</span> /root/nginx/conf/nginx.conf</pre></td></tr></table></figure><p><code>nginx.conf内容：</code></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>user  root<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>worker_processes  auto<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre> </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>error_log  /var/log/nginx/error.log warn<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>pid        /var/run/nginx.pid<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre> </pre></td></tr><tr><td data-num=\"7\"></td><td><pre> </pre></td></tr><tr><td data-num=\"8\"></td><td><pre>events <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    worker_connections  <span class=\"token number\">1024</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre> </pre></td></tr><tr><td data-num=\"12\"></td><td><pre> </pre></td></tr><tr><td data-num=\"13\"></td><td><pre>http <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    include       /etc/nginx/mime.types<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    default_type  application/octet-stream<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre> </pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    log_format  main  <span class=\"token string\">'$remote_addr - $remote_user [$time_local] \"$request\" '</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>                      <span class=\"token string\">'$status $body_bytes_sent \"$http_referer\" '</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>                      <span class=\"token string\">'\"$http_user_agent\" \"$http_x_forwarded_for\"'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre> </pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    access_log  /var/log/nginx/access.log  main<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre> </pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    sendfile        on<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token comment\">#tcp_nopush     on;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre> </pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    keepalive_timeout  <span class=\"token number\">65</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre> </pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token comment\">#gzip  on;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    server <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    \tlisten       <span class=\"token number\">80</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    \tserver_name  localhost<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    \t<span class=\"token comment\">#charset koi8-r;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    \t<span class=\"token comment\">#access_log  /var/log/nginx/host.access.log  main;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    \tlocation / <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        \troot   /usr/share/nginx/html<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>        \tindex  index.html index.htm<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    \t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    \t<span class=\"token comment\">#error_page  404              /404.html;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    \t<span class=\"token comment\"># redirect server error pages to the static page /50x.html</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    \terror_page   <span class=\"token number\">500</span> <span class=\"token number\">502</span> <span class=\"token number\">503</span> <span class=\"token number\">504</span>  /50x.html<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    \tlocation <span class=\"token operator\">=</span> /50x.html <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>        \troot   /usr/share/nginx/html<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>    \t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>   </pre></td></tr><tr><td data-num=\"52\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h4 id=\"3-创建容器\"><a class=\"anchor\" href=\"#3-创建容器\">#</a> 3、创建容器</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 注意 ip 一定要与检测 ip 相同</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">docker</span> run <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token parameter variable\">-p</span> <span class=\"token number\">80</span>:80 <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token parameter variable\">--name</span> nginx  <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token parameter variable\">-v</span> /root/nginx/conf/nginx.conf:/etc/nginx/nginx.conf <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token parameter variable\">-d</span> nginx:1.16.1</pre></td></tr></table></figure><h4 id=\"4-查看\"><a class=\"anchor\" href=\"#4-查看\">#</a> 4、查看</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> <span class=\"token function\">ps</span></pre></td></tr></table></figure><h2 id=\"zookeeper安装\"><a class=\"anchor\" href=\"#zookeeper安装\">#</a> Zookeeper 安装</h2>\n<h3 id=\"1-4\"><a class=\"anchor\" href=\"#1-4\">#</a> ——1</h3>\n<h4 id=\"1-zookeeper简介\"><a class=\"anchor\" href=\"#1-zookeeper简介\">#</a> 1     Zookeeper 简介</h4>\n<p>​\tzookeeper 分布式管理软件。常用它做注册中心（依赖 zookeeper 的发布 / 订阅功能）、配置文件中心、分布式锁配置、集群管理等。</p>\n<p>​\tzookeeper 一共就有两个版本。主要使用的是 java 语言写的。</p>\n<h4 id=\"2-安装\"><a class=\"anchor\" href=\"#2-安装\">#</a> 2     安装</h4>\n<h5 id=\"21-上传压缩文件\"><a class=\"anchor\" href=\"#21-上传压缩文件\">#</a> 2.1   上传压缩文件</h5>\n<p>​\t上传到 /usr/local/tmp 中</p>\n<h4 id=\"22-解压\"><a class=\"anchor\" href=\"#22-解压\">#</a> 2.2   解压</h4>\n<pre><code> tar zxf apache-zookeeper-3.5.5-bin.tar.gz\n cp -r apache-zookeeper-3.5.5-bin ../zookeeper\n</code></pre>\n<h4 id=\"23-新建data目录\"><a class=\"anchor\" href=\"#23-新建data目录\">#</a> 2.3   新建 data 目录</h4>\n<p>进入到 zookeeper 中</p>\n<pre><code> cd /usr/local/zookeeper\n mkdir data\n</code></pre>\n<h4 id=\"24-修改配置文件\"><a class=\"anchor\" href=\"#24-修改配置文件\">#</a> 2.4   修改配置文件</h4>\n<p>进入 conf 中</p>\n<pre><code> cd conf\n cp zoo_sample.cfg zoo.cfg\n vim zoo.cfg\n</code></pre>\n<p>修改 dataDir 为 data 文件夹路径</p>\n<pre><code>dataDir=/usr/local/zookeeper/data\n</code></pre>\n<h4 id=\"25-启动zookeeper\"><a class=\"anchor\" href=\"#25-启动zookeeper\">#</a> 2.5   启动 zookeeper</h4>\n<p>进入 bin 文件夹</p>\n<pre><code> cd /usr/local/zookeeper/bin\n ./zkServer.sh start\n</code></pre>\n<p>通过 status 查看启动状态。稍微有个等待时间</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>./zkServer.sh status</pre></td></tr></table></figure><h3 id=\"2-4\"><a class=\"anchor\" href=\"#2-4\">#</a> ——2</h3>\n<p><strong>资料：</strong></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20va2luZ2tvby9wLzg3MzI0NDguaHRtbA==\">https://www.cnblogs.com/kingkoo/p/8732448.html</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL2F2ODA4NzQ2NjY/ZnJvbT1zZWFyY2gmYW1wO3NlaWQ9MTYyOTE0NTAyNTIxMTk5OTEwNCZhbXA7c3BtX2lkX2Zyb209MzMzLjMzNy4wLjA=\">https://www.bilibili.com/video/av80874666?from=search&amp;seid=1629145025211999104&amp;spm_id_from=333.337.0.0</span></p>\n<h4 id=\"1-zookeeper简介-2\"><a class=\"anchor\" href=\"#1-zookeeper简介-2\">#</a> 1     Zookeeper 简介</h4>\n<p>​\tzookeeper 分布式管理软件。常用它做注册中心（依赖 zookeeper 的发布 / 订阅功能）、配置文件中心、分布式锁配置、集群管理等。</p>\n<p>​\tzookeeper 一共就有两个版本。主要使用的是 java 语言写的。</p>\n<h4 id=\"2-安装-2\"><a class=\"anchor\" href=\"#2-安装-2\">#</a> 2     安装</h4>\n<h5 id=\"21-拉取镜像\"><a class=\"anchor\" href=\"#21-拉取镜像\">#</a> 2.1   拉取镜像</h5>\n<ul>\n<li>\n<p>自定义 zookeeper 目录</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">mkdir</span> /root/zookeeper</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">mkdir</span> /root/zookeeper/data <span class=\"token comment\">#原因参照上面 - 在 docker 中 data 其实也不用在宿主机行自己生成 (目前如此)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">#仓库官网查看版本或者用命令直接查</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">docker</span> search zookeeper</pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">#拉取特定版本（3.5）</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token function\">docker</span> pull zookeeper:3.5</pre></td></tr></table></figure></li>\n</ul>\n<h5 id=\"22-创建并启动容器\"><a class=\"anchor\" href=\"#22-创建并启动容器\">#</a> 2.2 创建并启动容器</h5>\n<p>​\t<strong>注：就目前而且 好像直接在 docker 中使用 zookeeper 不需要过多的配置，直接用命令创建吧，下面的解释先不看，具体原因后面补充</strong></p>\n<p>命令：</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> run <span class=\"token parameter variable\">-d</span> <span class=\"token parameter variable\">--name</span> zookeeper <span class=\"token parameter variable\">-v</span> /root/zookeeper/data:/data <span class=\"token parameter variable\">-p</span> <span class=\"token number\">2181</span>:2181 <span class=\"token parameter variable\">--restart</span> always zookeeper:3.5</pre></td></tr></table></figure><ul>\n<li><code>--restart always</code> ：始终重启</li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vYWdlb3ZiL3AvMTUzMjg3OTYuaHRtbA==\">https://www.cnblogs.com/ageovb/p/15328796.html</span></li>\n</ul>\n<p><strong>解释</strong></p>\n<ul>\n<li>\n<p>1、这里为啥只挂载了 data 目录 --》因为当我们 没有直接的安装压缩包时，我们的就没有配置文件，所以我们直接生成，容器中就回自动生成 conf 文件，其中就有我们需要的 一系列配置文件，我们第一次创建的时候就可以如此，我们在进<strong>行配置文件的修改完成</strong>后，要将所有配置文件放到我们  bash 目录中的 conf 文件中去。</p>\n</li>\n<li>\n<p>2、第一次进入容器</p>\n<ul>\n<li>\n<p>在 bash 目录下进入 bin 目录然后输入开启客户端命令</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>./zkCli.sh</pre></td></tr></table></figure></li>\n</ul>\n</li>\n<li>\n<p>3、第二次进入容器</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> <span class=\"token builtin class-name\">exec</span> <span class=\"token parameter variable\">-it</span> zookeeper /bin/bash  <span class=\"token parameter variable\">-p</span>    端口号</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>或</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">docker</span> <span class=\"token builtin class-name\">exec</span> <span class=\"token parameter variable\">-it</span> zookeeper zkCli.sh</pre></td></tr></table></figure></li>\n</ul>\n<p><em><em>只看到这就可</em>，容器创建成功就可以直接用了，还没有出现问题。有待补充</em> *</p>\n<h5 id=\"23-修改配置文件\"><a class=\"anchor\" href=\"#23-修改配置文件\">#</a> 2.3   修改配置文件</h5>\n<ul>\n<li>配置文件来源\n<ul>\n<li>1、可以去我们的资料中直接解压出<strong> conf</strong> 目录粘贴到我们的 zookeeper 目录中去</li>\n<li>2、可以直接进行第 3 步，完事之后直接会在容器中生成。找到 conf 文件，修改其中的 zoo.cfg 文件，</li>\n</ul>\n</li>\n</ul>\n<p>进入容器后，找到 conf 中的 **zoo.cfg 文件，接下来就是修改 <strong>dataDir</strong> 路径为容器中的 data 文件目录。</p>\n<p>前提是要下载 vim ，因为容器中没有，命令是：</p>\n<pre><code>apt-get update\n\napt-get install -y vim\n\ncd conf\n# 没有zoo.cfg 就先拷贝 zoo_sample.cfg 两个其实是一个文件，内容相同\n#cp zoo_sample.cfg zoo.cfg\nvim zoo.cfg\n</code></pre>\n<p>修改 dataDir 为 data 文件夹路径</p>\n<pre><code>dataDir=/usr/local/zookeeper/data\n</code></pre>\n<h2 id=\"zookeeper集群搭建\"><a class=\"anchor\" href=\"#zookeeper集群搭建\">#</a> Zookeeper 集群搭建</h2>\n<h3 id=\"1-5\"><a class=\"anchor\" href=\"#1-5\">#</a> ——1</h3>\n<p>1. 上传压缩包到 /usr/local/tmp 下 并解压。</p>\n<p>2. 在 /usr/local 下新建文件夹 zookeeper</p>\n<pre><code># mkdir /usr/local/zookeeper\n</code></pre>\n<p>3. 把解压的所有文件复制到 zookeeper 下， 并命名为 zk1</p>\n<pre><code># cp -r /usr/local/temp/zookeeper-3.4.8 /usr/local/zookeeper/zk1\n</code></pre>\n<p>4. 在 zk1 下新建文件夹 data</p>\n<p>5. 在 data 下新建文件 myid, 里面写上 1</p>\n<pre><code># vim myid\n</code></pre>\n<p>6. 进入到 zk1/conf 下 把 zoo_sample.cfg 复制一份叫做 zoo.cfg</p>\n<p>7. 编辑 zoo.cfg 内容，设置 dataDIR 为 data 文件夹， 并在文件最下面添加下面内容</p>\n<pre><code>server.1=192.168.93.10:2688:3888\nserver.2=192.168.93.10:2689:3889\nserver.3=192.168.93.10:2690:3890\n</code></pre>\n<p>7.1 server.1 中的 1 是 myid 的内容</p>\n<p>7.2 2688 2689 2690 是 zookeeper 内部端口</p>\n<p>7.3 3888 3889 3890 是 leader 端口</p>\n<p>8. 把 zk1 复制两份，分部叫做 zk2  zk3  并修改 myid 的值为 2，3 修改 zoo.cfg 中 dataDIR 和 clientPort</p>\n<p>9. 启动三个 zookeeper</p>\n<pre><code># ./zkServer.sh start\n</code></pre>\n<p>10. 查看状态</p>\n<pre><code># ./zkServer.sh status\n</code></pre>\n<h3 id=\"2-5\"><a class=\"anchor\" href=\"#2-5\">#</a> ——2</h3>\n<h4 id=\"1-准备docker-composeyml文件\"><a class=\"anchor\" href=\"#1-准备docker-composeyml文件\">#</a> <strong>1、准备</strong> docker-compose.yml<strong> 文件</strong></h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>version: <span class=\"token string\">'2'</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>services:</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  zoo1:</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    image: zookeeper:3.5</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    restart: always</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    container_name: zoo1</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    ports:</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      - <span class=\"token string\">\"2182:2181\"</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    environment:</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      ZOO_MY_ID: <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      ZOO_SERVERS: <span class=\"token assign-left variable\">server.1</span><span class=\"token operator\">=</span><span class=\"token number\">0.0</span>.0.0:2688:3888 <span class=\"token assign-left variable\">server.2</span><span class=\"token operator\">=</span>zoo2:2689:3888 <span class=\"token assign-left variable\">server.3</span><span class=\"token operator\">=</span>zoo3:2690:3888</pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>  zoo2:</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    image: zookeeper:3.5</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    restart: always</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    container_name: zoo2</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    ports:</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>      - <span class=\"token string\">\"2183:2181\"</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    environment:</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>      ZOO_MY_ID: <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>      ZOO_SERVERS: <span class=\"token assign-left variable\">server.1</span><span class=\"token operator\">=</span>zoo1:2688:3888 <span class=\"token assign-left variable\">server.2</span><span class=\"token operator\">=</span><span class=\"token number\">0.0</span>.0.0:2689:3888 <span class=\"token assign-left variable\">server.3</span><span class=\"token operator\">=</span>zoo3:2690:3888</pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>  zoo3:</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    image: zookeeper:3.5</pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    restart: always</pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    container_name: zoo3</pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    ports:</pre></td></tr><tr><td data-num=\"28\"></td><td><pre>      - <span class=\"token string\">\"2184:2181\"</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    environment:</pre></td></tr><tr><td data-num=\"30\"></td><td><pre>      ZOO_MY_ID: <span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>      ZOO_SERVERS: <span class=\"token assign-left variable\">server.1</span><span class=\"token operator\">=</span>zoo1:2688:3888 <span class=\"token assign-left variable\">server.2</span><span class=\"token operator\">=</span>zoo2:2689:3888 <span class=\"token assign-left variable\">server.3</span><span class=\"token operator\">=</span><span class=\"token number\">0.0</span>.0.0:2690:3888</pre></td></tr></table></figure><h4 id=\"2-创建镜像\"><a class=\"anchor\" href=\"#2-创建镜像\">#</a> <strong>2、创建镜像</strong></h4>\n<ul>\n<li>要在创建的 docker-compose.yml 文件中使用命令</li>\n</ul>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker-compose</span> up <span class=\"token parameter variable\">-d</span></pre></td></tr></table></figure><h4 id=\"3-进入容器\"><a class=\"anchor\" href=\"#3-进入容器\">#</a> <strong>3、进入容器</strong></h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> <span class=\"token builtin class-name\">exec</span> <span class=\"token parameter variable\">-it</span> zoo1 /bin/bash</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">#查看 zoo1 的状态</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token builtin class-name\">cd</span> bin</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>./zkServer.sh status</pre></td></tr></table></figure><ul>\n<li>如果出现，以下情况：</li>\n</ul>\n<pre><code>ZooKeeper JMX enabled by default\nUsing config: /conf/zoo.cfg\nClient port not found in static config file. Looking in dynamic config file.\ngrep: : No such file or directory\nClient port not found in the server configs\nClient port not found. Looking for secureClientPort in the static config.\nUnable to find either secure or unsecure client port in any configs. Terminating.\n</code></pre>\n<p>​\t通过阅读我们知道他在 conf 中的 zoo.cfg 文件中缺少 **clientPort ** 我们只需要自行添加即可</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#修改之前我们先装一下 vim</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">apt-get</span> update</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> <span class=\"token parameter variable\">-y</span> <span class=\"token function\">vim</span> </pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">#修改 zoo.fcg 文件</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">vim</span> /conf/zoo.fcg</pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token assign-left variable\">clientPort</span><span class=\"token operator\">=</span><span class=\"token number\">2181</span></pre></td></tr></table></figure><ul>\n<li>\n<p>完事之后<strong>重启</strong> zoo1</p>\n<p><img data-src=\"tools-All%5C1645780920291.png\" alt=\"1645780920291\" /></p>\n<p>成功！！</p>\n</li>\n</ul>\n<h4 id=\"4-查看所有zookeeper的状态\"><a class=\"anchor\" href=\"#4-查看所有zookeeper的状态\">#</a> 4、查看所有 zookeeper 的状态</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> <span class=\"token builtin class-name\">exec</span> <span class=\"token parameter variable\">-it</span> zoo3 <span class=\"token function\">bash</span> ./bin/zkServer.sh status</pre></td></tr></table></figure><h4 id=\"5-进去客户端\"><a class=\"anchor\" href=\"#5-进去客户端\">#</a> 5、进去客户端</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> <span class=\"token builtin class-name\">exec</span> <span class=\"token parameter variable\">-it</span> zoo3 zkCli.sh</pre></td></tr></table></figure><h2 id=\"redis安装\"><a class=\"anchor\" href=\"#redis安装\">#</a> redis 安装</h2>\n<h3 id=\"1-6\"><a class=\"anchor\" href=\"#1-6\">#</a> ——1</h3>\n<h4 id=\"1安装依赖c语言依赖\"><a class=\"anchor\" href=\"#1安装依赖c语言依赖\">#</a> 1. 安装依赖 C 语言依赖</h4>\n<p>​\tredis 使用 C 语言编写，所以需要安装 C 语言库</p>\n<pre><code> yum install -y gcc-c++ automake autoconf libtool make tcl \n</code></pre>\n<p>​</p>\n<h4 id=\"2上传并解压\"><a class=\"anchor\" href=\"#2上传并解压\">#</a> 2. 上传并解压</h4>\n<p>​\t把 redis-5.0.5.tar.gz 上传到 /usr/local/tmp 中，解压文件</p>\n<pre><code> cd /usr/local/tmp\n\n tar zxf redis-5.0.5.tar.gz\n</code></pre>\n<h4 id=\"3编译并安装\"><a class=\"anchor\" href=\"#3编译并安装\">#</a> 3. 编译并安装</h4>\n<p>​\t进入解压文件夹</p>\n<pre><code>  cd /usr/local/tmp/redis-5.0.5/\n</code></pre>\n<p>​\t编译</p>\n<pre><code> make\n</code></pre>\n<p>​\t安装\t（一定要干）</p>\n<pre><code> make install PREFIX=/usr/local/redis\n</code></pre>\n<h4 id=\"4开启守护进程\"><a class=\"anchor\" href=\"#4开启守护进程\">#</a> 4. 开启守护进程</h4>\n<p>​\t复制 cd /usr/local/tmp/redis-5.0.5 / 中 redis.conf 配置文件</p>\n<pre><code> cp redis.conf /usr/local/redis/bin/\n</code></pre>\n<p><strong>修改配置文件</strong></p>\n<pre><code> cd /usr/local/redis/bin/\n\n vim redis.conf\n</code></pre>\n<p>​\t把 daemonize 的值由 no 修改为 yes</p>\n\n<h4 id=\"5修改外部访问\"><a class=\"anchor\" href=\"#5修改外部访问\">#</a> 5. 修改外部访问</h4>\n<p>​\t在 redis5 中需要修改配置文件 redis.conf 允许外部访问。需要修改两处。</p>\n<p>​\t注释掉下面</p>\n<p>​\tbind 127.0.0.1</p>\n<pre><code> bind 127.0.0.1\n</code></pre>\n<p>​\tprotected-mode yes 改成 no</p>\n\n<h4 id=\"6启动并测试\"><a class=\"anchor\" href=\"#6启动并测试\">#</a> 6. 启动并测试</h4>\n<p>​\t启动 redis</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>./redis-server redis.conf</pre></td></tr></table></figure><p>​\t重启 redis</p>\n<pre><code>./redis-cli shutdown\n./redis-server redis.conf\n</code></pre>\n<p>​\t启动客户端工具</p>\n<p>​\t在 redis5 中客户端工具对命令会有提供功能。</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>./redis-cli</pre></td></tr></table></figure><h4 id=\"7增加自定义日志文件\"><a class=\"anchor\" href=\"#7增加自定义日志文件\">#</a> 7. 增加自定义日志文件</h4>\n<p>​\t打开 redis.conf , 找到 logfile &quot;&quot; ，在引号中写入我们的日志文件目录，要写到文件，只写到日志目录是不行的，他无法打开， 而且这个文件你要先自己创建才能用，最好就是把文件的权限全部打开了</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 日志文件输出目录 / 文件</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">touch</span> /usr/local/redis/log/run.log</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 修改 redis.conf</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>logfile <span class=\"token string\">\"/usr/local/redis/log/run.log\"</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># 修改日志文件的权限</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">chmod</span> <span class=\"token number\">777</span> /usr/local/redis/log/run.log</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\"># 启动服务</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>./redis-server redis.conf</pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\"># 即使没有报错，也要手动看一下日志文件是否采集到了日志信息</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token function\">tail</span> <span class=\"token parameter variable\">-f</span> /usr/local/redis/log/run.log</pre></td></tr></table></figure><h3 id=\"2-6\"><a class=\"anchor\" href=\"#2-6\">#</a> ——2</h3>\n<h4 id=\"1-拉取镜像文件\"><a class=\"anchor\" href=\"#1-拉取镜像文件\">#</a> 1、拉取镜像文件</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> pull redis<span class=\"token punctuation\">[</span>:<span class=\"token punctuation\">(</span>版本号<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span></pre></td></tr></table></figure><h4 id=\"2-去gitee库中下载redis配置文件docker不自带配置文件也可不进行此步骤\"><a class=\"anchor\" href=\"#2-去gitee库中下载redis配置文件docker不自带配置文件也可不进行此步骤\">#</a> 2、去 gitee 库中下载 redis 配置文件（docker 不自带配置文件）【也可不进行此步骤】</h4>\n<p><strong>建议看完，先别操作，再看三，看完三之后再决定如何操作</strong></p>\n<p>然后按照文章内容进行，忽略下载。</p>\n<p>文章地址： <span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuamI1MS5uZXQvYXJ0aWNsZS8yMDMyNzQuaHRt\">https://www.jb51.net/article/203274.htm</span></p>\n<p>、</p>\n\n<p><strong>docker 镜像中没有 redis.conf 文件，要自己配置</strong></p>\n<pre><code class=\"language-undefined\">git pull --rebase https://gitee.com/zjj3366/mydemo.git master\n</code></pre>\n<h4 id=\"3-创建一个redis-服务容器\"><a class=\"anchor\" href=\"#3-创建一个redis-服务容器\">#</a> 3、创建一个 redis 服务容器</h4>\n<p><strong>第二步进行了的</strong></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> run <span class=\"token parameter variable\">-p</span> <span class=\"token number\">6379</span>:6379 <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token parameter variable\">--name</span> myredis  <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token parameter variable\">-v</span> /usr/local/docker/redis.conf:/etc/redis/redis.conf   <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token parameter variable\">-v</span> /usr/local/docker/data:/data  <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token parameter variable\">-d</span> redis  <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>redis-server  /etc/redis/redis.conf  <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token parameter variable\">--appendonly</span> <span class=\"token function\">yes</span></pre></td></tr></table></figure><p><strong>第二步没有进行的</strong></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> run <span class=\"token parameter variable\">-p</span> <span class=\"token number\">6379</span>:6379  <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token parameter variable\">--name</span> myredis  <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token parameter variable\">-v</span> /root/myredis/data:/data <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token parameter variable\">-v</span> /root/myredis/conf/redis.conf:/etc/redis/redis.conf  <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token parameter variable\">-d</span> redis:4.0  <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>redis-server /etc/redis/redis.conf  <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token parameter variable\">--appendonly</span> <span class=\"token function\">yes</span></pre></td></tr></table></figure><p><strong>区别：</strong></p>\n<p>​\t其实也没有什么区别，只是映射的文件不同，也可以将第二步的文件直接创建到第二种创建服务容器的配置文件地址中去，这样也可使用第二个创建方式。</p>\n\n\n<h2 id=\"redis集群cluster搭建\"><a class=\"anchor\" href=\"#redis集群cluster搭建\">#</a> redis 集群 (Cluster) 搭建</h2>\n<h3 id=\"1-7\"><a class=\"anchor\" href=\"#1-7\">#</a> ——1</h3>\n<p>​\t前提：已经安装好 redis 单机版。</p>\n<p>​\t当集群中超过或等于 1/2 节点不可用时，整个集群不可用。为了搭建稳定集群，都采用奇数节点。</p>\n<h4 id=\"1-复制redis配置文件\"><a class=\"anchor\" href=\"#1-复制redis配置文件\">#</a> 1 .<strong> 复制 redis 配置文件</strong></h4>\n<p>​\t从 /usr/local/redis/bin 下把 redis.conf 复制到当前目录中，命名为 redis-7001.conf</p>\n<pre><code># cp /usr/local/redis/bin/redis.conf /usr/local/redis/bin/redis-7001.conf\n</code></pre>\n<h4 id=\"2-修改redis-7001conf\"><a class=\"anchor\" href=\"#2-修改redis-7001conf\">#</a> 2. <strong>修改 redis-7001.conf</strong></h4>\n<pre><code># cd /usr/local/redis/bin\n# vim redis-7001.conf\n</code></pre>\n<p>​\t需要修改如下</p>\n<pre><code>port 7001\ncluster-enabled yes\ncluster-config-file nodes-7001.conf\ncluster-node-timeout 15000\n# appendonly yes 如果开启aof默认，需要修改为yes。如果使用rdb，此处不需要修改\ndaemonize yes\nprotected-mode no\npidfile /var/run/redis_7001.pid\n</code></pre>\n<h4 id=\"3-复制配置文件并修改内容\"><a class=\"anchor\" href=\"#3-复制配置文件并修改内容\">#</a> 3 .<strong> 复制配置文件，并修改内容</strong></h4>\n<p>​\t把 redis-7001.conf 复制 5 份，分别叫做 redis-7002.conf、redis-7003.conf、redis-7004.conf、redis-7005.conf、redis-7006.conf</p>\n<pre><code># cp redis-7001.conf redis-7002.conf\n# cp redis-7001.conf redis-7003.conf\n# cp redis-7001.conf redis-7004.conf\n# cp redis-7001.conf redis-7005.conf\n# cp redis-7001.conf redis-7006.conf\n</code></pre>\n<pre><code>新复制的5个配置文件都需要需改三处。\n</code></pre>\n<p>​\t例如 nodes-7002.conf 中需要把所有 7001 都换成 7002。</p>\n<p>​\t可以使用 :% s/7001/7002/g 进行全局修改。</p>\n<pre><code>port 7002\ncluster-config-file nodes-7002.conf\npidfile /var/run/redis_7002.pid\n</code></pre>\n<h4 id=\"4-启动6个redis\"><a class=\"anchor\" href=\"#4-启动6个redis\">#</a> 4 .<strong> 启动 6 个 redis</strong></h4>\n<p>​\t可以使用 redis-server 结合 6 个配置文件进行启动 6 个实例。</p>\n<p>​\t执行之前一定要先删除 dump.rdb</p>\n<pre><code># rm -f dump.rdb\n# vim startup.sh\n\n./redis-server redis-7001.conf\n./redis-server redis-7002.conf\n./redis-server redis-7003.conf\n./redis-server redis-7004.conf\n./redis-server redis-7005.conf\n./redis-server redis-7006.conf\n\n\n# chmod a+x startup.sh\n# ./startup.sh\n</code></pre>\n<h4 id=\"5-查看启动状态\"><a class=\"anchor\" href=\"#5-查看启动状态\">#</a> 5. <strong>查看启动状态</strong></h4>\n\n<h4 id=\"6-建立集群\"><a class=\"anchor\" href=\"#6-建立集群\">#</a> 6. <strong>建立集群</strong></h4>\n<p>​\t在 redis3 的时候需要借助 ruby 脚本实现集群。在 redis5 中可以使用自带的 redis-cli 实现集群功能，比 redis3 的时候更加方便了。</p>\n<p>​\t建议配置静态 ip，ip 改变集群失效</p>\n<pre><code>./redis-cli --cluster create 192.168.93.10:7001 192.168.93.10:7002 192.168.93.10:7003 192.168.93.10:7004 192.168.93.10:7005 192.168.93.10:7006 --cluster-replicas 1\n</code></pre>\n<h4 id=\"7-测试\"><a class=\"anchor\" href=\"#7-测试\">#</a> 7. <strong>测试</strong></h4>\n<p>​\t集群测试时，千万不要忘记最后一个 - c 参数。</p>\n<pre><code># ./redis-cli -p 7001 -c\n# set age 18\n</code></pre>\n<h4 id=\"8-编写关闭脚本\"><a class=\"anchor\" href=\"#8-编写关闭脚本\">#</a> 8 .<strong> 编写关闭脚本</strong></h4>\n<pre><code># vim stop.sh\n# chmod a+x stop.sh\n\n./redis-cli -p 7001 shutdown\n./redis-cli -p 7002 shutdown\n./redis-cli -p 7003 shutdown\n./redis-cli -p 7004 shutdown\n./redis-cli -p 7005 shutdown\n./redis-cli -p 7006 shutdown\n</code></pre>\n<h3 id=\"2-7\"><a class=\"anchor\" href=\"#2-7\">#</a> ——2</h3>\n<p>​\t<strong>注：<strong>1. 如果是配置修改之前</strong>已经创建过的集群时</strong>，要先进行第七步操作。</p>\n<p>​\t\t\t2. 要是想重启集群可以省略第一步，但是得<strong>先删除已经创建的容器</strong>，重新进行 2、3（合并也行）</p>\n<h4 id=\"0-创建网络\"><a class=\"anchor\" href=\"#0-创建网络\">#</a> 0、创建网络</h4>\n<p>** 目的：** 让宿主机可以访问到自身</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> network create net-redis <span class=\"token parameter variable\">--subnet</span> <span class=\"token number\">172.38</span>.0.0/16</pre></td></tr></table></figure><p>补充：关于虚拟机的三种网路连接方式区别</p>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL2Jsb2cuY3Nkbi5uZXQvYmlmZW5nbWlhb3podWFuL2FydGljbGUvZGV0YWlscy83OTg4NzY5Mj9zcG09MTAwMS4yMTAxLjMwMDEuNjY2MS4xJmFtcDt1dG1fbWVkaXVtPWRpc3RyaWJ1dGUucGNfcmVsZXZhbnRfdDAubm9uZS10YXNrLWJsb2ctMg==\">http://blog.csdn.net/bifengmiaozhuan/article/details/79887692?spm=1001.2101.3001.6661.1&amp;utm_medium=distribute.pc_relevant_t0.none-task-blog-2</span><sub>default</sub>CTRLIST<sub>Rate-1.pc_relevant_default&amp;depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2</sub>default<sub>CTRLIST</sub>Rate-1.pc_relevant_default&amp;utm_relevant_index=1</p>\n\n<h4 id=\"1-创建并修改配置文件\"><a class=\"anchor\" href=\"#1-创建并修改配置文件\">#</a> 1、创建并修改配置文件</h4>\n<p><strong>注：</strong></p>\n<pre><code>In certain deployments, Redis Cluster nodes address discovery fails, because addresses are NAT-ted or because ports are forwarded (the typical case is Docker and other containers).\n\n在某些部署中，Redis群集节点地址发现失败，因为地址是NAT，或者端口是转发的（典型情况是Docker和其他容器）。\n\nIn order to make Redis Cluster working in such environments, a static configuration where each node knows its public address is needed. The following two options are used for this scope, and are:\n\n为了让Redis集群在这样的环境中工作，需要一种静态配置，其中每个节点都知道自己的公共地址。以下两个选项用于此范围，分别是：\n\ncluster-announce-ip\n\ncluster-announce-port\n---------------------------------------------------------------------------------------\n你的docker内网是172，你宿主的IP是192网段\n\n根据redis的配置文件中的解释\n\n要在你的配置文件上加上上面的2个配置\n</code></pre>\n<p>** 方法一：** 参考上面的方法一样行。</p>\n<p>** 方法二：** 使用脚本</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#cat &lt;&lt;EOF EOF 在这里没有特殊的含义，你可以使用 FOE 或 000 等；</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">#表示以 cat &lt;&lt;EOF 开始输入以 EOF 结束结束输入</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">#cat > 创建文件，并把标准输入输出到后面的 filename 文件</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\"># * cluster-announce-ip\t\t\t\t\t192.168.1.195\t#* 群集 ip</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\"># * cluster-announce-port\t\t\t\t700$&#123;port&#125;\t\t#* 群集总线端口</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\"># * cluster-announce-bus-port#* 群集 ip    1700$&#123;port&#125;\t   #* 群集公布端口</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\"># 集群 ip 是固定 + 10000</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\"># 可以使用 :  % s/7001/7002/g     进行全局修改。 --- 将全局的 7001 修改成 7002</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token for-or-select variable\">port</span> <span class=\"token keyword\">in</span> <span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">seq</span> <span class=\"token number\">1</span> <span class=\"token number\">6</span><span class=\"token variable\">)</span></span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">\\</span> </pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">do</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token function\">mkdir</span>  <span class=\"token parameter variable\">-p</span>  /root/myredis/conf700<span class=\"token variable\">$&#123;port&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token function\">touch</span>  /root/myredis/conf700<span class=\"token variable\">$&#123;port&#125;</span>/redis.conf</pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token function\">cat</span> <span class=\"token operator\">&lt;&lt;</span><span class=\"token string\">TTT<span class=\"token bash punctuation\"> <span class=\"token operator\">></span> /root/myredis/conf700<span class=\"token variable\">$&#123;port&#125;</span>/redis.conf port <span class=\"token number\">6379</span></span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>bind 0.0.0.0</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>port 700<span class=\"token variable\">$&#123;port&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>cluster-enabled yes</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>cluster-config-file nodes-700<span class=\"token variable\">$&#123;port&#125;</span>.conf</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>cluster-node-timeout 15000</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>protected-mode no</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>pidfile /var/run/redis_ 700<span class=\"token variable\">$&#123;port&#125;</span>.pid</pre></td></tr><tr><td data-num=\"25\"></td><td><pre>cluster-announce-ip  192.168.1.195 </pre></td></tr><tr><td data-num=\"26\"></td><td><pre>cluster-announce-port  700$&#123;port) </pre></td></tr><tr><td data-num=\"27\"></td><td><pre>cluster-announce-bus-port 1700$&#123;port) </pre></td></tr><tr><td data-num=\"28\"></td><td><pre>appendonly yes </pre></td></tr><tr><td data-num=\"29\"></td><td><pre>TTT</span> </pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token keyword\">done</span></pre></td></tr></table></figure><h4 id=\"2-创建容器\"><a class=\"anchor\" href=\"#2-创建容器\">#</a> 2、创建容器</h4>\n<p>** 方法一：** 手动创建容器，并启动</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> run <span class=\"token parameter variable\">-p</span> <span class=\"token number\">7001</span>:7001   <span class=\"token parameter variable\">-p</span> <span class=\"token number\">17001</span>:17001  <span class=\"token parameter variable\">--name</span> redis7001  <span class=\"token parameter variable\">-v</span> /root/myredis/conf7001/redis.conf:/etc/redis/redis.conf <span class=\"token parameter variable\">-v</span> /root/myredis/data7001:/data <span class=\"token parameter variable\">-d</span> redis redis-server /etc/redis/redis.conf <span class=\"token parameter variable\">--appendonly</span> <span class=\"token function\">yes</span></pre></td></tr></table></figure><p>​\t7002 ~~~7006 同上，自行修改参数</p>\n<p>** 方法二：** 脚本一键启动，效果同上</p>\n<p>​\t<strong>注意：</strong></p>\n<ul>\n<li>其中要指定两个端口号 **-p 1700<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mrow><mi>p</mi><mi>o</mi><mi>r</mi><mi>t</mi></mrow><mo>:</mo><mn>1700</mn></mrow><annotation encoding=\"application/x-tex\">{port}:1700</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.80952em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">t</span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span><span class=\"mord\">7</span><span class=\"mord\">0</span><span class=\"mord\">0</span></span></span></span> {port}** 不要忘记，否则会在创建几群的时候出现  **Waiting for the cluster to join   ** 。【具体原因，我还没查出来，后面补充】</li>\n<li>在 docker 创建集群容器的时候，<strong>一定要</strong> 指定  ip</li>\n</ul>\n<p><strong>补充：</strong></p>\n<ul>\n<li>那肯定是你端口没有开启，不要质疑，这里的端口不是 7000-7005，而是 17000-17005，因为 redis 设置集群的端口号是”redis 端口 + 10000“，这个非常重要。并且 7001:7006 也是必须打开的。</li>\n</ul>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token for-or-select variable\">port</span> <span class=\"token keyword\">in</span> <span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">seq</span> <span class=\"token number\">1</span> <span class=\"token number\">6</span><span class=\"token variable\">)</span></span><span class=\"token punctuation\">;</span>  <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">do</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">docker</span> run <span class=\"token parameter variable\">-p</span> <span class=\"token number\">700</span><span class=\"token variable\">$&#123;port&#125;</span>:700<span class=\"token variable\">$&#123;port&#125;</span>   <span class=\"token parameter variable\">-p</span> <span class=\"token number\">1700</span><span class=\"token variable\">$&#123;port&#125;</span>:1700<span class=\"token variable\">$&#123;port&#125;</span>  <span class=\"token parameter variable\">--name</span> redis700<span class=\"token variable\">$&#123;port&#125;</span>  <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token parameter variable\">-v</span> /root/redis/redis700<span class=\"token variable\">$&#123;port&#125;</span>.conf:/etc/redis/redis.conf <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token parameter variable\">-v</span> /root/redis/data700<span class=\"token variable\">$&#123;port&#125;</span>:/data <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token parameter variable\">-d</span> <span class=\"token parameter variable\">--ip</span> <span class=\"token number\">192.168</span>.1.195 redis redis-server /etc/redis/redis.conf </pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">done</span></pre></td></tr></table></figure><h4 id=\"3-进入容器-2\"><a class=\"anchor\" href=\"#3-进入容器-2\">#</a> 3、进入容器</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> <span class=\"token builtin class-name\">exec</span> <span class=\"token parameter variable\">-it</span> redis7001 /bin/bash</pre></td></tr></table></figure><h4 id=\"4-创建集群\"><a class=\"anchor\" href=\"#4-创建集群\">#</a> 4、创建集群</h4>\n<p>​\t** 注：** 有一步操作，要自行进行确认，一定要输入 <strong>yes</strong> 而不是 <strong>y</strong> 或者其他之类的，除了 yes 一律视为 <strong>no</strong> 。</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>redis-cli <span class=\"token parameter variable\">--cluster</span> create <span class=\"token number\">192.168</span>.1.195:7001 <span class=\"token number\">192.168</span>.1.195:7002 <span class=\"token number\">192.168</span>.1.195:7003 <span class=\"token number\">192.168</span>.1.195:7004 <span class=\"token number\">192.168</span>.1.195:7005 <span class=\"token number\">192.168</span>.1.195:7006 --cluster-replicas <span class=\"token number\">1</span></pre></td></tr></table></figure><h4 id=\"5-测试\"><a class=\"anchor\" href=\"#5-测试\">#</a> 5、测试</h4>\n<p>​\t集群测试时，千万不要忘记最后一个 - c 参数。</p>\n<pre><code class=\"language-shel\">redis-cli -p 7001 -c\n</code></pre>\n<h4 id=\"6-关闭集群\"><a class=\"anchor\" href=\"#6-关闭集群\">#</a> 6、关闭集群</h4>\n<p><strong>方法一：</strong></p>\n<p>​\t自行手动一个一个停止，并且删除容器</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> stop redis7001 <span class=\"token comment\">#7002 ~~~7006</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">docker</span> <span class=\"token function\">rm</span> <span class=\"token parameter variable\">-f</span> redis7001</pre></td></tr></table></figure><p><strong>方法二：</strong></p>\n<p>​\t脚本程序，一劳永逸</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token for-or-select variable\">port</span> <span class=\"token keyword\">in</span> <span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">seq</span> <span class=\"token number\">1</span> <span class=\"token number\">6</span><span class=\"token variable\">)</span></span><span class=\"token punctuation\">;</span>  <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">do</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">docker</span> stop redis700<span class=\"token variable\">$&#123;port&#125;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">docker</span> <span class=\"token function\">rm</span> <span class=\"token parameter variable\">-f</span> redis700<span class=\"token variable\">$&#123;port&#125;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">done</span></pre></td></tr></table></figure><h4 id=\"7-清空集群文件\"><a class=\"anchor\" href=\"#7-清空集群文件\">#</a> 7、清空集群文件</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token for-or-select variable\">port</span> <span class=\"token keyword\">in</span> <span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">seq</span> <span class=\"token number\">1</span> <span class=\"token number\">6</span><span class=\"token variable\">)</span></span><span class=\"token punctuation\">;</span>  <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">do</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">rm</span>  <span class=\"token parameter variable\">-rf</span>  ./data700<span class=\"token variable\">$&#123;port&#125;</span>/* </pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">done</span></pre></td></tr></table></figure><h2 id=\"solr安装\"><a class=\"anchor\" href=\"#solr安装\">#</a> Solr 安装</h2>\n<h3 id=\"1-8\"><a class=\"anchor\" href=\"#1-8\">#</a> ——1</h3>\n<p>​\tSolr 是使用 Java 编写，所以必选先安装 JDK。</p>\n<h4 id=\"1上传并解压\"><a class=\"anchor\" href=\"#1上传并解压\">#</a> 1. 上传并解压</h4>\n<p>​\t上传压缩包 solr-7.7.2.tgz 到 /usr/local/tmp 中。</p>\n<p>​\t解压</p>\n<pre><code> cd /usr/local/tmp\n tar zxf solr-7.7.2.tgz -C /usr/local/tmp\n</code></pre>\n<h4 id=\"2复制到usrlocal中\"><a class=\"anchor\" href=\"#2复制到usrlocal中\">#</a> 2. 复制到 /usr/local 中</h4>\n<pre><code> cp -r solr-7.7.2 ../solr\n</code></pre>\n<h4 id=\"3修改启动参数\"><a class=\"anchor\" href=\"#3修改启动参数\">#</a> 3. 修改启动参数</h4>\n<p>​\t修改启动参数，否则启动时报警告。提示设置 SOLR_ULIMIT_CHECKS=false</p>\n<pre><code> cd /usr/local/solr/bin\n vim solr.in.sh\n</code></pre>\n\n<h4 id=\"4启动solr\"><a class=\"anchor\" href=\"#4启动solr\">#</a> 4. 启动 Solr</h4>\n<p>​\tSolr 内嵌 Jetty，直接启动即可。监听 8983 端口。</p>\n<p>​\tsolr 默认不推荐 root 账户启动，如果是 root 账户启动需要添加 - force 参数。</p>\n<pre><code># ./solr start -force\n</code></pre>\n<h4 id=\"5-可视化管理界面\"><a class=\"anchor\" href=\"#5-可视化管理界面\">#</a> 5、可视化管理界面</h4>\n<p>​\t在关闭防火墙的前提下，可以在 windows 的浏览器中访问 Solr。</p>\n<p>​\t输入: <span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguOTMuMTA6ODk4Mw==\">http://192.168.93.10:8983</span> 就可以访问 Solr 的可视化管理界面。</p>\n<p>​\t左侧有 5 个菜单。分别是：</p>\n<p>​\t（1）Dashboard：面板显示 Solr 的总体信息。</p>\n<p>​\t（2）Logging：日志</p>\n<p>​\t（3）Core Admin：Solr 的核心。类似于数据的 Database</p>\n<p>​\t（4）Java Perperties：所有 Java 相关属性。</p>\n<p>​\t（5）Thread Dump：线程相关信息。</p>\n<p>​\t（6）如果有 Core，将显示在此处。</p>\n\n<h4 id=\"6-新建核心\"><a class=\"anchor\" href=\"#6-新建核心\">#</a> 6、新建核心</h4>\n<p>​\tSolr 安装完成后默认是没有核心的。需要手动配置。</p>\n<p>​\t需要在 solr/server/solr 下新建文件夹，并给定配置文件，否则无法建立。</p>\n\n<h5 id=\"61新建目录\"><a class=\"anchor\" href=\"#61新建目录\">#</a> 6.1. 新建目录</h5>\n<p>​\t在 /usr/local/solr/server/solr 中新建自定义名称目录。此处示例名称为 testcore。</p>\n<pre><code> cd /usr/local/solr/server/solr\n mkdir testcore\n</code></pre>\n<h5 id=\"62复制配置文件\"><a class=\"anchor\" href=\"#62复制配置文件\">#</a> 6.2. 复制配置文件</h5>\n<p>​\t在 configsets 里面包含了_default 和 sample_techproducts_configs。里面都是配置文件示例。_default 属于默认配置，较纯净。sample_techproducts_configs 是带有了一些配置示例。</p>\n<pre><code># cp -r configsets/_default/conf/ testcore/\n</code></pre>\n<h5 id=\"63填写core信息\"><a class=\"anchor\" href=\"#63填写core信息\">#</a> 6.3. 填写 Core 信息</h5>\n<p>​\t在可视化管理界面中 Core Admin 中编写信息后点击 Add Core 后，短暂延迟后 testcore 就会创建成功。schema 处不用更改。</p>\n\n<h5 id=\"64出现testcore\"><a class=\"anchor\" href=\"#64出现testcore\">#</a> 6.4. 出现 testcore</h5>\n<p>​\t在客户端管理界面中，选择新建的 Core 后，就可以按照自己项目的需求进行操作了。</p>\n\n<h4 id=\"7-分词analysis\"><a class=\"anchor\" href=\"#7-分词analysis\">#</a> 7、分词 Analysis</h4>\n<p>​\t在 Solr 可视化管理界面中，Core 的管理菜单项中都会有 Analysis。表示根据 Scheme.xml (managed-schema) 中配置要求进行解析。</p>\n<p>​\t对英文解析就比较简单了，只要按照空格把英文语句拆分成英文单词即可。</p>\n\n<p>​\t但是如果条件是中文时，把一句话按照字进行拆分就不是很合理了。正确的方式是按照合理的词组进行拆分。![](D:/ 马士兵 / Java 课程 / 13_分布式资料 / 5_Solr / 文档 / Solr.assets/solr-08.jpg)</p>\n<h5 id=\"71配置步骤\"><a class=\"anchor\" href=\"#71配置步骤\">#</a> 7.1. 配置步骤</h5>\n<p>​\t上传 ik-analyzer.jar 到 webapps 中。</p>\n<p>​\t去 https://search.maven.org/search?q=com.github.magese 下载对应版本的 ik-analyzer。可以在资料中直接获取。</p>\n<h5 id=\"711上传jar到指定目录\"><a class=\"anchor\" href=\"#711上传jar到指定目录\">#</a> 7.1.1 上传 jar 到指定目录</h5>\n<p>​\t上传 ik-analyzer-7.7.0.jar 到</p>\n<p>​\t/usr/local/solr/server/solr-webapp/webapp/WEB-INF/lib 目录中</p>\n<h5 id=\"712修改配置文件\"><a class=\"anchor\" href=\"#712修改配置文件\">#</a> 7.1.2 修改配置文件</h5>\n<p>​\t修改 /usr/local/solr/server/solr/testcore/conf/managed-schema</p>\n<pre><code># vim /usr/local/solr/server/solr/testcore/conf/managed-schema\n</code></pre>\n<p>​\t添加下面内容。</p>\n<p>​\t排版：Esc 退出编辑状态下：gg=G</p>\n<pre><code>&lt;field name=&quot;myfield&quot; type=&quot;text_ik&quot; indexed=&quot;true&quot; stored=&quot;true&quot; /&gt;\n    &lt;fieldType name=&quot;text_ik&quot; class=&quot;solr.TextField&quot;&gt;\n            &lt;analyzer type=&quot;index&quot;&gt;\n                    &lt;tokenizer class=&quot;org.wltea.analyzer.lucene.IKTokenizerFactory&quot; useSmart=&quot;false&quot; conf=&quot;ik.conf&quot;/&gt;\n                    &lt;filter class=&quot;solr.LowerCaseFilterFactory&quot;/&gt;\n            &lt;/analyzer&gt;\n            &lt;analyzer type=&quot;query&quot;&gt;\n                    &lt;tokenizer class=&quot;org.wltea.analyzer.lucene.IKTokenizerFactory&quot; useSmart=&quot;true&quot; conf=&quot;ik.conf&quot;/&gt;\n                    &lt;filter class=&quot;solr.LowerCaseFilterFactory&quot;/&gt;\n            &lt;/analyzer&gt;\n    &lt;/fieldType&gt;\n</code></pre>\n<h5 id=\"713重启\"><a class=\"anchor\" href=\"#713重启\">#</a> 7.1.3 重启</h5>\n<pre><code># cd /usr/local/solr/bin\n# ./solr stop -all\n# ./solr start -force\n</code></pre>\n<h5 id=\"714验证\"><a class=\"anchor\" href=\"#714验证\">#</a> 7.1.4 验证</h5>\n<p>​\t可以在可视化管理界面中找到 myfield 属性进行验证。</p>\n\n<h5 id=\"72managed-schema配置说明\"><a class=\"anchor\" href=\"#72managed-schema配置说明\">#</a> 7.2.managed-schema 配置说明</h5>\n<h5 id=\"721-fieldtype\"><a class=\"anchor\" href=\"#721-fieldtype\">#</a> 7.2.1&lt; fieldType/&gt;</h5>\n<p>​\t表示定义一个属性类型。在 Solr 中属性类型都是自定义的。在上面配置中 name=”text_ik” 为自定义类型。当某个属性取值为 text_ik 时 IK Analyzer 才能生效。</p>\n<h5 id=\"722-field\"><a class=\"anchor\" href=\"#722-field\">#</a> 7.2.2&lt; field/&gt;</h5>\n<p>​\t表示向 Document 中添加一个属性。</p>\n<p>​\t常用属性：</p>\n<p>​\t\tname: 属性名</p>\n<p>​\t\ttype: 属性类型。所有类型都是 solr 使用<fieldType>配置的</p>\n<p>​\t\tindexed: 是否建立索引</p>\n<p>​\t\tstored: solr 是否把该属性值响应给搜索用户。</p>\n<p>​\t\trequired：该属性是否是必须的。默认 id 是必须的。</p>\n<p>​\t\tmultiValued：如果为 true，表示该属性为复合属性，此属性中包含了多个其他的属性。常用在多个列作为搜索条件时，把这些列定义定义成一个新的复合属性，通过搜索一个复合属性就可以实现搜索多个列。当设置为 true 时与 &lt;copyField source=&quot;&quot;dest=&quot;&quot;/&gt; 结合使用</p>\n<h5 id=\"723-uniquekey\"><a class=\"anchor\" href=\"#723-uniquekey\">#</a> 7.2.3&lt; uniqueKey&gt;</h5>\n<p>​\t唯一主键，Solr 中默认定义 id 属性为唯一主键。ID 的值是不允许重复的。</p>\n<h5 id=\"724-dynamicfield\"><a class=\"anchor\" href=\"#724-dynamicfield\">#</a> 7.2.4&lt; dynamicField&gt;</h5>\n<p>​\t名称中允许 * 进行通配。代表满足特定名称要求的一组属性。</p>\n<pre><code>msb_java    \n</code></pre>\n<p>​\tmsb_bigdata</p>\n<p>​\tmsb_UI</p>\n<p>​        msb_*</p>\n<h4 id=\"8-dataimport\"><a class=\"anchor\" href=\"#8-dataimport\">#</a> 8、Dataimport</h4>\n<p>​\t可以使用 Solr 自带的 Dataimport 功能把数据库中数据快速导入到 solr 中.</p>\n<p>​\t<strong>必须保证 managed-schema 和数据库中表的列对应。，添加配置</strong></p>\n<h5 id=\"81修改配置文件\"><a class=\"anchor\" href=\"#81修改配置文件\">#</a> 8.1. 修改配置文件</h5>\n<p>​\t修改 solrconfig.xml，添加下面内容</p>\n<pre><code> &lt;!-- 配置数据导入的处理器 --&gt;\n  &lt;requestHandler name=&quot;/dataimport&quot; class=&quot;org.apache.solr.handler.dataimport.DataImportHandler&quot;&gt;\n    &lt;lst name=&quot;defaults&quot;&gt;\n\t  &lt;!--  加载data-config.xml  --&gt;\n      &lt;str name=&quot;config&quot;&gt;data-config.xml&lt;/str&gt;\n     &lt;/lst&gt;\n  &lt;/requestHandler&gt;\n</code></pre>\n<h5 id=\"82新建data-configxml\"><a class=\"anchor\" href=\"#82新建data-configxml\">#</a> 8.2. 新建 data-config.xml</h5>\n<p>​\t和 solrconfig.xml 同一目录下新建 data-config.xml</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;dataConfig&gt;\n        &lt;dataSource type=&quot;JdbcDataSource&quot;   \n                driver=&quot;com.mysql.jdbc.Driver&quot;   \n                url=&quot;jdbc:mysql://192.168.1.135:3306/mytest&quot;   \n                user=&quot;root&quot;   \n                password=&quot;root&quot;/&gt;\n        &lt;document&gt;\n            &lt;entity name=&quot;product&quot; query=&quot;SELECT id,name,price from t_product&quot;&gt;\n                &lt;!-- \n                 实现数据库的列和索引库的字段的映射\n                 column 指定数据库的列表\n                 name  指定索引库的字段名字，必须和schema.xml中定义的一样\n                 --&gt;\n                 &lt;field column=&quot;id&quot; name=&quot;id&quot;/&gt;\n                 &lt;field column=&quot;name&quot; name=&quot;name&quot;/&gt;\n\t\t\t\t &lt;field column=&quot;price&quot; name=&quot;price&quot;/&gt;\n            &lt;/entity&gt;\n         &lt;/document&gt;\n&lt;/dataConfig&gt;\n</code></pre>\n<h5 id=\"83添加jar\"><a class=\"anchor\" href=\"#83添加jar\">#</a> 8.3. 添加 jar</h5>\n<p>​\t向 solr-webapp 中添加<strong>三个 jar</strong>。在<strong> dist 中两个还有一个数据库驱动。（自己去 maven-repository 里面找一个 mysql-connector-java ）</strong></p>\n\n<h5 id=\"84操作\"><a class=\"anchor\" href=\"#84操作\">#</a> 8.4. 操作</h5>\n<p>​\t重启 solr 后，在可视化管理页面中进行数据导入。</p>\n<p>​\t注意：</p>\n<p>​\t点击导入按钮后，要记得点击刷新按钮。</p>\n<h2 id=\"erlang安装\"><a class=\"anchor\" href=\"#erlang安装\">#</a> <strong>Erlang 安装</strong></h2>\n<h3 id=\"1-9\"><a class=\"anchor\" href=\"#1-9\">#</a> ——1</h3>\n<p>​\tRabbitMQ 是使用 Erlang 语言编写的，所以需要先配置 Erlang</p>\n<h4 id=\"1-修改主机名\"><a class=\"anchor\" href=\"#1-修改主机名\">#</a> 1 <strong>修改主机名</strong></h4>\n<p>​\tRabbitMQ 是通过主机名进行访问的，必须指定能访问的主机名。</p>\n<pre><code>  vim /etc/sysconfig/network\n  \n  添加\n  NETWORKING=yes\n  HOSTNAME=node-1 #名字可以随意\n</code></pre>\n\n<pre><code>    vim /etc/hosts\n  \n    ip network_hostname\neg: 192.168.1.195 node-1  \n</code></pre>\n<p>​\t新添加了一行，前面为服务器 ip，空格后面添加计算机主机名</p>\n\n<h4 id=\"2-安装依赖\"><a class=\"anchor\" href=\"#2-安装依赖\">#</a> 2 <strong>安装依赖</strong></h4>\n<pre><code>  yum -y install make gcc gcc-c++ kernel-devel m4 ncurses-devel openssl-devel unixODBC unixODBC-devel\n</code></pre>\n<h4 id=\"3-上传并解压\"><a class=\"anchor\" href=\"#3-上传并解压\">#</a> 3 <strong>上传并解压</strong></h4>\n<p>​\t上传 otp_src_22.0.tar.gz 到 /usr/local/tmp 目录中，进入目录并解压。</p>\n<pre><code>解压时注意，此压缩包不具有gzip属性，解压参数没有z，只有xf\n</code></pre>\n<pre><code>  cd /usr/local/tmp\n  tar xf otp_src_22.0.tar.gz -C /usr/local/tmp\n</code></pre>\n<h4 id=\"4-配置参数\"><a class=\"anchor\" href=\"#4-配置参数\">#</a> 4 <strong>配置参数</strong></h4>\n<p>​\t先新建 /usr/local/erlang 文件夹，作为安装文件夹</p>\n<pre><code>  mkdir -p /usr/local/erlang\n</code></pre>\n<p>​\t 进入文件夹</p>\n<pre><code>  cd otp_src_22.0\n</code></pre>\n<p>​\t 配置参数</p>\n<pre><code>  ./configure --prefix=/usr/local/erlang --with-ssl --enable-threads --enable-smp-support --enable-kernel-poll --enable-hipe --without-javac\n</code></pre>\n<h4 id=\"5-编译并安装\"><a class=\"anchor\" href=\"#5-编译并安装\">#</a> 5 <strong>编译并安装</strong></h4>\n<p>​\t编译</p>\n<pre><code>  make\n</code></pre>\n<p>​\t 安装</p>\n<pre><code>  make install\n</code></pre>\n<h4 id=\"6-修改环境变量\"><a class=\"anchor\" href=\"#6-修改环境变量\">#</a> 6 <strong>修改环境变量</strong></h4>\n<p>​\t修改 /etc/profile 文件</p>\n<pre><code> vim /etc/profile\n</code></pre>\n<p>​\t 在文件中添加下面代码</p>\n<pre><code>export PATH=$PATH:/usr/local/erlang/bin\n</code></pre>\n<p>​\t运行文件，让修改内容生效</p>\n<pre><code>  source /etc/profile\n</code></pre>\n<h4 id=\"7-查看配置是否成功\"><a class=\"anchor\" href=\"#7-查看配置是否成功\">#</a> 7 <strong>查看配置是否成功</strong></h4>\n<pre><code>  erl -version\n</code></pre>\n\n<h2 id=\"rabbitmq安装\"><a class=\"anchor\" href=\"#rabbitmq安装\">#</a> RabbitMQ<strong> 安装</strong></h2>\n<h4 id=\"1-上传并解压\"><a class=\"anchor\" href=\"#1-上传并解压\">#</a> 1 <strong>上传并解压</strong></h4>\n<p>​\t上传 rabbitmq-server-generic-unix-3.7.18.tar.xz 到 /usr/loca/tmp 中</p>\n<pre><code>  cd /usr/local/tmp\n  \n  tar xf rabbitmq-server-generic-unix-3.7.18.tar.xz -C /usr/local/tmp\n</code></pre>\n<h4 id=\"2-复制到local下\"><a class=\"anchor\" href=\"#2-复制到local下\">#</a> 2 <strong>复制到 local 下</strong></h4>\n<p>​\t复制解压文件到 /usr/local 下，命名为 rabbitmq</p>\n<pre><code>  cp -r rabbitmq_server-3.7.18 /usr/local/rabbitmq\n</code></pre>\n<h4 id=\"3-配置环境变量-3\"><a class=\"anchor\" href=\"#3-配置环境变量-3\">#</a> 3 <strong>配置环境变量</strong></h4>\n<pre><code>  vim /etc/profile\n</code></pre>\n<p>​\t在文件中添加</p>\n<pre><code>export PATH=$PATH:/usr/local/rabbitmq/sbin\n</code></pre>\n<p>​\t解析文件</p>\n<pre><code> source /etc/profile\n</code></pre>\n<h4 id=\"4-开启web管理插件\"><a class=\"anchor\" href=\"#4-开启web管理插件\">#</a> 4 <strong>开启 web 管理插件</strong></h4>\n<p>​\t进入 rabbitmq/sbin 目录</p>\n<pre><code> cd /usr/local/rabbitmq/sbin\n</code></pre>\n<pre><code>查看插件列表\n</code></pre>\n<pre><code>  ./rabbitmq-plugins list\n</code></pre>\n<pre><code>生效管理插件\n</code></pre>\n<pre><code>  ./rabbitmq-plugins enable rabbitmq_management\n</code></pre>\n<h4 id=\"5-后台运行\"><a class=\"anchor\" href=\"#5-后台运行\">#</a> 5 <strong>后台运行</strong></h4>\n<p>​\t启动 rabbitmq。</p>\n<pre><code>  ./rabbitmq-server -detached\n</code></pre>\n<p>​\t停止命令，如果无法停止，使用 kill -9 进程号进行关闭</p>\n<pre><code> ./rabbitmqctl stop_app\n</code></pre>\n<h4 id=\"6-查看web管理界面\"><a class=\"anchor\" href=\"#6-查看web管理界面\">#</a> 6 <strong>查看 web 管理界面</strong></h4>\n<p>​\t默认可以在安装 rabbitmq 的电脑上通过用户名：guest 密码 guest 进行访问 web 管理界面</p>\n<p>​\t端口号：15672（放行端口，或关闭防火墙）</p>\n<p>​\t在虚拟机浏览器中输入：</p>\n<p>​\t<span class=\"exturl\" data-url=\"aHR0cDovL2xvY2FsaG9zdDoxNTY3Mg==\">http://localhost:15672</span></p>\n<h3 id=\"rabbitmq账户管理\"><a class=\"anchor\" href=\"#rabbitmq账户管理\">#</a> * RabbitMq 账户管理</h3>\n<h4 id=\"1-创建账户\"><a class=\"anchor\" href=\"#1-创建账户\">#</a> 1 <strong>创建账户</strong></h4>\n<p>​\t语法：./rabbitmqctl add_user username password</p>\n<pre><code> cd /usr/local/rabbitmq/sbin\n \n ./rabbitmqctl add_user mashibing mashibing\n</code></pre>\n<h4 id=\"2-给用户授予管理员角色\"><a class=\"anchor\" href=\"#2-给用户授予管理员角色\">#</a> 2 <strong>给用户授予管理员角色</strong></h4>\n<p>​\t其中 smallming 为新建用户的用户名</p>\n<pre><code> ./rabbitmqctl set_user_tags mashibing administrator\n</code></pre>\n<h4 id=\"3-给用户授权\"><a class=\"anchor\" href=\"#3-给用户授权\">#</a> 3 <strong>给用户授权</strong></h4>\n<p>​\t“/” 表示虚拟机</p>\n<p>​\tmashibing 表示用户名</p>\n<p>​\t&quot;.<em>&quot; &quot;.</em>&quot;&quot;.*&quot; 表示完整权限</p>\n<pre><code> ./rabbitmqctl set_permissions -p &quot;/&quot; mashibing &quot;.*&quot; &quot;.*&quot; &quot;.*&quot;\n</code></pre>\n<h4 id=\"4-登录\"><a class=\"anchor\" href=\"#4-登录\">#</a> 4 <strong>登录</strong></h4>\n<p>​\t使用新建账户和密码在 windows 中访问 rabbitmq 并登录</p>\n<p>​\t在浏览器地址栏输入：</p>\n<p>​\t<span class=\"exturl\" data-url=\"aHR0cDovL2lwOjE1NjcyLw==\">http://ip:15672/</span></p>\n<pre><code>用户名：mashibing\n</code></pre>\n<p>​\t密码：mashibing</p>\n<h2 id=\"solrcloud\"><a class=\"anchor\" href=\"#solrcloud\">#</a> SolrCloud</h2>\n<p>​\tSolr 可以搭建具备容错能力和高可用的 Solr 集群。集群中集群配置、自动负载均衡和查询故障转移、\t\t\tZookeeper 集群实现集群协调管理，这些全部功能统称为 SolrCloud。</p>\n<p>​\tSolrCloud 是基于 Zookeeper 进行管理的。在 Solr 中已经内置了 Zookeeper 相关内容，当执行集群创建命令会自动创建 Zookeeper 相关内容。这个使用的是 Zookeeper 的集群管理功能实现的。</p>\n<h4 id=\"1搭建\"><a class=\"anchor\" href=\"#1搭建\">#</a> 1. 搭建</h4>\n<h5 id=\"11创建\"><a class=\"anchor\" href=\"#11创建\">#</a> 1.1 创建</h5>\n<p>​\tSolrCloud 已经包含在了 Solr 中，可以直接启动 Solr 集群。</p>\n<pre><code> ./solr -e cloud -noprompt -force\n</code></pre>\n<p>​\t此命令等同于# ./solr -e cloud -force 全部参数为默认值。</p>\n<p>​\t运行成功后会在 example 文件夹多出 cloud 文件夹。</p>\n<h5 id=\"12停止\"><a class=\"anchor\" href=\"#12停止\">#</a> 1.2 停止</h5>\n<pre><code> ./solr stop -all\n</code></pre>\n<h5 id=\"13重新运行\"><a class=\"anchor\" href=\"#13重新运行\">#</a> 1.3 重新运行</h5>\n<pre><code> ./solr start -c -p 8983 -s ../example/cloud/node1/solr/ -force\n ./solr start -c -p 7574 -z localhost:9983 -s ../example/cloud/node2/solr/ -force\n</code></pre>\n<h2 id=\"hdfs安装\"><a class=\"anchor\" href=\"#hdfs安装\">#</a> HDFS 安装</h2>\n<h3 id=\"1-10\"><a class=\"anchor\" href=\"#1-10\">#</a> ——1</h3>\n<h3 id=\"2-8\"><a class=\"anchor\" href=\"#2-8\">#</a> ——2</h3>\n<p>1. 拉取 Hadoop 镜像（可以在 docker hub 上找合适的镜像）：</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> pull singularities/hadoop</pre></td></tr></table></figure><p>2. 创建 docker-compose.yml 文件（可以在文本编辑器中写好后，复制），内容如下：</p>\n<figure class=\"highlight yml\"><figcaption data-lang=\"YAML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2\"</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token key atrule\">namenode</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> singularities/hadoop</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token key atrule\">command</span><span class=\"token punctuation\">:</span> start<span class=\"token punctuation\">-</span>hadoop namenode</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      <span class=\"token key atrule\">HDFS_USER</span><span class=\"token punctuation\">:</span> hdfsuser</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"8020:8020\"</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"14000:14000\"</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"50070:50070\"</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"10020:10020\"</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"13562:13562\"</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"19888:19888\"</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>  <span class=\"token key atrule\">datanode</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> singularities/hadoop</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token key atrule\">command</span><span class=\"token punctuation\">:</span> start<span class=\"token punctuation\">-</span>hadoop datanode namenode</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>      <span class=\"token key atrule\">HDFS_USER</span><span class=\"token punctuation\">:</span> hdfsuser</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token key atrule\">links</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>      <span class=\"token punctuation\">-</span> namenode</pre></td></tr></table></figure><p>3. 创建 hadoop，执行如下命令</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker-compose</span> up <span class=\"token parameter variable\">-d</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">docker</span> <span class=\"token function\">ps</span></pre></td></tr></table></figure><p>4. 开启多个 datanode</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker-compose</span> scale <span class=\"token assign-left variable\">datanode</span><span class=\"token operator\">=</span><span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">docker</span> <span class=\"token function\">ps</span></pre></td></tr></table></figure><p>5. 查看 hadoop 控制面板。由于服务刚初始化，可能需要等一会。访问类似如下 url：</p>\n<figure class=\"highlight ruby\"><figcaption data-lang=\"ruby\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>http<span class=\"token operator\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span><span class=\"token number\">192.168</span><span class=\"token number\">.1</span><span class=\"token number\">.195</span><span class=\"token operator\">:</span><span class=\"token number\">50070</span><span class=\"token operator\">/</span>dfshealth<span class=\"token punctuation\">.</span>html<span class=\"token comment\">#tab-datanode</span></pre></td></tr></table></figure><p>6. 进入任意 hadoop 相关容器，<strong>直接进行 hdfs 基础操作</strong><br />\n在任意 datanode 的容器中操作 hdfs，会自动同步到其他的 datanode 容器中。</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 查看所有命令</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>hadoop fs</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 创建目录</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>hadoop fs <span class=\"token parameter variable\">-mkdir</span> /hdfs <span class=\"token comment\">#在根目录下创建 hdfs 文件夹</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># 查看目录</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>hadoop fs <span class=\"token parameter variable\">-ls</span>  /   <span class=\"token comment\">#列出根目录下的文件列表</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\"># 创建多级目录</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>hadoop fs <span class=\"token parameter variable\">-mkdir</span> <span class=\"token parameter variable\">-p</span> /hdfs/d1/d2</pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\"># 上传文件到 HDFS</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"hello world\"</span> <span class=\"token operator\">>></span> local.txt   <span class=\"token comment\">#创建文件</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>hadoop fs <span class=\"token parameter variable\">-put</span> local.txt /hdfs/   <span class=\"token comment\">#上传文件到 hdfs</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\"># 下载 hdfs 文件</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>hadoop fs <span class=\"token parameter variable\">-get</span> /hdfs/local.txt</pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\"># 删除 hdfs 中的文件</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>hadoop fs <span class=\"token parameter variable\">-rm</span> /hdfs/local.txt</pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token comment\"># 删除 hdfs 中的目录</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>hadoop fs <span class=\"token parameter variable\">-rmdir</span> /hdfs/d1/d2</pre></td></tr></table></figure><h2 id=\"kafka-安装\"><a class=\"anchor\" href=\"#kafka-安装\">#</a> Kafka 安装</h2>\n<blockquote>\n<p>安装前提，kafka 安装运行最低支持 jdk7；本篇演示版本是基于 jdk1.8；</p>\n</blockquote>\n<p>官方下载地址：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9saW5rLnpoaWh1LmNvbS8/dGFyZ2V0PWh0dHAlM0EvL2thZmthLmFwYWNoZS5vcmcvZG93bmxvYWRz\">Apache Kafka</span></p>\n<p>kafka 是由 scala 语言编写，下载稳定版本，即前一个版本</p>\n<p><img data-src=\"https://cdn.jsdelivr.net/gh/onlymarryu/typora-ims-test@master/tools-All/v2-9f6503ade62cfa48df87cc9da984e87d_720w.jpg\" alt=\"img\" /></p>\n<p>点击进入后，按如下方式点击下载</p>\n<p><img data-src=\"https://cdn.jsdelivr.net/gh/onlymarryu/typora-ims-test@master/tools-All/v2-bd19bea83d1cb978fbeed614ee126da6_720w.jpg\" alt=\"img\" /></p>\n<p>下载完成后进行解压缩</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">tar</span> <span class=\"token parameter variable\">-zxvf</span> kafka_2.12-2.8.0.tgz </pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">mv</span> kafka_2.12-2.8.0 /usr/local/kafka</pre></td></tr></table></figure><p>解压完成后进入 kafka 目录</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">cd</span> /usr/local/kafka</pre></td></tr></table></figure><p><img data-src=\"https://cdn.jsdelivr.net/gh/onlymarryu/typora-ims-test@master/tools-All/v2-dfe360dfc7561953761f8ce69f782f4d_720w.png\" alt=\"img\" /></p>\n<p>kafka 是基于 Zookeeper 的消息管理系统，所以启动的时候是需要使用到 Zookeeper ，但其内置了 Zookeeper ，所以只需要根据 bin 目录下的文件进行启动即可</p>\n<p>启动 Zookeeper 服务端命令</p>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>./bin/zookeeper-server-start.sh ./config/zookeeper.properties</pre></td></tr></table></figure><p>Zookeeper 启动成功后会出现  <code>binding to port 0.0.0.0/0.0.0.0:2181</code>  所示结果表示启动成功；</p>\n<p><img data-src=\"https://pic1.zhimg.com/80/v2-6be2f91cd4ec47d589d3c5b58584c4b8_720w.png\" alt=\"img\" /></p>\n<p>启动 kafka 服务端命令</p>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>./bin/kafka-server-start.sh  ./config/server.properties</pre></td></tr></table></figure><h2 id=\"mycatserver安装\"><a class=\"anchor\" href=\"#mycatserver安装\">#</a> MyCat (Server 安装)</h2>\n<ul>\n<li>\n<p>前提：</p>\n<ul>\n<li>1、<a href=\"#jdk_install\">jdk 安装</a></li>\n<li>2、<a href=\"#mysql_install\">mysql 安装</a></li>\n</ul>\n</li>\n<li>\n<p>官网：<span class=\"exturl\" data-url=\"aHR0cDovL3d3dy5teWNhdC5vcmcuY24v\">http://www.mycat.org.cn/</span></p>\n</li>\n<li>\n<p>首先准备四台虚拟机，安装好 mysql，方便后续做读写分离和主从复制。<strong>(3.3 内容)</strong></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">192.168</span>.85.45 node01</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">192.168</span>.85.46 node02</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">192.168</span>.85.47 node03</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token number\">192.168</span>.85.48 node04</pre></td></tr></table></figure></li>\n</ul>\n<h4 id=\"1-下载mycat\"><a class=\"anchor\" href=\"#1-下载mycat\">#</a> 1、下载 MyCat</h4>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL2RsLm15Y2F0Lm9yZy5jbi8xLjYuNy42LzIwMjEwOTMwMjEzMDQ5L015Y2F0LXNlcnZlci0xLjYuNy42LXJlbGVhc2UtMjAyMTA5MzAyMTMwNDktbGludXgudGFyLmd6\">http://dl.mycat.org.cn/1.6.7.6/20210930213049/Mycat-server-1.6.7.6-release-20210930213049-linux.tar.gz</span></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>windows下载安装包</pre></td></tr></table></figure><h4 id=\"2-上传并解压压缩文件\"><a class=\"anchor\" href=\"#2-上传并解压压缩文件\">#</a> 2、上传并解压压缩文件</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">tar</span> <span class=\"token parameter variable\">-zxvf</span> Mycat-server-1.6.7.5-release-20200422133810-linux.tar.gz <span class=\"token parameter variable\">-C</span> /usr/local/</pre></td></tr></table></figure><h4 id=\"3-修改配置\"><a class=\"anchor\" href=\"#3-修改配置\">#</a> 3、修改配置</h4>\n<p>0、配置环境变量（可选）</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">vim</span> /etc/profile</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># 添加如下配置信息：</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">MYCAT_HOME</span><span class=\"token operator\">=</span>/usr/local/mycat</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\"><span class=\"token environment constant\">PATH</span></span><span class=\"token operator\">=</span><span class=\"token variable\">$MYCAT_HOME</span>/bin:<span class=\"token environment constant\">$PATH</span><span class=\"token builtin class-name\">:</span><span class=\"token variable\">$JAVA_HOME</span>/bin</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\"># 生效</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token builtin class-name\">source</span> /etc/profile</pre></td></tr></table></figure><p><strong>修改 server.xml schema.xml 之前先备份</strong></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">cd</span> /usr/local/mycat</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token builtin class-name\">cd</span> conf</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">cp</span> server.xml server.xml.list</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">cp</span> schema.xml schema.xml.list</pre></td></tr></table></figure><p>1、修改完成后的  <strong>server.xml</strong></p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token prolog\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">&lt;!-- - - Licensed under the Apache License, Version 2.0 (the \"License\"); </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        - you may not use this file except in compliance with the License. - You </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        may obtain a copy of the License at - - http://www.apache.org/licenses/LICENSE-2.0 </pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        - - Unless required by applicable law or agreed to in writing, software - </pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        distributed under the License is distributed on an \"AS IS\" BASIS, - WITHOUT </pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. - See the </pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        License for the specific language governing permissions and - limitations </pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        under the License. --></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">mycat:server</span> <span class=\"token name\">SYSTEM</span> <span class=\"token string\">\"server.dtd\"</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token namespace\">mycat:</span>server</span> <span class=\"token attr-name\"><span class=\"token namespace\">xmlns:</span>mycat</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://io.mycat/<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>user</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>root<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">defaultAccount</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>true<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>password<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>root<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>schemas<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>TESTDB<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>defaultSchema<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>TESTDB<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>user</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token namespace\">mycat:</span>server</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>2、修改完成后的 schema.xml</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token prolog\">&lt;?xml version=\"1.0\"?></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">mycat:schema</span> <span class=\"token name\">SYSTEM</span> <span class=\"token string\">\"schema.dtd\"</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token namespace\">mycat:</span>schema</span> <span class=\"token attr-name\"><span class=\"token namespace\">xmlns:</span>mycat</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://io.mycat/<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>schema</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>TESTDB<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">checkSQLschema</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>false<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">sqlMaxLimit</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>100<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">dataNode</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>dn1<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>schema</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dataNode</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>dn1<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">dataHost</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>host1<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">database</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>msb<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dataHost</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>host1<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">maxCon</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>1000<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">minCon</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>10<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">balance</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>                          <span class=\"token attr-name\">writeType</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">dbType</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>mysql<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">dbDriver</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>native<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">switchType</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>1<span class=\"token punctuation\">\"</span></span>  <span class=\"token attr-name\">slaveThreshold</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>100<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>heartbeat</span><span class=\"token punctuation\">></span></span>select user()<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>heartbeat</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>writeHost</span> <span class=\"token attr-name\">host</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>hostM1<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">url</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>192.168.1.45:3306<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">user</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>root<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>                                   <span class=\"token attr-name\">password</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>root<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                         <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>readHost</span> <span class=\"token attr-name\">host</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>hostS1<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">url</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>192.168.1.46:3306<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">user</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>root<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">password</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>root<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>readHost</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>writeHost</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dataHost</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token namespace\">mycat:</span>schema</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>3、修改 <strong>hosts</strong>  文件</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">vim</span> /etc/hosts</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">#添加</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">#ip name</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">192.168</span>.1.164 node01</pre></td></tr></table></figure><h4 id=\"4-启动mycat\"><a class=\"anchor\" href=\"#4-启动mycat\">#</a> 4、启动 mycat</h4>\n<p>​\t\tmycat 的启动有两种方式，一种是控制台启动，一种是后台启动，在初学的时候建议大家使用控制台启动的方式，当配置文件写错之后，可以方便的看到错误，及时修改，但是在生产环境中，使用后台启动的方式比较稳妥。</p>\n<p>​\t\t<strong>控制台启动：</strong></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">cd</span> /usrlocal/mycat/bin</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>./mycat console</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">#加入环境变量后可直接启动</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>mycat console</pre></td></tr></table></figure><p>​\t\t<strong>后台启动：</strong></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">cd</span> /usrlocal/mycat/bin</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>./mycat start</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">#加入环境变量后可直接启动</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>mycat start</pre></td></tr></table></figure><p>​\t\t按照如上配置在安装的时候应该不会报错，如果出现错误，根据错误的提示解决即可。</p>\n<h4 id=\"5-登录验证\"><a class=\"anchor\" href=\"#5-登录验证\">#</a> 5、登录验证</h4>\n<p>​\t\t<strong>管理窗口的登录</strong></p>\n<p>​\t\t从另外的虚拟机去登录访问当前 mycat，输入如下命令即可</p>\n<pre><code>mysql -uroot -proot -P 9066 -h ip\n</code></pre>\n<p>​\t\t此时访问的是 mycat 的管理窗口，可以通过 show @@help 查看可以执行的命令</p>\n<p>​\t\t<strong>数据窗口的登录</strong></p>\n<p>​\t\t从另外的虚拟机去登录访问 mycat，输入命令如下：【用户设置】</p>\n<pre><code>mysql -uroot -proot -P8066 -h ip\n</code></pre>\n<p>​\t\t当都能够成功的时候以为着 mycat 已经搭建完成。</p>\n<h2 id=\"haproxy安装\"><a class=\"anchor\" href=\"#haproxy安装\">#</a> HAProxy 安装</h2>\n<h3 id=\"1-11\"><a class=\"anchor\" href=\"#1-11\">#</a> ——1</h3>\n<h4 id=\"1-准备好haproxy的安装包\"><a class=\"anchor\" href=\"#1-准备好haproxy的安装包\">#</a> 1、准备好 HAProxy 的安装包</h4>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9zcmMuZmVkb3JhcHJvamVjdC5vcmcvcmVwby9wa2dzL2hhcHJveHkv\">https://src.fedoraproject.org/repo/pkgs/haproxy/</span></p>\n<h4 id=\"2-解压到usrlocal目录\"><a class=\"anchor\" href=\"#2-解压到usrlocal目录\">#</a> 2、解压到 /usr/local 目录</h4>\n<h4 id=\"3-进入到解压后的目录查看内核版本进行编译\"><a class=\"anchor\" href=\"#3-进入到解压后的目录查看内核版本进行编译\">#</a> 3、进入到解压后的目录，查看内核版本，进行编译</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">cd</span> <span class=\"token builtin class-name\">cd</span> /usr/local/haproxy-1.8.25/</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 查看内核版本 3.10=31</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">uname</span> <span class=\"token parameter variable\">-r</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">make</span> <span class=\"token assign-left variable\">TARGET</span><span class=\"token operator\">=</span>linux31</pre></td></tr></table></figure><h4 id=\"4-编译完成之后开始进行安装\"><a class=\"anchor\" href=\"#4-编译完成之后开始进行安装\">#</a> 4、编译完成之后，开始进行安装</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">make</span> <span class=\"token function\">install</span> <span class=\"token assign-left variable\">PREFIX</span><span class=\"token operator\">=</span>/usr/local/haproxy</pre></td></tr></table></figure><h4 id=\"5-安装完成之后创建目录创建haproxy配置文件\"><a class=\"anchor\" href=\"#5-安装完成之后创建目录创建haproxy配置文件\">#</a> 5、安装完成之后，创建目录，创建 HAProxy 配置文件</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">mkdir</span> <span class=\"token parameter variable\">-p</span> /usr/data/haproxy</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">mkdir</span> /usr/local/haproxy/conf</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">vi</span> /usr/local/haproxy/conf、haproxy.conf</pre></td></tr></table></figure><p>6、向配置文件中添加配置信息</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>global</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t\tlog <span class=\"token number\">127.0</span>.0.1 local0</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t\t<span class=\"token comment\">#log 127.0.0.1 local1 notice</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t\t<span class=\"token comment\">#log loghost local0 info</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t\tmaxconn <span class=\"token number\">4096</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t\t<span class=\"token function\">chroot</span> /usr/local/haproxy</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t\tpidfile /usr/data/haproxy/haproxy.pid</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t\tuid <span class=\"token number\">99</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t\tgid <span class=\"token number\">99</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t\tdaemon</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t\t<span class=\"token comment\">#debug</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t\t<span class=\"token comment\">#quiet</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>defaults</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\t\tlog global</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\t\tmode tcp</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\t\toption abortonclose</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\t\toption redispatch</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\t\tretries <span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>\t\tmaxconn <span class=\"token number\">2000</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>\t\t<span class=\"token function\">timeout</span> connect <span class=\"token number\">5000</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>\t\t<span class=\"token function\">timeout</span> client <span class=\"token number\">50000</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>\t\t<span class=\"token function\">timeout</span> server <span class=\"token number\">50000</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>listen proxy_status</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>\t<span class=\"token builtin class-name\">bind</span> :48066</pre></td></tr><tr><td data-num=\"25\"></td><td><pre>\t\tmode tcp</pre></td></tr><tr><td data-num=\"26\"></td><td><pre>\t\tbalance roundrobin</pre></td></tr><tr><td data-num=\"27\"></td><td><pre>\t\tserver mycat_1 <span class=\"token number\">192.168</span>.85.111:8066 check inter 10s</pre></td></tr><tr><td data-num=\"28\"></td><td><pre>\t\tserver mycat_2 <span class=\"token number\">192.168</span>.85.112:8066 check inter 10s</pre></td></tr><tr><td data-num=\"29\"></td><td><pre>frontend admin_stats</pre></td></tr><tr><td data-num=\"30\"></td><td><pre>\t<span class=\"token builtin class-name\">bind</span> :7777</pre></td></tr><tr><td data-num=\"31\"></td><td><pre>\t\tmode http</pre></td></tr><tr><td data-num=\"32\"></td><td><pre>\t\tstats <span class=\"token builtin class-name\">enable</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>\t\toption httplog</pre></td></tr><tr><td data-num=\"34\"></td><td><pre>\t\tmaxconn <span class=\"token number\">10</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>\t\tstats refresh 30s</pre></td></tr><tr><td data-num=\"36\"></td><td><pre>\t\tstats uri /admin</pre></td></tr><tr><td data-num=\"37\"></td><td><pre>\t\tstats auth admin:123123</pre></td></tr><tr><td data-num=\"38\"></td><td><pre>\t\tstats hide-version</pre></td></tr><tr><td data-num=\"39\"></td><td><pre>\t\tstats admin <span class=\"token keyword\">if</span> TRUE</pre></td></tr></table></figure><ul>\n<li>stats uri /admin                   \t\t   <strong>账号</strong></li>\n<li>stats auth admin:123123       \t   <strong>密码</strong></li>\n</ul>\n<h4 id=\"7-启动haproxy服务\"><a class=\"anchor\" href=\"#7-启动haproxy服务\">#</a> 7、启动 haproxy 服务</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>/usr/local/haproxy/sbin/haproxy <span class=\"token parameter variable\">-f</span> /usr/local/haproxy/conf/haproxy.conf</pre></td></tr></table></figure><h4 id=\"8-查看haproxy的进程如果存在则说明没有问题\"><a class=\"anchor\" href=\"#8-查看haproxy的进程如果存在则说明没有问题\">#</a> 8、查看 haproxy 的进程，如果存在则说明没有问题</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">ps</span> <span class=\"token parameter variable\">-ef</span> <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> haproxy</pre></td></tr></table></figure><h4 id=\"9-打开浏览器访问用户名为admin密码为123123\"><a class=\"anchor\" href=\"#9-打开浏览器访问用户名为admin密码为123123\">#</a> 9、打开浏览器访问，用户名为 admin，密码为 123123</h4>\n<p>​\t<span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMS4xNjQ6Nzc3Ny9hZG1pbg==\">http://192.168.1.164:7777/admin</span></p>\n<h2 id=\"keepalived安装\"><a class=\"anchor\" href=\"#keepalived安装\">#</a> Keepalived 安装</h2>\n<h3 id=\"1-12\"><a class=\"anchor\" href=\"#1-12\">#</a> ——1</h3>\n<h4 id=\"1-准备好keepalived安装包\"><a class=\"anchor\" href=\"#1-准备好keepalived安装包\">#</a> 1、准备好 Keepalived 安装包</h4>\n<h4 id=\"2-解压到usrlocal目录-2\"><a class=\"anchor\" href=\"#2-解压到usrlocal目录-2\">#</a> 2、解压到 /usr/local 目录</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">tar</span> <span class=\"token parameter variable\">-zxvf</span> /usr/local/tmp/keepalived-1.4.5.tar.gz <span class=\"token parameter variable\">-C</span> /usr/local/</pre></td></tr></table></figure><h4 id=\"3-安装需要依赖的环境组件\"><a class=\"anchor\" href=\"#3-安装需要依赖的环境组件\">#</a> 3、安装需要依赖的环境组件</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>yum <span class=\"token function\">install</span> gcc openssl-devel popt-devel <span class=\"token parameter variable\">-y</span></pre></td></tr></table></figure><h4 id=\"4-进入到解压目录进行编译\"><a class=\"anchor\" href=\"#4-进入到解压目录进行编译\">#</a> 4、进入到解压目录，进行编译</h4>\n<pre><code>cd /usr/local/keepalived-1.4.5\n./configure --prefix=/usr/local/keepalived\t\n</code></pre>\n<h4 id=\"5-编译完成之后进行安装\"><a class=\"anchor\" href=\"#5-编译完成之后进行安装\">#</a> 5、编译完成之后，进行安装</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">make</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">make</span> <span class=\"token function\">install</span></pre></td></tr></table></figure><h4 id=\"6-将keepalived的服务注册为系统服务\"><a class=\"anchor\" href=\"#6-将keepalived的服务注册为系统服务\">#</a> 6、将 keepalived 的服务注册为系统服务</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">cp</span>  <span class=\"token parameter variable\">-rf</span>   /usr/local/keepalived-1.4.5/keepalived/etc/init.d/keepalived /etc/init.d/</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">mkdir</span> /etc/keepalived</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">cp</span>   <span class=\"token parameter variable\">-rf</span>  /usr/local/keepalived/etc/keepalived/keepalived.conf /etc/keepalived/</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">cp</span>   <span class=\"token parameter variable\">-rf</span>  /usr/local/keepalived-1.4.5/keepalived/etc/sysconfig/keepalived /etc/sysconfig/</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">cp</span>   <span class=\"token parameter variable\">-rf</span>  /usr/local/keepalived/sbin/keepalived /usr/sbin/</pre></td></tr></table></figure><h4 id=\"7-修改配置文件\"><a class=\"anchor\" href=\"#7-修改配置文件\">#</a> 7、修改配置文件</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">vim</span>  /etc/keepalived/keepalived.conf</pre></td></tr></table></figure><p><strong>CentOS-6   下的配置文件</strong></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token operator\">!</span> Configuration File <span class=\"token keyword\">for</span> keepalived</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>global_defs <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   notification_email <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>     acassen@firewall.loc</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>     failover@firewall.loc</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>     sysadmin@firewall.loc</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>   notification_email_from Alexandre.Cassen@firewall.loc</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>   smtp_server <span class=\"token number\">127.0</span>.0.1</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>   smtp_connect_timeout <span class=\"token number\">30</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>   router_id LVS_DEVEL</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>   vrrp_skip_check_adv_addr</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>   vrrp_garp_interval <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>   vrrp_gna_interval <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>vrrp_instance VI_1 <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\t<span class=\"token comment\"># 配置为主</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    state MASTER</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token comment\"># 设置网卡</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    interface eth0</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>     <span class=\"token comment\"># 虚拟路由 ID，全局唯一</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    virtual_router_id <span class=\"token number\">51</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token comment\"># 优先级，权重值</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    priority <span class=\"token number\">100</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    advert_int <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    authentication <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        auth_type PASS</pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        auth_pass <span class=\"token number\">1111</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    virtual_ipaddress <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>         <span class=\"token number\">192.168</span>.1.100/24  dev eth0 label eth0:3:</pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><strong>CentOS-7   下的配置文件</strong></p>\n<pre><code class=\"language-conf\">! Configuration File for keepalived\nglobal_defs &#123;\n   notification_email &#123;\n     acassen@firewall.loc\n     failover@firewall.loc\n     sysadmin@firewall.loc\n   &#125;\n   notification_email_from Alexandre.Cassen@firewall.loc\n   smtp_server 127.0.0.1\n   smtp_connect_timeout 30\n   router_id LVS_DEVEL\n   vrrp_skip_check_adv_addr\n   vrrp_garp_interval 0\n   vrrp_gna_interval 0\n&#125;\n\nvrrp_instance VI_1 &#123;\n\t# 配置为主\n    state MASTER\n    # 设置网卡\n    interface ens33\n     # 虚拟路由ID，全局唯一\n    virtual_router_id 51\n    # 优先级，权重值\n    priority 100\n    advert_int 1\n    authentication &#123;\n        auth_type PASS\n        auth_pass 1111\n    &#125;\n    virtual_ipaddress &#123;\n        192.168.1.100/24 \n    &#125;\n&#125;\n\n</code></pre>\n<h4 id=\"8-启动keepalived\"><a class=\"anchor\" href=\"#8-启动keepalived\">#</a> 8、启动 keepalived</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">service</span> keepalived start</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">#或者</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>systemctl start keepalived.service</pre></td></tr></table></figure><h4 id=\"9-登录验证\"><a class=\"anchor\" href=\"#9-登录验证\">#</a> 9、登录验证</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>mysql <span class=\"token parameter variable\">-uroot</span> <span class=\"token parameter variable\">-p123456</span> <span class=\"token parameter variable\">-h</span> <span class=\"token number\">192.168</span>.1.100 <span class=\"token parameter variable\">-P</span> <span class=\"token number\">48066</span></pre></td></tr></table></figure><h2 id=\"mycat-web\"><a class=\"anchor\" href=\"#mycat-web\">#</a> mycat-web</h2>\n<h3 id=\"1-13\"><a class=\"anchor\" href=\"#1-13\">#</a> ——1</h3>\n<h4 id=\"1-下载mycat-web安装包\"><a class=\"anchor\" href=\"#1-下载mycat-web安装包\">#</a> 1、下载 mycat-web 安装包</h4>\n<p>​\t官方地址：<span class=\"exturl\" data-url=\"aHR0cDovL2RsLm15Y2F0Lm9yZy5jbi8=\">http://dl.mycat.org.cn/</span></p>\n<h4 id=\"2-解压安装包到usrlocal目录\"><a class=\"anchor\" href=\"#2-解压安装包到usrlocal目录\">#</a> 2、解压安装包到 /usr/local 目录</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">tar</span> <span class=\"token parameter variable\">-zxvf</span> Mycat-web-1.0-SNAPSHOT-20170102153329-linux.tar.gz <span class=\"token parameter variable\">-C</span> /usr/local/</pre></td></tr></table></figure><h4 id=\"3-进入mycat-web的目录运行启动命令\"><a class=\"anchor\" href=\"#3-进入mycat-web的目录运行启动命令\">#</a> 3、进入 mycat-web 的目录运行启动命令</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>./start.sh <span class=\"token operator\">&amp;</span></pre></td></tr></table></figure><h4 id=\"4-mycat-web的服务端口是8082查看服务是否启动\"><a class=\"anchor\" href=\"#4-mycat-web的服务端口是8082查看服务是否启动\">#</a> 4、mycat-web 的服务端口是 8082，查看服务是否启动</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">netstat</span> <span class=\"token parameter variable\">-nlpt</span> <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> <span class=\"token number\">8082</span></pre></td></tr></table></figure><h4 id=\"5-通过地址访问服务\"><a class=\"anchor\" href=\"#5-通过地址访问服务\">#</a> 5、通过地址访问服务</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">192.168</span>.1.164:8082/mycat/</pre></td></tr></table></figure><h4 id=\"6-mycat-web配置\"><a class=\"anchor\" href=\"#6-mycat-web配置\">#</a> 6、mycat-web 配置</h4>\n<h5 id=\"61-配置zookeeper可选\"><a class=\"anchor\" href=\"#61-配置zookeeper可选\">#</a> 6.1、配置 zookeeper (可选)</h5>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">cd</span> /usr/local/mycat-web/mycat-web/WEB-INF/classes</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">#修改 mycat.properties 文件，可以修改 zookeeper 的地址</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">vim</span> mycat.properties</pre></td></tr></table></figure><h5 id=\"62-添加mycat实例\"><a class=\"anchor\" href=\"#62-添加mycat实例\">#</a> 6.2、添加 mycat 实例</h5>\n<pre><code>* 在页面的mycat配置\n\n* mycat服务管理中添加mycat实例，需要填写相关的参数\n</code></pre>\n<h2 id=\"nacos安装\"><a class=\"anchor\" href=\"#nacos安装\">#</a> Nacos 安装</h2>\n<p><strong>注：</strong></p>\n<ul>\n<li>\n<p>安装之前必须 配置  <a href=\"#jdk_install\">jdk</a></p>\n</li>\n<li>\n<p>安装之前必须 配置  <a href=\"#mysql_install\">mysql5.6.+</a></p>\n</li>\n</ul>\n<div name=\"nacos_install_1\">\n<h3 id=\"1-14\"><a class=\"anchor\" href=\"#1-14\">#</a> ——1</h3>\n<h4 id=\"1-准备安装包\"><a class=\"anchor\" href=\"#1-准备安装包\">#</a> 1、准备安装包</h4>\n<p>官网：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2FsaWJhYmEvbmFjb3MvcmVsZWFzZXM=\">https://github.com/alibaba/nacos/releases</span></p>\n<p>本篇我们选择 version：2.0.3</p>\n<h4 id=\"2-上传并解压\"><a class=\"anchor\" href=\"#2-上传并解压\">#</a> 2、上传并解压</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">tar</span> <span class=\"token parameter variable\">-zxvf</span> nacos-server-2.0.3 .tar.gz <span class=\"token parameter variable\">-C</span> /usr/local/</pre></td></tr></table></figure><h4 id=\"3-修改配置-2\"><a class=\"anchor\" href=\"#3-修改配置-2\">#</a> 3、修改配置</h4>\n<blockquote>\n<p>1、使用 nacos-mysql.sql</p>\n<p>​\t\t为我们储存数据建立数据库、表</p>\n<p>2、 <code>application.properties里面修改数据储存位置为mysql</code></p>\n</blockquote>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">cd</span> /usr/local/nacos/conf</pre></td></tr></table></figure><figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">-- 1 建立数据库</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">create</span>  <span class=\"token keyword\">database</span> nacos_config<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">use</span> nacos_config<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>config_info<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">bigint</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">AUTO_INCREMENT</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'id'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>data_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'data_id'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>group_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>content<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">longtext</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'content'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>md5<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'md5'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>gmt_create<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">datetime</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CURRENT_TIMESTAMP</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'创建时间'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>gmt_modified<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">datetime</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CURRENT_TIMESTAMP</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'修改时间'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>src_user<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">text</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'source user'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>src_ip<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'source ip'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>app_name<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tenant_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token string\">''</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'租户字段'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>c_desc<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">256</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>c_use<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">64</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>effect<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">64</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>type<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">64</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>c_schema<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">text</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>  <span class=\"token keyword\">PRIMARY</span> <span class=\"token keyword\">KEY</span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>  <span class=\"token keyword\">UNIQUE</span> <span class=\"token keyword\">KEY</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>uk_configinfo_datagrouptenant<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>data_id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">,</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>group_id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">,</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>tenant_id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token punctuation\">)</span> <span class=\"token keyword\">ENGINE</span><span class=\"token operator\">=</span><span class=\"token keyword\">InnoDB</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CHARSET</span><span class=\"token operator\">=</span>utf8 <span class=\"token keyword\">COLLATE</span><span class=\"token operator\">=</span>utf8_bin <span class=\"token keyword\">COMMENT</span><span class=\"token operator\">=</span><span class=\"token string\">'config_info'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>config_info_aggr<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">bigint</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">AUTO_INCREMENT</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'id'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>data_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'data_id'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>group_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'group_id'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>datum_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'datum_id'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>content<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">longtext</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'内容'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>gmt_modified<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">datetime</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'修改时间'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>app_name<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tenant_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token string\">''</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'租户字段'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>  <span class=\"token keyword\">PRIMARY</span> <span class=\"token keyword\">KEY</span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>  <span class=\"token keyword\">UNIQUE</span> <span class=\"token keyword\">KEY</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>uk_configinfoaggr_datagrouptenantdatum<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>data_id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">,</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>group_id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">,</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>tenant_id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">,</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>datum_id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token punctuation\">)</span> <span class=\"token keyword\">ENGINE</span><span class=\"token operator\">=</span><span class=\"token keyword\">InnoDB</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CHARSET</span><span class=\"token operator\">=</span>utf8 <span class=\"token keyword\">COLLATE</span><span class=\"token operator\">=</span>utf8_bin <span class=\"token keyword\">COMMENT</span><span class=\"token operator\">=</span><span class=\"token string\">'增加租户字段'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre></pre></td></tr><tr><td data-num=\"40\"></td><td><pre></pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>config_info_beta<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">bigint</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">AUTO_INCREMENT</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'id'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>data_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'data_id'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>group_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'group_id'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>app_name<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'app_name'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>content<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">longtext</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'content'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>beta_ips<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">1024</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'betaIps'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>md5<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'md5'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>gmt_create<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">datetime</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CURRENT_TIMESTAMP</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'创建时间'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>gmt_modified<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">datetime</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CURRENT_TIMESTAMP</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'修改时间'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>src_user<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">text</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'source user'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>src_ip<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'source ip'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tenant_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token string\">''</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'租户字段'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>  <span class=\"token keyword\">PRIMARY</span> <span class=\"token keyword\">KEY</span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>  <span class=\"token keyword\">UNIQUE</span> <span class=\"token keyword\">KEY</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>uk_configinfobeta_datagrouptenant<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>data_id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">,</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>group_id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">,</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>tenant_id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre><span class=\"token punctuation\">)</span> <span class=\"token keyword\">ENGINE</span><span class=\"token operator\">=</span><span class=\"token keyword\">InnoDB</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CHARSET</span><span class=\"token operator\">=</span>utf8 <span class=\"token keyword\">COLLATE</span><span class=\"token operator\">=</span>utf8_bin <span class=\"token keyword\">COMMENT</span><span class=\"token operator\">=</span><span class=\"token string\">'config_info_beta'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre></pre></td></tr><tr><td data-num=\"59\"></td><td><pre></pre></td></tr><tr><td data-num=\"60\"></td><td><pre><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>config_info_tag<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">bigint</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">AUTO_INCREMENT</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'id'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>data_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'data_id'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>group_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'group_id'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tenant_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token string\">''</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'tenant_id'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tag_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'tag_id'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>app_name<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'app_name'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>content<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">longtext</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'content'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>md5<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'md5'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>gmt_create<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">datetime</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CURRENT_TIMESTAMP</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'创建时间'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>gmt_modified<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">datetime</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CURRENT_TIMESTAMP</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'修改时间'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>src_user<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">text</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'source user'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>src_ip<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'source ip'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>  <span class=\"token keyword\">PRIMARY</span> <span class=\"token keyword\">KEY</span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>  <span class=\"token keyword\">UNIQUE</span> <span class=\"token keyword\">KEY</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>uk_configinfotag_datagrouptenanttag<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>data_id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">,</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>group_id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">,</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>tenant_id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">,</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>tag_id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre><span class=\"token punctuation\">)</span> <span class=\"token keyword\">ENGINE</span><span class=\"token operator\">=</span><span class=\"token keyword\">InnoDB</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CHARSET</span><span class=\"token operator\">=</span>utf8 <span class=\"token keyword\">COLLATE</span><span class=\"token operator\">=</span>utf8_bin <span class=\"token keyword\">COMMENT</span><span class=\"token operator\">=</span><span class=\"token string\">'config_info_tag'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre></pre></td></tr><tr><td data-num=\"77\"></td><td><pre></pre></td></tr><tr><td data-num=\"78\"></td><td><pre><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>config_tags_relation<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">bigint</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'id'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tag_name<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'tag_name'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tag_type<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">64</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'tag_type'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>data_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'data_id'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>group_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'group_id'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tenant_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token string\">''</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'tenant_id'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>nid<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">bigint</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">AUTO_INCREMENT</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>  <span class=\"token keyword\">PRIMARY</span> <span class=\"token keyword\">KEY</span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>nid<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre>  <span class=\"token keyword\">UNIQUE</span> <span class=\"token keyword\">KEY</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>uk_configtagrelation_configidtag<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">,</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>tag_name<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">,</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>tag_type<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre>  <span class=\"token keyword\">KEY</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>idx_tenant_id<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>tenant_id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre><span class=\"token punctuation\">)</span> <span class=\"token keyword\">ENGINE</span><span class=\"token operator\">=</span><span class=\"token keyword\">InnoDB</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CHARSET</span><span class=\"token operator\">=</span>utf8 <span class=\"token keyword\">COLLATE</span><span class=\"token operator\">=</span>utf8_bin <span class=\"token keyword\">COMMENT</span><span class=\"token operator\">=</span><span class=\"token string\">'config_tag_relation'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre></pre></td></tr><tr><td data-num=\"91\"></td><td><pre></pre></td></tr><tr><td data-num=\"92\"></td><td><pre><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>group_capacity<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">bigint</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">unsigned</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">AUTO_INCREMENT</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'主键ID'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>group_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token string\">''</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'Group ID，空字符表示整个集群'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"95\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>quota<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">unsigned</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token string\">'0'</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'配额，0表示使用默认值'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"96\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>usage<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">unsigned</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token string\">'0'</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'使用量'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"97\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>max_size<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">unsigned</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token string\">'0'</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'单个配置大小上限，单位为字节，0表示使用默认值'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>max_aggr_count<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">unsigned</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token string\">'0'</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'聚合子配置最大个数，，0表示使用默认值'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"99\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>max_aggr_size<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">unsigned</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token string\">'0'</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'单个聚合数据的子配置大小上限，单位为字节，0表示使用默认值'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"100\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>max_history_count<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">unsigned</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token string\">'0'</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'最大变更历史数量'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"101\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>gmt_create<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">datetime</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CURRENT_TIMESTAMP</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'创建时间'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"102\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>gmt_modified<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">datetime</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CURRENT_TIMESTAMP</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'修改时间'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"103\"></td><td><pre>  <span class=\"token keyword\">PRIMARY</span> <span class=\"token keyword\">KEY</span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"104\"></td><td><pre>  <span class=\"token keyword\">UNIQUE</span> <span class=\"token keyword\">KEY</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>uk_group_id<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>group_id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"105\"></td><td><pre><span class=\"token punctuation\">)</span> <span class=\"token keyword\">ENGINE</span><span class=\"token operator\">=</span><span class=\"token keyword\">InnoDB</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CHARSET</span><span class=\"token operator\">=</span>utf8 <span class=\"token keyword\">COLLATE</span><span class=\"token operator\">=</span>utf8_bin <span class=\"token keyword\">COMMENT</span><span class=\"token operator\">=</span><span class=\"token string\">'集群、各Group容量信息表'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"106\"></td><td><pre></pre></td></tr><tr><td data-num=\"107\"></td><td><pre></pre></td></tr><tr><td data-num=\"108\"></td><td><pre><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>his_config_info<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"109\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">bigint</span><span class=\"token punctuation\">(</span><span class=\"token number\">64</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">unsigned</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"110\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>nid<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">bigint</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">unsigned</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">AUTO_INCREMENT</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"111\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>data_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"112\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>group_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"113\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>app_name<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'app_name'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"114\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>content<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">longtext</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"115\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>md5<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"116\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>gmt_create<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">datetime</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CURRENT_TIMESTAMP</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"117\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>gmt_modified<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">datetime</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CURRENT_TIMESTAMP</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"118\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>src_user<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">text</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"119\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>src_ip<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"120\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>op_type<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">char</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"121\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tenant_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token string\">''</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'租户字段'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"122\"></td><td><pre>  <span class=\"token keyword\">PRIMARY</span> <span class=\"token keyword\">KEY</span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>nid<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"123\"></td><td><pre>  <span class=\"token keyword\">KEY</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>idx_gmt_create<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>gmt_create<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"124\"></td><td><pre>  <span class=\"token keyword\">KEY</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>idx_gmt_modified<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>gmt_modified<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"125\"></td><td><pre>  <span class=\"token keyword\">KEY</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>idx_did<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>data_id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"126\"></td><td><pre><span class=\"token punctuation\">)</span> <span class=\"token keyword\">ENGINE</span><span class=\"token operator\">=</span><span class=\"token keyword\">InnoDB</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CHARSET</span><span class=\"token operator\">=</span>utf8 <span class=\"token keyword\">COLLATE</span><span class=\"token operator\">=</span>utf8_bin <span class=\"token keyword\">COMMENT</span><span class=\"token operator\">=</span><span class=\"token string\">'多租户改造'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"127\"></td><td><pre></pre></td></tr><tr><td data-num=\"128\"></td><td><pre></pre></td></tr><tr><td data-num=\"129\"></td><td><pre><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tenant_capacity<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"130\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">bigint</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">unsigned</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">AUTO_INCREMENT</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'主键ID'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"131\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tenant_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token string\">''</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'Tenant ID'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"132\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>quota<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">unsigned</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token string\">'0'</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'配额，0表示使用默认值'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"133\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>usage<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">unsigned</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token string\">'0'</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'使用量'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"134\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>max_size<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">unsigned</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token string\">'0'</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'单个配置大小上限，单位为字节，0表示使用默认值'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"135\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>max_aggr_count<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">unsigned</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token string\">'0'</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'聚合子配置最大个数'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"136\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>max_aggr_size<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">unsigned</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token string\">'0'</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'单个聚合数据的子配置大小上限，单位为字节，0表示使用默认值'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"137\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>max_history_count<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">unsigned</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token string\">'0'</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'最大变更历史数量'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"138\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>gmt_create<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">datetime</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CURRENT_TIMESTAMP</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'创建时间'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"139\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>gmt_modified<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">datetime</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CURRENT_TIMESTAMP</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'修改时间'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"140\"></td><td><pre>  <span class=\"token keyword\">PRIMARY</span> <span class=\"token keyword\">KEY</span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"141\"></td><td><pre>  <span class=\"token keyword\">UNIQUE</span> <span class=\"token keyword\">KEY</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>uk_tenant_id<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>tenant_id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"142\"></td><td><pre><span class=\"token punctuation\">)</span> <span class=\"token keyword\">ENGINE</span><span class=\"token operator\">=</span><span class=\"token keyword\">InnoDB</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CHARSET</span><span class=\"token operator\">=</span>utf8 <span class=\"token keyword\">COLLATE</span><span class=\"token operator\">=</span>utf8_bin <span class=\"token keyword\">COMMENT</span><span class=\"token operator\">=</span><span class=\"token string\">'租户容量信息表'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"143\"></td><td><pre></pre></td></tr><tr><td data-num=\"144\"></td><td><pre></pre></td></tr><tr><td data-num=\"145\"></td><td><pre><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tenant_info<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"146\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">bigint</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">AUTO_INCREMENT</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'id'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"147\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>kp<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'kp'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"148\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tenant_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">default</span> <span class=\"token string\">''</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'tenant_id'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"149\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tenant_name<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">default</span> <span class=\"token string\">''</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'tenant_name'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"150\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tenant_desc<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">256</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'tenant_desc'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"151\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>create_source<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'create_source'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"152\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>gmt_create<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">bigint</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'创建时间'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"153\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>gmt_modified<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">bigint</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'修改时间'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"154\"></td><td><pre>  <span class=\"token keyword\">PRIMARY</span> <span class=\"token keyword\">KEY</span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"155\"></td><td><pre>  <span class=\"token keyword\">UNIQUE</span> <span class=\"token keyword\">KEY</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>uk_tenant_info_kptenantid<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>kp<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">,</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>tenant_id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"156\"></td><td><pre>  <span class=\"token keyword\">KEY</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>idx_tenant_id<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>tenant_id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"157\"></td><td><pre><span class=\"token punctuation\">)</span> <span class=\"token keyword\">ENGINE</span><span class=\"token operator\">=</span><span class=\"token keyword\">InnoDB</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CHARSET</span><span class=\"token operator\">=</span>utf8 <span class=\"token keyword\">COLLATE</span><span class=\"token operator\">=</span>utf8_bin <span class=\"token keyword\">COMMENT</span><span class=\"token operator\">=</span><span class=\"token string\">'tenant_info'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"158\"></td><td><pre></pre></td></tr><tr><td data-num=\"159\"></td><td><pre><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>users<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"160\"></td><td><pre>\t<span class=\"token identifier\"><span class=\"token punctuation\">`</span>username<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">PRIMARY</span> <span class=\"token keyword\">KEY</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"161\"></td><td><pre>\t<span class=\"token identifier\"><span class=\"token punctuation\">`</span>password<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">500</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"162\"></td><td><pre>\t<span class=\"token identifier\"><span class=\"token punctuation\">`</span>enabled<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">boolean</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span></pre></td></tr><tr><td data-num=\"163\"></td><td><pre><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"164\"></td><td><pre></pre></td></tr><tr><td data-num=\"165\"></td><td><pre><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>roles<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"166\"></td><td><pre>\t<span class=\"token identifier\"><span class=\"token punctuation\">`</span>username<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"167\"></td><td><pre>\t<span class=\"token identifier\"><span class=\"token punctuation\">`</span>role<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"168\"></td><td><pre>\t<span class=\"token keyword\">UNIQUE</span> <span class=\"token keyword\">INDEX</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>idx_user_role<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>username<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">ASC</span><span class=\"token punctuation\">,</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>role<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">ASC</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">USING</span> <span class=\"token keyword\">BTREE</span></pre></td></tr><tr><td data-num=\"169\"></td><td><pre><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"170\"></td><td><pre></pre></td></tr><tr><td data-num=\"171\"></td><td><pre><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>permissions<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"172\"></td><td><pre>    <span class=\"token identifier\"><span class=\"token punctuation\">`</span>role<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"173\"></td><td><pre>    <span class=\"token identifier\"><span class=\"token punctuation\">`</span>resource<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"174\"></td><td><pre>    <span class=\"token identifier\"><span class=\"token punctuation\">`</span>action<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"175\"></td><td><pre>    <span class=\"token keyword\">UNIQUE</span> <span class=\"token keyword\">INDEX</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>uk_role_permission<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>role<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">,</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>resource<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">,</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>action<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">USING</span> <span class=\"token keyword\">BTREE</span></pre></td></tr><tr><td data-num=\"176\"></td><td><pre><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"177\"></td><td><pre></pre></td></tr><tr><td data-num=\"178\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> users <span class=\"token punctuation\">(</span>username<span class=\"token punctuation\">,</span> password<span class=\"token punctuation\">,</span> enabled<span class=\"token punctuation\">)</span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'nacos'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'$2a$10$EuWPZHzz32dJN7jexM34MOeYirDdFAZm2kuWj7VEOJhhZkDrxfvUu'</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">TRUE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"179\"></td><td><pre></pre></td></tr><tr><td data-num=\"180\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> roles <span class=\"token punctuation\">(</span>username<span class=\"token punctuation\">,</span> role<span class=\"token punctuation\">)</span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'nacos'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ROLE_ADMIN'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#2 先留取备份</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">cp</span> application.properties application.properties.bk</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">vim</span> application.properties</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\"># 在 application.properties 最后添加以下内容</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token assign-left variable\">spring.datasource.platform</span><span class=\"token operator\">=</span>mysql</pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token assign-left variable\">db.num</span><span class=\"token operator\">=</span><span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token assign-left variable\">db.url.0</span><span class=\"token operator\">=</span>jdbc:mysql://127.0.0.1:3306/nacos_config?characterEncoding<span class=\"token operator\">=</span>utf8<span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">connectTimeout</span><span class=\"token operator\">=</span><span class=\"token number\">1000</span><span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">socketTimeout</span><span class=\"token operator\">=</span><span class=\"token number\">3000</span><span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">autoReconnect</span><span class=\"token operator\">=</span>true<span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">serverTimezone</span><span class=\"token operator\">=</span>UTC</pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token assign-left variable\">db.user</span><span class=\"token operator\">=</span>root</pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token assign-left variable\">db.password</span><span class=\"token operator\">=</span>root</pre></td></tr></table></figure><h4 id=\"4-开启nacos\"><a class=\"anchor\" href=\"#4-开启nacos\">#</a> 4、开启 nacos</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>/usr/local/nacos/bin/startup.sh</pre></td></tr></table></figure><h4 id=\"5-查看\"><a class=\"anchor\" href=\"#5-查看\">#</a> 5、查看</h4>\n<ul>\n<li>测试之前先关闭防火墙</li>\n</ul>\n<p><span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMS41Mjo4ODQ4L25hY29z\">http://192.168.1.52:8848/nacos</span></p>\n<h2 id=\"nacos集群配置\"><a class=\"anchor\" href=\"#nacos集群配置\">#</a> Nacos 集群配置</h2>\n<ul>\n<li>前提</li>\n</ul>\n<blockquote>\n<p>1、安装  <a href=\"#jdk_install\">jdk</a></p>\n<p>2、安装之前必须 配置  <a href=\"#mysql_install\">mysql5.6.+</a></p>\n<p>3、配置 <a href=\"#nginx_install_1\">nginx</a></p>\n<p>4、配置 <a href=\"#nacos_install_1\">Nacos（单机版 - 1）</a></p>\n</blockquote>\n<ul>\n<li>懒加载</li>\n</ul>\n<blockquote>\n<p>我们启动 nginx 之后可能不会立即开始代理，打开日志等一会，没有结果的时候重配一下</p>\n</blockquote>\n<h3 id=\"1-15\"><a class=\"anchor\" href=\"#1-15\">#</a> ——1</h3>\n<p>​\t* 此例中   <code>nginx:1.16</code>  安装教程为： <a href=\"#nacos_install_1\">Nacos（单机版 - 1）</a></p>\n<h4 id=\"1-修改集群配置文件\"><a class=\"anchor\" href=\"#1-修改集群配置文件\">#</a> 1、修改集群配置文件</h4>\n<p>​\t这里开始正式配置集群，首先我们要更改   <strong>cluter.conf</strong>   这个配置文件，当然我们也需要备份，但是这里它的<strong>原始名称</strong>为：<strong>cluster.conf.example</strong> ，我们需要把它保留同时复制出一个 cluster.conf 来进行更改</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">cd</span> /usr/local/nacos/conf</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 先备份</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">cp</span> cluster.conf.example cluster.conf</pre></td></tr></table></figure><p>修改 cluster.conf</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 格式： ip 地址：端口号</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">#</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># Copyright 1999-2018 Alibaba Group Holding Ltd.</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">#</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># Licensed under the Apache License, Version 2.0 (the \"License\");</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\"># you may not use this file except in compliance with the License.</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\"># You may obtain a copy of the License at</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">#</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\">#      http://www.apache.org/licenses/LICENSE-2.0</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\">#</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\"># Unless required by applicable law or agreed to in writing, software</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\"># distributed under the License is distributed on an \"AS IS\" BASIS,</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\"># See the License for the specific language governing permissions and</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\"># limitations under the License.</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token comment\">#</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token comment\">#it is ip</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token comment\">#example</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token comment\">#192.168.16.101:8847</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token comment\">#192.168.16.102</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token comment\">#192.168.16.10</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token comment\">#ip:port</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token number\">192.168</span>.124.133:3333</pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token number\">192.168</span>.124.133:4444</pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token number\">192.168</span>.124.133:5555</pre></td></tr></table></figure><h4 id=\"2-编辑nacos的启动脚本startupsh\"><a class=\"anchor\" href=\"#2-编辑nacos的启动脚本startupsh\">#</a> 2、<span class=\"exturl\" data-url=\"aHR0cDovL3huLS1OYWNvc3N0YXJ0dXAtYmg3dDI5bmx0MGd1azlicnA0YXZ1aDd2NWUuc2g=\">编辑 Nacos 的启动脚本 startup.sh</span></h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">cd</span> /usr/local/nacos/bin</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 先备份</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">cp</span> startup.sh starup.sh.bk</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">vim</span>  startup.sh</pre></td></tr></table></figure><figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#1  在 while 的变量中添加 o 并且在 case 中添加对应处理</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>        o<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>            <span class=\"token assign-left variable\">PORT</span><span class=\"token operator\">=</span><span class=\"token variable\">$OPTARG</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        </pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">#2  在 nohup 和 \"$JAVA_OPT_EXT_FIX\" 之前配置这个</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>     <span class=\"token variable\">$JAVA</span> <span class=\"token parameter variable\">-Dserver.port</span><span class=\"token operator\">=</span><span class=\"token variable\">$&#123;PORT&#125;</span></pre></td></tr></table></figure><img data-src=\"/tools/tools-All/1648643016965.png\" class=\"\" width=\"1648643016965\">\n<img data-src=\"/tools/tools-All/1648643157451.png\" class=\"\" width=\"1648643157451\">\n<h4 id=\"3-配置nginx\"><a class=\"anchor\" href=\"#3-配置nginx\">#</a> 3、配置 nginx</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>upstream  cluster<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\tserver <span class=\"token number\">192.168</span>.1.52:3333<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\tserver <span class=\"token number\">192.168</span>.1.52:4444<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\tserver <span class=\"token number\">192.168</span>.1.52:5555<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\tproxy_pass  http://cluter<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p><strong>图片中  <code>cluster</code>  写错了 少了一个 <code>s</code>  ，其实问题也不大，但是要专业～～</strong></p>\n<img data-src=\"/tools/tools-All/1648643539716.png\" class=\"\" width=\"1648643539716\">\n<h4 id=\"4-启动nginx\"><a class=\"anchor\" href=\"#4-启动nginx\">#</a> 4、启动 Nginx</h4>\n<pre><code class=\"language-shell\">\n</code></pre>\n<h4 id=\"5-查看测试\"><a class=\"anchor\" href=\"#5-查看测试\">#</a> 5、查看测试</h4>\n<p><span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMS41Mjo4MC9uYWNvcw==\">http://192.168.1.52:80/nacos</span></p>\n<h2 id=\"openssl安装\"><a class=\"anchor\" href=\"#openssl安装\">#</a> OpenSSL 安装</h2>\n<h3 id=\"1-16\"><a class=\"anchor\" href=\"#1-16\">#</a> ——1</h3>\n<p>参考链接：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3ZlY3Rvcl9kYXRhL2FydGljbGUvZGV0YWlscy8xMDc1NTc5NDE=\">https://blog.csdn.net/vector_data/article/details/107557941</span></p>\n<h4 id=\"1安装依赖c语言依赖-2\"><a class=\"anchor\" href=\"#1安装依赖c语言依赖-2\">#</a> 1. 安装依赖 C 语言依赖</h4>\n<p>​\tredis 使用 C 语言编写，所以需要安装 C 语言库</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>yum <span class=\"token function\">install</span> <span class=\"token parameter variable\">-y</span> gcc zlib</pre></td></tr></table></figure><p>​</p>\n<h4 id=\"2上传并解压-2\"><a class=\"anchor\" href=\"#2上传并解压-2\">#</a> 2. 上传并解压</h4>\n<p>​\t把  <code>openssl-1.1.1j.tar.gz</code>  上传到 /usr/local/tmp 中，解压文件</p>\n<pre><code> cd /usr/local/tmp\n\n tar zxf openssl-1.1.1j.tar.gz \n mv openssl-1.1.1j ../openssl\n \n</code></pre>\n<h4 id=\"3编译并安装-2\"><a class=\"anchor\" href=\"#3编译并安装-2\">#</a> 3. 编译并安装</h4>\n<p>​\t进入解压文件夹</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">cd</span> /usr/local/openssl</pre></td></tr></table></figure><p>​\t 配置编译</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>./config</pre></td></tr></table></figure><p>​\t编译安装</p>\n<pre><code>make clean &amp;&amp; make install\n</code></pre>\n<p>​\t测试</p>\n<pre><code>openssl version -a\n</code></pre>\n<h2 id=\"kettle安装\"><a class=\"anchor\" href=\"#kettle安装\">#</a> Kettle 安装</h2>\n<p><a href=\"#Windows_kettle\">他是 java 写的，所以跨平台，去看 Windows 里面的安装方法</a></p>\n<h1 id=\"未完成-linux\"><a class=\"anchor\" href=\"#未完成-linux\">#</a> 未完成 ！————Linux</h1>\n<h1 id=\"path-windows\"><a class=\"anchor\" href=\"#path-windows\">#</a> PATH-------Windows</h1>\n<h2 id=\"mysql安装\"><a class=\"anchor\" href=\"#mysql安装\">#</a> MySQL 安装</h2>\n<h3 id=\"1mysql的版本\"><a class=\"anchor\" href=\"#1mysql的版本\">#</a> 【1】MySQL 的版本：</h3>\n<p>近期主要历史版本有 5.0/5.1/5.5/5.6/5.7，目前最新版本是 MySQL8。6.0 曾经是个内部试验版本，已取消了。</p>\n<p>MySQL8.0 的版本历史</p>\n<ol>\n<li>2016-09-12 第一个 DM (development milestone) 版本 8.0.0 发布</li>\n<li>2018-04-19 第一个 GA (General Availability) 版本开始，8.0.11 发布</li>\n<li>2018-07-27 8.0.12GA 发布</li>\n<li>2018-10-22 8.0.13GA 发布</li>\n<li>2019-01-21 8.0.14GA 发布</li>\n<li>2019-02-01 8.0.15GA 发布</li>\n<li>最新的版本是 8.0.18,2019 年 10 月 14 日正式发布</li>\n<li>.... 后续更新</li>\n</ol>\n<h3 id=\"2官方下载地址\"><a class=\"anchor\" href=\"#2官方下载地址\">#</a> 【2】官方下载地址：</h3>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9kZXYubXlzcWwuY29tL2Rvd25sb2Fkcy93aW5kb3dzL2luc3RhbGxlci84LjAuaHRtbA==\">https://dev.mysql.com/downloads/windows/installer/8.0.html</span></p>\n\n<h3 id=\"3安装过程\"><a class=\"anchor\" href=\"#3安装过程\">#</a> 【3】安装过程：</h3>\n<p><strong>1. 双击 MySQL 安装文件 mysql-installer-community-8.0.18.0.msi，出现安装类型选项。</strong></p>\n<ul>\n<li>\n<p>Developer Default：开发者默认</p>\n</li>\n<li>\n<p>Server only：只安装服务器端</p>\n</li>\n<li>\n<p>Client only：只安装客户端</p>\n</li>\n<li>\n<p>Full：安装全部选项</p>\n</li>\n<li>\n<p>Custom：自定义安装</p>\n</li>\n</ul>\n\n<p><strong>2. 选择，然后继续：</strong></p>\n\n<p><strong>3. 进入产品配置向导，配置多个安装细节，点击 Next 按钮即可。</strong></p>\n\n<p><strong>4. 高可靠性 High Availability，采用默认选项即可。</strong></p>\n<ul>\n<li>\n<p>Standalone MySQL Server/Classic MySQL Replication: 独立 MySQL 服务器 / 经典 MySQL 复制</p>\n</li>\n<li>\n<p>InnoDB Cluster:InnoDB 集群</p>\n</li>\n</ul>\n\n<p><strong>5. 类型和网络 Type and Networking，采用默认选项即可。记住 MySQL 的监听端口默认是 3306。</strong></p>\n\n<p><strong>6. 身份验证方法 Authentication Method，采用默认选项即可。</strong></p>\n<p><img data-src=\"tools-All%5C1646193956569.png\" alt=\"1646193956569\" /></p>\n<p><strong>7. 账户和角色 Accounts and Roles。MySQL 管理员账户名称是 root，在此处指定 root 用户的密码。还可以在此处通过 Add User 按钮添加其他新账户，此处省略该操作。</strong></p>\n\n<p><strong>8.Windows 服务：Windows Service。</strong></p>\n<ul>\n<li>\n<p>Configure MySQL Server as a Windows Service: 给 MySQL 服务器配置一个服务项。</p>\n</li>\n<li>\n<p>Windows Service Name: 服务名称，采用默认名称 MySQL80 即可。</p>\n</li>\n<li>\n<p>Start the MySQL at System Startup：系统启动时开启 MySQL 服务</p>\n</li>\n</ul>\n\n<p><strong>9.Apply Configuration：点击 Execute 按钮执行开始应用这些配置项。</strong></p>\n<ul>\n<li>\n<p>Writing configuration file: 写配置文件。</p>\n</li>\n<li>\n<p>Updating Windows Firewall rules：更新 Windows 防火墙规则</p>\n</li>\n<li>\n<p>Adjusting Windows services：调整 Windows 服务</p>\n</li>\n<li>\n<p>Initializing database：初始化数据库</p>\n</li>\n<li>\n<p>Starting the server： 启动服务器</p>\n</li>\n<li>\n<p>Applying security setting：应用安全设置</p>\n</li>\n<li>\n<p>Updating the Start menu link：更新开始菜单快捷方式链接</p>\n</li>\n</ul>\n\n<p><strong>PS：如果配置出错，查看右侧的 log，查看对应错误信息。</strong><br />\n<strong>执行完成后，如下图所示。单击 Finish 完成安装，进入产品配置环节。</strong></p>\n\n<p><strong>10. 产品配置 Product Configuration 到此结束：点击 Next 按钮。</strong></p>\n\n<p><strong>11. 安装完成 Installation Complete。点击 Finish 按钮完成安装。</strong></p>\n\n<h3 id=\"4mysql配置-登录\"><a class=\"anchor\" href=\"#4mysql配置-登录\">#</a> 【4】MySQL 配置、登录</h3>\n<p><strong>【1】登录：</strong><br />\n访问 MySQL 服务器对应的命令：mysql.exe , 位置：C:\\Program Files\\MySQL\\MySQL Server 8.0\\bin</p>\n\n<p>（mysql.exe 需要带参数执行，所以直接在图形界面下执行该命令会自动结束）</p>\n<p>打开控制命令台：win+r:</p>\n\n<p>执行 mysql.exe 命令的时候出现错误：</p>\n\n<p>需要配置环境变量 path:</p>\n\n<p><strong>注意：控制命令台必须重启才会生效：</strong></p>\n<p><strong>登录的命令：mysql  -hlocalhost -uroot –p</strong></p>\n<ul>\n<li>\n<p>mysql：bin 目录下的文件 mysql.exe。mysql 是 MySQL 的命令行工具，是一个客户端软件，可以对任何主机的 mysql 服务（即后台运行的 mysqld）发起连接。</p>\n</li>\n<li>\n<p>-h：host 主机名。后面跟要访问的数据库服务器的地址；<strong>如果是登录本机，可以省略</strong></p>\n</li>\n<li>\n<p>-u：user 用户名。后面跟登录数据的用户名，第一次安装后以 root 用户来登录，是 MySQL 的管理员用户</p>\n</li>\n<li>\n<p>-p:   password 密码。一般不直接输入，而是回车后以保密方式输入。</p>\n<p><img data-src=\"tools-All%5C1646194262329.png\" alt=\"1646194262329\" /></p>\n</li>\n</ul>\n<p><strong>【2】访问数据库</strong></p>\n<p>显示 MySQL 中的数据库列表：</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>show databases<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>默认有四个自带的数据库，每个数据库中可以有多个数据库表、视图等对象。</p>\n<p>切换当前数据库的命令：</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>use mysql<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><ul>\n<li>\n<p>MySQL 下可以有多个数据库，如果要访问哪个数据库，需要将其置为当前数据库。</p>\n</li>\n<li>\n<p>该命令的作用就是将数据库 mysql（默认提供的四个数据库之一的名字）置为当前数据库</p>\n</li>\n</ul>\n<p>显示当前数据库的所有数据库表：</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>show tables<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>MySQL 层次：不同项目对应不同的数据库组成 - 每个数据库中有很多表  - 每个表中有很多数据</p>\n<p><strong>【3】退出数据库</strong></p>\n<p>退出数据库可以使用 quit 或者 exit 命令完成，也可以用 \\q;  完成退出操作</p>\n\n<h3 id=\"5卸载\"><a class=\"anchor\" href=\"#5卸载\">#</a> 【5】卸载</h3>\n<p><strong>1) 停止 MySQL 服务：在命令行模式下执行 net stop mysql 或者在 Windows 服务窗口下停止服务</strong></p>\n\n<p><strong>2) 在控制面板中删除 MySQL 软件</strong></p>\n\n<p><strong>3) 删除软件文件夹：直接删除安装文件夹 C:\\Program Files\\MySQL，其实此时该文件夹已经被删除或者剩下一个空文件夹。</strong></p>\n<p><strong>4) 删除数据文件夹：直接删除文件夹 C:\\ProgramData\\MySQL。此步不要忘记，否则会影响 MySQL 的再次安装。</strong><br />\n<strong>（ProgramData 文件夹可能是隐藏的，显示出来即可）</strong><br />\n<strong>（MySQL 文件下的内容才是真正的 MySQL 中数据）</strong></p>\n<p><strong>5) 删除 path 环境变量中关于 MySQL 安装路径的配置</strong></p>\n<h2 id=\"tomcat安装-2\"><a class=\"anchor\" href=\"#tomcat安装-2\">#</a> Tomcat 安装</h2>\n<p>下载</p>\n<p>下载地址：<span class=\"exturl\" data-url=\"aHR0cDovL3RvbWNhdC5hcGFjaGUub3JnLw==\">http://tomcat.apache.org/</span></p>\n\n<h3 id=\"安装\"><a class=\"anchor\" href=\"#安装\">#</a> 安装</h3>\n<p>tomcat 由 apache 开源组织使用 java 开发的一款 web 容器，在使用之前需要安装 JDK 及配置 JAVA_HOME.Tomcat 是绿色软解，<strong>解压就可使用</strong>。如果之前已经安装了其他 tomcat 并且还配置了 CATALINA_HOME 不要忘记修改 CATALINA_HOME 指向我们现在使用的这个 tomcat</p>\n<h3 id=\"tomcat启动\"><a class=\"anchor\" href=\"#tomcat启动\">#</a> Tomcat 启动</h3>\n<p>运行 startup.bat 文件。</p>\n<p>一定要配置 JAVA_HOME   C:\\Program Files\\Java\\jdk1.8.0_161<br />\n 部分电脑需要配置 CATALINA_HOME   D:/<em><strong>/</strong></em>/apache-tomcat-9.0.41<br />\n 记住一个习惯：以后我们装任何一个软件路径都应该避免中文，空格和特殊符号，可以使用_</p>\n<h3 id=\"tomcat关闭\"><a class=\"anchor\" href=\"#tomcat关闭\">#</a> Tomcat 关闭</h3>\n<p>运行 shutdown.bat 文件或者直接关闭掉启动窗口。</p>\n<h3 id=\"访问tomcat\"><a class=\"anchor\" href=\"#访问tomcat\">#</a> 访问 Tomcat</h3>\n<p>访问 Tomcat 的 URL 格式：<span class=\"exturl\" data-url=\"aHR0cDovL2lw\">http://ip</span>:port</p>\n<p>访问本机 Tomcat 的 URL 格式：<span class=\"exturl\" data-url=\"aHR0cDovL2xvY2FsaG9zdDo4MDgw\">http://localhost:8080</span></p>\n<h2 id=\"git安装\"><a class=\"anchor\" href=\"#git安装\">#</a> Git 安装</h2>\n<p>【1】Git 官网：<br />\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXQtc2NtLmNvbS8=\">https://git-scm.com/</span></p>\n<p>【2】安装过程：</p>\n<p>一直下一步</p>\n\n\n\n\n\n\n<p>点击 Git Bash Here 打开 Git 终端：</p>\n\n<h2 id=\"openssl安装教程\"><a class=\"anchor\" href=\"#openssl安装教程\">#</a> OpenSSL 安装教程</h2>\n<p>openssl 官网下载地址：<span class=\"exturl\" data-url=\"aHR0cDovL3NscHJvd2ViLmNvbS9wcm9kdWN0cy9XaW4zMk9wZW5TU0wuaHRtbA==\">http://slproweb.com/products/Win32OpenSSL.html</span></p>\n<h3 id=\"安装环境\"><a class=\"anchor\" href=\"#安装环境\">#</a> 安装环境:</h3>\n<blockquote>\n<p>windows 10<br />\nWin64 OpenSSL v1.1.1i</p>\n</blockquote>\n<h3 id=\"一下载openssl安装版\"><a class=\"anchor\" href=\"#一下载openssl安装版\">#</a> 一。下载 openssl 安装版</h3>\n<p>​\t我这里是 win10 64 位，所以选的中间那个</p>\n<p><img data-src=\"https://tools-All-blog.csdnimg.cn/20201222101342278.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2NTUwOTY0,size_16,color_FFFFFF,t_70#pic_center\" alt=\"按照操作系统选择\" /></p>\n<h3 id=\"二安装过程\"><a class=\"anchor\" href=\"#二安装过程\">#</a> 二。安装过程</h3>\n<p>​\t也没啥特殊的 ，一直 next，只有两点注意：</p>\n<p>1、修改安装地址</p>\n<p>2、最后一步，不要勾选，会掏钱。</p>\n<p><img data-src=\"https://tools-All-blog.csdnimg.cn/20201222102601218.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2NTUwOTY0,size_16,color_FFFFFF,t_70\" alt=\"在这里插入图片描述\" /></p>\n<p><img data-src=\"https://tools-All-blog.csdnimg.cn/20201222102703276.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2NTUwOTY0,size_16,color_FFFFFF,t_70\" alt=\"在这里插入图片描述\" /></p>\n<p><img data-src=\"https://tools-All-blog.csdnimg.cn/20201222102703268.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2NTUwOTY0,size_16,color_FFFFFF,t_70\" alt=\"在这里插入图片描述\" /></p>\n<p><img data-src=\"https://tools-All-blog.csdnimg.cn/20201222102721958.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2NTUwOTY0,size_16,color_FFFFFF,t_70\" alt=\"在这里插入图片描述\" /></p>\n<img data-src=\"/tools/tools-All/1650347562395.png\" class=\"\" width=\"1650347562395\">\n<h3 id=\"三配置环境变量\"><a class=\"anchor\" href=\"#三配置环境变量\">#</a> 三。配置环境变量</h3>\n<img data-src=\"/tools/tools-All/1650351119292.png\" class=\"\" width=\"1650351119292\">\n <img data-src=\"/tools/tools-All/1650351138506.png\" class=\"\" width=\"1650351138506\">\n<h3 id=\"四测试\"><a class=\"anchor\" href=\"#四测试\">#</a> 四。测试</h3>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>openssl <span class=\"token parameter variable\">-version</span></pre></td></tr></table></figure><img data-src=\"/tools/tools-All/1650351011263.png\" class=\"\" width=\"1650351011263\">\n<h2 id=\"kafka安装\"><a class=\"anchor\" href=\"#kafka安装\">#</a> Kafka 安装</h2>\n<p>​\tkafka 的安装包其实没有分 window 还是 linux, 所以下载的安装包还是之前的安装包，直接解压出来即可；</p>\n<p><img data-src=\"https://pic3.zhimg.com/80/v2-5ea0647a0e4acab3a7c6de90df11fe3e_720w.jpg\" alt=\"img\" /></p>\n<p>启动 Zookeeper 服务端命令</p>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>./bin\\windows\\zookeeper-server-start.bat  ./config\\zookeeper.properties</pre></td></tr></table></figure><p>这边会报一个奇葩的错误，命令行太长，直接将压缩包解压到根目录或者桌面进行操作</p>\n<p><img data-src=\"https://pic4.zhimg.com/80/v2-0f8d03dbe85bdf6f44e05a20d87bc60b_720w.png\" alt=\"img\" /></p>\n<p>启动成功</p>\n<p><img data-src=\"https://cdn.jsdelivr.net/gh/onlymarryu/typora-ims-test@master/tools-All/v2-348c2d162934ac0844103a2cfcf2f16c_720w.jpg\" alt=\"img\" /></p>\n<p>启动 kafka 服务端命令</p>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>./bin\\windows\\kafka-server-start.bat  ./config\\server.properties</pre></td></tr></table></figure><p>启动成功</p>\n<p><img data-src=\"https://cdn.jsdelivr.net/gh/onlymarryu/typora-ims-test@master/tools-All/v2-4f9527f5ed1fb0a09b90cd598b5c09c3_720w.jpg\" alt=\"img\" /></p>\n<div name=\"Windows_kettle\">\n<h2 id=\"kettle安装-2\"><a class=\"anchor\" href=\"#kettle安装-2\">#</a> Kettle 安装</h2>\n<p>下载地址：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9saW5rLnpoaWh1LmNvbS8/dGFyZ2V0PWh0dHBzJTNBLy9zb3VyY2Vmb3JnZS5uZXQvcHJvamVjdHMvcGVudGFoby9maWxlcy9EYXRhJTIwSW50ZWdyYXRpb24v\">https://sourceforge.net/project</span></p>\n<p>下载完成解压到任意路径</p>\n<p><img data-src=\"https://cdn.jsdelivr.net/gh/onlymarryu/typora-ims-test@master/tools-All/v2-9b34b600471d87b624e1a355af5e1a77_720w.png\" alt=\"img\" /></p>\n<p>打开文件夹，找到 Spoon.bat，创建桌面快捷方式，打开</p>\n<p><img data-src=\"https://cdn.jsdelivr.net/gh/onlymarryu/typora-ims-test@master/tools-All/v2-304e8e08f977c9e1f6c3c1aef07d76ad_720w.png\" alt=\"img\" /></p>\n<p><img data-src=\"https://cdn.jsdelivr.net/gh/onlymarryu/typora-ims-test@master/tools-All/v2-5a6b50aa38075f30a80868319b57189a_720w.jpg\" alt=\"img\" /></p>\n<p>成功打开，安装完成</p>\n<p>最后还要配置下 oracle 的驱动</p>\n<p>找到 oracle 的安装目录搜索关键字：ojdbc</p>\n<p>把 ojdbc5.jar 文件复制到 ETL 的 lib 目录下</p>\n<p><img data-src=\"https://cdn.jsdelivr.net/gh/onlymarryu/typora-ims-test@master/tools-All/v2-dd6bd35ae080600c32d3cf75ccc40389_720w.jpg\" alt=\"img\" /></p>\n<p>这样就可以在 kettle 里连接到数据库了</p>\n<p><img data-src=\"https://cdn.jsdelivr.net/gh/onlymarryu/typora-ims-test@master/tools-All/v2-79043e230a5f8c040c429855c8766b9c_720w.jpg\" alt=\"img\" /></p>\n<h2 id=\"redis安装-2\"><a class=\"anchor\" href=\"#redis安装-2\">#</a> redis 安装</h2>\n<p>** 下载地址：**<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL3Rwb3JhZG93c2tpL3JlZGlzL3JlbGVhc2Vz\">https://github.com/tporadowski/redis/releases</span></p>\n<img data-src=\"/tools/tools-All/3B8D633F-14CE-42E3-B174-FCCD48B11FF3.jpg\" class=\"\" title=\"img\">\n<p>打开文件夹，内容如下：</p>\n<p><img data-src=\"https://www.runoob.com/wp-content/uploads/2014/11/C2CEBAA0-30B9-4340-8D23-78F6FEB8CBE2.png%22\" alt=\"img\" /></p>\n<p>打开一个 <strong>cmd</strong> 窗口 使用 cd 命令切换目录到 <strong>C:\\redis</strong> 运行：</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>redis-server.exe redis.windows.conf</pre></td></tr></table></figure><p>如果想方便的话，可以把 redis 的路径加到系统的环境变量里，这样就省得再输路径了，后面的那个 redis.windows.conf 可以省略，如果省略，会启用默认的。输入之后，会显示如下界面：</p>\n<img data-src=\"/tools/tools-All/redis-install1.png\" class=\"\" title=\"Redis 安装\">\n<p>这时候另启一个 cmd 窗口，原来的不要关闭，不然就无法访问服务端了。</p>\n<p>切换到 redis 目录下运行:</p>\n<pre><code>redis-cli.exe -h 127.0.0.1 -p 6379\n</code></pre>\n<h1 id=\"未完成-windows\"><a class=\"anchor\" href=\"#未完成-windows\">#</a> 未完成 ！———— Windows</h1>\n<h1 id=\"-2\"><a class=\"anchor\" href=\"#-2\">#</a> ———————————————</h1>\n<h1 id=\"问题-2\"><a class=\"anchor\" href=\"#问题-2\">#</a> 问题</h1>\n<h2 id=\"0-布置在服务器中的东西通过url-无法访问\"><a class=\"anchor\" href=\"#0-布置在服务器中的东西通过url-无法访问\">#</a> 0、布置在服务器中的东西，通过 URL 无法访问</h2>\n<blockquote>\n<p>​\t1、防火墙问题</p>\n<p>​\t2、端口 释放问题 ，<strong>・我们要手动去配置我们服务器的安全组・</strong></p>\n</blockquote>\n<div name=\"perblem-1\">\n<h2 id=\"1-解决centos-7-每次进入要重新加载环境变量\"><a class=\"anchor\" href=\"#1-解决centos-7-每次进入要重新加载环境变量\">#</a> 1、解决：CentOS 7 每次进入要重新加载环境变量</h2>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">1</span>.进入系统配置文件</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">vim</span> ~/.bashrc</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token number\">2</span>.末尾添加如下代码</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token builtin class-name\">source</span> /etc/profile</pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>保存即可</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>:wq</pre></td></tr></table></figure><h2 id=\"2-端口占用-查看端口\"><a class=\"anchor\" href=\"#2-端口占用-查看端口\">#</a> 2、端口占用、查看端口</h2>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>查看是否运行端口   </pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">netstat</span> <span class=\"token parameter variable\">-tln</span> <span class=\"token number\">8080</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>查看端口属于哪个程序？端口被哪个进程占用<span class=\"token punctuation\">(</span>得到PID<span class=\"token punctuation\">)</span>\t</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">lsof</span> <span class=\"token parameter variable\">-i</span> :8080  </pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>关闭PID对应的程序            </pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token function\">kill</span> <span class=\"token parameter variable\">-9</span> <span class=\"token punctuation\">(</span>PID<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><div name=\"preblem_2\">\n<h2 id=\"3-防火墙关闭-开启\"><a class=\"anchor\" href=\"#3-防火墙关闭-开启\">#</a> 3、防火墙关闭、开启</h2>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>关闭防火墙 ，重启失效<span class=\"token punctuation\">(</span>Linux系统一重启Linux中的防火墙又会被开起<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">service</span> firewalld stop</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>禁用防火墙，永久有效</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>systemctl disable firewalld</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>systemctl disable firewalld.service</pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>启动防火墙 <span class=\"token punctuation\">(</span>对禁用的防火墙进行启动<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>systemctl <span class=\"token builtin class-name\">enable</span> firewalld</pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>防火墙相关命令：</pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token number\">1</span>）查看防火墙状态：</pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token function\">service</span>  iptables status或者systemctl status firewalld或者firewall-cmd <span class=\"token parameter variable\">--state</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token number\">2</span>）暂时关闭防火墙：</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>systemctl stop firewalld或者service  iptables stop或者systemctl stop firewalld.service</pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token number\">3</span>）永久关闭防火墙：</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>systemctl disable firewalld或者chkconfig iptables off或者systemctl disable firewalld.service</pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token number\">4</span>）重启防火墙：</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>systemctl <span class=\"token builtin class-name\">enable</span> firewalld或者service iptables restart  或者systemctl restart firewalld.service</pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>永久关闭后重启：</pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token function\">chkconfig</span> iptables on</pre></td></tr></table></figure><h2 id=\"4-failure-repodatarepomdxml-from-epel-errno-256-no-more-mirrors-to-try\"><a class=\"anchor\" href=\"#4-failure-repodatarepomdxml-from-epel-errno-256-no-more-mirrors-to-try\">#</a> 4、failure: repodata/repomd.xml from epel: [Errno 256] No more mirrors to try.</h2>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL21pcnJvcnMuYWxpeXVuLmNvbS9lcGVsLzUveDg2XzY0L3JlcG9kYXRhL3JlcG9tZC54bWw6\">http://mirrors.aliyun.com/epel/5/x86_64/repodata/repomd.xml:</span> [Errno 14] HTTP Error 404 - Not Found 的解决办法：</p>\n<p>​\t一直说那个 XML 文件不存在，以为是 yum 源是去读取 xml 当中的数据然后去下载。确实自己去访问也是 404. 还以\t为是这阵子开会 yum 源都搞不能用了怎么。之前我用阿里用的挺好的。</p>\n<p>​\t最简单的办法就是删除 /etc/yum.repos.d/ 下所有的文件，重新来。</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">cd</span> /etc/yum.repos.d/</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">mkdir</span> repo_bak</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">mv</span> *.repo repo_bak/</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">#下载缓存文件 版本自己控制</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">wget</span> http://mirrors.aliyun.com/repo/Centos-7.repo</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>yum clean all</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>yum makecache</pre></td></tr></table></figure><div name=\"problem-5\"></div>\n<h2 id=\"5-xshell连接centos7能连上但是连接过程很慢\"><a class=\"anchor\" href=\"#5-xshell连接centos7能连上但是连接过程很慢\">#</a> 5、Xshell 连接 centos7 能连上但是连接过程很慢</h2>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>原因：因为在登录时，需要反向解析dns。</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>解决方法：修改linux配置文件，</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">vim</span> /etc/ssh/sshd_config</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>将 <span class=\"token comment\"># UseDNS yes 此处注释去掉</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>改为：UseDNS no</pre></td></tr></table></figure><p><a href=\"#Linux_minInstall_4\">跳转到 Linux 安装_4</a></p>\n<div name=\"problem-6\"></div>\n## 6、Xshell 连接Centos7，root拒绝登录，而其他用户可登陆？———— root用户直接登录\n<p><strong>PermitRootLogin</strong>  的值改成  yes  ，并保存</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">vim</span> /etc/ssh/sshd_config</pre></td></tr></table></figure><p><img data-src=\"https://tools-All-blog.csdnimg.cn/20210712112157753.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1lhbmdfeWFuZ3lhbmc=,size_16,color_FFFFFF,t_70\" alt=\"在这里插入图片描述\" /></p>\n<p>重启 sshd 服务</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">service</span> sshd restart</pre></td></tr></table></figure><p>如果上面命令提示文件不存在，可以用下面的命令</p>\n<pre><code>systemctl restart sshd.service\n</code></pre>\n<p>如果还不行，直接 重启服务器。。。</p>\n<pre><code>reboot\n</code></pre>\n<p>意外的是，发现 root 依然不能登录。最后研究 sshd_config 的每一行意义，发现坑在这里：</p>\n<p><strong>注：有则看，无则跳</strong></p>\n<p><img data-src=\"https://tools-All-blog.csdnimg.cn/2021071211252989.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1lhbmdfeWFuZ3lhbmc=,size_16,color_FFFFFF,t_70\" alt=\"在这里插入图片描述\" /></p>\n<p>文件的最后一行，有一行 ：AllowUsers xxx@192.168.1.<em>。这是写死的了，即：能远程登录的 用户名、IP 信息。难怪，其他用户一直无法登录。<br />\n所以，在后面追加：root@192.168.1.</em><br />\n 修改完的代码为：xxx@192.168.1.* root@192.168.1.*<br />\n 然后再执行重启服务操作，然后发现 root 可以登录了！搞定！！！</p>\n<blockquote>\n<p>注意： <code>xxx@192.168.1.* root@192.168.1.*</code>  之间要有空格。</p>\n<p>或者直接将此行 代码直接注释掉，也可以。</p>\n</blockquote>\n<p><a href=\"#Linux_minInstall_6\">跳转到 Linux 安装_最小化安装_6</a></p>\n<div name=\"problem-7\"></div>\n## 7、yum直接安装docker-ce报错找不到安装包\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#更换成阿里云镜像仓库</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>yum-config-manager --add-repo   http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</pre></td></tr></table></figure><p><a href=\"#docker_install_3\">回到 Docker 安装步骤 3</a></p>\n<h2 id=\"8-docker-查看日志\"><a class=\"anchor\" href=\"#8-docker-查看日志\">#</a> 8、docker 查看日志</h2>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> logs <span class=\"token punctuation\">[</span>OPTIONS<span class=\"token punctuation\">]</span> CONTAINER</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  Options:</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token parameter variable\">--details</span>        显示更多的信息</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    -f, <span class=\"token parameter variable\">--follow</span>         跟踪实时日志</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token parameter variable\">--since</span> string   显示自某个timestamp之后的日志，或相对时间，如42m（即42分钟）</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token parameter variable\">--tail</span> string    从日志末尾显示多少行日志， 默认是all</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        </pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    -t, <span class=\"token parameter variable\">--timestamps</span>     显示时间戳</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token parameter variable\">--until</span> string   显示自某个timestamp之前的日志，或相对时间，如42m（即42分钟）</pre></td></tr></table></figure><p>​\t查看指定时间后的日志，只显示最后 100 行：</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ <span class=\"token function\">docker</span> logs <span class=\"token parameter variable\">-f</span> <span class=\"token parameter variable\">-t</span> <span class=\"token parameter variable\">--since</span><span class=\"token operator\">=</span><span class=\"token string\">\"2018-02-08\"</span> <span class=\"token parameter variable\">--tail</span><span class=\"token operator\">=</span><span class=\"token number\">100</span> CONTAINER_ID</pre></td></tr></table></figure><p>​\t查看最近 30 分钟的日志:</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ <span class=\"token function\">docker</span> logs <span class=\"token parameter variable\">--since</span> 30m CONTAINER_ID</pre></td></tr></table></figure><p>​\t查看某时间之后的日志：</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ <span class=\"token function\">docker</span> logs <span class=\"token parameter variable\">-t</span> <span class=\"token parameter variable\">--since</span><span class=\"token operator\">=</span><span class=\"token string\">\"2018-02-08T13:23:37\"</span> CONTAINER_ID</pre></td></tr></table></figure><p>​\t查看某时间段日志：</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ <span class=\"token function\">docker</span> logs <span class=\"token parameter variable\">-t</span> <span class=\"token parameter variable\">--since</span><span class=\"token operator\">=</span><span class=\"token string\">\"2018-02-08T13:23:37\"</span> <span class=\"token parameter variable\">--until</span> <span class=\"token string\">\"2018-02-09T12:23:37\"</span> CONTAINER_ID</pre></td></tr></table></figure><h2 id=\"9-如何解决error-failed-to-push-some-refs-to-httpsgiteecom\"><a class=\"anchor\" href=\"#9-如何解决error-failed-to-push-some-refs-to-httpsgiteecom\">#</a> 9 、如何解决 error: failed to push some refs to ‘<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRlZS5jb20v\">https://gitee.com/</span></h2>\n<p>​\t出现错误的主要原因是 gitee (github) 中的 README.md 文件不在本地代码目录中</p>\n<p>​\t此时我们要执行 git pull --rebase origin master 命令<strong><span class=\"exturl\" data-url=\"aHR0cDovL1JFQURNRS5tZA==\"> README.md</span></strong> 拉到本地</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">git</span> pull <span class=\"token parameter variable\">--rebase</span> origin master</pre></td></tr></table></figure><p>然后执行 git push origin master</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">git</span> push origin master</pre></td></tr></table></figure><p>就 ok 啦！</p>\n<h2 id=\"10-idea-官网下载插件过慢\"><a class=\"anchor\" href=\"#10-idea-官网下载插件过慢\">#</a> 10 、idea 官网下载插件过慢</h2>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1JlYWxfQ1NETl9Vc2VyL2FydGljbGUvZGV0YWlscy8xMTM5NDQ0OTY=\">(29 条消息) Intellij IDEA 下载插件太慢，怎么办？_Real_csdn_User 的博客 - CSDN 博客_idea 下载插件很慢</span></p>\n<h3 id=\"1查询自己的网络服务提供商\"><a class=\"anchor\" href=\"#1查询自己的网络服务提供商\">#</a> （1）查询自己的网络服务提供商</h3>\n<p>访问<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuaXAxMzguY29tLw==\"> iP138 查询网</span>，查看自己的网络服务提供商并记下它。比如我访问该网站截图如下：<br />\n<img data-src=\"https://tools-All-blog.csdnimg.cn/20210222191130433.png#pic_center\" alt=\"我的网络服务提供商是移动（为保护隐私，部分内容打码）\" /><br />\n如果你已经知道自己的网络服务提供商就不需要这一步。</p>\n<h3 id=\"2查找访问插件网站最快的ip\"><a class=\"anchor\" href=\"#2查找访问插件网站最快的ip\">#</a> （2）查找访问插件网站最快的 IP</h3>\n<p>Intellij IDEA 的插件主页地址是<span class=\"exturl\" data-url=\"aHR0cHM6Ly9wbHVnaW5zLmpldGJyYWlucy5jb20v\"> https://plugins.jetbrains.com</span>。打开<span class=\"exturl\" data-url=\"aHR0cDovL3Rvb2wuY2hpbmF6LmNvbS9zcGVlZHRlc3Qv\">网站测速 - 站长工具</span>，将插件的主页地址填入输入框内，点击查看分析按钮。一段时间后，就可以看到全中国各个地区访问插件主页的速度。点击表头 “总耗时” 右侧的小按钮，令全国各地访问插件主页的总耗时按增长顺序排列，这样耗时最短、速度最快的行就在最上方。从表格中找到与自己网络服务提供商相同的行，记下对应的 IP 地址。下面是我测量的访问插件主页的速度的结果：<br />\n<img data-src=\"https://tools-All-blog.csdnimg.cn/20210222193138206.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1JlYWxfQ1NETl9Vc2Vy,size_16,color_FFFFFF,t_70#pic_center\" alt=\"我的网络服务提供商是移动，我记下的IP是54.192.23.52\" /></p>\n<h3 id=\"3在hosts文件中为pluginsjetbrainscom添加相关条目\"><a class=\"anchor\" href=\"#3在hosts文件中为pluginsjetbrainscom添加相关条目\">#</a> （3）在 hosts 文件中为 plugins.jetbrains.com 添加相关条目</h3>\n<p>用文本编辑器打开 C:\\Windows\\System32\\drivers\\etc\\hosts 文件。在文件最下方添加一行文字：<br />\n[你记下的 IP 地址] <span class=\"exturl\" data-url=\"aHR0cDovL3BsdWdpbnMuamV0YnJhaW5zLmNvbQ==\">plugins.jetbrains.com</span><br />\n [你记下的 IP 地址] 用你记下的 IP 地址代替，记住不要带上方括号，而且 IP 地址和 plugins.jetbrains.com 之间有空格。例如我在文件中添加的文字是：<br />\n13.225.160.7 <span class=\"exturl\" data-url=\"aHR0cDovL3BsdWdpbnMuamV0YnJhaW5zLmNvbQ==\">plugins.jetbrains.com</span><br />\n 注意：编辑 hosts 文件需要管理员权限。</p>\n<h3 id=\"三-题外话\"><a class=\"anchor\" href=\"#三-题外话\">#</a> 三、题外话</h3>\n<p>这种方法并不只限于加快下载 IDEA 插件的速度，只要你知道网络资源的网址，而且该网络资源使用了下载加速服务器，都可以用这种方法。</p>\n<h2 id=\"-3\"><a class=\"anchor\" href=\"#-3\">#</a> </h2>\n<h1 id=\"未完成问题\"><a class=\"anchor\" href=\"#未完成问题\">#</a> 未完成 —— 问题</h1>\n<h1 id=\"未完成\"><a class=\"anchor\" href=\"#未完成\">#</a> 未完成</h1>\n\n<div id=\"gitalk-container\"></div>\n<script src=\"https://cdn.bootcss.com/blueimp-md5/2.12.0/js/md5.min.js\"></script><link rel=\"stylesheet\" href=\"https://unpkg.com/gitalk/dist/gitalk.css\"><script src=\"https://unpkg.com/gitalk/dist/gitalk.min.js\"></script>\n\n\t\t<script>\n\t\tvar gitalkConfig = {\"clientID\":\"6db178ba46c8af8f6a6f\",\"clientSecret\":\"90f730e5956024596558df00975cd8eae28cae3d\",\"repo\":\"bk-comment01\",\"owner\":\"onlymarryu\",\"admin\":[\"onlymarryu\"],\"distractionFreeMode\":false,\"language\":\"zh-CN\",\"proxy\":\"https://gitalk-comments.netlify.app/github_access_token\",\"perPage\":15};\n\t    gitalkConfig.id = md5(location.pathname);\n\t\tvar gitalk = new Gitalk(gitalkConfig);\n\t    gitalk.render(\"gitalk-container\");\n\t    </script>",
            "tags": [
                "工具软件安装"
            ]
        },
        {
            "id": "http://yoursite.com/tools/Zookeeper-tool/",
            "url": "http://yoursite.com/tools/Zookeeper-tool/",
            "title": "Zookeeper",
            "date_published": "2022-10-15T04:52:38.222Z",
            "content_html": "<h3 id=\"zookeeper-linux安装\"><a class=\"anchor\" href=\"#zookeeper-linux安装\">#</a> Zookeeper-linux 安装</h3>\n<h4 id=\"1\"><a class=\"anchor\" href=\"#1\">#</a> ——1</h4>\n<h5 id=\"1-zookeeper简介\"><a class=\"anchor\" href=\"#1-zookeeper简介\">#</a> 1     Zookeeper 简介</h5>\n<p>​\tzookeeper 分布式管理软件。常用它做注册中心（依赖 zookeeper 的发布 / 订阅功能）、配置文件中心、分布式锁配置、集群管理等。</p>\n<p>​\tzookeeper 一共就有两个版本。主要使用的是 java 语言写的。</p>\n<h5 id=\"2-安装\"><a class=\"anchor\" href=\"#2-安装\">#</a> 2     安装</h5>\n<h6 id=\"21-上传压缩文件\"><a class=\"anchor\" href=\"#21-上传压缩文件\">#</a> 2.1   上传压缩文件</h6>\n<p>​\t上传到 /usr/local/tmp 中</p>\n<h5 id=\"22-解压\"><a class=\"anchor\" href=\"#22-解压\">#</a> 2.2   解压</h5>\n<pre><code> tar zxf apache-zookeeper-3.5.5-bin.tar.gz\n cp -r apache-zookeeper-3.5.5-bin ../zookeeper\n</code></pre>\n<h5 id=\"23-新建data目录\"><a class=\"anchor\" href=\"#23-新建data目录\">#</a> 2.3   新建 data 目录</h5>\n<p>进入到 zookeeper 中</p>\n<pre><code> cd /usr/local/zookeeper\n mkdir data\n</code></pre>\n<h5 id=\"24-修改配置文件\"><a class=\"anchor\" href=\"#24-修改配置文件\">#</a> 2.4   修改配置文件</h5>\n<p>进入 conf 中</p>\n<pre><code> cd conf\n cp zoo_sample.cfg zoo.cfg\n vim zoo.cfg\n</code></pre>\n<p>修改 dataDir 为 data 文件夹路径</p>\n<pre><code>dataDir=/usr/local/zookeeper/data\n</code></pre>\n<h5 id=\"25-启动zookeeper\"><a class=\"anchor\" href=\"#25-启动zookeeper\">#</a> 2.5   启动 zookeeper</h5>\n<p>进入 bin 文件夹</p>\n<pre><code> cd /usr/local/zookeeper/bin\n ./zkServer.sh start\n</code></pre>\n<p>通过 status 查看启动状态。稍微有个等待时间</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>./zkServer.sh status</pre></td></tr></table></figure><h4 id=\"2\"><a class=\"anchor\" href=\"#2\">#</a> ——2</h4>\n<p><strong>资料：</strong></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20va2luZ2tvby9wLzg3MzI0NDguaHRtbA==\">https://www.cnblogs.com/kingkoo/p/8732448.html</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL2F2ODA4NzQ2NjY/ZnJvbT1zZWFyY2gmYW1wO3NlaWQ9MTYyOTE0NTAyNTIxMTk5OTEwNCZhbXA7c3BtX2lkX2Zyb209MzMzLjMzNy4wLjA=\">https://www.bilibili.com/video/av80874666?from=search&amp;seid=1629145025211999104&amp;spm_id_from=333.337.0.0</span></p>\n<h5 id=\"1-zookeeper简介-2\"><a class=\"anchor\" href=\"#1-zookeeper简介-2\">#</a> 1     Zookeeper 简介</h5>\n<p>​\tzookeeper 分布式管理软件。常用它做注册中心（依赖 zookeeper 的发布 / 订阅功能）、配置文件中心、分布式锁配置、集群管理等。</p>\n<p>​\tzookeeper 一共就有两个版本。主要使用的是 java 语言写的。</p>\n<h5 id=\"2-安装-2\"><a class=\"anchor\" href=\"#2-安装-2\">#</a> 2     安装</h5>\n<h6 id=\"21-拉取镜像\"><a class=\"anchor\" href=\"#21-拉取镜像\">#</a> 2.1   拉取镜像</h6>\n<ul>\n<li>\n<p>自定义 zookeeper 目录</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">mkdir</span> /root/zookeeper</pre></td></tr></table></figure></li>\n</ul>\n<p>#mkdir /root/zookeeper/data #原因参照上面 - 在 docker 中 data 其实也不用在宿主机行自己生成 (目前如此)</p>\n<p>仓库官网查看版本或者用命令直接查</p>\n<pre><code>docker search zookeeper\n</code></pre>\n<p>拉取特定版本（3.5）</p>\n<pre><code>docker pull zookeeper:3.5\n\n```\n</code></pre>\n<h6 id=\"22-创建并启动容器\"><a class=\"anchor\" href=\"#22-创建并启动容器\">#</a> 2.2 创建并启动容器</h6>\n<p>​\t<strong>注：就目前而且 好像直接在 docker 中使用 zookeeper 不需要过多的配置，直接用命令创建吧，下面的解释先不看，具体原因后面补充</strong></p>\n<p>命令：</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> run <span class=\"token parameter variable\">-d</span> <span class=\"token parameter variable\">--name</span> zookeeper <span class=\"token parameter variable\">-v</span> /root/zookeeper/data:/data <span class=\"token parameter variable\">-p</span> <span class=\"token number\">2181</span>:2181 <span class=\"token parameter variable\">--restart</span> always zookeeper:3.5</pre></td></tr></table></figure><ul>\n<li><code>--restart always</code> ：始终重启</li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vYWdlb3ZiL3AvMTUzMjg3OTYuaHRtbA==\">https://www.cnblogs.com/ageovb/p/15328796.html</span></li>\n</ul>\n<p><strong>解释</strong></p>\n<ul>\n<li>\n<p>1、这里为啥只挂载了 data 目录 --》因为当我们 没有直接的安装压缩包时，我们的就没有配置文件，所以我们直接生成，容器中就回自动生成 conf 文件，其中就有我们需要的 一系列配置文件，我们第一次创建的时候就可以如此，我们在进<strong>行配置文件的修改完成</strong>后，要将所有配置文件放到我们  bash 目录中的 conf 文件中去。</p>\n</li>\n<li>\n<p>2、第一次进入容器</p>\n<ul>\n<li>\n<p>在 bash 目录下进入 bin 目录然后输入开启客户端命令</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>./zkCli.sh</pre></td></tr></table></figure></li>\n</ul>\n</li>\n<li>\n<p>3、第二次进入容器</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> <span class=\"token builtin class-name\">exec</span> <span class=\"token parameter variable\">-it</span> zookeeper /bin/bash  <span class=\"token parameter variable\">-p</span>    端口号</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>或</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">docker</span> <span class=\"token builtin class-name\">exec</span> <span class=\"token parameter variable\">-it</span> zookeeper zkCli.sh</pre></td></tr></table></figure></li>\n</ul>\n<p><em><em>只看到这就可</em>，容器创建成功就可以直接用了，还没有出现问题。有待补充</em> *</p>\n<h6 id=\"23-修改配置文件\"><a class=\"anchor\" href=\"#23-修改配置文件\">#</a> 2.3   修改配置文件</h6>\n<ul>\n<li>配置文件来源\n<ul>\n<li>1、可以去我们的资料中直接解压出<strong> conf</strong> 目录粘贴到我们的 zookeeper 目录中去</li>\n<li>2、可以直接进行第 3 步，完事之后直接会在容器中生成。找到 conf 文件，修改其中的 zoo.cfg 文件，</li>\n</ul>\n</li>\n</ul>\n<p>进入容器后，找到 conf 中的 **zoo.cfg 文件，接下来就是修改 <strong>dataDir</strong> 路径为容器中的 data 文件目录。</p>\n<p>前提是要下载 vim ，因为容器中没有，命令是：</p>\n<pre><code>apt-get update\n\napt-get install -y vim\n\ncd conf\n### 没有zoo.cfg 就先拷贝 zoo_sample.cfg 两个其实是一个文件，内容相同\n###cp zoo_sample.cfg zoo.cfg\nvim zoo.cfg\n</code></pre>\n<p>修改 dataDir 为 data 文件夹路径</p>\n<pre><code>dataDir=/usr/local/zookeeper/data\n</code></pre>\n<h3 id=\"zookeeper集群搭建\"><a class=\"anchor\" href=\"#zookeeper集群搭建\">#</a> Zookeeper 集群搭建</h3>\n<h4 id=\"1-2\"><a class=\"anchor\" href=\"#1-2\">#</a> ——1</h4>\n<p>1. 上传压缩包到 /usr/local/tmp 下 并解压。</p>\n<p>2. 在 /usr/local 下新建文件夹 zookeeper</p>\n<pre><code>### mkdir /usr/local/zookeeper\n</code></pre>\n<p>3. 把解压的所有文件复制到 zookeeper 下， 并命名为 zk1</p>\n<pre><code>### cp -r /usr/local/temp/zookeeper-3.4.8 /usr/local/zookeeper/zk1\n</code></pre>\n<p>4. 在 zk1 下新建文件夹 data</p>\n<p>5. 在 data 下新建文件 myid, 里面写上 1</p>\n<pre><code>### vim myid\n</code></pre>\n<p>6. 进入到 zk1/conf 下 把 zoo_sample.cfg 复制一份叫做 zoo.cfg</p>\n<p>7. 编辑 zoo.cfg 内容，设置 dataDIR 为 data 文件夹， 并在文件最下面添加下面内容</p>\n<pre><code>server.1=192.168.93.10:2688:3888\nserver.2=192.168.93.10:2689:3889\nserver.3=192.168.93.10:2690:3890\n</code></pre>\n<p>7.1 server.1 中的 1 是 myid 的内容</p>\n<p>7.2 2688 2689 2690 是 zookeeper 内部端口</p>\n<p>7.3 3888 3889 3890 是 leader 端口</p>\n<p>8. 把 zk1 复制两份，分部叫做 zk2  zk3  并修改 myid 的值为 2，3 修改 zoo.cfg 中 dataDIR 和 clientPort</p>\n<p>9. 启动三个 zookeeper</p>\n<pre><code>### ./zkServer.sh start\n</code></pre>\n<p>10. 查看状态</p>\n<pre><code>### ./zkServer.sh status\n</code></pre>\n<h4 id=\"2-2\"><a class=\"anchor\" href=\"#2-2\">#</a> ——2</h4>\n<p><strong>1、准备</strong> docker-compose.yml<strong> 文件</strong></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>version: <span class=\"token string\">'2'</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>services:</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  zoo1:</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    image: zookeeper:3.5</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    restart: always</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    container_name: zoo1</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    ports:</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      - <span class=\"token string\">\"2182:2181\"</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    environment:</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      ZOO_MY_ID: <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      ZOO_SERVERS: <span class=\"token assign-left variable\">server.1</span><span class=\"token operator\">=</span><span class=\"token number\">0.0</span>.0.0:2688:3888 <span class=\"token assign-left variable\">server.2</span><span class=\"token operator\">=</span>zoo2:2689:3888 <span class=\"token assign-left variable\">server.3</span><span class=\"token operator\">=</span>zoo3:2690:3888</pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>  zoo2:</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    image: zookeeper:3.5</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    restart: always</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    container_name: zoo2</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    ports:</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>      - <span class=\"token string\">\"2183:2181\"</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    environment:</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>      ZOO_MY_ID: <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>      ZOO_SERVERS: <span class=\"token assign-left variable\">server.1</span><span class=\"token operator\">=</span>zoo1:2688:3888 <span class=\"token assign-left variable\">server.2</span><span class=\"token operator\">=</span><span class=\"token number\">0.0</span>.0.0:2689:3888 <span class=\"token assign-left variable\">server.3</span><span class=\"token operator\">=</span>zoo3:2690:3888</pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>  zoo3:</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    image: zookeeper:3.5</pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    restart: always</pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    container_name: zoo3</pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    ports:</pre></td></tr><tr><td data-num=\"28\"></td><td><pre>      - <span class=\"token string\">\"2184:2181\"</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    environment:</pre></td></tr><tr><td data-num=\"30\"></td><td><pre>      ZOO_MY_ID: <span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>      ZOO_SERVERS: <span class=\"token assign-left variable\">server.1</span><span class=\"token operator\">=</span>zoo1:2688:3888 <span class=\"token assign-left variable\">server.2</span><span class=\"token operator\">=</span>zoo2:2689:3888 <span class=\"token assign-left variable\">server.3</span><span class=\"token operator\">=</span><span class=\"token number\">0.0</span>.0.0:2690:3888</pre></td></tr></table></figure><p><strong>2、创建镜像</strong></p>\n<ul>\n<li>要在创建的 docker-compose.yml 文件中使用命令</li>\n</ul>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker-compose</span> up <span class=\"token parameter variable\">-d</span></pre></td></tr></table></figure><p><strong>3、进入容器</strong></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> <span class=\"token builtin class-name\">exec</span> <span class=\"token parameter variable\">-it</span> zoo1 /bin/bash</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">### 查看 zoo1 的状态</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token builtin class-name\">cd</span> bin</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>./zkServer.sh status</pre></td></tr></table></figure><ul>\n<li>如果出现，以下情况：</li>\n</ul>\n<pre><code>ZooKeeper JMX enabled by default\nUsing config: /conf/zoo.cfg\nClient port not found in static config file. Looking in dynamic config file.\ngrep: : No such file or directory\nClient port not found in the server configs\nClient port not found. Looking for secureClientPort in the static config.\nUnable to find either secure or unsecure client port in any configs. Terminating.\n</code></pre>\n<p>​\t通过阅读我们知道他在 conf 中的 zoo.cfg 文件中缺少 **clientPort ** 我们只需要自行添加即可</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">### 修改之前我们先装一下 vim</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">apt-get</span> update</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> <span class=\"token parameter variable\">-y</span> <span class=\"token function\">vim</span> </pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">### 修改 zoo.fcg 文件</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">vim</span> /conf/zoo.fcg</pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token assign-left variable\">clientPort</span><span class=\"token operator\">=</span><span class=\"token number\">2181</span></pre></td></tr></table></figure><ul>\n<li>\n<p>完事之后<strong>重启</strong> zoo1</p>\n  <img data-src=\"/tools/Zookeeper-tool/1645780920291.png\" class=\"\" width=\"1645780920291\">\n<p>成功！！</p>\n</li>\n</ul>\n<h6 id=\"4-查看所有zookeeper的状态\"><a class=\"anchor\" href=\"#4-查看所有zookeeper的状态\">#</a> 4、查看所有 zookeeper 的状态</h6>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> <span class=\"token builtin class-name\">exec</span> <span class=\"token parameter variable\">-it</span> zoo3 <span class=\"token function\">bash</span> ./bin/zkServer.sh status</pre></td></tr></table></figure><h6 id=\"5-进去客户端\"><a class=\"anchor\" href=\"#5-进去客户端\">#</a> 5、进去客户端</h6>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> <span class=\"token builtin class-name\">exec</span> <span class=\"token parameter variable\">-it</span> zoo3 zkCli.sh</pre></td></tr></table></figure>\n<div id=\"gitalk-container\"></div>\n<script src=\"https://cdn.bootcss.com/blueimp-md5/2.12.0/js/md5.min.js\"></script><link rel=\"stylesheet\" href=\"https://unpkg.com/gitalk/dist/gitalk.css\"><script src=\"https://unpkg.com/gitalk/dist/gitalk.min.js\"></script>\n\n\t\t<script>\n\t\tvar gitalkConfig = {\"clientID\":\"6db178ba46c8af8f6a6f\",\"clientSecret\":\"90f730e5956024596558df00975cd8eae28cae3d\",\"repo\":\"bk-comment01\",\"owner\":\"onlymarryu\",\"admin\":[\"onlymarryu\"],\"distractionFreeMode\":false,\"language\":\"zh-CN\",\"proxy\":\"https://gitalk-comments.netlify.app/github_access_token\",\"perPage\":15};\n\t    gitalkConfig.id = md5(location.pathname);\n\t\tvar gitalk = new Gitalk(gitalkConfig);\n\t    gitalk.render(\"gitalk-container\");\n\t    </script>",
            "tags": [
                "工具软件安装"
            ]
        },
        {
            "id": "http://yoursite.com/tools/XShell-tool/",
            "url": "http://yoursite.com/tools/XShell-tool/",
            "title": "XShell",
            "date_published": "2022-10-15T04:52:38.220Z",
            "content_html": "<h2 id=\"安装\"><a class=\"anchor\" href=\"#安装\">#</a> 安装</h2>\n<h2 id=\"配色\"><a class=\"anchor\" href=\"#配色\">#</a> 配色</h2>\n<blockquote>\n<p>所有资源都在网盘和仓库里面</p>\n</blockquote>\n<h4 id=\"zk1\"><a class=\"anchor\" href=\"#zk1\">#</a> zk1</h4>\n<img data-src=\"/tools/XShell-tool/image-20220801173236598.png\" class=\"\">\n<h4 id=\"solarized-dark\"><a class=\"anchor\" href=\"#solarized-dark\">#</a> Solarized Dark</h4>\n<img data-src=\"/tools/XShell-tool/image-20220801173040826.png\" class=\"\">\n<h4 id=\"solarizeddarkmodify\"><a class=\"anchor\" href=\"#solarizeddarkmodify\">#</a> SolarizedDarkModify</h4>\n<img data-src=\"/tools/XShell-tool/image-20220801173129171.png\" class=\"\">\n<h4 id=\"isayme\"><a class=\"anchor\" href=\"#isayme\">#</a> isayme</h4>\n<img data-src=\"/tools/XShell-tool/image-20220801172922893.png\" class=\"\">\n<h4 id=\"ubuntu\"><a class=\"anchor\" href=\"#ubuntu\">#</a> ubuntu</h4>\n<img data-src=\"/tools/XShell-tool/image-20220801173207482.png\" class=\"\">\n\n<div id=\"gitalk-container\"></div>\n<script src=\"https://cdn.bootcss.com/blueimp-md5/2.12.0/js/md5.min.js\"></script><link rel=\"stylesheet\" href=\"https://unpkg.com/gitalk/dist/gitalk.css\"><script src=\"https://unpkg.com/gitalk/dist/gitalk.min.js\"></script>\n\n\t\t<script>\n\t\tvar gitalkConfig = {\"clientID\":\"6db178ba46c8af8f6a6f\",\"clientSecret\":\"90f730e5956024596558df00975cd8eae28cae3d\",\"repo\":\"bk-comment01\",\"owner\":\"onlymarryu\",\"admin\":[\"onlymarryu\"],\"distractionFreeMode\":false,\"language\":\"zh-CN\",\"proxy\":\"https://gitalk-comments.netlify.app/github_access_token\",\"perPage\":15};\n\t    gitalkConfig.id = md5(location.pathname);\n\t\tvar gitalk = new Gitalk(gitalkConfig);\n\t    gitalk.render(\"gitalk-container\");\n\t    </script>",
            "tags": [
                "工具软件安装"
            ]
        },
        {
            "id": "http://yoursite.com/tools/Tomcat-tool/",
            "url": "http://yoursite.com/tools/Tomcat-tool/",
            "title": "Tomcat",
            "date_published": "2022-10-15T04:52:38.217Z",
            "content_html": "<h3 id=\"tomcat安装\"><a class=\"anchor\" href=\"#tomcat安装\">#</a> Tomcat 安装</h3>\n<p>下载</p>\n<p>下载地址：<span class=\"exturl\" data-url=\"aHR0cDovL3RvbWNhdC5hcGFjaGUub3JnLw==\">http://tomcat.apache.org/</span></p>\n<img data-src=\"/tools/Tomcat-tool/1646193444708.png\" class=\"\">\n<h4 id=\"安装\"><a class=\"anchor\" href=\"#安装\">#</a> 安装</h4>\n<p>tomcat 由 apache 开源组织使用 java 开发的一款 web 容器，在使用之前需要安装 JDK 及配置 JAVA_HOME.Tomcat 是绿色软解，<strong>解压就可使用</strong>。如果之前已经安装了其他 tomcat 并且还配置了 CATALINA_HOME 不要忘记修改 CATALINA_HOME 指向我们现在使用的这个 tomcat</p>\n<h4 id=\"tomcat启动\"><a class=\"anchor\" href=\"#tomcat启动\">#</a> Tomcat 启动</h4>\n<p>运行 startup.bat 文件。</p>\n<p>一定要配置 JAVA_HOME   C:\\Program Files\\Java\\jdk1.8.0_161<br />\n 部分电脑需要配置 CATALINA_HOME   D:/<em><strong>/</strong></em>/apache-tomcat-9.0.41<br />\n 记住一个习惯：以后我们装任何一个软件路径都应该避免中文，空格和特殊符号，可以使用_</p>\n<h4 id=\"tomcat关闭\"><a class=\"anchor\" href=\"#tomcat关闭\">#</a> Tomcat 关闭</h4>\n<p>运行 shutdown.bat 文件或者直接关闭掉启动窗口。</p>\n<h4 id=\"访问tomcat\"><a class=\"anchor\" href=\"#访问tomcat\">#</a> 访问 Tomcat</h4>\n<p>访问 Tomcat 的 URL 格式：<span class=\"exturl\" data-url=\"aHR0cDovL2lw\">http://ip</span>:port</p>\n<p>访问本机 Tomcat 的 URL 格式：<span class=\"exturl\" data-url=\"aHR0cDovL2xvY2FsaG9zdDo4MDgw\">http://localhost:8080</span></p>\n<h3 id=\"tomcat安装-2\"><a class=\"anchor\" href=\"#tomcat安装-2\">#</a> Tomcat 安装</h3>\n<h4 id=\"1\"><a class=\"anchor\" href=\"#1\">#</a> ——1</h4>\n<h5 id=\"1-下载linux对应版本的tomcat\"><a class=\"anchor\" href=\"#1-下载linux对应版本的tomcat\">#</a> 1、下载 Linux 对应版本的 Tomcat</h5>\n<p>​\t  下载压缩文件     apache-tomcat-7.0.68.tar.gz</p>\n<h5 id=\"2-解压压缩文件\"><a class=\"anchor\" href=\"#2-解压压缩文件\">#</a> 2、解压压缩文件</h5>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#tar -xvf   apache-tomcat-7.0.68.tar.gz -C /usr/local/  #解压到的路径</span></pre></td></tr></table></figure><h5 id=\"3-配置环境变量\"><a class=\"anchor\" href=\"#3-配置环境变量\">#</a> 3、配置环境变量</h5>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">vim</span>  /etc/profile</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">### 自己定义为位置</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">CATALINA_BASE</span><span class=\"token operator\">=</span>/usr/local/apache-tomcat-7.0.68</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\"><span class=\"token environment constant\">PATH</span></span><span class=\"token operator\">=</span><span class=\"token variable\">$CATALINA_BASE</span>/bin:<span class=\"token environment constant\">$PATH</span></pre></td></tr></table></figure><h5 id=\"4-使用环境变量生效\"><a class=\"anchor\" href=\"#4-使用环境变量生效\">#</a> 4、使用环境变量生效</h5>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">source</span> /etc/profile</pre></td></tr></table></figure><h5 id=\"5-启动tomcat服务\"><a class=\"anchor\" href=\"#5-启动tomcat服务\">#</a> 5、启动 Tomcat 服务</h5>\n<ul>\n<li>注：要是远程访问你关注防火墙问题</li>\n</ul>\n<p>启动 Tomcat 服务：</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>./startup.sh</pre></td></tr></table></figure><p>启动 Tomcat 并输出启动日志 :</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>./startup.sh <span class=\"token operator\">&amp;</span> <span class=\"token function\">tail</span> <span class=\"token parameter variable\">-f</span>  <span class=\"token punctuation\">..</span>/logs/catalina.out</pre></td></tr></table></figure>\n<div id=\"gitalk-container\"></div>\n<script src=\"https://cdn.bootcss.com/blueimp-md5/2.12.0/js/md5.min.js\"></script><link rel=\"stylesheet\" href=\"https://unpkg.com/gitalk/dist/gitalk.css\"><script src=\"https://unpkg.com/gitalk/dist/gitalk.min.js\"></script>\n\n\t\t<script>\n\t\tvar gitalkConfig = {\"clientID\":\"6db178ba46c8af8f6a6f\",\"clientSecret\":\"90f730e5956024596558df00975cd8eae28cae3d\",\"repo\":\"bk-comment01\",\"owner\":\"onlymarryu\",\"admin\":[\"onlymarryu\"],\"distractionFreeMode\":false,\"language\":\"zh-CN\",\"proxy\":\"https://gitalk-comments.netlify.app/github_access_token\",\"perPage\":15};\n\t    gitalkConfig.id = md5(location.pathname);\n\t\tvar gitalk = new Gitalk(gitalkConfig);\n\t    gitalk.render(\"gitalk-container\");\n\t    </script>",
            "tags": [
                "工具软件安装"
            ]
        },
        {
            "id": "http://yoursite.com/tools/redis-tool/",
            "url": "http://yoursite.com/tools/redis-tool/",
            "title": "redis",
            "date_published": "2022-10-15T04:52:38.205Z",
            "content_html": "<h3 id=\"redis安装\"><a class=\"anchor\" href=\"#redis安装\">#</a> redis 安装</h3>\n<h4 id=\"1\"><a class=\"anchor\" href=\"#1\">#</a> ——1</h4>\n<h5 id=\"1安装依赖c语言依赖\"><a class=\"anchor\" href=\"#1安装依赖c语言依赖\">#</a> 1. 安装依赖 C 语言依赖</h5>\n<p>​\tredis 使用 C 语言编写，所以需要安装 C 语言库</p>\n<pre><code> yum install -y gcc-c++ automake autoconf libtool make tcl \n</code></pre>\n<p>​</p>\n<h5 id=\"2上传并解压\"><a class=\"anchor\" href=\"#2上传并解压\">#</a> 2. 上传并解压</h5>\n<p>​\t把 redis-5.0.5.tar.gz 上传到 /usr/local/tmp 中，解压文件</p>\n<pre><code> cd /usr/local/tmp\n\n tar zxf redis-5.0.5.tar.gz\n</code></pre>\n<h5 id=\"3编译并安装\"><a class=\"anchor\" href=\"#3编译并安装\">#</a> 3. 编译并安装</h5>\n<p>​\t进入解压文件夹</p>\n<pre><code>  cd /usr/local/tmp/redis-5.0.5/\n</code></pre>\n<p>​\t编译</p>\n<pre><code> make\n</code></pre>\n<p>​\t安装</p>\n<pre><code> make install PREFIX=/usr/local/redis\n</code></pre>\n<h5 id=\"4开启守护进程\"><a class=\"anchor\" href=\"#4开启守护进程\">#</a> 4. 开启守护进程</h5>\n<p>​\t复制 cd /usr/local/tmp/redis-5.0.5 / 中 redis.conf 配置文件</p>\n<pre><code> cp redis.conf /usr/local/redis/bin/\n</code></pre>\n<p><strong>修改配置文件</strong></p>\n<pre><code> cd /usr/local/redis/bin/\n\n vim redis.conf\n</code></pre>\n<p>​\t把 daemonize 的值由 no 修改为 yes</p>\n<p><img data-src=\"https://cdn.jsdelivr.net/gh/onlymarryu/typora-ims-test@master/Redis-01.jpg\" alt=\"\" /></p>\n<h5 id=\"5修改外部访问\"><a class=\"anchor\" href=\"#5修改外部访问\">#</a> 5. 修改外部访问</h5>\n<p>​\t在 redis5 中需要修改配置文件 redis.conf 允许外部访问。需要修改两处。</p>\n<p>​\t注释掉下面</p>\n<p>​\tbind 127.0.0.1</p>\n<pre><code> bind 127.0.0.1\n</code></pre>\n<p>​\tprotected-mode yes 改成 no</p>\n<p><img data-src=\"https://cdn.jsdelivr.net/gh/onlymarryu/typora-ims-test@master/Redis-02.jpg\" alt=\"\" /></p>\n<h5 id=\"6启动并测试\"><a class=\"anchor\" href=\"#6启动并测试\">#</a> 6. 启动并测试</h5>\n<p>​\t启动 redis</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>./redis-server redis.conf</pre></td></tr></table></figure><p>​\t重启 redis</p>\n<pre><code>./redis-cli shutdown\n./redis-server redis.conf\n</code></pre>\n<p>​\t启动客户端工具</p>\n<p>​\t在 redis5 中客户端工具对命令会有提供功能。</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>./redis-cli</pre></td></tr></table></figure><h4 id=\"2\"><a class=\"anchor\" href=\"#2\">#</a> ——2</h4>\n<h5 id=\"1-拉取镜像文件\"><a class=\"anchor\" href=\"#1-拉取镜像文件\">#</a> 1、拉取镜像文件</h5>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> pull redis<span class=\"token punctuation\">[</span>:<span class=\"token punctuation\">(</span>版本号<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span></pre></td></tr></table></figure><h5 id=\"2-去gitee库中下载redis配置文件docker不自带配置文件也可不进行此步骤\"><a class=\"anchor\" href=\"#2-去gitee库中下载redis配置文件docker不自带配置文件也可不进行此步骤\">#</a> 2、去 gitee 库中下载 redis 配置文件（docker 不自带配置文件）【也可不进行此步骤】</h5>\n<p><strong>建议看完，先别操作，再看三，看完三之后再决定如何操作</strong></p>\n<p>然后按照文章内容进行，忽略下载。</p>\n<p>文章地址： <span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuamI1MS5uZXQvYXJ0aWNsZS8yMDMyNzQuaHRt\">https://www.jb51.net/article/203274.htm</span></p>\n<p>、</p>\n<p><img data-src=\"https://cdn.jsdelivr.net/gh/onlymarryu/typora-ims-test@master/1645177895314.png\" alt=\"1645177895314\" /></p>\n<p><strong>docker 镜像中没有 redis.conf 文件，要自己配置</strong></p>\n<pre><code class=\"language-undefined\">git pull --rebase https://gitee.com/zjj3366/mydemo.git master\n</code></pre>\n<h5 id=\"3-创建一个redis-服务容器\"><a class=\"anchor\" href=\"#3-创建一个redis-服务容器\">#</a> 3、创建一个 redis 服务容器</h5>\n<p><strong>第二步进行了的</strong></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> run <span class=\"token parameter variable\">-p</span> <span class=\"token number\">6379</span>:6379 <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token parameter variable\">--name</span> myredis  <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token parameter variable\">-v</span> /usr/local/docker/redis.conf:/etc/redis/redis.conf   <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token parameter variable\">-v</span> /usr/local/docker/data:/data  <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token parameter variable\">-d</span> redis  <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>redis-server  /etc/redis/redis.conf  <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token parameter variable\">--appendonly</span> <span class=\"token function\">yes</span></pre></td></tr></table></figure><p><strong>第二步没有进行的</strong></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> run <span class=\"token parameter variable\">-p</span> <span class=\"token number\">6379</span>:6379  <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token parameter variable\">--name</span> myredis  <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token parameter variable\">-v</span> /root/myredis/data:/data <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token parameter variable\">-v</span> /root/myredis/conf/redis.conf:/etc/redis/redis.conf  <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token parameter variable\">-d</span> redis:4.0  <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>redis-server /etc/redis/redis.conf  <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token parameter variable\">--appendonly</span> <span class=\"token function\">yes</span></pre></td></tr></table></figure><p><strong>区别：</strong></p>\n<p>​\t其实也没有什么区别，只是映射的文件不同，也可以将第二步的文件直接创建到第二种创建服务容器的配置文件地址中去，这样也可使用第二个创建方式。</p>\n<p><img data-src=\"https://cdn.jsdelivr.net/gh/onlymarryu/typora-ims-test@master/1645177877202.png\" alt=\"1645177877202\" /></p>\n<p><img data-src=\"https://cdn.jsdelivr.net/gh/onlymarryu/typora-ims-test@master/1645177918077.png\" alt=\"1645177918077\" /></p>\n\n<div id=\"gitalk-container\"></div>\n<script src=\"https://cdn.bootcss.com/blueimp-md5/2.12.0/js/md5.min.js\"></script><link rel=\"stylesheet\" href=\"https://unpkg.com/gitalk/dist/gitalk.css\"><script src=\"https://unpkg.com/gitalk/dist/gitalk.min.js\"></script>\n\n\t\t<script>\n\t\tvar gitalkConfig = {\"clientID\":\"6db178ba46c8af8f6a6f\",\"clientSecret\":\"90f730e5956024596558df00975cd8eae28cae3d\",\"repo\":\"bk-comment01\",\"owner\":\"onlymarryu\",\"admin\":[\"onlymarryu\"],\"distractionFreeMode\":false,\"language\":\"zh-CN\",\"proxy\":\"https://gitalk-comments.netlify.app/github_access_token\",\"perPage\":15};\n\t    gitalkConfig.id = md5(location.pathname);\n\t\tvar gitalk = new Gitalk(gitalkConfig);\n\t    gitalk.render(\"gitalk-container\");\n\t    </script>",
            "tags": [
                "工具软件安装"
            ]
        },
        {
            "id": "http://yoursite.com/tools/RabbitMQ-tool/",
            "url": "http://yoursite.com/tools/RabbitMQ-tool/",
            "title": "RabbitMQ",
            "date_published": "2022-10-15T04:52:38.201Z",
            "content_html": "<h3 id=\"rabbitmq安装\"><a class=\"anchor\" href=\"#rabbitmq安装\">#</a> RabbitMQ<strong> 安装</strong></h3>\n<h4 id=\"1-上传并解压\"><a class=\"anchor\" href=\"#1-上传并解压\">#</a> 1 <strong>上传并解压</strong></h4>\n<p>​\t上传 rabbitmq-server-generic-unix-3.7.18.tar.xz 到 /usr/loca/tmp 中</p>\n<pre><code>  cd /usr/local/tmp\n  \n  tar xf rabbitmq-server-generic-unix-3.7.18.tar.xz -C /usr/local/tmp\n</code></pre>\n<h4 id=\"2-复制到local下\"><a class=\"anchor\" href=\"#2-复制到local下\">#</a> 2 <strong>复制到 local 下</strong></h4>\n<p>​\t复制解压文件到 /usr/local 下，命名为 rabbitmq</p>\n<pre><code>  cp -r rabbitmq_server-3.7.18 /usr/local/rabbitmq\n</code></pre>\n<h4 id=\"3-配置环境变量\"><a class=\"anchor\" href=\"#3-配置环境变量\">#</a> 3 <strong>配置环境变量</strong></h4>\n<pre><code>  vim /etc/profile\n</code></pre>\n<p>​\t在文件中添加</p>\n<pre><code>export PATH=$PATH:/usr/local/rabbitmq/sbin\n</code></pre>\n<p>​\t解析文件</p>\n<pre><code> source /etc/profile\n</code></pre>\n<h4 id=\"4-开启web管理插件\"><a class=\"anchor\" href=\"#4-开启web管理插件\">#</a> 4 <strong>开启 web 管理插件</strong></h4>\n<p>​\t进入 rabbitmq/sbin 目录</p>\n<pre><code> cd /usr/local/rabbitmq/sbin\n</code></pre>\n<pre><code>查看插件列表\n</code></pre>\n<pre><code>  ./rabbitmq-plugins list\n</code></pre>\n<pre><code>生效管理插件\n</code></pre>\n<pre><code>  ./rabbitmq-plugins enable rabbitmq_management\n</code></pre>\n<h4 id=\"5-后台运行\"><a class=\"anchor\" href=\"#5-后台运行\">#</a> 5 <strong>后台运行</strong></h4>\n<p>​\t启动 rabbitmq。</p>\n<pre><code>  ./rabbitmq-server -detached\n</code></pre>\n<p>​\t停止命令，如果无法停止，使用 kill -9 进程号进行关闭</p>\n<pre><code> ./rabbitmqctl stop_app\n</code></pre>\n<h4 id=\"6-查看web管理界面\"><a class=\"anchor\" href=\"#6-查看web管理界面\">#</a> 6 <strong>查看 web 管理界面</strong></h4>\n<p>​\t默认可以在安装 rabbitmq 的电脑上通过用户名：guest 密码 guest 进行访问 web 管理界面</p>\n<p>​\t端口号：15672（放行端口，或关闭防火墙）</p>\n<p>​\t在虚拟机浏览器中输入：</p>\n<p>​\t<span class=\"exturl\" data-url=\"aHR0cDovL2xvY2FsaG9zdDoxNTY3Mg==\">http://localhost:15672</span></p>\n<h3 id=\"rabbitmq账户管理\"><a class=\"anchor\" href=\"#rabbitmq账户管理\">#</a> * RabbitMq 账户管理</h3>\n<h4 id=\"1-创建账户\"><a class=\"anchor\" href=\"#1-创建账户\">#</a> 1 <strong>创建账户</strong></h4>\n<p>​\t语法：./rabbitmqctl add_user username password</p>\n<pre><code> cd /usr/local/rabbitmq/sbin\n \n ./rabbitmqctl add_user mashibing mashibing\n</code></pre>\n<h4 id=\"2-给用户授予管理员角色\"><a class=\"anchor\" href=\"#2-给用户授予管理员角色\">#</a> 2 <strong>给用户授予管理员角色</strong></h4>\n<p>​\t其中 smallming 为新建用户的用户名</p>\n<pre><code> ./rabbitmqctl set_user_tags mashibing administrator\n</code></pre>\n<h4 id=\"3-给用户授权\"><a class=\"anchor\" href=\"#3-给用户授权\">#</a> 3 <strong>给用户授权</strong></h4>\n<p>​\t“/” 表示虚拟机</p>\n<p>​\tmashibing 表示用户名</p>\n<p>​\t&quot;.<em>&quot; &quot;.</em>&quot;&quot;.*&quot; 表示完整权限</p>\n<pre><code> ./rabbitmqctl set_permissions -p &quot;/&quot; mashibing &quot;.*&quot; &quot;.*&quot; &quot;.*&quot;\n</code></pre>\n<h4 id=\"4-登录\"><a class=\"anchor\" href=\"#4-登录\">#</a> 4 <strong>登录</strong></h4>\n<p>​\t使用新建账户和密码在 windows 中访问 rabbitmq 并登录</p>\n<p>​\t在浏览器地址栏输入：</p>\n<p>​\t<span class=\"exturl\" data-url=\"aHR0cDovL2lwOjE1NjcyLw==\">http://ip:15672/</span></p>\n<pre><code>用户名：mashibing\n</code></pre>\n<p>​\t密码：mashibing</p>\n\n<div id=\"gitalk-container\"></div>\n<script src=\"https://cdn.bootcss.com/blueimp-md5/2.12.0/js/md5.min.js\"></script><link rel=\"stylesheet\" href=\"https://unpkg.com/gitalk/dist/gitalk.css\"><script src=\"https://unpkg.com/gitalk/dist/gitalk.min.js\"></script>\n\n\t\t<script>\n\t\tvar gitalkConfig = {\"clientID\":\"6db178ba46c8af8f6a6f\",\"clientSecret\":\"90f730e5956024596558df00975cd8eae28cae3d\",\"repo\":\"bk-comment01\",\"owner\":\"onlymarryu\",\"admin\":[\"onlymarryu\"],\"distractionFreeMode\":false,\"language\":\"zh-CN\",\"proxy\":\"https://gitalk-comments.netlify.app/github_access_token\",\"perPage\":15};\n\t    gitalkConfig.id = md5(location.pathname);\n\t\tvar gitalk = new Gitalk(gitalkConfig);\n\t    gitalk.render(\"gitalk-container\");\n\t    </script>",
            "tags": [
                "工具软件安装"
            ]
        },
        {
            "id": "http://yoursite.com/tools/python-tool/",
            "url": "http://yoursite.com/tools/python-tool/",
            "title": "python",
            "date_published": "2022-10-15T04:52:38.198Z",
            "content_html": "<h3 id=\"python升级\"><a class=\"anchor\" href=\"#python升级\">#</a> Python 升级</h3>\n<h4 id=\"一-查看当前python版本\"><a class=\"anchor\" href=\"#一-查看当前python版本\">#</a> 一、<strong>查看当前 python 版本</strong></h4>\n<pre><code>#[root@ansible ~]# python -V\nPython 2.7.5\n</code></pre>\n<h4 id=\"二-下载新的python包并安装\"><a class=\"anchor\" href=\"#二-下载新的python包并安装\">#</a> 二、<strong>下载新的 python 包并安装</strong></h4>\n<p>​\t进入 python 官网（<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cucHl0aG9uLm9yZw==\">https://www.python.org</span>），选择需要的版本。此处我选择当前最新版本 Python3.6.1</p>\n<pre><code>yum install gcc gcc-c++ -y\n\nwget https://www.python.org/ftp/python/3.7.3/Python-3.7.3.tar.xz\n\ntar xvf Python-3.7.3.tar.xz \n\ncd Python-3.7.3/\n\n ./configure\n \nmake\n\nmake install\n</code></pre>\n<h4 id=\"三-验证\"><a class=\"anchor\" href=\"#三-验证\">#</a> 三、<strong>验证</strong></h4>\n<pre><code>#python -V     #一个是旧版本，一个是新版本\nPython 2.7.5\n### python3 -V\nPython 3.7.3\n</code></pre>\n<h4 id=\"四-设置3x为默认版本\"><a class=\"anchor\" href=\"#四-设置3x为默认版本\">#</a> 四、<strong>设置 3.X 为默认版本</strong></h4>\n<p>​\t查看 Python 的路径，在 /usr/bin 下面。可以看到 python 链接的是 python 2.7，所以，执行 python 就相当于执行 python 2.7。</p>\n<pre><code>#[root@ansible ~]# ls -al /usr/bin | grep python\n-rwxr-xr-x.   1 root root       11232 Dec  2  2016 abrt-action-analyze-python\nlrwxrwxrwx.   1 root root           7 May 26  2017 python -&gt; python2\nlrwxrwxrwx.   1 root root           9 May 26  2017 python2 -&gt; python2.7\n-rwxr-xr-x.   1 root root        7136 Nov  6  2016 python2.7\n</code></pre>\n<p>将原来 python 的软链接重命名：</p>\n<pre><code>  mv /usr/bin/python /usr/bin/python.bak\n</code></pre>\n<p>将 python 链接至 python3：</p>\n<pre><code>  ln -s /usr/local/bin/python3 /usr/bin/python\n</code></pre>\n<h4 id=\"五-配置yum\"><a class=\"anchor\" href=\"#五-配置yum\">#</a> 五、<strong>配置 yum</strong></h4>\n<p>​\t升级 Python 之后，由于将默认的 python 指向了 python3，yum 不能正常使用，需要编辑 yum 的配置文件，此时：</p>\n<pre><code>#[root@ansible-admin Python-3.7.3]# yum list\n  File &quot;/usr/bin/yum&quot;, line 30\n    except KeyboardInterrupt, e:\n\nSyntaxError: invalid syntax\n</code></pre>\n<p>​\t修改 /usr/bin/yum 和 /usr/libexec/urlgrabber-ext-down，将 #!/usr/bin/python 改为 #!/usr/bin/python2.7，保存退出即可。</p>\n<blockquote>\n<p>vim /usr/bin/yum</p>\n<p>vim /usr/libexec/urlgrabber-ext-down</p>\n</blockquote>\n\n<div id=\"gitalk-container\"></div>\n<script src=\"https://cdn.bootcss.com/blueimp-md5/2.12.0/js/md5.min.js\"></script><link rel=\"stylesheet\" href=\"https://unpkg.com/gitalk/dist/gitalk.css\"><script src=\"https://unpkg.com/gitalk/dist/gitalk.min.js\"></script>\n\n\t\t<script>\n\t\tvar gitalkConfig = {\"clientID\":\"6db178ba46c8af8f6a6f\",\"clientSecret\":\"90f730e5956024596558df00975cd8eae28cae3d\",\"repo\":\"bk-comment01\",\"owner\":\"onlymarryu\",\"admin\":[\"onlymarryu\"],\"distractionFreeMode\":false,\"language\":\"zh-CN\",\"proxy\":\"https://gitalk-comments.netlify.app/github_access_token\",\"perPage\":15};\n\t    gitalkConfig.id = md5(location.pathname);\n\t\tvar gitalk = new Gitalk(gitalkConfig);\n\t    gitalk.render(\"gitalk-container\");\n\t    </script>",
            "tags": [
                "工具软件安装"
            ]
        },
        {
            "id": "http://yoursite.com/tools/OpenSSL-tool/",
            "url": "http://yoursite.com/tools/OpenSSL-tool/",
            "title": "OpenSSL",
            "date_published": "2022-10-15T04:52:38.193Z",
            "content_html": "<h3 id=\"openssl安装教程windows\"><a class=\"anchor\" href=\"#openssl安装教程windows\">#</a> OpenSSL 安装教程（Windows）</h3>\n<p>openssl 官网下载地址：<span class=\"exturl\" data-url=\"aHR0cDovL3NscHJvd2ViLmNvbS9wcm9kdWN0cy9XaW4zMk9wZW5TU0wuaHRtbA==\">http://slproweb.com/products/Win32OpenSSL.html</span></p>\n<h4 id=\"安装环境\"><a class=\"anchor\" href=\"#安装环境\">#</a> 安装环境:</h4>\n<blockquote>\n<p>windows 10<br />\nWin64 OpenSSL v1.1.1i</p>\n</blockquote>\n<h4 id=\"一下载openssl安装版\"><a class=\"anchor\" href=\"#一下载openssl安装版\">#</a> 一。下载 openssl 安装版</h4>\n<p>​\t我这里是 win10 64 位，所以选的中间那个</p>\n<img data-src=\"/tools/OpenSSL-tool/20201222101342278.png\" class=\"\" title=\"按照操作系统选择\"> \n<h4 id=\"二安装过程\"><a class=\"anchor\" href=\"#二安装过程\">#</a> 二。安装过程</h4>\n<p>​\t也没啥特殊的 ，一直 next，只有两点注意：</p>\n<p>1、修改安装地址</p>\n<p>2、最后一步，不要勾选，会掏钱。</p>\n <img data-src=\"/tools/OpenSSL-tool/20201222102601218.png\" class=\"\" title=\"在这里插入图片描述\"> \n <img data-src=\"/tools/OpenSSL-tool/20201222102703276.png\" class=\"\" title=\"在这里插入图片描述\"> \n <img data-src=\"/tools/OpenSSL-tool/20201222102703268.png\" class=\"\" title=\"在这里插入图片描述\"> \n <img data-src=\"/tools/OpenSSL-tool/20201222102721958.png\" class=\"\" title=\"在这里插入图片描述\"> \n<img data-src=\"/tools/OpenSSL-tool/1650347562395.png\" class=\"\">\n<h4 id=\"三配置环境变量\"><a class=\"anchor\" href=\"#三配置环境变量\">#</a> 三。配置环境变量</h4>\n<img data-src=\"/tools/OpenSSL-tool/1650351119292.png\" class=\"\">\n <img data-src=\"/tools/OpenSSL-tool/1650351138506.png\" class=\"\" width=\"1650351138506\">\n<h4 id=\"四测试\"><a class=\"anchor\" href=\"#四测试\">#</a> 四。测试</h4>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>openssl <span class=\"token parameter variable\">-version</span></pre></td></tr></table></figure><img data-src=\"/tools/OpenSSL-tool/1650351011263.png\" class=\"\">\n<h3 id=\"openssl安装linux\"><a class=\"anchor\" href=\"#openssl安装linux\">#</a> OpenSSL 安装（Linux）</h3>\n<h4 id=\"1\"><a class=\"anchor\" href=\"#1\">#</a> ——1</h4>\n<p>参考链接：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3ZlY3Rvcl9kYXRhL2FydGljbGUvZGV0YWlscy8xMDc1NTc5NDE=\">https://blog.csdn.net/vector_data/article/details/107557941</span></p>\n<h5 id=\"1安装依赖c语言依赖\"><a class=\"anchor\" href=\"#1安装依赖c语言依赖\">#</a> 1. 安装依赖 C 语言依赖</h5>\n<p>​\tredis 使用 C 语言编写，所以需要安装 C 语言库</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>yum <span class=\"token function\">install</span> <span class=\"token parameter variable\">-y</span> gcc zlib</pre></td></tr></table></figure><p>​</p>\n<h5 id=\"2上传并解压\"><a class=\"anchor\" href=\"#2上传并解压\">#</a> 2. 上传并解压</h5>\n<p>​\t把  <code>openssl-1.1.1j.tar.gz</code>  上传到 /usr/local/tmp 中，解压文件</p>\n<pre><code> cd /usr/local/tmp\n\n tar zxf openssl-1.1.1j.tar.gz \n mv openssl-1.1.1j ../openssl\n \n</code></pre>\n<h5 id=\"3编译并安装\"><a class=\"anchor\" href=\"#3编译并安装\">#</a> 3. 编译并安装</h5>\n<p>​\t进入解压文件夹</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">cd</span> /usr/local/openssl</pre></td></tr></table></figure><p>​\t 配置编译</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>./config</pre></td></tr></table></figure><p>​\t编译安装</p>\n<pre><code>make clean &amp;&amp; make install\n</code></pre>\n<p>​\t测试</p>\n<pre><code>openssl version -a\n</code></pre>\n\n<div id=\"gitalk-container\"></div>\n<script src=\"https://cdn.bootcss.com/blueimp-md5/2.12.0/js/md5.min.js\"></script><link rel=\"stylesheet\" href=\"https://unpkg.com/gitalk/dist/gitalk.css\"><script src=\"https://unpkg.com/gitalk/dist/gitalk.min.js\"></script>\n\n\t\t<script>\n\t\tvar gitalkConfig = {\"clientID\":\"6db178ba46c8af8f6a6f\",\"clientSecret\":\"90f730e5956024596558df00975cd8eae28cae3d\",\"repo\":\"bk-comment01\",\"owner\":\"onlymarryu\",\"admin\":[\"onlymarryu\"],\"distractionFreeMode\":false,\"language\":\"zh-CN\",\"proxy\":\"https://gitalk-comments.netlify.app/github_access_token\",\"perPage\":15};\n\t    gitalkConfig.id = md5(location.pathname);\n\t\tvar gitalk = new Gitalk(gitalkConfig);\n\t    gitalk.render(\"gitalk-container\");\n\t    </script>",
            "tags": [
                "工具软件安装"
            ]
        },
        {
            "id": "http://yoursite.com/tools/Nginx-tool/",
            "url": "http://yoursite.com/tools/Nginx-tool/",
            "title": "Nginx",
            "date_published": "2022-10-15T04:52:38.188Z",
            "content_html": "<h3 id=\"nginx安装\"><a class=\"anchor\" href=\"#nginx安装\">#</a> nginx 安装</h3>\n<h4 id=\"1\"><a class=\"anchor\" href=\"#1\">#</a> ——1</h4>\n<h5 id=\"安装yum\"><a class=\"anchor\" href=\"#安装yum\">#</a> 安装：yum</h5>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>yum <span class=\"token function\">install</span> yum-utils</pre></td></tr></table></figure><h5 id=\"切换目录\"><a class=\"anchor\" href=\"#切换目录\">#</a> 切换目录：</h5>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">cd</span> /etc/yum.repos.d/</pre></td></tr></table></figure><h5 id=\"创建文件\"><a class=\"anchor\" href=\"#创建文件\">#</a> 创建文件：</h5>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">vim</span> nginx.repo</pre></td></tr></table></figure><p><em>修改文件内容：</em></p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>nginx-stable<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token assign-left variable\">name</span><span class=\"token operator\">=</span>nginx stable repo</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token assign-left variable\">baseurl</span><span class=\"token operator\">=</span>http://nginx.org/packages/centos/<span class=\"token variable\">$releasever</span>/<span class=\"token variable\">$basearch</span>/</pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token assign-left variable\">gpgcheck</span><span class=\"token operator\">=</span><span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token assign-left variable\">enabled</span><span class=\"token operator\">=</span><span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token assign-left variable\">gpgkey</span><span class=\"token operator\">=</span>https://nginx.org/keys/nginx_signing.key</pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token assign-left variable\">module_hotfixes</span><span class=\"token operator\">=</span>true</pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">[</span>nginx-mainline<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token assign-left variable\">name</span><span class=\"token operator\">=</span>nginx mainline repo</pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token assign-left variable\">baseurl</span><span class=\"token operator\">=</span>http://nginx.org/packages/mainline/centos/<span class=\"token variable\">$releasever</span>/<span class=\"token variable\">$basearch</span>/</pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token assign-left variable\">gpgcheck</span><span class=\"token operator\">=</span><span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token assign-left variable\">enabled</span><span class=\"token operator\">=</span><span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token assign-left variable\">gpgkey</span><span class=\"token operator\">=</span>https://nginx.org/keys/nginx_signing.key</pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token assign-left variable\">module_hotfixes</span><span class=\"token operator\">=</span>true</pre></td></tr></table></figure><h5 id=\"nginx的安装\"><a class=\"anchor\" href=\"#nginx的安装\">#</a> Nginx 的安装：</h5>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>yum <span class=\"token function\">install</span> nginx</pre></td></tr></table></figure><p>安装完成：我们的版本：nginx.x86_64 1:1.20.2-1.el7.ngx</p>\n<div name=\"nginx_install_2\">\n<h4 id=\"2\"><a class=\"anchor\" href=\"#2\">#</a> ——2</h4>\n<h5 id=\"1-拉取镜像\"><a class=\"anchor\" href=\"#1-拉取镜像\">#</a> 1、拉取镜像</h5>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> pull nginx:1.16.1</pre></td></tr></table></figure><h5 id=\"2-创建挂载数据卷\"><a class=\"anchor\" href=\"#2-创建挂载数据卷\">#</a> 2、创建挂载数据卷</h5>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">mkdir</span> <span class=\"token parameter variable\">-p</span> /root/nginx/conf</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">vim</span> /root/nginx/conf/nginx.conf</pre></td></tr></table></figure><p><code>nginx.conf内容：</code></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>user  root<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>worker_processes  <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre> </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>error_log  /var/log/nginx/error.log warn<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>pid        /var/run/nginx.pid<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre> </pre></td></tr><tr><td data-num=\"7\"></td><td><pre> </pre></td></tr><tr><td data-num=\"8\"></td><td><pre>events <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    worker_connections  <span class=\"token number\">1024</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre> </pre></td></tr><tr><td data-num=\"12\"></td><td><pre> </pre></td></tr><tr><td data-num=\"13\"></td><td><pre>http <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    include       /etc/nginx/mime.types<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    default_type  application/octet-stream<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre> </pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    log_format  main  <span class=\"token string\">'$remote_addr - $remote_user [$time_local] \"$request\" '</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>                      <span class=\"token string\">'$status $body_bytes_sent \"$http_referer\" '</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>                      <span class=\"token string\">'\"$http_user_agent\" \"$http_x_forwarded_for\"'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre> </pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    access_log  /var/log/nginx/access.log  main<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre> </pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    sendfile        on<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token comment\">#    #tcp_nopush     on;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre> </pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    keepalive_timeout  <span class=\"token number\">65</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre> </pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token comment\">#    #gzip  on;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    server <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    \tlisten       <span class=\"token number\">80</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    \tserver_name  localhost<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token comment\">#    \t#charset koi8-r;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token comment\">#    \t#access_log  /var/log/nginx/host.access.log  main;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    \tlocation / <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        \troot   /usr/share/nginx/html<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>        \tindex  index.html index.htm<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    \t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre></pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token comment\">#    \t#error_page  404              /404.html;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre></pre></td></tr><tr><td data-num=\"45\"></td><td><pre><span class=\"token comment\">#    \t# redirect server error pages to the static page /50x.html</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    \terror_page   <span class=\"token number\">500</span> <span class=\"token number\">502</span> <span class=\"token number\">503</span> <span class=\"token number\">504</span>  /50x.html<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    \tlocation <span class=\"token operator\">=</span> /50x.html <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>        \troot   /usr/share/nginx/html<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>    \t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>   </pre></td></tr><tr><td data-num=\"52\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h5 id=\"3-创建容器\"><a class=\"anchor\" href=\"#3-创建容器\">#</a> 3、创建容器</h5>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">### 注意 ip 一定要与检测 ip 相同</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">docker</span> run <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token parameter variable\">-p</span> <span class=\"token number\">80</span>:80 <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token parameter variable\">--name</span> nginx  <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token parameter variable\">-v</span> /root/nginx/conf/nginx.conf:/etc/nginx/nginx.conf <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token parameter variable\">-d</span> nginx:1.16.1</pre></td></tr></table></figure><h5 id=\"4-查看\"><a class=\"anchor\" href=\"#4-查看\">#</a> 4、查看</h5>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> <span class=\"token function\">ps</span></pre></td></tr></table></figure>\n<div id=\"gitalk-container\"></div>\n<script src=\"https://cdn.bootcss.com/blueimp-md5/2.12.0/js/md5.min.js\"></script><link rel=\"stylesheet\" href=\"https://unpkg.com/gitalk/dist/gitalk.css\"><script src=\"https://unpkg.com/gitalk/dist/gitalk.min.js\"></script>\n\n\t\t<script>\n\t\tvar gitalkConfig = {\"clientID\":\"6db178ba46c8af8f6a6f\",\"clientSecret\":\"90f730e5956024596558df00975cd8eae28cae3d\",\"repo\":\"bk-comment01\",\"owner\":\"onlymarryu\",\"admin\":[\"onlymarryu\"],\"distractionFreeMode\":false,\"language\":\"zh-CN\",\"proxy\":\"https://gitalk-comments.netlify.app/github_access_token\",\"perPage\":15};\n\t    gitalkConfig.id = md5(location.pathname);\n\t\tvar gitalk = new Gitalk(gitalkConfig);\n\t    gitalk.render(\"gitalk-container\");\n\t    </script>",
            "tags": [
                "工具软件安装"
            ]
        },
        {
            "id": "http://yoursite.com/tools/Nacos-tool/",
            "url": "http://yoursite.com/tools/Nacos-tool/",
            "title": "Nacos",
            "date_published": "2022-10-15T04:52:38.178Z",
            "content_html": "<h3 id=\"nacos安装\"><a class=\"anchor\" href=\"#nacos安装\">#</a> Nacos 安装</h3>\n<p><strong>注：</strong></p>\n<ul>\n<li>\n<p>安装之前必须 配置  <a href=\"#jdk_install\">jdk</a></p>\n</li>\n<li>\n<p>安装之前必须 配置  <a href=\"#mysql_install\">mysql5.6.+</a></p>\n</li>\n</ul>\n<div name=\"nacos_install_1\">\n<h4 id=\"1\"><a class=\"anchor\" href=\"#1\">#</a> ——1</h4>\n<h5 id=\"1-准备安装包\"><a class=\"anchor\" href=\"#1-准备安装包\">#</a> 1、准备安装包</h5>\n<p>官网：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2FsaWJhYmEvbmFjb3MvcmVsZWFzZXM=\">https://github.com/alibaba/nacos/releases</span></p>\n<p>本篇我们选择 version：2.0.3</p>\n<h5 id=\"2-上传并解压\"><a class=\"anchor\" href=\"#2-上传并解压\">#</a> 2、上传并解压</h5>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">tar</span> <span class=\"token parameter variable\">-zxvf</span> nacos-server-2.0.3 .tar.gz <span class=\"token parameter variable\">-C</span> /usr/local/</pre></td></tr></table></figure><h5 id=\"3-修改配置\"><a class=\"anchor\" href=\"#3-修改配置\">#</a> 3、修改配置</h5>\n<blockquote>\n<p>1、使用 nacos-mysql.sql</p>\n<p>​\t\t为我们储存数据建立数据库、表</p>\n<p>2、 <code>application.properties里面修改数据储存位置为mysql</code></p>\n</blockquote>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">cd</span> /usr/local/nacos/conf</pre></td></tr></table></figure><figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">-- 1 建立数据库</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">create</span>  <span class=\"token keyword\">database</span> nacos_config<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">use</span> nacos_config<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>config_info<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">bigint</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">AUTO_INCREMENT</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'id'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>data_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'data_id'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>group_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>content<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">longtext</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'content'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>md5<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'md5'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>gmt_create<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">datetime</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CURRENT_TIMESTAMP</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'创建时间'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>gmt_modified<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">datetime</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CURRENT_TIMESTAMP</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'修改时间'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>src_user<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">text</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'source user'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>src_ip<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'source ip'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>app_name<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tenant_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token string\">''</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'租户字段'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>c_desc<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">256</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>c_use<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">64</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>effect<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">64</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>type<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">64</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>c_schema<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">text</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>  <span class=\"token keyword\">PRIMARY</span> <span class=\"token keyword\">KEY</span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>  <span class=\"token keyword\">UNIQUE</span> <span class=\"token keyword\">KEY</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>uk_configinfo_datagrouptenant<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>data_id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">,</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>group_id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">,</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>tenant_id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token punctuation\">)</span> <span class=\"token keyword\">ENGINE</span><span class=\"token operator\">=</span><span class=\"token keyword\">InnoDB</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CHARSET</span><span class=\"token operator\">=</span>utf8 <span class=\"token keyword\">COLLATE</span><span class=\"token operator\">=</span>utf8_bin <span class=\"token keyword\">COMMENT</span><span class=\"token operator\">=</span><span class=\"token string\">'config_info'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>config_info_aggr<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">bigint</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">AUTO_INCREMENT</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'id'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>data_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'data_id'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>group_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'group_id'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>datum_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'datum_id'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>content<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">longtext</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'内容'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>gmt_modified<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">datetime</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'修改时间'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>app_name<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tenant_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token string\">''</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'租户字段'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>  <span class=\"token keyword\">PRIMARY</span> <span class=\"token keyword\">KEY</span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>  <span class=\"token keyword\">UNIQUE</span> <span class=\"token keyword\">KEY</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>uk_configinfoaggr_datagrouptenantdatum<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>data_id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">,</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>group_id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">,</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>tenant_id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">,</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>datum_id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token punctuation\">)</span> <span class=\"token keyword\">ENGINE</span><span class=\"token operator\">=</span><span class=\"token keyword\">InnoDB</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CHARSET</span><span class=\"token operator\">=</span>utf8 <span class=\"token keyword\">COLLATE</span><span class=\"token operator\">=</span>utf8_bin <span class=\"token keyword\">COMMENT</span><span class=\"token operator\">=</span><span class=\"token string\">'增加租户字段'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre></pre></td></tr><tr><td data-num=\"40\"></td><td><pre></pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>config_info_beta<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">bigint</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">AUTO_INCREMENT</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'id'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>data_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'data_id'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>group_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'group_id'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>app_name<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'app_name'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>content<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">longtext</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'content'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>beta_ips<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">1024</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'betaIps'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>md5<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'md5'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>gmt_create<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">datetime</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CURRENT_TIMESTAMP</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'创建时间'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>gmt_modified<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">datetime</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CURRENT_TIMESTAMP</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'修改时间'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>src_user<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">text</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'source user'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>src_ip<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'source ip'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tenant_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token string\">''</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'租户字段'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>  <span class=\"token keyword\">PRIMARY</span> <span class=\"token keyword\">KEY</span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>  <span class=\"token keyword\">UNIQUE</span> <span class=\"token keyword\">KEY</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>uk_configinfobeta_datagrouptenant<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>data_id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">,</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>group_id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">,</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>tenant_id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre><span class=\"token punctuation\">)</span> <span class=\"token keyword\">ENGINE</span><span class=\"token operator\">=</span><span class=\"token keyword\">InnoDB</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CHARSET</span><span class=\"token operator\">=</span>utf8 <span class=\"token keyword\">COLLATE</span><span class=\"token operator\">=</span>utf8_bin <span class=\"token keyword\">COMMENT</span><span class=\"token operator\">=</span><span class=\"token string\">'config_info_beta'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre></pre></td></tr><tr><td data-num=\"59\"></td><td><pre></pre></td></tr><tr><td data-num=\"60\"></td><td><pre><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>config_info_tag<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">bigint</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">AUTO_INCREMENT</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'id'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>data_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'data_id'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>group_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'group_id'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tenant_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token string\">''</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'tenant_id'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tag_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'tag_id'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>app_name<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'app_name'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>content<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">longtext</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'content'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>md5<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'md5'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>gmt_create<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">datetime</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CURRENT_TIMESTAMP</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'创建时间'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>gmt_modified<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">datetime</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CURRENT_TIMESTAMP</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'修改时间'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>src_user<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">text</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'source user'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>src_ip<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'source ip'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>  <span class=\"token keyword\">PRIMARY</span> <span class=\"token keyword\">KEY</span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>  <span class=\"token keyword\">UNIQUE</span> <span class=\"token keyword\">KEY</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>uk_configinfotag_datagrouptenanttag<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>data_id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">,</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>group_id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">,</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>tenant_id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">,</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>tag_id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre><span class=\"token punctuation\">)</span> <span class=\"token keyword\">ENGINE</span><span class=\"token operator\">=</span><span class=\"token keyword\">InnoDB</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CHARSET</span><span class=\"token operator\">=</span>utf8 <span class=\"token keyword\">COLLATE</span><span class=\"token operator\">=</span>utf8_bin <span class=\"token keyword\">COMMENT</span><span class=\"token operator\">=</span><span class=\"token string\">'config_info_tag'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre></pre></td></tr><tr><td data-num=\"77\"></td><td><pre></pre></td></tr><tr><td data-num=\"78\"></td><td><pre><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>config_tags_relation<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">bigint</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'id'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tag_name<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'tag_name'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tag_type<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">64</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'tag_type'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>data_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'data_id'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>group_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'group_id'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tenant_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token string\">''</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'tenant_id'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>nid<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">bigint</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">AUTO_INCREMENT</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>  <span class=\"token keyword\">PRIMARY</span> <span class=\"token keyword\">KEY</span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>nid<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre>  <span class=\"token keyword\">UNIQUE</span> <span class=\"token keyword\">KEY</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>uk_configtagrelation_configidtag<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">,</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>tag_name<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">,</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>tag_type<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre>  <span class=\"token keyword\">KEY</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>idx_tenant_id<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>tenant_id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre><span class=\"token punctuation\">)</span> <span class=\"token keyword\">ENGINE</span><span class=\"token operator\">=</span><span class=\"token keyword\">InnoDB</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CHARSET</span><span class=\"token operator\">=</span>utf8 <span class=\"token keyword\">COLLATE</span><span class=\"token operator\">=</span>utf8_bin <span class=\"token keyword\">COMMENT</span><span class=\"token operator\">=</span><span class=\"token string\">'config_tag_relation'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre></pre></td></tr><tr><td data-num=\"91\"></td><td><pre></pre></td></tr><tr><td data-num=\"92\"></td><td><pre><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>group_capacity<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">bigint</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">unsigned</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">AUTO_INCREMENT</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'主键ID'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>group_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token string\">''</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'Group ID，空字符表示整个集群'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"95\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>quota<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">unsigned</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token string\">'0'</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'配额，0表示使用默认值'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"96\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>usage<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">unsigned</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token string\">'0'</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'使用量'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"97\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>max_size<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">unsigned</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token string\">'0'</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'单个配置大小上限，单位为字节，0表示使用默认值'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>max_aggr_count<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">unsigned</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token string\">'0'</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'聚合子配置最大个数，，0表示使用默认值'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"99\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>max_aggr_size<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">unsigned</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token string\">'0'</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'单个聚合数据的子配置大小上限，单位为字节，0表示使用默认值'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"100\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>max_history_count<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">unsigned</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token string\">'0'</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'最大变更历史数量'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"101\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>gmt_create<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">datetime</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CURRENT_TIMESTAMP</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'创建时间'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"102\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>gmt_modified<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">datetime</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CURRENT_TIMESTAMP</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'修改时间'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"103\"></td><td><pre>  <span class=\"token keyword\">PRIMARY</span> <span class=\"token keyword\">KEY</span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"104\"></td><td><pre>  <span class=\"token keyword\">UNIQUE</span> <span class=\"token keyword\">KEY</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>uk_group_id<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>group_id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"105\"></td><td><pre><span class=\"token punctuation\">)</span> <span class=\"token keyword\">ENGINE</span><span class=\"token operator\">=</span><span class=\"token keyword\">InnoDB</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CHARSET</span><span class=\"token operator\">=</span>utf8 <span class=\"token keyword\">COLLATE</span><span class=\"token operator\">=</span>utf8_bin <span class=\"token keyword\">COMMENT</span><span class=\"token operator\">=</span><span class=\"token string\">'集群、各Group容量信息表'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"106\"></td><td><pre></pre></td></tr><tr><td data-num=\"107\"></td><td><pre></pre></td></tr><tr><td data-num=\"108\"></td><td><pre><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>his_config_info<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"109\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">bigint</span><span class=\"token punctuation\">(</span><span class=\"token number\">64</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">unsigned</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"110\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>nid<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">bigint</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">unsigned</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">AUTO_INCREMENT</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"111\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>data_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"112\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>group_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"113\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>app_name<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'app_name'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"114\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>content<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">longtext</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"115\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>md5<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"116\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>gmt_create<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">datetime</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CURRENT_TIMESTAMP</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"117\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>gmt_modified<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">datetime</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CURRENT_TIMESTAMP</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"118\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>src_user<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">text</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"119\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>src_ip<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"120\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>op_type<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">char</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"121\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tenant_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token string\">''</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'租户字段'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"122\"></td><td><pre>  <span class=\"token keyword\">PRIMARY</span> <span class=\"token keyword\">KEY</span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>nid<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"123\"></td><td><pre>  <span class=\"token keyword\">KEY</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>idx_gmt_create<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>gmt_create<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"124\"></td><td><pre>  <span class=\"token keyword\">KEY</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>idx_gmt_modified<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>gmt_modified<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"125\"></td><td><pre>  <span class=\"token keyword\">KEY</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>idx_did<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>data_id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"126\"></td><td><pre><span class=\"token punctuation\">)</span> <span class=\"token keyword\">ENGINE</span><span class=\"token operator\">=</span><span class=\"token keyword\">InnoDB</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CHARSET</span><span class=\"token operator\">=</span>utf8 <span class=\"token keyword\">COLLATE</span><span class=\"token operator\">=</span>utf8_bin <span class=\"token keyword\">COMMENT</span><span class=\"token operator\">=</span><span class=\"token string\">'多租户改造'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"127\"></td><td><pre></pre></td></tr><tr><td data-num=\"128\"></td><td><pre></pre></td></tr><tr><td data-num=\"129\"></td><td><pre><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tenant_capacity<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"130\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">bigint</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">unsigned</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">AUTO_INCREMENT</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'主键ID'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"131\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tenant_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token string\">''</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'Tenant ID'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"132\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>quota<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">unsigned</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token string\">'0'</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'配额，0表示使用默认值'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"133\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>usage<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">unsigned</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token string\">'0'</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'使用量'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"134\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>max_size<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">unsigned</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token string\">'0'</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'单个配置大小上限，单位为字节，0表示使用默认值'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"135\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>max_aggr_count<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">unsigned</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token string\">'0'</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'聚合子配置最大个数'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"136\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>max_aggr_size<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">unsigned</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token string\">'0'</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'单个聚合数据的子配置大小上限，单位为字节，0表示使用默认值'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"137\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>max_history_count<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">unsigned</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token string\">'0'</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'最大变更历史数量'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"138\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>gmt_create<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">datetime</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CURRENT_TIMESTAMP</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'创建时间'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"139\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>gmt_modified<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">datetime</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CURRENT_TIMESTAMP</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'修改时间'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"140\"></td><td><pre>  <span class=\"token keyword\">PRIMARY</span> <span class=\"token keyword\">KEY</span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"141\"></td><td><pre>  <span class=\"token keyword\">UNIQUE</span> <span class=\"token keyword\">KEY</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>uk_tenant_id<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>tenant_id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"142\"></td><td><pre><span class=\"token punctuation\">)</span> <span class=\"token keyword\">ENGINE</span><span class=\"token operator\">=</span><span class=\"token keyword\">InnoDB</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CHARSET</span><span class=\"token operator\">=</span>utf8 <span class=\"token keyword\">COLLATE</span><span class=\"token operator\">=</span>utf8_bin <span class=\"token keyword\">COMMENT</span><span class=\"token operator\">=</span><span class=\"token string\">'租户容量信息表'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"143\"></td><td><pre></pre></td></tr><tr><td data-num=\"144\"></td><td><pre></pre></td></tr><tr><td data-num=\"145\"></td><td><pre><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tenant_info<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"146\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">bigint</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">AUTO_INCREMENT</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'id'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"147\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>kp<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'kp'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"148\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tenant_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">default</span> <span class=\"token string\">''</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'tenant_id'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"149\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tenant_name<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">default</span> <span class=\"token string\">''</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'tenant_name'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"150\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tenant_desc<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">256</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'tenant_desc'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"151\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>create_source<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'create_source'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"152\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>gmt_create<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">bigint</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'创建时间'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"153\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>gmt_modified<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">bigint</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">'修改时间'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"154\"></td><td><pre>  <span class=\"token keyword\">PRIMARY</span> <span class=\"token keyword\">KEY</span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"155\"></td><td><pre>  <span class=\"token keyword\">UNIQUE</span> <span class=\"token keyword\">KEY</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>uk_tenant_info_kptenantid<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>kp<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">,</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>tenant_id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"156\"></td><td><pre>  <span class=\"token keyword\">KEY</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>idx_tenant_id<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>tenant_id<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"157\"></td><td><pre><span class=\"token punctuation\">)</span> <span class=\"token keyword\">ENGINE</span><span class=\"token operator\">=</span><span class=\"token keyword\">InnoDB</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CHARSET</span><span class=\"token operator\">=</span>utf8 <span class=\"token keyword\">COLLATE</span><span class=\"token operator\">=</span>utf8_bin <span class=\"token keyword\">COMMENT</span><span class=\"token operator\">=</span><span class=\"token string\">'tenant_info'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"158\"></td><td><pre></pre></td></tr><tr><td data-num=\"159\"></td><td><pre><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>users<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"160\"></td><td><pre>\t<span class=\"token identifier\"><span class=\"token punctuation\">`</span>username<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">PRIMARY</span> <span class=\"token keyword\">KEY</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"161\"></td><td><pre>\t<span class=\"token identifier\"><span class=\"token punctuation\">`</span>password<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">500</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"162\"></td><td><pre>\t<span class=\"token identifier\"><span class=\"token punctuation\">`</span>enabled<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">boolean</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span></pre></td></tr><tr><td data-num=\"163\"></td><td><pre><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"164\"></td><td><pre></pre></td></tr><tr><td data-num=\"165\"></td><td><pre><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>roles<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"166\"></td><td><pre>\t<span class=\"token identifier\"><span class=\"token punctuation\">`</span>username<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"167\"></td><td><pre>\t<span class=\"token identifier\"><span class=\"token punctuation\">`</span>role<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"168\"></td><td><pre>\t<span class=\"token keyword\">UNIQUE</span> <span class=\"token keyword\">INDEX</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>idx_user_role<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>username<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">ASC</span><span class=\"token punctuation\">,</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>role<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">ASC</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">USING</span> <span class=\"token keyword\">BTREE</span></pre></td></tr><tr><td data-num=\"169\"></td><td><pre><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"170\"></td><td><pre></pre></td></tr><tr><td data-num=\"171\"></td><td><pre><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>permissions<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"172\"></td><td><pre>    <span class=\"token identifier\"><span class=\"token punctuation\">`</span>role<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"173\"></td><td><pre>    <span class=\"token identifier\"><span class=\"token punctuation\">`</span>resource<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"174\"></td><td><pre>    <span class=\"token identifier\"><span class=\"token punctuation\">`</span>action<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"175\"></td><td><pre>    <span class=\"token keyword\">UNIQUE</span> <span class=\"token keyword\">INDEX</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>uk_role_permission<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>role<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">,</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>resource<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">,</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>action<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">USING</span> <span class=\"token keyword\">BTREE</span></pre></td></tr><tr><td data-num=\"176\"></td><td><pre><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"177\"></td><td><pre></pre></td></tr><tr><td data-num=\"178\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> users <span class=\"token punctuation\">(</span>username<span class=\"token punctuation\">,</span> password<span class=\"token punctuation\">,</span> enabled<span class=\"token punctuation\">)</span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'nacos'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'$2a$10$EuWPZHzz32dJN7jexM34MOeYirDdFAZm2kuWj7VEOJhhZkDrxfvUu'</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">TRUE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"179\"></td><td><pre></pre></td></tr><tr><td data-num=\"180\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> roles <span class=\"token punctuation\">(</span>username<span class=\"token punctuation\">,</span> role<span class=\"token punctuation\">)</span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'nacos'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ROLE_ADMIN'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">###2 先留取备份</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">cp</span> application.properties application.properties.bk</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">vim</span> application.properties</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">### 在 application.properties 最后添加以下内容</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token assign-left variable\">spring.datasource.platform</span><span class=\"token operator\">=</span>mysql</pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token assign-left variable\">db.num</span><span class=\"token operator\">=</span><span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token assign-left variable\">db.url.0</span><span class=\"token operator\">=</span>jdbc:mysql://127.0.0.1:3306/nacos_config?characterEncoding<span class=\"token operator\">=</span>utf8<span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">connectTimeout</span><span class=\"token operator\">=</span><span class=\"token number\">1000</span><span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">socketTimeout</span><span class=\"token operator\">=</span><span class=\"token number\">3000</span><span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">autoReconnect</span><span class=\"token operator\">=</span>true<span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">serverTimezone</span><span class=\"token operator\">=</span>UTC</pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token assign-left variable\">db.user</span><span class=\"token operator\">=</span>root</pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token assign-left variable\">db.password</span><span class=\"token operator\">=</span>root</pre></td></tr></table></figure><h5 id=\"4-开启nacos\"><a class=\"anchor\" href=\"#4-开启nacos\">#</a> 4、开启 nacos</h5>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>/usr/local/nacos/bin/startup.sh</pre></td></tr></table></figure><h5 id=\"5-查看\"><a class=\"anchor\" href=\"#5-查看\">#</a> 5、查看</h5>\n<ul>\n<li>测试之前先关闭防火墙</li>\n</ul>\n<p><span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMS41Mjo4ODQ4L25hY29z\">http://192.168.1.52:8848/nacos</span></p>\n<h3 id=\"nacos集群配置\"><a class=\"anchor\" href=\"#nacos集群配置\">#</a> Nacos 集群配置</h3>\n<ul>\n<li>前提</li>\n</ul>\n<p>#&gt; 1、安装  <a href=\"#jdk_install\">jdk</a></p>\n<blockquote></blockquote>\n<p>#&gt; 2、安装之前必须 配置  <a href=\"#mysql_install\">mysql5.6.+</a></p>\n<blockquote></blockquote>\n<p>#&gt; 3、配置 <a href=\"#nginx_install_1\">nginx</a></p>\n<blockquote></blockquote>\n<p>#&gt; 4、配置 <a href=\"#nacos_install_1\">Nacos（单机版 - 1）</a></p>\n<ul>\n<li>懒加载</li>\n</ul>\n<blockquote>\n<p>我们启动 nginx 之后可能不会立即开始代理，打开日志等一会，没有结果的时候重配一下</p>\n</blockquote>\n<h4 id=\"1-2\"><a class=\"anchor\" href=\"#1-2\">#</a> ——1</h4>\n<p>#​\t* 此例中   <code>nginx:1.16</code>  安装教程为： <a href=\"#nacos_install_1\">Nacos（单机版 - 1）</a></p>\n<h5 id=\"1-修改集群配置文件\"><a class=\"anchor\" href=\"#1-修改集群配置文件\">#</a> 1、修改集群配置文件</h5>\n<p>​\t这里开始正式配置集群，首先我们要更改   <strong>cluter.conf</strong>   这个配置文件，当然我们也需要备份，但是这里它的<strong>原始名称</strong>为：<strong>cluster.conf.example</strong> ，我们需要把它保留同时复制出一个 cluster.conf 来进行更改</p>\n<p><strong>注：对于要集群启动的所有 nacos 都要做这步操作</strong></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">cd</span> /usr/local/nacos/conf</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">### 先备份</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">cp</span> cluster.conf.example cluster.conf</pre></td></tr></table></figure><p>修改 <code>cluster.conf</code></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">### 格式： ip 地址：端口号</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">###</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">### Copyright 1999-2018 Alibaba Group Holding Ltd.</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">###</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">### Licensed under the Apache License, Version 2.0 (the \"License\");</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">### you may not use this file except in compliance with the License.</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">### You may obtain a copy of the License at</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">###</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\">###      http://www.apache.org/licenses/LICENSE-2.0</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\">###</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\">### Unless required by applicable law or agreed to in writing, software</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\">### distributed under the License is distributed on an \"AS IS\" BASIS,</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\">### WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\">### See the License for the specific language governing permissions and</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\">### limitations under the License.</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token comment\">###</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token comment\">###it is ip</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token comment\">###example</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token comment\">###192.168.16.101:8847</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token comment\">###192.168.16.102</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token comment\">###192.168.16.10</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token comment\">###ip:port</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token number\">192.168</span>.124.133:3333</pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token number\">192.168</span>.124.133:4444</pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token number\">192.168</span>.124.133:5555</pre></td></tr></table></figure><h5 id=\"2-编辑nacos的启动脚本startupsh\"><a class=\"anchor\" href=\"#2-编辑nacos的启动脚本startupsh\">#</a> 2、<span class=\"exturl\" data-url=\"aHR0cDovL3huLS1OYWNvc3N0YXJ0dXAtYmg3dDI5bmx0MGd1azlicnA0YXZ1aDd2NWUuc2g=\">编辑 Nacos 的启动脚本 startup.sh</span></h5>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">cd</span> /usr/local/nacos/bin</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">### 先备份</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">cp</span> startup.sh starup.sh.bk</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">vim</span>  startup.sh</pre></td></tr></table></figure><figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">###1  在 while 的变量中添加 o 并且在 case 中添加对应处理</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>        o<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>            <span class=\"token assign-left variable\">PORT</span><span class=\"token operator\">=</span><span class=\"token variable\">$OPTARG</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        </pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">###2  在 nohup 和 \"$JAVA_OPT_EXT_FIX\" 之前配置这个</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>     <span class=\"token variable\">$JAVA</span> <span class=\"token parameter variable\">-Dserver.port</span><span class=\"token operator\">=</span><span class=\"token variable\">$&#123;PORT&#125;</span></pre></td></tr></table></figure><img data-src=\"/tools/Nacos-tool/1648643016965.png\" class=\"\">\n<img data-src=\"/tools/Nacos-tool/1648643157451.png\" class=\"\">\n<h5 id=\"3-配置nginx\"><a class=\"anchor\" href=\"#3-配置nginx\">#</a> 3、配置 nginx</h5>\n<p>下图是 http 的转发，但是还是 TCP 的更好</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>upstream  cluster<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\tserver <span class=\"token number\">192.168</span>.1.52:3333<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\tserver <span class=\"token number\">192.168</span>.1.52:4444<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\tserver <span class=\"token number\">192.168</span>.1.52:5555<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\tproxy_pass  http://cluter<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p><strong>图片中  <code>cluster</code>  写错了 少了一个 <code>s</code>  ，其实问题也不大，但是要专业～～</strong></p>\n<img data-src=\"/tools/Nacos-tool/1648643539716.png\" class=\"\">\n<p>TCP 格式：</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>worker_processes  <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>events <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    worker_connections  <span class=\"token number\">1024</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>stream <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      upstream nacos <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        server <span class=\"token number\">192.168</span>.1.52:8848<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        server <span class=\"token number\">192.168</span>.1.52:8868<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        server <span class=\"token number\">192.168</span>.1.52:8888<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>     server <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        listen  <span class=\"token number\">81</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        proxy_pass nacos<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>     <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h5 id=\"4-启动nginx\"><a class=\"anchor\" href=\"#4-启动nginx\">#</a> 4、启动 Nginx</h5>\n<pre><code class=\"language-shell\">\n</code></pre>\n<h5 id=\"5-查看测试\"><a class=\"anchor\" href=\"#5-查看测试\">#</a> 5、查看测试</h5>\n<p><span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMS41Mjo4MC9uYWNvcw==\">http://192.168.1.52:80/nacos</span></p>\n<h5 id=\"6-nacos持久化\"><a class=\"anchor\" href=\"#6-nacos持久化\">#</a> 6、Nacos 持久化</h5>\n<p>我们在配置的时候没有修改他的数据库，用的是自带的 deery，如果是真的要部署要修改成 mysql。这个熟悉</p>\n<ol>\n<li>在 Linux 系统上执行 SQL 脚本，具体位置在 nacos 目录下的 conf 中，这里的操作和之前是一样的，我们可以直接打开这个文件然后拷贝到数据库中执行，当然也是要创建数据库使用数据库然后在复制脚本内容，执行即可</li>\n</ol>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>create database nacos_config<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>use nacos_config<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><img data-src=\"/tools/Nacos-tool/image-20210929175710498.png\" class=\"\">\n<ol start=\"2\">\n<li>修改 application.properties 配置文件，但是修改之前我们最好做一个备份。</li>\n</ol>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>cp application<span class=\"token punctuation\">.</span>properties application<span class=\"token punctuation\">.</span>properties<span class=\"token punctuation\">.</span>init</pre></td></tr></table></figure><ol start=\"3\">\n<li>这里的修改和我们之间的在 win 上的修改是完全一样的，所以我们只要打开这个文件，加上对应的内容即可</li>\n</ol>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>spring<span class=\"token punctuation\">.</span>datasource<span class=\"token punctuation\">.</span>platform<span class=\"token operator\">=</span>mysql</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>db<span class=\"token punctuation\">.</span>num<span class=\"token operator\">=</span><span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>db<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">.</span><span class=\"token number\">0</span><span class=\"token operator\">=</span>jdbc<span class=\"token operator\">:</span>mysql<span class=\"token operator\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span><span class=\"token number\">127.0</span><span class=\"token number\">.0</span><span class=\"token number\">.1</span><span class=\"token operator\">:</span><span class=\"token number\">3306</span><span class=\"token operator\">/</span>nacos_config<span class=\"token operator\">?</span>characterEncoding<span class=\"token operator\">=</span>utf8<span class=\"token operator\">&amp;</span>connectTimeout<span class=\"token operator\">=</span><span class=\"token number\">1000</span><span class=\"token operator\">&amp;</span>socketTimeout<span class=\"token operator\">=</span><span class=\"token number\">3000</span><span class=\"token operator\">&amp;</span>autoReconnect<span class=\"token operator\">=</span><span class=\"token boolean\">true</span><span class=\"token operator\">&amp;</span>serverTimezone<span class=\"token operator\">=</span><span class=\"token constant\">UTC</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>db<span class=\"token punctuation\">.</span>user<span class=\"token operator\">=</span>root</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>db<span class=\"token punctuation\">.</span>password<span class=\"token operator\">=</span><span class=\"token number\">123456</span></pre></td></tr></table></figure><ol start=\"4\">\n<li>还要注意一点，如果是一台机子上部署要修改服务端口</li>\n</ol>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>#<span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> <span class=\"token class-name\">Spring</span> <span class=\"token class-name\">Boot</span> <span class=\"token class-name\">Related</span> <span class=\"token class-name\">Configurations</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span>#</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>##### <span class=\"token class-name\">Default</span> web context path<span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>server<span class=\"token punctuation\">.</span>servlet<span class=\"token punctuation\">.</span>contextPath<span class=\"token operator\">=</span><span class=\"token operator\">/</span>nacos</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>##### <span class=\"token class-name\">Default</span> web server port<span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>###f服务端口</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>server<span class=\"token punctuation\">.</span>port<span class=\"token operator\">=</span><span class=\"token number\">8888</span><span class=\"token operator\">/</span><span class=\"token number\">8868</span></pre></td></tr></table></figure>\n<div id=\"gitalk-container\"></div>\n<script src=\"https://cdn.bootcss.com/blueimp-md5/2.12.0/js/md5.min.js\"></script><link rel=\"stylesheet\" href=\"https://unpkg.com/gitalk/dist/gitalk.css\"><script src=\"https://unpkg.com/gitalk/dist/gitalk.min.js\"></script>\n\n\t\t<script>\n\t\tvar gitalkConfig = {\"clientID\":\"6db178ba46c8af8f6a6f\",\"clientSecret\":\"90f730e5956024596558df00975cd8eae28cae3d\",\"repo\":\"bk-comment01\",\"owner\":\"onlymarryu\",\"admin\":[\"onlymarryu\"],\"distractionFreeMode\":false,\"language\":\"zh-CN\",\"proxy\":\"https://gitalk-comments.netlify.app/github_access_token\",\"perPage\":15};\n\t    gitalkConfig.id = md5(location.pathname);\n\t\tvar gitalk = new Gitalk(gitalkConfig);\n\t    gitalk.render(\"gitalk-container\");\n\t    </script>",
            "tags": [
                "工具软件安装"
            ]
        },
        {
            "id": "http://yoursite.com/tools/MySQL-tool/",
            "url": "http://yoursite.com/tools/MySQL-tool/",
            "title": "MySQL",
            "date_published": "2022-10-15T04:52:38.166Z",
            "content_html": "<h3 id=\"mysql安装windows\"><a class=\"anchor\" href=\"#mysql安装windows\">#</a> MySQL 安装（Windows）</h3>\n<h4 id=\"1mysql的版本\"><a class=\"anchor\" href=\"#1mysql的版本\">#</a> 【1】MySQL 的版本：</h4>\n<p>近期主要历史版本有 5.0/5.1/5.5/5.6/5.7，目前最新版本是 MySQL8。6.0 曾经是个内部试验版本，已取消了。</p>\n<p>MySQL8.0 的版本历史</p>\n<ol>\n<li>2016-09-12 第一个 DM (development milestone) 版本 8.0.0 发布</li>\n<li>2018-04-19 第一个 GA (General Availability) 版本开始，8.0.11 发布</li>\n<li>2018-07-27 8.0.12GA 发布</li>\n<li>2018-10-22 8.0.13GA 发布</li>\n<li>2019-01-21 8.0.14GA 发布</li>\n<li>2019-02-01 8.0.15GA 发布</li>\n<li>最新的版本是 8.0.18,2019 年 10 月 14 日正式发布</li>\n<li>.... 后续更新</li>\n</ol>\n<h4 id=\"2官方下载地址\"><a class=\"anchor\" href=\"#2官方下载地址\">#</a> 【2】官方下载地址：</h4>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9kZXYubXlzcWwuY29tL2Rvd25sb2Fkcy93aW5kb3dzL2luc3RhbGxlci84LjAuaHRtbA==\">https://dev.mysql.com/downloads/windows/installer/8.0.html</span></p>\n<img data-src=\"/tools/MySQL-tool/1646193598821.png\" class=\"\">\n<h4 id=\"3安装过程\"><a class=\"anchor\" href=\"#3安装过程\">#</a> 【3】安装过程：</h4>\n<p><strong>1. 双击 MySQL 安装文件 mysql-installer-community-8.0.18.0.msi，出现安装类型选项。</strong></p>\n<ul>\n<li>\n<p>Developer Default：开发者默认</p>\n</li>\n<li>\n<p>Server only：只安装服务器端</p>\n</li>\n<li>\n<p>Client only：只安装客户端</p>\n</li>\n<li>\n<p>Full：安装全部选项</p>\n</li>\n<li>\n<p>Custom：自定义安装</p>\n</li>\n</ul>\n<img data-src=\"/tools/MySQL-tool/1646193860553.png\" class=\"\">\n<p><strong>2. 选择，然后继续：</strong></p>\n<img data-src=\"/tools/MySQL-tool/1646193913998.png\" class=\"\">\n<p><strong>3. 进入产品配置向导，配置多个安装细节，点击 Next 按钮即可。</strong></p>\n<img data-src=\"/tools/MySQL-tool/1646193920702.png\" class=\"\">\n<p><strong>4. 高可靠性 High Availability，采用默认选项即可。</strong></p>\n<ul>\n<li>\n<p>Standalone MySQL Server/Classic MySQL Replication: 独立 MySQL 服务器 / 经典 MySQL 复制</p>\n</li>\n<li>\n<p>InnoDB Cluster:InnoDB 集群</p>\n</li>\n</ul>\n<img data-src=\"/tools/MySQL-tool/1646193926612.png\" class=\"\">\n<p><strong>5. 类型和网络 Type and Networking，采用默认选项即可。记住 MySQL 的监听端口默认是 3306。</strong></p>\n<img data-src=\"/tools/MySQL-tool/1646193950590.png\" class=\"\">\n<p><strong>6. 身份验证方法 Authentication Method，采用默认选项即可。</strong></p>\n <img data-src=\"/tools/MySQL-tool/1646193956569.png\" class=\"\" width=\"1646193956569\">\n<p><strong>7. 账户和角色 Accounts and Roles。MySQL 管理员账户名称是 root，在此处指定 root 用户的密码。还可以在此处通过 Add User 按钮添加其他新账户，此处省略该操作。</strong></p>\n<img data-src=\"/tools/MySQL-tool/1646193968510.png\" class=\"\">\n<p><strong>8.Windows 服务：Windows Service。</strong></p>\n<ul>\n<li>\n<p>Configure MySQL Server as a Windows Service: 给 MySQL 服务器配置一个服务项。</p>\n</li>\n<li>\n<p>Windows Service Name: 服务名称，采用默认名称 MySQL80 即可。</p>\n</li>\n<li>\n<p>Start the MySQL at System Startup：系统启动时开启 MySQL 服务</p>\n</li>\n</ul>\n<img data-src=\"/tools/MySQL-tool/1646193985805.png\" class=\"\">\n<p><strong>9.Apply Configuration：点击 Execute 按钮执行开始应用这些配置项。</strong></p>\n<ul>\n<li>\n<p>Writing configuration file: 写配置文件。</p>\n</li>\n<li>\n<p>Updating Windows Firewall rules：更新 Windows 防火墙规则</p>\n</li>\n<li>\n<p>Adjusting Windows services：调整 Windows 服务</p>\n</li>\n<li>\n<p>Initializing database：初始化数据库</p>\n</li>\n<li>\n<p>Starting the server： 启动服务器</p>\n</li>\n<li>\n<p>Applying security setting：应用安全设置</p>\n</li>\n<li>\n<p>Updating the Start menu link：更新开始菜单快捷方式链接</p>\n</li>\n</ul>\n<img data-src=\"/tools/MySQL-tool/1646194015388.png\" class=\"\">\n<p><strong>PS：如果配置出错，查看右侧的 log，查看对应错误信息。</strong><br />\n<strong>执行完成后，如下图所示。单击 Finish 完成安装，进入产品配置环节。</strong></p>\n<img data-src=\"/tools/MySQL-tool/1646194023800.png\" class=\"\">\n<p><strong>10. 产品配置 Product Configuration 到此结束：点击 Next 按钮。</strong></p>\n<img data-src=\"/tools/MySQL-tool/1646194031356.png\" class=\"\">\n<p><strong>11. 安装完成 Installation Complete。点击 Finish 按钮完成安装。</strong></p>\n<img data-src=\"/tools/MySQL-tool/1646194038230.png\" class=\"\">\n<h4 id=\"4mysql配置-登录\"><a class=\"anchor\" href=\"#4mysql配置-登录\">#</a> 【4】MySQL 配置、登录</h4>\n<p><strong>【1】登录：</strong><br />\n访问 MySQL 服务器对应的命令：mysql.exe , 位置：C:\\Program Files\\MySQL\\MySQL Server 8.0\\bin</p>\n<img data-src=\"/tools/MySQL-tool/1646194179663.png\" class=\"\">\n<p>（mysql.exe 需要带参数执行，所以直接在图形界面下执行该命令会自动结束）</p>\n<p>打开控制命令台：win+r:</p>\n<img data-src=\"/tools/MySQL-tool/1646194204312.png\" class=\"\">\n<p>执行 mysql.exe 命令的时候出现错误：</p>\n<img data-src=\"/tools/MySQL-tool/1646194212295.png\" class=\"\">\n<p>需要配置环境变量 path:</p>\n<img data-src=\"/tools/MySQL-tool/1646194221073.png\" class=\"\">\n<p><strong>注意：控制命令台必须重启才会生效：</strong></p>\n<p><strong>登录的命令：mysql  -hlocalhost -uroot –p</strong></p>\n<ul>\n<li>\n<p>mysql：bin 目录下的文件 mysql.exe。mysql 是 MySQL 的命令行工具，是一个客户端软件，可以对任何主机的 mysql 服务（即后台运行的 mysqld）发起连接。</p>\n</li>\n<li>\n<p>-h：host 主机名。后面跟要访问的数据库服务器的地址；<strong>如果是登录本机，可以省略</strong></p>\n</li>\n<li>\n<p>-u：user 用户名。后面跟登录数据的用户名，第一次安装后以 root 用户来登录，是 MySQL 的管理员用户</p>\n</li>\n<li>\n<p>-p:   password 密码。一般不直接输入，而是回车后以保密方式输入。</p>\n  <img data-src=\"/tools/MySQL-tool/1646194262329.png\" class=\"\" width=\"1646194262329\">\n</li>\n</ul>\n<p><strong>【2】访问数据库</strong></p>\n<p>显示 MySQL 中的数据库列表：</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>show databases<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>默认有四个自带的数据库，每个数据库中可以有多个数据库表、视图等对象。</p>\n<p>切换当前数据库的命令：</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>use mysql<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><ul>\n<li>\n<p>MySQL 下可以有多个数据库，如果要访问哪个数据库，需要将其置为当前数据库。</p>\n</li>\n<li>\n<p>该命令的作用就是将数据库 mysql（默认提供的四个数据库之一的名字）置为当前数据库</p>\n</li>\n</ul>\n<p>显示当前数据库的所有数据库表：</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>show tables<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>MySQL 层次：不同项目对应不同的数据库组成 - 每个数据库中有很多表  - 每个表中有很多数据</p>\n<p><strong>【3】退出数据库</strong></p>\n<p>退出数据库可以使用 quit 或者 exit 命令完成，也可以用 \\q;  完成退出操作</p>\n<img data-src=\"/tools/MySQL-tool/1646194349092.png\" class=\"\">\n<h4 id=\"5卸载\"><a class=\"anchor\" href=\"#5卸载\">#</a> 【5】卸载</h4>\n<p><strong>1) 停止 MySQL 服务：在命令行模式下执行 net stop mysql 或者在 Windows 服务窗口下停止服务</strong></p>\n<img data-src=\"/tools/MySQL-tool/1646194422719.png\" class=\"\">\n<p><strong>2) 在控制面板中删除 MySQL 软件</strong></p>\n<img data-src=\"/tools/MySQL-tool/1646194431091.png\" class=\"\">\n<p><strong>3) 删除软件文件夹：直接删除安装文件夹 C:\\Program Files\\MySQL，其实此时该文件夹已经被删除或者剩下一个空文件夹。</strong></p>\n<p><strong>4) 删除数据文件夹：直接删除文件夹 C:\\ProgramData\\MySQL。此步不要忘记，否则会影响 MySQL 的再次安装。</strong><br />\n<strong>（ProgramData 文件夹可能是隐藏的，显示出来即可）</strong><br />\n<strong>（MySQL 文件下的内容才是真正的 MySQL 中数据）</strong></p>\n<p><strong>5) 删除 path 环境变量中关于 MySQL 安装路径的配置</strong></p>\n<h3 id=\"mysql-安装linux\"><a class=\"anchor\" href=\"#mysql-安装linux\">#</a> MySQL 安装（Linux）</h3>\n<h4 id=\"11\"><a class=\"anchor\" href=\"#11\">#</a> ——1.1</h4>\n<p>MySQL 安装</p>\n<h5 id=\"1-卸载原来的版本\"><a class=\"anchor\" href=\"#1-卸载原来的版本\">#</a> 1、卸载原来的版本</h5>\n<h6 id=\"1-查看mysql的安装情况\"><a class=\"anchor\" href=\"#1-查看mysql的安装情况\">#</a> 1、查看 mysql 的安装情况</h6>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">rpm</span> <span class=\"token parameter variable\">-qa</span> <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> <span class=\"token parameter variable\">-i</span> mysql</pre></td></tr></table></figure><img data-src=\"/tools/MySQL-tool/1570605325400.png\" class=\"\">\n<h6 id=\"2-删除上图安装的软件\"><a class=\"anchor\" href=\"#2-删除上图安装的软件\">#</a> 2、删除上图安装的软件</h6>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">rpm</span> <span class=\"token parameter variable\">-ev</span> <span class=\"token parameter variable\">--nodeps</span> mysql57-community-release-el5-7.noarch</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">rpm</span> <span class=\"token parameter variable\">-ev</span> <span class=\"token parameter variable\">--nodeps</span> mysql-community-server-5.7.18-1.el5.x86_64</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">rpm</span> <span class=\"token parameter variable\">-ev</span> <span class=\"token parameter variable\">--nodeps</span> mysql-community-client-5.7.18-1.el5.x86_64</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">rpm</span> <span class=\"token parameter variable\">-ev</span> <span class=\"token parameter variable\">--nodeps</span> mysql-community-libs-5.7.18-1.el5.x86_64</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">rpm</span> <span class=\"token parameter variable\">-ev</span> <span class=\"token parameter variable\">--nodeps</span> mysql-community-common-5.7.18-1.el5.x86_64</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">rpm</span> <span class=\"token parameter variable\">-ev</span> <span class=\"token parameter variable\">--nodeps</span> mysql-5.7.18-1.el5.x86_64</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">rpm</span> <span class=\"token parameter variable\">-ev</span> <span class=\"token parameter variable\">--nodeps</span> mysql-community-libs-compat-5.7.18-1.el5.x86_64</pre></td></tr></table></figure><h6 id=\"3-都删除成功之后查找相关的mysql的文件\"><a class=\"anchor\" href=\"#3-都删除成功之后查找相关的mysql的文件\">#</a> 3、都删除成功之后，查找相关的 mysql 的文件</h6>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">find</span> / <span class=\"token parameter variable\">-name</span> mysql</pre></td></tr></table></figure><img data-src=\"/tools/MySQL-tool/1570605553095.png\" class=\"\">\n<h6 id=\"4-删除全部文件\"><a class=\"anchor\" href=\"#4-删除全部文件\">#</a> 4、删除全部文件</h6>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">rm</span> <span class=\"token parameter variable\">-rf</span> /etc/selinux/targeted/active/modules/100/mysql</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">rm</span> <span class=\"token parameter variable\">-rf</span> /root/mysql</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">rm</span> <span class=\"token parameter variable\">-rf</span> /root/mysql/data/mysql</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">rm</span> <span class=\"token parameter variable\">-rf</span> /var/lib/mysql</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">rm</span> <span class=\"token parameter variable\">-rf</span> /var/lib/mysql/mysql</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">rm</span> <span class=\"token parameter variable\">-rf</span> /usr/share/mysql</pre></td></tr></table></figure><h6 id=\"5-再次执行命令\"><a class=\"anchor\" href=\"#5-再次执行命令\">#</a> 5、再次执行命令</h6>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">rpm</span> <span class=\"token parameter variable\">-qa</span> <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> <span class=\"token parameter variable\">-i</span> mysql</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">### 如果没有显式则表示卸载完成</span></pre></td></tr></table></figure><h5 id=\"2-删除mariadb-libs不可省略\"><a class=\"anchor\" href=\"#2-删除mariadb-libs不可省略\">#</a> 2、删除 mariadb-libs (不可省略)</h5>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">### 检查 mariadb-libs</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">rpm</span> -qa<span class=\"token operator\">|</span><span class=\"token function\">grep</span> mariadb</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">### 卸载 mariadb-libs</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>yum remove mariadb-libs</pre></td></tr></table></figure><h5 id=\"3-安装mysql\"><a class=\"anchor\" href=\"#3-安装mysql\">#</a> 3、安装 MySQL</h5>\n<h6 id=\"1输入\"><a class=\"anchor\" href=\"#1输入\">#</a> 1，输入</h6>\n<p>wegt <span class=\"exturl\" data-url=\"aHR0cHM6Ly9kZXYubXlzcWwuY29tL2dldC9teXNxbCVFNyU4OSU4OCVFNiU5QyVBQyVFNSU4RiVCNy1jb21tdW5pdHktcmVsZWFzZS1lbCVFNSVBNCVBNyVFNyU4OSU4OCVFNiU5QyVBQy0lRTUlQjAlOEYlRTclODklODglRTYlOUMlQUMubm9hcmNoLnJwbQ==\">https://dev.mysql.com/get/mysql 版本号 - community-release-el 大版本 - 小版本.noarch.rpm</span></p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">wget</span> https://dev.mysql.com/get/mysql57-community-release-el5-7.noarch.rpm</pre></td></tr></table></figure><h6 id=\"2-安装数据源\"><a class=\"anchor\" href=\"#2-安装数据源\">#</a> 2、安装数据源</h6>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>yum <span class=\"token function\">install</span> mysql57-community-release-el5-7.noarch.rpm</pre></td></tr></table></figure><h6 id=\"3-查看mysql源是否安装成功\"><a class=\"anchor\" href=\"#3-查看mysql源是否安装成功\">#</a> 3、查看 mysql 源是否安装成功</h6>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>yum repolist enabled <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> <span class=\"token string\">\"mysql.*-community.*\"</span></pre></td></tr></table></figure><h6 id=\"4-安装数据库\"><a class=\"anchor\" href=\"#4-安装数据库\">#</a> 4、安装数据库</h6>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>yum <span class=\"token function\">install</span> mysql-community-server</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">### 如果过期可以在运行安装程序之前导入密钥</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">rpm</span> <span class=\"token parameter variable\">--import</span> https://repo.mysql.com/RPM-GPG-KEY-mysql-2022</pre></td></tr></table></figure><h6 id=\"5-启动mysql\"><a class=\"anchor\" href=\"#5-启动mysql\">#</a> 5、启动 mysql</h6>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">### centos7</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>systemctl restart mysqld</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>systemctl status mysqld</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">### centos6</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">service</span> mysqld start</pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token function\">service</span> mysqld status</pre></td></tr></table></figure><h6 id=\"6-显示mysql的随机密码\"><a class=\"anchor\" href=\"#6-显示mysql的随机密码\">#</a> 6、显示 mysql 的随机密码</h6>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">grep</span> <span class=\"token string\">'temporary password'</span> /var/log/mysqld.log</pre></td></tr></table></figure><img data-src=\"/tools/MySQL-tool/image-20220827193405451.png\" class=\"\">\n<h6 id=\"7-登录并修改mysql密码\"><a class=\"anchor\" href=\"#7-登录并修改mysql密码\">#</a> 7、登录并修改 mysql 密码</h6>\n<p>登录：mysql -u root -p   \t\t然后输入上面生成的密码</p>\n<p><strong><em>修改自定义密码，设置自己想要的密码</em></strong></p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">-- ALTER USER 'root'@'localhost' IDENTIFIED BY ' 密码 ';</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">ALTER</span> <span class=\"token keyword\">USER</span> <span class=\"token string\">'root'</span><span class=\"token variable\">@'localhost'</span> IDENTIFIED <span class=\"token keyword\">BY</span> <span class=\"token string\">'root'</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p><strong><em>失败了的话就修改策略，将策略降低一下就可以了</em></strong></p>\n<p>查看密码策略：</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">SHOW</span> VARIABLES <span class=\"token operator\">LIKE</span> <span class=\"token string\">'validate_password%'</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>修改密码策略</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">-- 修改密码长度：（长度）</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">set</span> <span class=\"token keyword\">global</span> validate_password<span class=\"token punctuation\">.</span>length<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">-- 修改密码等级：（等级）</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">set</span> <span class=\"token keyword\">global</span> validate_password<span class=\"token punctuation\">.</span>policy<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h5 id=\"4-其他配置\"><a class=\"anchor\" href=\"#4-其他配置\">#</a> 4、其他配置</h5>\n<h6 id=\"1开机自启\"><a class=\"anchor\" href=\"#1开机自启\">#</a> 1. 开机自启</h6>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">### 开机启动</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>systemctl <span class=\"token builtin class-name\">enable</span> mysql</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">### 关闭自动启动</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>systemctl disable mysqld</pre></td></tr></table></figure><h6 id=\"2远程连接\"><a class=\"anchor\" href=\"#2远程连接\">#</a> 2. 远程连接</h6>\n<h6 id=\"方法一-创建一个用户-支持远程连接\"><a class=\"anchor\" href=\"#方法一-创建一个用户-支持远程连接\">#</a> 方法一、创建一个用户 支持远程连接</h6>\n<p>①登录 ：mysql -u root -p</p>\n<p>②创建用户： create user 'aaa'@'%' identified by '123456';</p>\n<p>③授权所有权限给 user 这个新用户 ：grant all on <em>.</em> to 'aaa'@'%';</p>\n<p>④退出 mysql：quit;</p>\n<h6 id=\"方法二-设置root用户支持远程连接\"><a class=\"anchor\" href=\"#方法二-设置root用户支持远程连接\">#</a> 方法二、设置 root 用户支持远程连接</h6>\n<p>①登录：mysql -u root -p （ 注：系统提示输入数据库 root 用户的密码，输入完成后即进入 mysql 控制台，这个命令的第一个 mysql 是执行命令，第二个 mysql 是系统数据名称，不一样的。）</p>\n<p>②设置权限：</p>\n<p>赋予权限格式： grant 权限 on 数据库对象 to 用户 @IP (或者相应正则)</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">-- 新建用户规则或者直接修改 root 用户的规则 ，2 选一</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">use</span> mysql<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">-- 这里表示赋予该用户所有数据库所有表（*.* 表示所有表），% 表示所有 IP 地址。</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">GRANT</span> <span class=\"token keyword\">ALL</span> <span class=\"token keyword\">PRIVILEGES</span> <span class=\"token keyword\">ON</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">.</span><span class=\"token operator\">*</span> <span class=\"token keyword\">TO</span> <span class=\"token string\">'root'</span><span class=\"token variable\">@'%'</span> IDENTIFIED <span class=\"token keyword\">BY</span> <span class=\"token string\">'123456'</span> <span class=\"token keyword\">WITH</span> <span class=\"token keyword\">GRANT</span> <span class=\"token keyword\">OPTION</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">-- 使 root 能再任何 host 访问</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">update</span> <span class=\"token keyword\">user</span> <span class=\"token keyword\">set</span> host <span class=\"token operator\">=</span> <span class=\"token string\">'%'</span> <span class=\"token keyword\">where</span> <span class=\"token keyword\">user</span> <span class=\"token operator\">=</span> <span class=\"token string\">'root'</span><span class=\"token punctuation\">;</span>      </pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\">-- 刷新</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>FLUSH <span class=\"token keyword\">PRIVILEGES</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>③查看：</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">use</span> mysql<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">SELECT</span> HOST<span class=\"token punctuation\">,</span><span class=\"token keyword\">USER</span> <span class=\"token keyword\">FROM</span> <span class=\"token keyword\">USER</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><img data-src=\"/tools/MySQL-tool/920952e9041b4af1a8a49eb64e0f4430.jpeg\" class=\"\">\n<p>④退出 mysql：quit;</p>\n<h4 id=\"2\"><a class=\"anchor\" href=\"#2\">#</a> ——2</h4>\n<h5 id=\"1-查询镜像\"><a class=\"anchor\" href=\"#1-查询镜像\">#</a> 1、查询镜像</h5>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> search mysql</pre></td></tr></table></figure><h5 id=\"2-拉取镜像\"><a class=\"anchor\" href=\"#2-拉取镜像\">#</a> 2、拉取镜像</h5>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> pull mysql:5.7</pre></td></tr></table></figure><h5 id=\"3-构建容器\"><a class=\"anchor\" href=\"#3-构建容器\">#</a> 3、构建容器</h5>\n<p>先自己创建配置文件基础模板（<strong>要是后期要修改配置文件必须加入 模板中的两个元素，不然容器启动会出错</strong>）</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">mkdir</span> <span class=\"token parameter variable\">-p</span> /root/mysql/conf</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">vim</span>  /root/mysql/conf/my.cnf</pre></td></tr></table></figure><p><strong>模板内容：</strong></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">### Copyright (c) 2016, 2021, Oracle and/or its affiliates.</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">###</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">### This program is free software; you can redistribute it and/or modify</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">### it under the terms of the GNU General Public License, version 2.0,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">### as published by the Free Software Foundation.</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">###</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">### This program is also distributed with certain software (including</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">### but not limited to OpenSSL) that is licensed under separate terms,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\">### as designated in a particular file or component or in included license</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\">### documentation.  The authors of MySQL hereby grant you an additional</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\">### permission to link the program and your derivative works with the</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\">### separately licensed software that they have included with MySQL.</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\">###</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\">### This program is distributed in the hope that it will be useful,</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\">### but WITHOUT ANY WARRANTY; without even the implied warranty of</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token comment\">### MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token comment\">### GNU General Public License, version 2.0, for more details.</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token comment\">###</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token comment\">### You should have received a copy of the GNU General Public License</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token comment\">### along with this program; if not, write to the Free Software</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token comment\">### Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301 USA</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token operator\">!</span>includedir /etc/mysql/conf.d/</pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token operator\">!</span>includedir /etc/mysql/mysql.conf.d/</pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token punctuation\">[</span>mysql<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>default-character-set<span class=\"token operator\">=</span>utf8</pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token punctuation\">[</span>mysqld<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token assign-left variable\">character_set_server</span><span class=\"token operator\">=</span>utf8</pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token assign-left variable\">init_connect</span><span class=\"token operator\">=</span><span class=\"token string\">'SET NAMES utf8'</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>lower_case_table_names <span class=\"token operator\">=</span> <span class=\"token number\">1</span></pre></td></tr></table></figure><p><strong>构建容器</strong></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> run <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token parameter variable\">-p</span> <span class=\"token number\">3306</span>:3306 <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token parameter variable\">-v</span> /root/mysql/data:/var/lib/mysql <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token parameter variable\">-v</span> /root/mysql/logs:/logs <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token parameter variable\">-v</span> /root/.bashrc:/root/.bashrc <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token parameter variable\">-v</span> /root/mysql/conf/my.cnf:/etc/mysql/my.cnf <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token parameter variable\">-e</span> <span class=\"token assign-left variable\">MYSQL_ROOT_PASSWORD</span><span class=\"token operator\">=</span>root <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token parameter variable\">--name</span> mysql <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token parameter variable\">--hostname</span> node1 <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token parameter variable\">--restart</span><span class=\"token operator\">=</span>always <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token parameter variable\">-d</span> mysql:5.7</pre></td></tr></table></figure><p><strong>注</strong>：出错时将本地映射文件检查一下，要是不需要配置，只需映射直接删掉就可，以后再改配置文件</p>\n<h5 id=\"4-进入容器\"><a class=\"anchor\" href=\"#4-进入容器\">#</a> 4、进入容器</h5>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> <span class=\"token builtin class-name\">exec</span> <span class=\"token parameter variable\">-it</span> mysql /bin/bash</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>或者</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">docker</span> <span class=\"token builtin class-name\">exec</span> <span class=\"token parameter variable\">-it</span> mysql mysql <span class=\"token parameter variable\">-uroot</span> <span class=\"token parameter variable\">-p</span></pre></td></tr></table></figure><h5 id=\"5-查看远程连接\"><a class=\"anchor\" href=\"#5-查看远程连接\">#</a> 5、查看远程连接</h5>\n<p>还有一些方法也可以试一下</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">1</span>.赋予权限格式：grant 权限 on 数据库对象 to 用户@IP<span class=\"token punctuation\">(</span>或者相应正则<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>　　　　注：可以赋予select,delete,update,insert,index等权限精确到某一个数据库某一个表。</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>　　　　GRANT ALL PRIVILEGES ON *.* TO <span class=\"token string\">'用户名'</span>@<span class=\"token string\">'%'</span> IDENTIFIED BY <span class=\"token string\">'密码'</span> WITH GRANT OPTION<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t  GRANT ALL PRIVILEGES ON *.* TO <span class=\"token string\">'root'</span>@<span class=\"token string\">'%'</span> IDENTIFIED BY <span class=\"token string\">'123456'</span> WITH GRANT OPTION<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>　　　　这里表示赋予该用户所有数据库所有表（*.*表示所有表），%表示所有IP地址。</pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token number\">2</span>.刷新权限：FLUSH PRIVILEGES<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token number\">3</span>.查看权限：select user,host from mysql.user<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>二.意外</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>　　<span class=\"token number\">1</span>.配置文件种指定了blind-address：</pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token comment\">#　　　　查看 Mysql 配置文件种（一般是 /etc/my.cnf 种）是否指定了 blind-address，这表示只能是某个或某几个 ip 能连接。如果有就将它注释了，前面加 #号注释。然后从启 mysql。</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    　重启mysql：service mysqld restart,如果安装的是Mariadb（我的就是）,则需要使用systemctl restart mariadb.service</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    　</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token number\">2</span>.防火墙的原因：</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>　　　　可能会报：ERROR <span class=\"token number\">2003</span> <span class=\"token punctuation\">(</span>HY000<span class=\"token punctuation\">)</span>: Can<span class=\"token string\">'t connect to MySQL server on '</span>你要连接的IP<span class=\"token string\">' (111)。</pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>　　　　原因：1.可能是Mysql端口不对（默认是3306），只需加参数 -P 你的端口指定就行；</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>　　　　</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>　　　2.还有可能是有防火墙阻止，可以通过telnet来测试（可以直接关闭防火墙）。</pre></td></tr><tr><td data-num=\"25\"></td><td><pre>　　　　　　　　　　防火墙相关命令：</pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>　　　　　　　　　　　　（1）查看防火墙状态：service  iptables status或者systemctl status firewalld或者firewall-cmd --state</pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>　　　　　　　　　　　　（2）暂时关闭防火墙：systemctl stop firewalld或者service  iptables stop或者systemctl stop firewalld.service</pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>　　　　　　　　　　　　（3）永久关闭防火墙：systemctl disable firewalld或者chkconfig iptables off或者systemctl disable firewalld.service</pre></td></tr><tr><td data-num=\"32\"></td><td><pre></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>　　　　　　　　　　　　（4）重启防火墙：systemctl enable firewalld或者service iptables restart  或者systemctl restart firewalld.service</pre></td></tr><tr><td data-num=\"34\"></td><td><pre></pre></td></tr><tr><td data-num=\"35\"></td><td><pre> 　　　　　　　　　　　　 (5)永久关闭后重启：chkconfig iptables on</pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>　　</pre></td></tr><tr><td data-num=\"38\"></td><td><pre></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>　　3.端口未开启：（我遇到的就是这个原因）</pre></td></tr><tr><td data-num=\"40\"></td><td><pre>　　　　　　Mysql：ERROR 2003 (HY000) 110（连接超时）</pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>　　　　　　查看你的服务器是否把对应端口打开，未打开启动就行了。　</pre></td></tr><tr><td data-num=\"43\"></td><td><pre>　　　　　　</pre></td></tr><tr><td data-num=\"44\"></td><td><pre>   4.Navicat连接MySQL，出现2059 - authentication plugin '</span>caching_sha2_password<span class=\"token string\">'的解决方案</pre></td></tr><tr><td data-num=\"45\"></td><td><pre>  \t</pre></td></tr><tr><td data-num=\"46\"></td><td><pre>  \t0先进入容器，</pre></td></tr><tr><td data-num=\"47\"></td><td><pre>  \tdocker exec -it mysql mysql -uroot -p</pre></td></tr><tr><td data-num=\"48\"></td><td><pre>  \t</pre></td></tr><tr><td data-num=\"49\"></td><td><pre>#  \t1#修改加密规则password是自己的密码，root也是登陆账户，下同。</pre></td></tr><tr><td data-num=\"50\"></td><td><pre>  \tuse mysql;</pre></td></tr><tr><td data-num=\"51\"></td><td><pre>    ALTER USER '</span>root<span class=\"token string\">'@'</span>localhost<span class=\"token string\">' IDENTIFIED BY '</span>root<span class=\"token string\">' PASSWORD EXPIRE NEVER; </pre></td></tr><tr><td data-num=\"52\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"53\"></td><td><pre>##\t2 #更新一下用户的密码 </pre></td></tr><tr><td data-num=\"54\"></td><td><pre>\tALTER USER '</span>root<span class=\"token string\">'@'</span>localhost<span class=\"token string\">' IDENTIFIED WITH mysql_native_password BY '</span>root<span class=\"token string\">';</pre></td></tr><tr><td data-num=\"55\"></td><td><pre>\t</pre></td></tr><tr><td data-num=\"56\"></td><td><pre>##\t3#刷新权限 </pre></td></tr><tr><td data-num=\"57\"></td><td><pre>\tFLUSH PRIVILEGES; </pre></td></tr><tr><td data-num=\"58\"></td><td><pre>\t</pre></td></tr><tr><td data-num=\"59\"></td><td><pre>##\t4#更新一下用户的密码</pre></td></tr><tr><td data-num=\"60\"></td><td><pre>\tALTER USER '</span>root<span class=\"token string\">'@'</span>%<span class=\"token string\">' IDENTIFIED WITH mysql_native_password BY '</span>root'<span class=\"token punctuation\">;</span></pre></td></tr></table></figure>\n<div id=\"gitalk-container\"></div>\n<script src=\"https://cdn.bootcss.com/blueimp-md5/2.12.0/js/md5.min.js\"></script><link rel=\"stylesheet\" href=\"https://unpkg.com/gitalk/dist/gitalk.css\"><script src=\"https://unpkg.com/gitalk/dist/gitalk.min.js\"></script>\n\n\t\t<script>\n\t\tvar gitalkConfig = {\"clientID\":\"6db178ba46c8af8f6a6f\",\"clientSecret\":\"90f730e5956024596558df00975cd8eae28cae3d\",\"repo\":\"bk-comment01\",\"owner\":\"onlymarryu\",\"admin\":[\"onlymarryu\"],\"distractionFreeMode\":false,\"language\":\"zh-CN\",\"proxy\":\"https://gitalk-comments.netlify.app/github_access_token\",\"perPage\":15};\n\t    gitalkConfig.id = md5(location.pathname);\n\t\tvar gitalk = new Gitalk(gitalkConfig);\n\t    gitalk.render(\"gitalk-container\");\n\t    </script>",
            "tags": [
                "工具软件安装"
            ]
        },
        {
            "id": "http://yoursite.com/tools/MyCat-tool/",
            "url": "http://yoursite.com/tools/MyCat-tool/",
            "title": "MyCat",
            "date_published": "2022-10-15T04:52:38.160Z",
            "content_html": "<h2 id=\"mycatlinux\"><a class=\"anchor\" href=\"#mycatlinux\">#</a> MyCat（Linux）</h2>\n<h3 id=\"server安装\"><a class=\"anchor\" href=\"#server安装\">#</a> (Server 安装)</h3>\n<ul>\n<li>前提：</li>\n</ul>\n<p>#* 1、<a href=\"#jdk_install\">jdk 安装</a></p>\n<p>#* 2、<a href=\"#mysql_install\">mysql 安装</a></p>\n<ul>\n<li>\n<p>官网：<span class=\"exturl\" data-url=\"aHR0cDovL3d3dy5teWNhdC5vcmcuY24v\">http://www.mycat.org.cn/</span></p>\n</li>\n<li>\n<p>首先准备四台虚拟机，安装好 mysql，方便后续做读写分离和主从复制。<strong>(3.3 内容)</strong></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">192.168</span>.85.45 node01</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">192.168</span>.85.46 node02</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">192.168</span>.85.47 node03</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token number\">192.168</span>.85.48 node04</pre></td></tr></table></figure></li>\n</ul>\n<h4 id=\"1-下载mycat\"><a class=\"anchor\" href=\"#1-下载mycat\">#</a> 1、下载 MyCat</h4>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL2RsLm15Y2F0Lm9yZy5jbi8xLjYuNy42LzIwMjEwOTMwMjEzMDQ5L015Y2F0LXNlcnZlci0xLjYuNy42LXJlbGVhc2UtMjAyMTA5MzAyMTMwNDktbGludXgudGFyLmd6\">http://dl.mycat.org.cn/1.6.7.6/20210930213049/Mycat-server-1.6.7.6-release-20210930213049-linux.tar.gz</span></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>windows下载安装包</pre></td></tr></table></figure><h4 id=\"2-上传并解压压缩文件\"><a class=\"anchor\" href=\"#2-上传并解压压缩文件\">#</a> 2、上传并解压压缩文件</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">tar</span> <span class=\"token parameter variable\">-zxvf</span> Mycat-server-1.6.7.5-release-20200422133810-linux.tar.gz <span class=\"token parameter variable\">-C</span> /usr/local/</pre></td></tr></table></figure><h4 id=\"3-修改配置\"><a class=\"anchor\" href=\"#3-修改配置\">#</a> 3、修改配置</h4>\n<p>0、配置环境变量（可选）</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">vim</span> /etc/profile</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">### 添加如下配置信息：</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">MYCAT_HOME</span><span class=\"token operator\">=</span>/usr/local/mycat</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\"><span class=\"token environment constant\">PATH</span></span><span class=\"token operator\">=</span><span class=\"token variable\">$MYCAT_HOME</span>/bin:<span class=\"token environment constant\">$PATH</span><span class=\"token builtin class-name\">:</span><span class=\"token variable\">$JAVA_HOME</span>/bin</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">### 生效</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token builtin class-name\">source</span> /etc/profile</pre></td></tr></table></figure><p><strong>修改 server.xml schema.xml 之前先备份</strong></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">cd</span> /usr/local/mycat</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token builtin class-name\">cd</span> conf</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">cp</span> server.xml server.xml.list</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">cp</span> schema.xml schema.xml.list</pre></td></tr></table></figure><p>1、修改完成后的  <strong>server.xml</strong></p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token prolog\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">&lt;!-- - - Licensed under the Apache License, Version 2.0 (the \"License\"); </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        - you may not use this file except in compliance with the License. - You </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        may obtain a copy of the License at - - http://www.apache.org/licenses/LICENSE-2.0 </pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        - - Unless required by applicable law or agreed to in writing, software - </pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        distributed under the License is distributed on an \"AS IS\" BASIS, - WITHOUT </pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. - See the </pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        License for the specific language governing permissions and - limitations </pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        under the License. --></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">mycat:server</span> <span class=\"token name\">SYSTEM</span> <span class=\"token string\">\"server.dtd\"</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token namespace\">mycat:</span>server</span> <span class=\"token attr-name\"><span class=\"token namespace\">xmlns:</span>mycat</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://io.mycat/<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>user</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>root<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">defaultAccount</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>true<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>password<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>root<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>schemas<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>TESTDB<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>property</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>defaultSchema<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>TESTDB<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>property</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>user</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token namespace\">mycat:</span>server</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>2、修改完成后的 schema.xml</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token prolog\">&lt;?xml version=\"1.0\"?></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">mycat:schema</span> <span class=\"token name\">SYSTEM</span> <span class=\"token string\">\"schema.dtd\"</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token namespace\">mycat:</span>schema</span> <span class=\"token attr-name\"><span class=\"token namespace\">xmlns:</span>mycat</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://io.mycat/<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>schema</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>TESTDB<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">checkSQLschema</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>false<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">sqlMaxLimit</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>100<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">dataNode</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>dn1<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>schema</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dataNode</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>dn1<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">dataHost</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>host1<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">database</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>msb<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dataHost</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>host1<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">maxCon</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>1000<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">minCon</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>10<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">balance</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>                          <span class=\"token attr-name\">writeType</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">dbType</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>mysql<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">dbDriver</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>native<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">switchType</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>1<span class=\"token punctuation\">\"</span></span>  <span class=\"token attr-name\">slaveThreshold</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>100<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>heartbeat</span><span class=\"token punctuation\">></span></span>select user()<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>heartbeat</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>writeHost</span> <span class=\"token attr-name\">host</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>hostM1<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">url</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>192.168.1.45:3306<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">user</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>root<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>                                   <span class=\"token attr-name\">password</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>root<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                         <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>readHost</span> <span class=\"token attr-name\">host</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>hostS1<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">url</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>192.168.1.46:3306<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">user</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>root<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">password</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>root<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>readHost</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>writeHost</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dataHost</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token namespace\">mycat:</span>schema</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>3、修改 <strong>hosts</strong>  文件</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">vim</span> /etc/hosts</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">### 添加</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">###ip name</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">192.168</span>.1.164 node01</pre></td></tr></table></figure><h4 id=\"4-启动mycat\"><a class=\"anchor\" href=\"#4-启动mycat\">#</a> 4、启动 mycat</h4>\n<p>​\t\tmycat 的启动有两种方式，一种是控制台启动，一种是后台启动，在初学的时候建议大家使用控制台启动的方式，当配置文件写错之后，可以方便的看到错误，及时修改，但是在生产环境中，使用后台启动的方式比较稳妥。</p>\n<p>​\t\t<strong>控制台启动：</strong></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">cd</span> /usrlocal/mycat/bin</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>./mycat console</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">### 加入环境变量后可直接启动</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>mycat console</pre></td></tr></table></figure><p>​\t\t<strong>后台启动：</strong></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">cd</span> /usrlocal/mycat/bin</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>./mycat start</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">### 加入环境变量后可直接启动</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>mycat start</pre></td></tr></table></figure><p>​\t\t按照如上配置在安装的时候应该不会报错，如果出现错误，根据错误的提示解决即可。</p>\n<h4 id=\"5-登录验证\"><a class=\"anchor\" href=\"#5-登录验证\">#</a> 5、登录验证</h4>\n<p>​\t\t<strong>管理窗口的登录</strong></p>\n<p>​\t\t从另外的虚拟机去登录访问当前 mycat，输入如下命令即可</p>\n<pre><code>mysql -uroot -proot -P 9066 -h ip\n</code></pre>\n<p>​\t\t此时访问的是 mycat 的管理窗口，可以通过 show @@help 查看可以执行的命令</p>\n<p>​\t\t<strong>数据窗口的登录</strong></p>\n<p>​\t\t从另外的虚拟机去登录访问 mycat，输入命令如下：【用户设置】</p>\n<pre><code>mysql -uroot -proot -P8066 -h ip\n</code></pre>\n<p>​\t\t当都能够成功的时候以为着 mycat 已经搭建完成。</p>\n<h3 id=\"mycat-web\"><a class=\"anchor\" href=\"#mycat-web\">#</a> mycat-web</h3>\n<h4 id=\"1\"><a class=\"anchor\" href=\"#1\">#</a> ——1</h4>\n<h5 id=\"1-下载mycat-web安装包\"><a class=\"anchor\" href=\"#1-下载mycat-web安装包\">#</a> 1、下载 mycat-web 安装包</h5>\n<p>​\t官方地址：<span class=\"exturl\" data-url=\"aHR0cDovL2RsLm15Y2F0Lm9yZy5jbi8=\">http://dl.mycat.org.cn/</span></p>\n<h5 id=\"2-解压安装包到usrlocal目录\"><a class=\"anchor\" href=\"#2-解压安装包到usrlocal目录\">#</a> 2、解压安装包到 /usr/local 目录</h5>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">tar</span> <span class=\"token parameter variable\">-zxvf</span> Mycat-web-1.0-SNAPSHOT-20170102153329-linux.tar.gz <span class=\"token parameter variable\">-C</span> /usr/local/</pre></td></tr></table></figure><h4 id=\"3-进入mycat-web的目录运行启动命令\"><a class=\"anchor\" href=\"#3-进入mycat-web的目录运行启动命令\">#</a> 3、进入 mycat-web 的目录运行启动命令</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>./start.sh <span class=\"token operator\">&amp;</span></pre></td></tr></table></figure><h4 id=\"4-mycat-web的服务端口是8082查看服务是否启动\"><a class=\"anchor\" href=\"#4-mycat-web的服务端口是8082查看服务是否启动\">#</a> 4、mycat-web 的服务端口是 8082，查看服务是否启动</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">netstat</span> <span class=\"token parameter variable\">-nlpt</span> <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> <span class=\"token number\">8082</span></pre></td></tr></table></figure><h4 id=\"5-通过地址访问服务\"><a class=\"anchor\" href=\"#5-通过地址访问服务\">#</a> 5、通过地址访问服务</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">192.168</span>.1.164:8082/mycat/</pre></td></tr></table></figure><h4 id=\"6-mycat-web配置\"><a class=\"anchor\" href=\"#6-mycat-web配置\">#</a> 6、mycat-web 配置</h4>\n<h5 id=\"61-配置zookeeper可选\"><a class=\"anchor\" href=\"#61-配置zookeeper可选\">#</a> 6.1、配置 zookeeper (可选)</h5>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">cd</span> /usr/local/mycat-web/mycat-web/WEB-INF/classes</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">### 修改 mycat.properties 文件，可以修改 zookeeper 的地址</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">vim</span> mycat.properties</pre></td></tr></table></figure><h5 id=\"62-添加mycat实例\"><a class=\"anchor\" href=\"#62-添加mycat实例\">#</a> 6.2、添加 mycat 实例</h5>\n<pre><code>* 在页面的mycat配置\n\n* mycat服务管理中添加mycat实例，需要填写相关的参数\n</code></pre>\n\n<div id=\"gitalk-container\"></div>\n<script src=\"https://cdn.bootcss.com/blueimp-md5/2.12.0/js/md5.min.js\"></script><link rel=\"stylesheet\" href=\"https://unpkg.com/gitalk/dist/gitalk.css\"><script src=\"https://unpkg.com/gitalk/dist/gitalk.min.js\"></script>\n\n\t\t<script>\n\t\tvar gitalkConfig = {\"clientID\":\"6db178ba46c8af8f6a6f\",\"clientSecret\":\"90f730e5956024596558df00975cd8eae28cae3d\",\"repo\":\"bk-comment01\",\"owner\":\"onlymarryu\",\"admin\":[\"onlymarryu\"],\"distractionFreeMode\":false,\"language\":\"zh-CN\",\"proxy\":\"https://gitalk-comments.netlify.app/github_access_token\",\"perPage\":15};\n\t    gitalkConfig.id = md5(location.pathname);\n\t\tvar gitalk = new Gitalk(gitalkConfig);\n\t    gitalk.render(\"gitalk-container\");\n\t    </script>",
            "tags": [
                "工具软件安装"
            ]
        },
        {
            "id": "http://yoursite.com/tools/Keepalived-tool/",
            "url": "http://yoursite.com/tools/Keepalived-tool/",
            "title": "Keepalived",
            "date_published": "2022-10-15T04:52:38.149Z",
            "content_html": "<h3 id=\"keepalived安装\"><a class=\"anchor\" href=\"#keepalived安装\">#</a> Keepalived 安装</h3>\n<h4 id=\"1\"><a class=\"anchor\" href=\"#1\">#</a> ——1</h4>\n<h5 id=\"1-准备好keepalived安装包\"><a class=\"anchor\" href=\"#1-准备好keepalived安装包\">#</a> 1、准备好 Keepalived 安装包</h5>\n<h5 id=\"2-解压到usrlocal目录\"><a class=\"anchor\" href=\"#2-解压到usrlocal目录\">#</a> 2、解压到 /usr/local 目录</h5>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">tar</span> <span class=\"token parameter variable\">-zxvf</span> /usr/local/tmp/keepalived-1.4.5.tar.gz <span class=\"token parameter variable\">-C</span> /usr/local/</pre></td></tr></table></figure><h5 id=\"3-安装需要依赖的环境组件\"><a class=\"anchor\" href=\"#3-安装需要依赖的环境组件\">#</a> 3、安装需要依赖的环境组件</h5>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>yum <span class=\"token function\">install</span> gcc openssl-devel popt-devel <span class=\"token parameter variable\">-y</span></pre></td></tr></table></figure><h5 id=\"4-进入到解压目录进行编译\"><a class=\"anchor\" href=\"#4-进入到解压目录进行编译\">#</a> 4、进入到解压目录，进行编译</h5>\n<pre><code>cd /usr/local/keepalived-1.4.5\n./configure --prefix=/usr/local/keepalived\t\n</code></pre>\n<h5 id=\"5-编译完成之后进行安装\"><a class=\"anchor\" href=\"#5-编译完成之后进行安装\">#</a> 5、编译完成之后，进行安装</h5>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">make</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">make</span> <span class=\"token function\">install</span></pre></td></tr></table></figure><h5 id=\"6-将keepalived的服务注册为系统服务\"><a class=\"anchor\" href=\"#6-将keepalived的服务注册为系统服务\">#</a> 6、将 keepalived 的服务注册为系统服务</h5>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">cp</span>  <span class=\"token parameter variable\">-rf</span>   /usr/local/keepalived-1.4.5/keepalived/etc/init.d/keepalived /etc/init.d/</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">mkdir</span> /etc/keepalived</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">cp</span>   <span class=\"token parameter variable\">-rf</span>  /usr/local/keepalived/etc/keepalived/keepalived.conf /etc/keepalived/</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">cp</span>   <span class=\"token parameter variable\">-rf</span>  /usr/local/keepalived-1.4.5/keepalived/etc/sysconfig/keepalived /etc/sysconfig/</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">cp</span>   <span class=\"token parameter variable\">-rf</span>  /usr/local/keepalived/sbin/keepalived /usr/sbin/</pre></td></tr></table></figure><h5 id=\"7-修改配置文件\"><a class=\"anchor\" href=\"#7-修改配置文件\">#</a> 7、修改配置文件</h5>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">vim</span>  /etc/keepalived/keepalived.conf</pre></td></tr></table></figure><p><strong>CentOS-6   下的配置文件</strong></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token operator\">!</span> Configuration File <span class=\"token keyword\">for</span> keepalived</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>global_defs <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   notification_email <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>     acassen@firewall.loc</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>     failover@firewall.loc</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>     sysadmin@firewall.loc</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>   notification_email_from Alexandre.Cassen@firewall.loc</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>   smtp_server <span class=\"token number\">127.0</span>.0.1</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>   smtp_connect_timeout <span class=\"token number\">30</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>   router_id LVS_DEVEL</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>   vrrp_skip_check_adv_addr</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>   vrrp_garp_interval <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>   vrrp_gna_interval <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>vrrp_instance VI_1 <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token comment\">##\t# 配置为主</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    state MASTER</pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token comment\">#    # 设置网卡</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    interface eth0</pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token comment\">#     # 虚拟路由 ID，全局唯一</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    virtual_router_id <span class=\"token number\">51</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token comment\">#    # 优先级，权重值</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    priority <span class=\"token number\">100</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    advert_int <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    authentication <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        auth_type PASS</pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        auth_pass <span class=\"token number\">1111</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    virtual_ipaddress <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>         <span class=\"token number\">192.168</span>.1.100/24  dev eth0 label eth0:3:</pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><strong>CentOS-7   下的配置文件</strong></p>\n<pre><code class=\"language-conf\">! Configuration File for keepalived\nglobal_defs &#123;\n   notification_email &#123;\n     acassen@firewall.loc\n     failover@firewall.loc\n     sysadmin@firewall.loc\n   &#125;\n   notification_email_from Alexandre.Cassen@firewall.loc\n   smtp_server 127.0.0.1\n   smtp_connect_timeout 30\n   router_id LVS_DEVEL\n   vrrp_skip_check_adv_addr\n   vrrp_garp_interval 0\n   vrrp_gna_interval 0\n&#125;\n\nvrrp_instance VI_1 &#123;\n##\t# 配置为主\n    state MASTER\n#    # 设置网卡\n    interface ens33\n#     # 虚拟路由ID，全局唯一\n    virtual_router_id 51\n#    # 优先级，权重值\n    priority 100\n    advert_int 1\n    authentication &#123;\n        auth_type PASS\n        auth_pass 1111\n    &#125;\n    virtual_ipaddress &#123;\n        192.168.1.100/24 \n    &#125;\n&#125;\n\n</code></pre>\n<h6 id=\"8-启动keepalived\"><a class=\"anchor\" href=\"#8-启动keepalived\">#</a> 8、启动 keepalived</h6>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">service</span> keepalived start</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">### 或者</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>systemctl start keepalived.service</pre></td></tr></table></figure><h6 id=\"9-登录验证\"><a class=\"anchor\" href=\"#9-登录验证\">#</a> 9、登录验证</h6>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>mysql <span class=\"token parameter variable\">-uroot</span> <span class=\"token parameter variable\">-p123456</span> <span class=\"token parameter variable\">-h</span> <span class=\"token number\">192.168</span>.1.100 <span class=\"token parameter variable\">-P</span> <span class=\"token number\">48066</span></pre></td></tr></table></figure>\n<div id=\"gitalk-container\"></div>\n<script src=\"https://cdn.bootcss.com/blueimp-md5/2.12.0/js/md5.min.js\"></script><link rel=\"stylesheet\" href=\"https://unpkg.com/gitalk/dist/gitalk.css\"><script src=\"https://unpkg.com/gitalk/dist/gitalk.min.js\"></script>\n\n\t\t<script>\n\t\tvar gitalkConfig = {\"clientID\":\"6db178ba46c8af8f6a6f\",\"clientSecret\":\"90f730e5956024596558df00975cd8eae28cae3d\",\"repo\":\"bk-comment01\",\"owner\":\"onlymarryu\",\"admin\":[\"onlymarryu\"],\"distractionFreeMode\":false,\"language\":\"zh-CN\",\"proxy\":\"https://gitalk-comments.netlify.app/github_access_token\",\"perPage\":15};\n\t    gitalkConfig.id = md5(location.pathname);\n\t\tvar gitalk = new Gitalk(gitalkConfig);\n\t    gitalk.render(\"gitalk-container\");\n\t    </script>",
            "tags": [
                "工具软件安装"
            ]
        },
        {
            "id": "http://yoursite.com/tools/Kafka-tool/",
            "url": "http://yoursite.com/tools/Kafka-tool/",
            "title": "Kafka",
            "date_published": "2022-10-15T04:52:38.146Z",
            "content_html": "<h3 id=\"kafka-安装\"><a class=\"anchor\" href=\"#kafka-安装\">#</a> Kafka 安装</h3>\n<blockquote>\n<p>安装前提，kafka 安装运行最低支持 jdk7；本篇演示版本是基于 jdk1.8；</p>\n</blockquote>\n<p>官方下载地址：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9saW5rLnpoaWh1LmNvbS8/dGFyZ2V0PWh0dHAlM0EvL2thZmthLmFwYWNoZS5vcmcvZG93bmxvYWRz\">Apache Kafka</span></p>\n<p>kafka 是由 scala 语言编写，下载稳定版本，即前一个版本</p>\n<p><img data-src=\"https://cdn.jsdelivr.net/gh/onlymarryu/typora-ims-test@master/img/v2-9f6503ade62cfa48df87cc9da984e87d_720w.jpg\" alt=\"img\" /></p>\n<p>点击进入后，按如下方式点击下载</p>\n<p><img data-src=\"https://cdn.jsdelivr.net/gh/onlymarryu/typora-ims-test@master/img/v2-bd19bea83d1cb978fbeed614ee126da6_720w.jpg\" alt=\"img\" /></p>\n<p>下载完成后进行解压缩</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">tar</span> <span class=\"token parameter variable\">-zxvf</span> kafka_2.12-2.8.0.tgz </pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">mv</span> kafka_2.12-2.8.0 /usr/local/kafka</pre></td></tr></table></figure><p>解压完成后进入 kafka 目录</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">cd</span> /usr/local/kafka</pre></td></tr></table></figure><p><img data-src=\"https://cdn.jsdelivr.net/gh/onlymarryu/typora-ims-test@master/v2-dfe360dfc7561953761f8ce69f782f4d_720w.png\" alt=\"img\" /></p>\n<p>kafka 是基于 Zookeeper 的消息管理系统，所以启动的时候是需要使用到 Zookeeper ，但其内置了 Zookeeper ，所以只需要根据 bin 目录下的文件进行启动即可</p>\n<p>启动 Zookeeper 服务端命令</p>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>./bin/zookeeper-server-start.sh ./config/zookeeper.properties</pre></td></tr></table></figure><p>Zookeeper 启动成功后会出现  <code>binding to port 0.0.0.0/0.0.0.0:2181</code>  所示结果表示启动成功；</p>\n<p><img data-src=\"https://pic1.zhimg.com/80/v2-6be2f91cd4ec47d589d3c5b58584c4b8_720w.png\" alt=\"img\" /></p>\n<p>启动 kafka 服务端命令</p>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>./bin/kafka-server-start.sh  ./config/server.properties</pre></td></tr></table></figure>\n<div id=\"gitalk-container\"></div>\n<script src=\"https://cdn.bootcss.com/blueimp-md5/2.12.0/js/md5.min.js\"></script><link rel=\"stylesheet\" href=\"https://unpkg.com/gitalk/dist/gitalk.css\"><script src=\"https://unpkg.com/gitalk/dist/gitalk.min.js\"></script>\n\n\t\t<script>\n\t\tvar gitalkConfig = {\"clientID\":\"6db178ba46c8af8f6a6f\",\"clientSecret\":\"90f730e5956024596558df00975cd8eae28cae3d\",\"repo\":\"bk-comment01\",\"owner\":\"onlymarryu\",\"admin\":[\"onlymarryu\"],\"distractionFreeMode\":false,\"language\":\"zh-CN\",\"proxy\":\"https://gitalk-comments.netlify.app/github_access_token\",\"perPage\":15};\n\t    gitalkConfig.id = md5(location.pathname);\n\t\tvar gitalk = new Gitalk(gitalkConfig);\n\t    gitalk.render(\"gitalk-container\");\n\t    </script>",
            "tags": [
                "工具软件安装"
            ]
        },
        {
            "id": "http://yoursite.com/tools/JRebel-tool/",
            "url": "http://yoursite.com/tools/JRebel-tool/",
            "title": "JRebel安装",
            "date_published": "2022-10-15T04:52:38.145Z",
            "content_html": "<h3 id=\"资料在网盘里面\"><a class=\"anchor\" href=\"#资料在网盘里面\">#</a> 资料在网盘里面</h3>\n\n<div id=\"gitalk-container\"></div>\n<script src=\"https://cdn.bootcss.com/blueimp-md5/2.12.0/js/md5.min.js\"></script><link rel=\"stylesheet\" href=\"https://unpkg.com/gitalk/dist/gitalk.css\"><script src=\"https://unpkg.com/gitalk/dist/gitalk.min.js\"></script>\n\n\t\t<script>\n\t\tvar gitalkConfig = {\"clientID\":\"6db178ba46c8af8f6a6f\",\"clientSecret\":\"90f730e5956024596558df00975cd8eae28cae3d\",\"repo\":\"bk-comment01\",\"owner\":\"onlymarryu\",\"admin\":[\"onlymarryu\"],\"distractionFreeMode\":false,\"language\":\"zh-CN\",\"proxy\":\"https://gitalk-comments.netlify.app/github_access_token\",\"perPage\":15};\n\t    gitalkConfig.id = md5(location.pathname);\n\t\tvar gitalk = new Gitalk(gitalkConfig);\n\t    gitalk.render(\"gitalk-container\");\n\t    </script>",
            "tags": [
                "工具软件安装"
            ]
        },
        {
            "id": "http://yoursite.com/tools/IDEA-tool/",
            "url": "http://yoursite.com/tools/IDEA-tool/",
            "title": "IDEA-tool",
            "date_published": "2022-10-15T04:52:38.136Z",
            "content_html": "<h2 id=\"常用插件\"><a class=\"anchor\" href=\"#常用插件\">#</a> 常用插件</h2>\n<h4 id=\"皮肤\"><a class=\"anchor\" href=\"#皮肤\">#</a> 皮肤</h4>\n<blockquote>\n<p>所有 Jetbrains 全家桶都适用</p>\n</blockquote>\n<h5 id=\"cyan-light-theme\"><a class=\"anchor\" href=\"#cyan-light-theme\">#</a> Cyan Light Theme</h5>\n<img data-src=\"/tools/IDEA-tool/image-20220721202846958-1665745616515.png\" class=\"\">\n<h5 id=\"vuesion-theme\"><a class=\"anchor\" href=\"#vuesion-theme\">#</a> Vuesion Theme</h5>\n<img data-src=\"/tools/IDEA-tool/image-20220721203729737-1665745616515.png\" class=\"\">\n<h5 id=\"one-dark-theme\"><a class=\"anchor\" href=\"#one-dark-theme\">#</a> One Dark Theme</h5>\n<img data-src=\"/tools/IDEA-tool/img-1665745616515.png\" class=\"\">\n<h4 id=\"atom-material-icons\"><a class=\"anchor\" href=\"#atom-material-icons\">#</a> Atom Material ICons</h4>\n<blockquote>\n<p>文件夹图标修改</p>\n</blockquote>\n<img data-src=\"/tools/IDEA-tool/image-20220721202830248-1665745616515.png\" class=\"\">\n<h4 id=\"maven-helper\"><a class=\"anchor\" href=\"#maven-helper\">#</a> Maven Helper ******</h4>\n<blockquote>\n<p>查看 Maven 依赖，如果存在依赖冲突会直接爆红，很方便。</p>\n</blockquote>\n<img data-src=\"/tools/IDEA-tool/image-20220721203551163-1665745616515.png\" class=\"\">\n<h4 id=\"mybatisx\"><a class=\"anchor\" href=\"#mybatisx\">#</a> MybatisX</h4>\n<blockquote>\n<p>这个不用多说懂的都懂</p>\n</blockquote>\n<h4 id=\"lombok\"><a class=\"anchor\" href=\"#lombok\">#</a> Lombok</h4>\n<blockquote>\n<p>这个不用多说懂的都懂</p>\n</blockquote>\n<h4 id=\"jrebel-and-xrebel\"><a class=\"anchor\" href=\"#jrebel-and-xrebel\">#</a> JRebel and XRebel</h4>\n<blockquote>\n<p>热部署工具</p>\n</blockquote>\n<h4 id=\"restfultoolkits\"><a class=\"anchor\" href=\"#restfultoolkits\">#</a> RestfulToolkits</h4>\n<blockquote>\n<p>可以直接根据 URL 查看本地的对应 Controller，也可以当做 Postman 用</p>\n</blockquote>\n<img data-src=\"/tools/IDEA-tool/image-20220721203331392-1665745616515.png\" class=\"\">\n<h4 id=\"gsonformat\"><a class=\"anchor\" href=\"#gsonformat\">#</a> GsonFormat</h4>\n<blockquote>\n<p>可以帮助我们快速的将 JSON 对象转换为 Bean</p>\n</blockquote>\n<h4 id=\"rainbow-brakets\"><a class=\"anchor\" href=\"#rainbow-brakets\">#</a> Rainbow Brakets</h4>\n<blockquote>\n<p>彩虹括号</p>\n</blockquote>\n<h4 id=\"arthas-idea\"><a class=\"anchor\" href=\"#arthas-idea\">#</a> arthas idea</h4>\n<blockquote>\n<p>Arthas 阿里开源的一款强大的 JAVA 在线诊断工具</p>\n<p>缺点：需要输入一段很长的命令，如果有遗忘的话就去查看文档<br />\n这款插件就直接解决了这些问题。</p>\n</blockquote>\n<h4 id=\"visualgc\"><a class=\"anchor\" href=\"#visualgc\">#</a> VisualGC</h4>\n<blockquote>\n<p>诊断 JVM 堆栈工具</p>\n</blockquote>\n<h4 id=\"zoolytic\"><a class=\"anchor\" href=\"#zoolytic\">#</a> Zoolytic</h4>\n<blockquote>\n<p>一款 Zookeeper 结点查看分析插件。其实第三方也有一些工具。</p>\n</blockquote>\n<h4 id=\"sequencediagram\"><a class=\"anchor\" href=\"#sequencediagram\">#</a> SequenceDiagram</h4>\n<blockquote>\n<p>作用：快速查看某个方法的时序图，作用就是在我们查看项目源码时，查看方法的流程</p>\n<p>注：只能查看我们自己写的源码，不能查看 JDK 的源码运行流程</p>\n</blockquote>\n<h5 id=\"具体步骤\"><a class=\"anchor\" href=\"#具体步骤\">#</a> 具体步骤</h5>\n<p>1、点击<strong>方法名</strong> ，然后右键点击  <code>SequenceDiagram</code></p>\n<img data-src=\"/tools/IDEA-tool/image-20220727211446055-1665745616515.png\" class=\"\">\n<p>2、配置我们的生成策略</p>\n<img data-src=\"/tools/IDEA-tool/image-20220727212313180-1665745616515.png\" class=\"\">\n<img data-src=\"/tools/IDEA-tool/image-20220727211659767-1665745616515.png\" class=\"\">\n<p>除了策略配置我们最常用的就还是最后一个保存为 .plantUML 文件，配合  <code>PlantUML Integration</code>  删除或者添加一下注解 更加完善我们的流程图</p>\n<h4 id=\"plantuml-integration\"><a class=\"anchor\" href=\"#plantuml-integration\">#</a> PlantUML Integration</h4>\n<blockquote>\n<p>作用：通过代码形式来写时序图，主要还是配合 SquenceDiagram</p>\n</blockquote>\n<p>插件下载成功之后我们可以右键直接 new 出来 .PlantUML 文件，自己直接写时序图，但是效率低不推荐还是配合 Sequence 吧</p>\n<img data-src=\"/tools/IDEA-tool/image-20220727212819103-1665745616515.png\" class=\"\">\n<p>推荐一个 Sequence 和 PlantUML 二合一的应用：Sourcetrail ，有点难用，关键是英文，但是真的好用，等我死磕！！！</p>\n<p>具体操作百度一下就行了</p>\n<h4 id=\"easy-code\"><a class=\"anchor\" href=\"#easy-code\">#</a> Easy Code</h4>\n<p>自动生成作为为我自己常用的架构层次以及命名规则，在快速生产中没有他人硬性标准的情况下，不用额外配置，由于 MybatisPlus 的逆向工程 (这老哥还要写那一套重复代码麻烦，我就鼠标点点！！！)</p>\n<p><mark>下载完成之后，修改一下原来的配置模板文档 (无脑粘贴没毛病)</mark></p>\n<img data-src=\"/tools/IDEA-tool/image-20220821181239253-1665745616515.png\" class=\"\">\n<h5 id=\"controller\"><a class=\"anchor\" href=\"#controller\">#</a> controller</h5>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>####导入宏定义</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>$<span class=\"token operator\">!</span><span class=\"token punctuation\">&#123;</span>define<span class=\"token punctuation\">.</span>vm<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>####设置表后缀（宏定义）</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>####<span class=\"token function\">setTableSuffix</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Controller\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>####保存文件（宏定义）</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>####<span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/controller\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Controller.java\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>####包路径（宏定义）</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>####<span class=\"token function\">setPackageSuffix</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"controller\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>####定义服务名</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>####<span class=\"token function\">set</span><span class=\"token punctuation\">(</span>$serviceName <span class=\"token operator\">=</span> $<span class=\"token operator\">!</span>tool<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>$<span class=\"token operator\">!</span>tool<span class=\"token punctuation\">.</span><span class=\"token function\">firstLowerCase</span><span class=\"token punctuation\">(</span>$<span class=\"token operator\">!</span>tableInfo<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Service\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>####定义实体对象名</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>####<span class=\"token function\">set</span><span class=\"token punctuation\">(</span>$entityName <span class=\"token operator\">=</span> $<span class=\"token operator\">!</span>tool<span class=\"token punctuation\">.</span><span class=\"token function\">firstLowerCase</span><span class=\"token punctuation\">(</span>$<span class=\"token operator\">!</span>tableInfo<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">com<span class=\"token punctuation\">.</span>baomidou<span class=\"token punctuation\">.</span>mybatisplus<span class=\"token punctuation\">.</span>core<span class=\"token punctuation\">.</span>conditions<span class=\"token punctuation\">.</span>query<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">QueryWrapper</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">com<span class=\"token punctuation\">.</span>baomidou<span class=\"token punctuation\">.</span>mybatisplus<span class=\"token punctuation\">.</span>extension<span class=\"token punctuation\">.</span>api<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">ApiController</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">com<span class=\"token punctuation\">.</span>baomidou<span class=\"token punctuation\">.</span>mybatisplus<span class=\"token punctuation\">.</span>extension<span class=\"token punctuation\">.</span>api<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">R</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>beans<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Autowired</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">com<span class=\"token punctuation\">.</span>baomidou<span class=\"token punctuation\">.</span>mybatisplus<span class=\"token punctuation\">.</span>extension<span class=\"token punctuation\">.</span>plugins<span class=\"token punctuation\">.</span>pagination<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Page</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token keyword\">import</span> $<span class=\"token operator\">!</span><span class=\"token punctuation\">&#123;</span>tableInfo<span class=\"token punctuation\">.</span>savePackageName<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">.</span>pojo<span class=\"token punctuation\">.</span>$<span class=\"token operator\">!</span>tableInfo<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token keyword\">import</span> $<span class=\"token operator\">!</span><span class=\"token punctuation\">&#123;</span>tableInfo<span class=\"token punctuation\">.</span>savePackageName<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">.</span>service<span class=\"token punctuation\">.</span>$<span class=\"token operator\">!</span><span class=\"token punctuation\">&#123;</span>tableInfo<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">&#125;</span><span class=\"token class-name\">Service</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>web<span class=\"token punctuation\">.</span>bind<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token operator\">*</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>io<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Serializable</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">List</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>####表注释（宏定义）</pre></td></tr><tr><td data-num=\"32\"></td><td><pre>####<span class=\"token function\">tableComment</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"表控制层\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token annotation punctuation\">@RestController</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token annotation punctuation\">@RequestMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/$!tool.firstLowerCase($!tableInfo.name)\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> $<span class=\"token operator\">!</span><span class=\"token punctuation\">&#123;</span>tableName<span class=\"token punctuation\">&#125;</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"37\"></td><td><pre>     * 服务对象</pre></td></tr><tr><td data-num=\"38\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    <span class=\"token annotation punctuation\">@Autowired</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token keyword\">private</span> $<span class=\"token operator\">!</span><span class=\"token punctuation\">&#123;</span>tableInfo<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">&#125;</span><span class=\"token class-name\">Service</span> $<span class=\"token operator\">!</span><span class=\"token punctuation\">&#123;</span>serviceName<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h5 id=\"entity\"><a class=\"anchor\" href=\"#entity\">#</a> entity</h5>\n<p>我的实体类一般都叫 pojo， 其中要整合 MybatisPlus 因为我在模板里面加了一个他的注解 @TableName</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">&lt;!--MybatisPlus--></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>com.baomidou<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>mybatis-plus-boot-starter<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>3.4.2<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>####导入宏定义</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>$<span class=\"token operator\">!</span><span class=\"token punctuation\">&#123;</span>define<span class=\"token punctuation\">.</span>vm<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>####保存文件（宏定义）</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>####<span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/pojo\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\".java\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>####包路径（宏定义）</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>####<span class=\"token function\">setPackageSuffix</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"pojo\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>####自动导入包（全局变量）</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>$<span class=\"token operator\">!</span><span class=\"token punctuation\">&#123;</span>autoImport<span class=\"token punctuation\">.</span>vm<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">com<span class=\"token punctuation\">.</span>baomidou<span class=\"token punctuation\">.</span>mybatisplus<span class=\"token punctuation\">.</span>extension<span class=\"token punctuation\">.</span>activerecord<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Model</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>io<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Serializable</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">lombok<span class=\"token punctuation\">.</span></span><span class=\"token operator\">*</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">com<span class=\"token punctuation\">.</span>baomidou<span class=\"token punctuation\">.</span>mybatisplus<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">TableName</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">com<span class=\"token punctuation\">.</span>baomidou<span class=\"token punctuation\">.</span>mybatisplus<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">TableField</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>####表注释（宏定义）</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>####<span class=\"token function\">tableComment</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"表实体类\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token annotation punctuation\">@AllArgsConstructor</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token annotation punctuation\">@NoArgsConstructor</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token annotation punctuation\">@Date</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token annotation punctuation\">@ToString</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token annotation punctuation\">@TableName</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token string\">\"$!&#123;tableInfo.name&#125;\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> $<span class=\"token operator\">!</span><span class=\"token punctuation\">&#123;</span>tableInfo<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">Serializable</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>####<span class=\"token function\">foreach</span><span class=\"token punctuation\">(</span>$column in $tableInfo<span class=\"token punctuation\">.</span>fullColumn<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    * ##if($&#123;column.comment&#125;)$&#123;column.comment&#125;##end</pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    */</span> </pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token annotation punctuation\">@TableField</span><span class=\"token punctuation\">(</span>$tool<span class=\"token punctuation\">.</span><span class=\"token function\">hump2Underline</span><span class=\"token punctuation\">(</span>$<span class=\"token operator\">!</span><span class=\"token punctuation\">&#123;</span>column<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token keyword\">private</span> $<span class=\"token operator\">!</span><span class=\"token punctuation\">&#123;</span>tool<span class=\"token punctuation\">.</span><span class=\"token function\">getClsNameByFullName</span><span class=\"token punctuation\">(</span>$column<span class=\"token punctuation\">.</span>type<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span> $<span class=\"token operator\">!</span><span class=\"token punctuation\">&#123;</span>column<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"35\"></td><td><pre>####end</pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h5 id=\"service\"><a class=\"anchor\" href=\"#service\">#</a> Service</h5>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>####导入宏定义</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>$<span class=\"token operator\">!</span><span class=\"token punctuation\">&#123;</span>define<span class=\"token punctuation\">.</span>vm<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>####设置表后缀（宏定义）</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>####<span class=\"token function\">setTableSuffix</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Service\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>####保存文件（宏定义）</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>####<span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/service\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Service.java\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>####包路径（宏定义）</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>####<span class=\"token function\">setPackageSuffix</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"service\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">com<span class=\"token punctuation\">.</span>baomidou<span class=\"token punctuation\">.</span>mybatisplus<span class=\"token punctuation\">.</span>extension<span class=\"token punctuation\">.</span>service<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">IService</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">import</span> $<span class=\"token operator\">!</span><span class=\"token punctuation\">&#123;</span>tableInfo<span class=\"token punctuation\">.</span>savePackageName<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">.</span>pojo<span class=\"token punctuation\">.</span>$<span class=\"token operator\">!</span>tableInfo<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>####表注释（宏定义）</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>####<span class=\"token function\">tableComment</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"表服务接口\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> $<span class=\"token operator\">!</span><span class=\"token punctuation\">&#123;</span>tableName<span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">IService</span><span class=\"token operator\">&lt;</span>$<span class=\"token operator\">!</span>tableInfo<span class=\"token punctuation\">.</span>name<span class=\"token operator\">></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h5 id=\"serviceimpl\"><a class=\"anchor\" href=\"#serviceimpl\">#</a> ServiceImpl</h5>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>####导入宏定义</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>$<span class=\"token operator\">!</span><span class=\"token punctuation\">&#123;</span>define<span class=\"token punctuation\">.</span>vm<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>####设置表后缀（宏定义）</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>####<span class=\"token function\">setTableSuffix</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ServiceImpl\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>####保存文件（宏定义）</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>####<span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/service/impl\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"ServiceImpl.java\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>####包路径（宏定义）</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>####<span class=\"token function\">setPackageSuffix</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"service.impl\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">com<span class=\"token punctuation\">.</span>baomidou<span class=\"token punctuation\">.</span>mybatisplus<span class=\"token punctuation\">.</span>extension<span class=\"token punctuation\">.</span>service<span class=\"token punctuation\">.</span>impl<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">ServiceImpl</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">import</span> $<span class=\"token operator\">!</span><span class=\"token punctuation\">&#123;</span>tableInfo<span class=\"token punctuation\">.</span>savePackageName<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">.</span>mapper<span class=\"token punctuation\">.</span>$<span class=\"token operator\">!</span><span class=\"token punctuation\">&#123;</span>tableInfo<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">&#125;</span><span class=\"token class-name\">Mapper</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">import</span> $<span class=\"token operator\">!</span><span class=\"token punctuation\">&#123;</span>tableInfo<span class=\"token punctuation\">.</span>savePackageName<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">.</span>pojo<span class=\"token punctuation\">.</span>$<span class=\"token operator\">!</span><span class=\"token punctuation\">&#123;</span>tableInfo<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">import</span> $<span class=\"token operator\">!</span><span class=\"token punctuation\">&#123;</span>tableInfo<span class=\"token punctuation\">.</span>savePackageName<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">.</span>service<span class=\"token punctuation\">.</span>$<span class=\"token operator\">!</span><span class=\"token punctuation\">&#123;</span>tableInfo<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">&#125;</span><span class=\"token class-name\">Service</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>stereotype<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Service</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>####表注释（宏定义）</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>####<span class=\"token function\">tableComment</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"表服务实现类\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token annotation punctuation\">@Service</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"$!tool.firstLowerCase($tableInfo.name)Service\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> $<span class=\"token operator\">!</span><span class=\"token punctuation\">&#123;</span>tableName<span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">ServiceImpl</span><span class=\"token operator\">&lt;</span>$<span class=\"token operator\">!</span><span class=\"token punctuation\">&#123;</span>tableInfo<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">&#125;</span><span class=\"token class-name\">Mapper</span><span class=\"token punctuation\">,</span> $<span class=\"token operator\">!</span><span class=\"token punctuation\">&#123;</span>tableInfo<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">&#125;</span><span class=\"token operator\">></span> <span class=\"token keyword\">implements</span> $<span class=\"token operator\">!</span><span class=\"token punctuation\">&#123;</span>tableInfo<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">&#125;</span><span class=\"token class-name\">Service</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token annotation punctuation\">@Autowired</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token keyword\">private</span> $<span class=\"token operator\">!</span><span class=\"token punctuation\">&#123;</span>tableInfo<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">&#125;</span><span class=\"token class-name\">Mapper</span> $tool<span class=\"token punctuation\">.</span><span class=\"token function\">firstLowerCase</span><span class=\"token punctuation\">(</span>$<span class=\"token operator\">!</span><span class=\"token punctuation\">&#123;</span>tableInfo<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token class-name\">Mapper</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h5 id=\"dao-mapperjava\"><a class=\"anchor\" href=\"#dao-mapperjava\">#</a> Dao  /  Mapper.java</h5>\n<p>我习惯叫 mapper 层，文件也是以 *Mapper 结尾</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>####导入宏定义</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>$<span class=\"token operator\">!</span><span class=\"token punctuation\">&#123;</span>define<span class=\"token punctuation\">.</span>vm<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>####设置表后缀（宏定义）</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>####<span class=\"token function\">setTableSuffix</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Mapper\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>####保存文件（宏定义）</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>####<span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/mapper\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Mapper.java\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>####包路径（宏定义）</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>####<span class=\"token function\">setPackageSuffix</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"mapper\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">com<span class=\"token punctuation\">.</span>baomidou<span class=\"token punctuation\">.</span>mybatisplus<span class=\"token punctuation\">.</span>core<span class=\"token punctuation\">.</span>mapper<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">BaseMapper</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">import</span> $<span class=\"token operator\">!</span><span class=\"token punctuation\">&#123;</span>tableInfo<span class=\"token punctuation\">.</span>savePackageName<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">.</span>pojo<span class=\"token punctuation\">.</span>$<span class=\"token operator\">!</span>tableInfo<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>ibatis<span class=\"token punctuation\">.</span>annotations<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Mapper</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>####表注释（宏定义）</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>####<span class=\"token function\">tableComment</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"表数据库访问层\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token annotation punctuation\">@Mapper</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> $<span class=\"token operator\">!</span><span class=\"token punctuation\">&#123;</span>tableName<span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">BaseMapper</span><span class=\"token operator\">&lt;</span>$<span class=\"token operator\">!</span>tableInfo<span class=\"token punctuation\">.</span>name<span class=\"token operator\">></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h5 id=\"mapperxml映射文件自己创建一下\"><a class=\"anchor\" href=\"#mapperxml映射文件自己创建一下\">#</a> Mapper.xml (映射文件，自己创建一下)</h5>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>####引入mybatis支持</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>$!&#123;mybatisSupport.vm&#125;</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>####设置保存名称与保存位置</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>$!callback.setFileName($tool.append($!&#123;tableInfo.name&#125;, \"Mapper.xml\"))</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>$!callback.setSavePath($tool.append($modulePath, \"/src/main/resources/mapper\"))</pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>####拿到主键</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>####if(!$tableInfo.pkColumn.isEmpty())</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>#    ##set($pk = $tableInfo.pkColumn.get(0))</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>####end</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>#### 拿到全索引列，用‘，’间隔</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>##set($sqlCloumn=\"##foreach($column in $tableInfo.fullColumn)$!column.name##if($!foreach.hasNext) ,##end ##end\")</pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token prolog\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">mapper</span> <span class=\"token name\">PUBLIC</span> <span class=\"token string\">\"-//mybatis.org//DTD Mapper 3.0//EN\"</span> <span class=\"token string\">\"http://mybatis.org/dtd/mybatis-3-mapper.dtd\"</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>mapper</span> <span class=\"token attr-name\">namespace</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>$&#123;tableInfo.savePackageName&#125;.mapper.$!&#123;tableInfo.name&#125;Mapper<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>sql</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>All$!&#123;tableInfo.name&#125;Column<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>$sqlCloumn<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>sql</span><span class=\"token punctuation\">></span></span>   </pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>resultMap</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>$&#123;tableInfo.savePackageName&#125;.pojo.$!&#123;tableInfo.name&#125;<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>$!&#123;tableInfo.name&#125;Map<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>####foreach($column in $tableInfo.fullColumn)</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>result</span> <span class=\"token attr-name\">property</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>$!column.name<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">column</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>$!column.obj.name<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>####end</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>resultMap</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"27\"></td><td><pre></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>mapper</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><h5 id=\"设置快捷操作\"><a class=\"anchor\" href=\"#设置快捷操作\">#</a> 设置快捷操作 ***</h5>\n<p>直接导入我的 JSON 文件即可，将以下内容保存为.json 文件并进行导入</p>\n<img data-src=\"/tools/IDEA-tool/image-20220823220304489-1665745616515.png\" class=\"\">\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token property\">\"author\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"makejava\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token property\">\"version\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"1.2.6\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token property\">\"userSecure\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token property\">\"currTypeMapperGroupName\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"Default\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token property\">\"currTemplateGroupName\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"MybatisPlus\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token property\">\"currColumnConfigGroupName\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"Default\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token property\">\"currGlobalConfigGroupName\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"Default\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  <span class=\"token property\">\"typeMapper\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  <span class=\"token property\">\"template\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token property\">\"MybatisPlus\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token property\">\"name\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"MybatisPlus\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      <span class=\"token property\">\"elementList\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token property\">\"name\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"controller.java.vm\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token property\">\"code\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"##导入宏定义\\n$!&#123;define.vm&#125;\\n\\n##设置表后缀（宏定义）\\n##setTableSuffix(\\\"Controller\\\")\\n\\n##保存文件（宏定义）\\n##save(\\\"/controller\\\", \\\"Controller.java\\\")\\n\\n##包路径（宏定义）\\n##setPackageSuffix(\\\"controller\\\")\\n\\n##定义服务名\\n##set($serviceName = $!tool.append($!tool.firstLowerCase($!tableInfo.name), \\\"Service\\\"))\\n\\n##定义实体对象名\\n##set($entityName = $!tool.firstLowerCase($!tableInfo.name))\\n\\nimport com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;\\nimport com.baomidou.mybatisplus.extension.api.ApiController;\\nimport com.baomidou.mybatisplus.extension.api.R;\\nimport org.springframework.beans.factory.annotation.Autowired;\\nimport com.baomidou.mybatisplus.extension.plugins.pagination.Page;\\nimport $!&#123;tableInfo.savePackageName&#125;.pojo.$!tableInfo.name;\\nimport $!&#123;tableInfo.savePackageName&#125;.service.$!&#123;tableInfo.name&#125;Service;\\nimport org.springframework.web.bind.annotation.*;\\n\\nimport java.io.Serializable;\\nimport java.util.List;\\n\\n##表注释（宏定义）\\n##tableComment(\\\"表控制层\\\")\\n@RestController\\n@RequestMapping(\\\"/$!tool.firstLowerCase($!tableInfo.name)\\\")\\npublic class $!&#123;tableName&#125; &#123;\\n    /**\\n     * 服务对象\\n     */\\n    @Autowired\\n    private $!&#123;tableInfo.name&#125;Service $!&#123;serviceName&#125;;\\n\\n    \\n&#125;\\n\"</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token property\">\"name\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"entity.java.vm\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token property\">\"code\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"##导入宏定义\\n$!&#123;define.vm&#125;\\n\\n##保存文件（宏定义）\\n##save(\\\"/pojo\\\", \\\".java\\\")\\n\\n##包路径（宏定义）\\n##setPackageSuffix(\\\"pojo\\\")\\n\\n##自动导入包（全局变量）\\n$!&#123;autoImport.vm&#125;\\nimport com.baomidou.mybatisplus.extension.activerecord.Model;\\nimport java.io.Serializable;\\nimport lombok.*;\\nimport com.baomidou.mybatisplus.annotation.TableName;\\nimport com.baomidou.mybatisplus.annotation.TableField;\\n\\n##表注释（宏定义）\\n##tableComment(\\\"表实体类\\\")\\n\\n@AllArgsConstructor\\n@NoArgsConstructor\\n@Data\\n@ToString\\n@TableName(value = \\\"$tool.hump2Underline($!&#123;tableInfo.name&#125;)\\\")\\npublic class $!&#123;tableInfo.name&#125; implements Serializable &#123;\\n##foreach($column in $tableInfo.fullColumn)\\n    /**\\n    * ##if($&#123;column.comment&#125;)$&#123;column.comment&#125;##end\\n    \\n    */ \\n    @TableField(\\\"$tool.hump2Underline($!&#123;column.name&#125;)\\\")\\n    private $!&#123;tool.getClsNameByFullName($column.type)&#125; $!&#123;column.name&#125;;\\n    \\n##end\\n\\n&#125;\\n\"</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token property\">\"name\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"service.java.vm\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token property\">\"code\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"##导入宏定义\\n$!&#123;define.vm&#125;\\n\\n##设置表后缀（宏定义）\\n##setTableSuffix(\\\"Service\\\")\\n\\n##保存文件（宏定义）\\n##save(\\\"/service\\\", \\\"Service.java\\\")\\n\\n##包路径（宏定义）\\n##setPackageSuffix(\\\"service\\\")\\n\\nimport com.baomidou.mybatisplus.extension.service.IService;\\nimport $!&#123;tableInfo.savePackageName&#125;.pojo.$!tableInfo.name;\\n\\n##表注释（宏定义）\\n##tableComment(\\\"表服务接口\\\")\\npublic interface $!&#123;tableName&#125; extends IService&lt;$!tableInfo.name> &#123;\\n\\n&#125;\\n\"</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token property\">\"name\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"serviceImpl.java.vm\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token property\">\"code\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"##导入宏定义\\n$!&#123;define.vm&#125;\\n\\n##设置表后缀（宏定义）\\n##setTableSuffix(\\\"ServiceImpl\\\")\\n\\n##保存文件（宏定义）\\n##save(\\\"/service/impl\\\", \\\"ServiceImpl.java\\\")\\n\\n##包路径（宏定义）\\n##setPackageSuffix(\\\"service.impl\\\")\\n\\nimport com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;\\nimport $!&#123;tableInfo.savePackageName&#125;.mapper.$!&#123;tableInfo.name&#125;Mapper;\\nimport $!&#123;tableInfo.savePackageName&#125;.pojo.$!&#123;tableInfo.name&#125;;\\nimport $!&#123;tableInfo.savePackageName&#125;.service.$!&#123;tableInfo.name&#125;Service;\\nimport org.springframework.stereotype.Service;\\n\\n##表注释（宏定义）\\n##tableComment(\\\"表服务实现类\\\")\\n@Service(\\\"$!tool.firstLowerCase($tableInfo.name)Service\\\")\\npublic class $!&#123;tableName&#125; extends ServiceImpl&lt;$!&#123;tableInfo.name&#125;Mapper, $!&#123;tableInfo.name&#125;> implements $!&#123;tableInfo.name&#125;Service &#123;\\n    @Autowired\\n    private $!&#123;tableInfo.name&#125;Mapper $tool.firstLowerCase($!&#123;tableInfo.name&#125;)Mapper;\\n    \\n    \\n    \\n&#125;\\n\"</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token property\">\"name\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"mapper.java.vm\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token property\">\"code\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"##导入宏定义\\n$!&#123;define.vm&#125;\\n\\n##设置表后缀（宏定义）\\n##setTableSuffix(\\\"Mapper\\\")\\n\\n##保存文件（宏定义）\\n##save(\\\"/mapper\\\", \\\"Mapper.java\\\")\\n\\n##包路径（宏定义）\\n##setPackageSuffix(\\\"mapper\\\")\\n\\nimport com.baomidou.mybatisplus.core.mapper.BaseMapper;\\nimport $!&#123;tableInfo.savePackageName&#125;.pojo.$!tableInfo.name;\\nimport org.apache.ibatis.annotations.Mapper;\\n\\n##表注释（宏定义）\\n##tableComment(\\\"表数据库访问层\\\")\\n\\n@Mapper\\npublic interface $!&#123;tableName&#125; extends BaseMapper&lt;$!tableInfo.name> &#123;\\n\\n&#125;\\n\"</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token property\">\"name\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"mapper.xml.vm\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token property\">\"code\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"##引入mybatis支持\\n$!&#123;mybatisSupport.vm&#125;\\n\\n##设置保存名称与保存位置\\n$!callback.setFileName($tool.append($!&#123;tableInfo.name&#125;, \\\"Mapper.xml\\\"))\\n$!callback.setSavePath($tool.append($modulePath, \\\"/src/main/resources/mapper\\\"))\\n\\n##拿到主键\\n##if(!$tableInfo.pkColumn.isEmpty())\\n    ##set($pk = $tableInfo.pkColumn.get(0))\\n##end\\n## 拿到全索引列，用‘，’间隔\\n##set($sqlCloumn=\\\"##foreach($column in $tableInfo.fullColumn)$tool.hump2Underline($!column.name)##if($!foreach.hasNext) ,##end ##end\\\")\\n\\n&lt;?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>\\n&lt;!DOCTYPE mapper PUBLIC \\\"-//mybatis.org//DTD Mapper 3.0//EN\\\" \\\"http://mybatis.org/dtd/mybatis-3-mapper.dtd\\\">\\n&lt;mapper namespace=\\\"$&#123;tableInfo.savePackageName&#125;.mapper.$!&#123;tableInfo.name&#125;Mapper\\\">\\n\\n    &lt;sql id=\\\"All$!&#123;tableInfo.name&#125;Column\\\">$sqlCloumn&lt;/sql>   \\n    &lt;resultMap type=\\\"$&#123;tableInfo.savePackageName&#125;.pojo.$!&#123;tableInfo.name&#125;\\\" id=\\\"$!&#123;tableInfo.name&#125;Map\\\">\\n##foreach($column in $tableInfo.fullColumn)\\n        &lt;result property=\\\"$!column.name\\\" column=\\\"$!column.obj.name\\\" />\\n##end\\n    &lt;/resultMap>\\n    \\n    \\n\\n&lt;/mapper>\\n\"</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span> <span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>  <span class=\"token property\">\"columnConfig\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>  <span class=\"token property\">\"globalConfig\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h5 id=\"注意\"><a class=\"anchor\" href=\"#注意\">#</a> 注意</h5>\n<p>一定要选择你的 Module、包路径、Path，因为它们分别对应的是你模板中的三个参数 modulePath、tableInfo.savePackageName、我们所有的 Save 都是以 Path 的路径为根路径</p>\n<img data-src=\"/tools/IDEA-tool/image-20220823215323871-1665745616515.png\" class=\"\">\n<h4 id=\"未完成\"><a class=\"anchor\" href=\"#未完成\">#</a> 未完成</h4>\n<h2 id=\"设置\"><a class=\"anchor\" href=\"#设置\">#</a> 设置</h2>\n<h4 id=\"service窗口\"><a class=\"anchor\" href=\"#service窗口\">#</a> Service 窗口</h4>\n<blockquote>\n<p>在微服务项目中，我们在创建多个模块后，想要启动特定的几个寻找起来非常麻烦我们这个时候就可以通过 Service 窗口快速找到我们的启动类</p>\n<img data-src=\"/tools/IDEA-tool/image-20220724161332641.png\" class=\"\" title=\"image-20220724161332641\">\n</blockquote>\n<h5 id=\"具体步骤-2\"><a class=\"anchor\" href=\"#具体步骤-2\">#</a> 具体步骤</h5>\n<p>1：开启 idea，右下角会显示下图</p>\n<img data-src=\"/tools/IDEA-tool/726e3c50b51442839ca357fa23bef649.png\" class=\"\">\n<p>2、点击 Show run configurations in Services</p>\n<img data-src=\"/tools/IDEA-tool/f90f6ac3965943209d1761bc12e3bd03.png\" class=\"\">\n<p>最终效果图如下：</p>\n<img data-src=\"/tools/IDEA-tool/5649373054b74c3da30cc18febb3a01c.png\" class=\"\">\n<h4 id=\"未完成-2\"><a class=\"anchor\" href=\"#未完成-2\">#</a> 未完成</h4>\n\n<div id=\"gitalk-container\"></div>\n<script src=\"https://cdn.bootcss.com/blueimp-md5/2.12.0/js/md5.min.js\"></script><link rel=\"stylesheet\" href=\"https://unpkg.com/gitalk/dist/gitalk.css\"><script src=\"https://unpkg.com/gitalk/dist/gitalk.min.js\"></script>\n\n\t\t<script>\n\t\tvar gitalkConfig = {\"clientID\":\"6db178ba46c8af8f6a6f\",\"clientSecret\":\"90f730e5956024596558df00975cd8eae28cae3d\",\"repo\":\"bk-comment01\",\"owner\":\"onlymarryu\",\"admin\":[\"onlymarryu\"],\"distractionFreeMode\":false,\"language\":\"zh-CN\",\"proxy\":\"https://gitalk-comments.netlify.app/github_access_token\",\"perPage\":15};\n\t    gitalkConfig.id = md5(location.pathname);\n\t\tvar gitalk = new Gitalk(gitalkConfig);\n\t    gitalk.render(\"gitalk-container\");\n\t    </script>",
            "tags": [
                "工具软件安装"
            ]
        },
        {
            "id": "http://yoursite.com/tools/HDFS-tool/",
            "url": "http://yoursite.com/tools/HDFS-tool/",
            "title": "HDFS安装",
            "date_published": "2022-10-15T04:52:38.132Z",
            "content_html": "<h3 id=\"hdfs安装\"><a class=\"anchor\" href=\"#hdfs安装\">#</a> HDFS 安装</h3>\n<h4 id=\"1\"><a class=\"anchor\" href=\"#1\">#</a> ——1</h4>\n<h4 id=\"2\"><a class=\"anchor\" href=\"#2\">#</a> ——2</h4>\n<p>1. 拉取 Hadoop 镜像（可以在 docker hub 上找合适的镜像）：</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> pull singularities/hadoop</pre></td></tr></table></figure><p>2. 创建 docker-compose.yml 文件（可以在文本编辑器中写好后，复制），内容如下：</p>\n<figure class=\"highlight yml\"><figcaption data-lang=\"YAML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2\"</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token key atrule\">namenode</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> singularities/hadoop</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token key atrule\">command</span><span class=\"token punctuation\">:</span> start<span class=\"token punctuation\">-</span>hadoop namenode</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      <span class=\"token key atrule\">HDFS_USER</span><span class=\"token punctuation\">:</span> hdfsuser</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"8020:8020\"</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"14000:14000\"</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"50070:50070\"</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"10020:10020\"</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"13562:13562\"</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"19888:19888\"</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>  <span class=\"token key atrule\">datanode</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> singularities/hadoop</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token key atrule\">command</span><span class=\"token punctuation\">:</span> start<span class=\"token punctuation\">-</span>hadoop datanode namenode</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>      <span class=\"token key atrule\">HDFS_USER</span><span class=\"token punctuation\">:</span> hdfsuser</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token key atrule\">links</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>      <span class=\"token punctuation\">-</span> namenode</pre></td></tr></table></figure><p>3. 创建 hadoop，执行如下命令</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker-compose</span> up <span class=\"token parameter variable\">-d</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">docker</span> <span class=\"token function\">ps</span></pre></td></tr></table></figure><p>4. 开启多个 datanode</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker-compose</span> scale <span class=\"token assign-left variable\">datanode</span><span class=\"token operator\">=</span><span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">docker</span> <span class=\"token function\">ps</span></pre></td></tr></table></figure><p>5. 查看 hadoop 控制面板。由于服务刚初始化，可能需要等一会。访问类似如下 url：</p>\n<figure class=\"highlight ruby\"><figcaption data-lang=\"ruby\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#http://192.168.1.195:50070/dfshealth.html#tab-datanode</span></pre></td></tr></table></figure><p>6. 进入任意 hadoop 相关容器，<strong>直接进行 hdfs 基础操作</strong><br />\n在任意 datanode 的容器中操作 hdfs，会自动同步到其他的 datanode 容器中。</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">### 查看所有命令</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>hadoop fs</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">### 创建目录</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">#hadoop fs -mkdir /hdfs #在根目录下创建 hdfs 文件夹</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">### 查看目录</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">#hadoop fs -ls  /   #列出根目录下的文件列表</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">### 创建多级目录</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>hadoop fs <span class=\"token parameter variable\">-mkdir</span> <span class=\"token parameter variable\">-p</span> /hdfs/d1/d2</pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\">### 上传文件到 HDFS</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\">#echo \"hello world\" >> local.txt   #创建文件</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\">#hadoop fs -put local.txt/hdfs/   #上传文件到 hdfs</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\">### 下载 hdfs 文件</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>hadoop fs <span class=\"token parameter variable\">-get</span> /hdfs/local.txt</pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\">### 删除 hdfs 中的文件</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>hadoop fs <span class=\"token parameter variable\">-rm</span> /hdfs/local.txt</pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token comment\">### 删除 hdfs 中的目录</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>hadoop fs <span class=\"token parameter variable\">-rmdir</span> /hdfs/d1/d2</pre></td></tr></table></figure>\n<div id=\"gitalk-container\"></div>\n<script src=\"https://cdn.bootcss.com/blueimp-md5/2.12.0/js/md5.min.js\"></script><link rel=\"stylesheet\" href=\"https://unpkg.com/gitalk/dist/gitalk.css\"><script src=\"https://unpkg.com/gitalk/dist/gitalk.min.js\"></script>\n\n\t\t<script>\n\t\tvar gitalkConfig = {\"clientID\":\"6db178ba46c8af8f6a6f\",\"clientSecret\":\"90f730e5956024596558df00975cd8eae28cae3d\",\"repo\":\"bk-comment01\",\"owner\":\"onlymarryu\",\"admin\":[\"onlymarryu\"],\"distractionFreeMode\":false,\"language\":\"zh-CN\",\"proxy\":\"https://gitalk-comments.netlify.app/github_access_token\",\"perPage\":15};\n\t    gitalkConfig.id = md5(location.pathname);\n\t\tvar gitalk = new Gitalk(gitalkConfig);\n\t    gitalk.render(\"gitalk-container\");\n\t    </script>",
            "tags": [
                "工具软件安装"
            ]
        }
    ]
}