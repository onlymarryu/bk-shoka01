{
    "version": "https://jsonfeed.org/version/1",
    "title": "记录“美食”每刻 • All posts by \"mysql基础\" category",
    "description": "记录“美食”每刻",
    "home_page_url": "http://example.com",
    "items": [
        {
            "id": "http://example.com/2022/10/07/DataBase/MySQL/MySQL_Basic/",
            "url": "http://example.com/2022/10/07/DataBase/MySQL/MySQL_Basic/",
            "title": "MySQL基础",
            "date_published": "2022-10-06T16:00:00.000Z",
            "content_html": "<h1 id=\"mysql安装\"><a class=\"anchor\" href=\"#mysql安装\">#</a> MySQL 安装</h1>\n<h2 id=\"1-卸载原来的版本\"><a class=\"anchor\" href=\"#1-卸载原来的版本\">#</a> 1、卸载原来的版本</h2>\n<h3 id=\"1-查看mysql的安装情况\"><a class=\"anchor\" href=\"#1-查看mysql的安装情况\">#</a> 1、查看 mysql 的安装情况</h3>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">rpm</span> <span class=\"token parameter variable\">-qa</span> <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> <span class=\"token parameter variable\">-i</span> mysql</pre></td></tr></table></figure><p><img data-src=\"/2022/10/07/DataBase/MySQL/MySQL_Basic/1570605325400.png\" class=\"\"></p>\n<h3 id=\"2-删除上图安装的软件\"><a class=\"anchor\" href=\"#2-删除上图安装的软件\">#</a> 2、删除上图安装的软件</h3>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">rpm</span> <span class=\"token parameter variable\">-ev</span> <span class=\"token parameter variable\">--nodeps</span> mysql57-community-release-el5-7.noarch</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">rpm</span> <span class=\"token parameter variable\">-ev</span> <span class=\"token parameter variable\">--nodeps</span> mysql-community-server-5.7.18-1.el5.x86_64</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">rpm</span> <span class=\"token parameter variable\">-ev</span> <span class=\"token parameter variable\">--nodeps</span> mysql-community-client-5.7.18-1.el5.x86_64</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">rpm</span> <span class=\"token parameter variable\">-ev</span> <span class=\"token parameter variable\">--nodeps</span> mysql-community-libs-5.7.18-1.el5.x86_64</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">rpm</span> <span class=\"token parameter variable\">-ev</span> <span class=\"token parameter variable\">--nodeps</span> mysql-community-common-5.7.18-1.el5.x86_64</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">rpm</span> <span class=\"token parameter variable\">-ev</span> <span class=\"token parameter variable\">--nodeps</span> mysql-5.7.18-1.el5.x86_64</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">rpm</span> <span class=\"token parameter variable\">-ev</span> <span class=\"token parameter variable\">--nodeps</span> mysql-community-libs-compat-5.7.18-1.el5.x86_64</pre></td></tr></table></figure><h3 id=\"3-都删除成功之后查找相关的mysql的文件\"><a class=\"anchor\" href=\"#3-都删除成功之后查找相关的mysql的文件\">#</a> 3、都删除成功之后，查找相关的 mysql 的文件</h3>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">find</span> / <span class=\"token parameter variable\">-name</span> mysql</pre></td></tr></table></figure><p><img data-src=\"/2022/10/07/DataBase/MySQL/MySQL_Basic/1570605553095.png\" class=\"\"></p>\n<h3 id=\"4-删除全部文件\"><a class=\"anchor\" href=\"#4-删除全部文件\">#</a> 4、删除全部文件</h3>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">rm</span> <span class=\"token parameter variable\">-rf</span> /etc/selinux/targeted/active/modules/100/mysql</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">rm</span> <span class=\"token parameter variable\">-rf</span> /root/mysql</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">rm</span> <span class=\"token parameter variable\">-rf</span> /root/mysql/data/mysql</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">rm</span> <span class=\"token parameter variable\">-rf</span> /var/lib/mysql</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">rm</span> <span class=\"token parameter variable\">-rf</span> /var/lib/mysql/mysql</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">rm</span> <span class=\"token parameter variable\">-rf</span> /usr/share/mysql</pre></td></tr></table></figure><h3 id=\"5-再次执行命令\"><a class=\"anchor\" href=\"#5-再次执行命令\">#</a> 5、再次执行命令</h3>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">rpm</span> <span class=\"token parameter variable\">-qa</span> <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> <span class=\"token parameter variable\">-i</span> mysql</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">#如果没有显式则表示卸载完成</span></pre></td></tr></table></figure><h2 id=\"2-删除mariadb-libs不可省略\"><a class=\"anchor\" href=\"#2-删除mariadb-libs不可省略\">#</a> 2、删除 mariadb-libs (不可省略)</h2>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 检查 mariadb-libs</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">rpm</span> -qa<span class=\"token operator\">|</span><span class=\"token function\">grep</span> mariadb</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 卸载 mariadb-libs</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>yum remove <span class=\"token parameter variable\">-y</span> mariadb-libs</pre></td></tr></table></figure><h2 id=\"3-安装mysql\"><a class=\"anchor\" href=\"#3-安装mysql\">#</a> 3、安装 MySQL</h2>\n<h3 id=\"1输入\"><a class=\"anchor\" href=\"#1输入\">#</a> 1，输入：</h3>\n<p>wegt <span class=\"exturl\" data-url=\"aHR0cHM6Ly9kZXYubXlzcWwuY29tL2dldC9teXNxbCVFNyU4OSU4OCVFNiU5QyVBQyVFNSU4RiVCNy1jb21tdW5pdHktcmVsZWFzZS1lbCVFNSVBNCVBNyVFNyU4OSU4OCVFNiU5QyVBQy0lRTUlQjAlOEYlRTclODklODglRTYlOUMlQUMubm9hcmNoLnJwbQ==\">https://dev.mysql.com/get/mysql 版本号 - community-release-el 大版本 - 小版本.noarch.rpm</span></p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">wget</span> https://dev.mysql.com/get/mysql57-community-release-el5-7.noarch.rpm</pre></td></tr></table></figure><h3 id=\"2-安装数据源\"><a class=\"anchor\" href=\"#2-安装数据源\">#</a> 2、安装数据源</h3>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>yum <span class=\"token function\">install</span> <span class=\"token parameter variable\">-y</span> mysql57-community-release-el5-7.noarch.rpm</pre></td></tr></table></figure><h3 id=\"3-查看mysql源是否安装成功\"><a class=\"anchor\" href=\"#3-查看mysql源是否安装成功\">#</a> 3、查看 mysql 源是否安装成功</h3>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>yum repolist enabled <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> <span class=\"token string\">\"mysql.*-community.*\"</span></pre></td></tr></table></figure><h3 id=\"4-安装数据库\"><a class=\"anchor\" href=\"#4-安装数据库\">#</a> 4、安装数据库</h3>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>yum <span class=\"token function\">install</span> <span class=\"token parameter variable\">-y</span>  mysql-community-server</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># 如果过期可以在运行安装程序之前导入密钥</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">rpm</span> <span class=\"token parameter variable\">--import</span> https://repo.mysql.com/RPM-GPG-KEY-mysql-2022</pre></td></tr></table></figure><h3 id=\"5-启动mysql\"><a class=\"anchor\" href=\"#5-启动mysql\">#</a> 5、启动 mysql</h3>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># centos7</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>systemctl restart mysqld</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>systemctl status mysqld</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\"># centos6</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">service</span> mysqld start</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token function\">service</span> mysqld status</pre></td></tr></table></figure><h3 id=\"6-显示mysql的随机密码\"><a class=\"anchor\" href=\"#6-显示mysql的随机密码\">#</a> 6、显示 mysql 的随机密码</h3>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">grep</span> <span class=\"token string\">'temporary password'</span> /var/log/mysqld.log</pre></td></tr></table></figure><p><img data-src=\"/2022/10/07/DataBase/MySQL/MySQL_Basic/image-20220827193405451.png\" class=\"\"></p>\n<h3 id=\"7-登录并修改mysql密码\"><a class=\"anchor\" href=\"#7-登录并修改mysql密码\">#</a> 7、登录并修改 mysql 密码</h3>\n<p>登录：mysql -u root -p   \t\t然后输入上面生成的密码</p>\n<p><strong><em>修改自定义密码，设置自己想要的密码</em></strong></p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">-- ALTER USER 'root'@'localhost' IDENTIFIED BY ' 密码 ';</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">ALTER</span> <span class=\"token keyword\">USER</span> <span class=\"token string\">'root'</span><span class=\"token variable\">@'localhost'</span> IDENTIFIED <span class=\"token keyword\">BY</span> <span class=\"token string\">'root'</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p><strong><em>失败了的话就修改策略，将策略降低一下就可以了</em></strong></p>\n<p>查看密码策略：</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">SHOW</span> VARIABLES <span class=\"token operator\">LIKE</span> <span class=\"token string\">'%validate_password%'</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>修改密码策略</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">-- 修改密码长度：（长度）</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">set</span> <span class=\"token keyword\">global</span> validate_password<span class=\"token punctuation\">.</span>length<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">set</span> <span class=\"token keyword\">global</span> validate_password_length<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">-- 修改密码等级：（等级）</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">set</span> <span class=\"token keyword\">global</span> validate_password<span class=\"token punctuation\">.</span>policy<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">set</span> <span class=\"token keyword\">global</span> validate_password_policy<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h2 id=\"4-其他配置\"><a class=\"anchor\" href=\"#4-其他配置\">#</a> 4、其他配置</h2>\n<h3 id=\"1开机自启\"><a class=\"anchor\" href=\"#1开机自启\">#</a> 1. 开机自启</h3>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 开机启动</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>systemctl <span class=\"token builtin class-name\">enable</span> mysql</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 关闭自动启动</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>systemctl disable mysqld</pre></td></tr></table></figure><h3 id=\"2远程连接\"><a class=\"anchor\" href=\"#2远程连接\">#</a> 2. 远程连接</h3>\n<h4 id=\"方法一-创建一个用户-支持远程连接\"><a class=\"anchor\" href=\"#方法一-创建一个用户-支持远程连接\">#</a> 方法一、创建一个用户 支持远程连接</h4>\n<p>①登录 ：mysql -u root -p</p>\n<p>②创建用户： create user 'aaa'@'%' identified by '123456';</p>\n<p>③授权所有权限给 user 这个新用户 ：grant all on <em>.</em> to 'aaa'@'%';</p>\n<p>④退出 mysql：quit;</p>\n<h4 id=\"方法二-设置root用户支持远程连接\"><a class=\"anchor\" href=\"#方法二-设置root用户支持远程连接\">#</a> 方法二、设置 root 用户支持远程连接</h4>\n<p>①登录：mysql -u root -p （ 注：系统提示输入数据库 root 用户的密码，输入完成后即进入 mysql 控制台，这个命令的第一个 mysql 是执行命令，第二个 mysql 是系统数据名称，不一样的。）</p>\n<p>②设置权限：</p>\n<p>赋予权限格式： grant 权限 on 数据库对象 to 用户 @IP (或者相应正则)</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">-- 新建用户规则或者直接修改 root 用户的规则 ，2 选一</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">use</span> mysql<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">-- 这里表示赋予该用户所有数据库所有表（*.* 表示所有表），% 表示所有 IP 地址。</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">GRANT</span> <span class=\"token keyword\">ALL</span> <span class=\"token keyword\">PRIVILEGES</span> <span class=\"token keyword\">ON</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">.</span><span class=\"token operator\">*</span> <span class=\"token keyword\">TO</span> <span class=\"token string\">'root'</span><span class=\"token variable\">@'%'</span> IDENTIFIED <span class=\"token keyword\">BY</span> <span class=\"token string\">'123456'</span> <span class=\"token keyword\">WITH</span> <span class=\"token keyword\">GRANT</span> <span class=\"token keyword\">OPTION</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">-- 使 root 能再任何 host 访问</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">update</span> <span class=\"token keyword\">user</span> <span class=\"token keyword\">set</span> host <span class=\"token operator\">=</span> <span class=\"token string\">'%'</span> <span class=\"token keyword\">where</span> <span class=\"token keyword\">user</span> <span class=\"token operator\">=</span> <span class=\"token string\">'root'</span><span class=\"token punctuation\">;</span>      </pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\">-- 刷新</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>FLUSH <span class=\"token keyword\">PRIVILEGES</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>③查看：</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">use</span> mysql<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">SELECT</span> HOST<span class=\"token punctuation\">,</span><span class=\"token keyword\">USER</span> <span class=\"token keyword\">FROM</span> <span class=\"token keyword\">USER</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p><img data-src=\"/2022/10/07/DataBase/MySQL/MySQL_Basic/920952e9041b4af1a8a49eb64e0f4430.jpeg\" class=\"\"></p>\n<p>④退出 mysql：quit;</p>\n<h2 id=\"其他安装方式\"><a class=\"anchor\" href=\"#其他安装方式\">#</a> 其他安装方式</h2>\n<h3 id=\"docker\"><a class=\"anchor\" href=\"#docker\">#</a> docker</h3>\n<h4 id=\"1-查询镜像\"><a class=\"anchor\" href=\"#1-查询镜像\">#</a> 1、查询镜像</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> search mysql</pre></td></tr></table></figure><h4 id=\"2-拉取镜像\"><a class=\"anchor\" href=\"#2-拉取镜像\">#</a> 2、拉取镜像</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> pull mysql:5.7</pre></td></tr></table></figure><h4 id=\"3-构建容器\"><a class=\"anchor\" href=\"#3-构建容器\">#</a> 3、构建容器</h4>\n<p>先自己创建配置文件基础模板（<strong>要是后期要修改配置文件必须加入 模板中的两个元素，不然容器启动会出错</strong>）</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">mkdir</span> <span class=\"token parameter variable\">-p</span> /root/mysql/conf</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">vim</span>  /root/mysql/conf/my.cnf</pre></td></tr></table></figure><p><strong>模板内容：</strong></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token operator\">!</span>includedir /etc/mysql/conf.d/</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token operator\">!</span>includedir /etc/mysql/mysql.conf.d/</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">[</span>mysql<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>default-character-set<span class=\"token operator\">=</span>utf8mb4</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">[</span>mysqld<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token assign-left variable\">character_set_server</span><span class=\"token operator\">=</span>utf8mb4</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token assign-left variable\">init_connect</span><span class=\"token operator\">=</span><span class=\"token string\">'SET NAMES utf8'</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>lower_case_table_names <span class=\"token operator\">=</span> <span class=\"token number\">1</span></pre></td></tr></table></figure><p><strong>构建容器</strong></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> run <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token parameter variable\">-p</span> <span class=\"token number\">3306</span>:3306 <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token parameter variable\">-v</span> /root/mysql/data:/var/lib/mysql <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token parameter variable\">-v</span> /root/mysql/logs:/logs <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token parameter variable\">-v</span> /root/mysql/conf/my.cnf:/etc/mysql/my.cnf <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token parameter variable\">-e</span> <span class=\"token assign-left variable\">MYSQL_ROOT_PASSWORD</span><span class=\"token operator\">=</span>root <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token parameter variable\">--name</span> mysql <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token parameter variable\">--hostname</span> node1 <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token parameter variable\">--restart</span><span class=\"token operator\">=</span>always <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token parameter variable\">-d</span> mysql:5.7</pre></td></tr></table></figure><p><strong>注</strong>：出错时将本地映射文件检查一下，要是不需要配置，只需映射直接删掉就可，以后再改配置文件</p>\n<h4 id=\"4-进入容器\"><a class=\"anchor\" href=\"#4-进入容器\">#</a> 4、进入容器</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> <span class=\"token builtin class-name\">exec</span> <span class=\"token parameter variable\">-it</span> mysql /bin/bash</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>或者</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">docker</span> <span class=\"token builtin class-name\">exec</span> <span class=\"token parameter variable\">-it</span> mysql mysql <span class=\"token parameter variable\">-uroot</span> <span class=\"token parameter variable\">-p</span></pre></td></tr></table></figure><h3 id=\"docker-compose\"><a class=\"anchor\" href=\"#docker-compose\">#</a> docker-compose</h3>\n<blockquote>\n<p>前提安装了 docker-compose</p>\n</blockquote>\n<h4 id=\"配置-docker-comoseyml-文件\"><a class=\"anchor\" href=\"#配置-docker-comoseyml-文件\">#</a> 配置  docker-comose.yml 文件</h4>\n<p>5.7：</p>\n<figure class=\"highlight yml\"><figcaption data-lang=\"YAML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"3.0\"</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token key atrule\">mysql8</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> mysql<span class=\"token punctuation\">:</span>5.7.32</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token key atrule\">container_name</span><span class=\"token punctuation\">:</span> my_db57</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token key atrule\">restart</span><span class=\"token punctuation\">:</span> always</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      <span class=\"token punctuation\">-</span> ./db<span class=\"token punctuation\">:</span>/var/lib/mysql</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      <span class=\"token punctuation\">-</span> ./conf/my.cnf<span class=\"token punctuation\">:</span>/etc/my.cnf</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      <span class=\"token comment\"># 数据库初始化脚本，当 Mysql 容器首次启动时，会在 /docker-entrypoint-initdb.d 目录下扫描 .sh，.sql，.sql.gz 类型的文件。如果这些类型的文件存在，将执行它们来初始化一个数据库；</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token punctuation\">-</span> ./init/<span class=\"token punctuation\">:</span>/docker<span class=\"token punctuation\">-</span>entrypoint<span class=\"token punctuation\">-</span>initdb.d/</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      <span class=\"token punctuation\">-</span> MYSQL_ROOT_PASSWORD=123456</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>      <span class=\"token comment\"># 指定初始化 sql 文件的数据库，简单来书就是新建一个数据库</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>      <span class=\"token punctuation\">-</span> MYSQL_DATABASE=my_db</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>      <span class=\"token punctuation\">-</span> TZ=Asia/Shanghai</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>      <span class=\"token punctuation\">-</span> 3311<span class=\"token punctuation\">:</span><span class=\"token number\">3306</span></pre></td></tr></table></figure><p>8.0</p>\n<figure class=\"highlight yml\"><figcaption data-lang=\"YAML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"3.0\"</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token key atrule\">mysql8</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> mysql<span class=\"token punctuation\">:</span>8.0.25</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token key atrule\">container_name</span><span class=\"token punctuation\">:</span> my_db8</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token key atrule\">restart</span><span class=\"token punctuation\">:</span> always</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      <span class=\"token punctuation\">-</span> ./db<span class=\"token punctuation\">:</span>/var/lib/mysql</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      <span class=\"token punctuation\">-</span> ./conf/my.cnf<span class=\"token punctuation\">:</span>/etc/my.cnf</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      <span class=\"token comment\"># 数据库初始化脚本，当 Mysql 容器首次启动时，会在 /docker-entrypoint-initdb.d 目录下扫描 .sh，.sql，.sql.gz 类型的文件。如果这些类型的文件存在，将执行它们来初始化一个数据库；</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token punctuation\">-</span> ./init/<span class=\"token punctuation\">:</span>/docker<span class=\"token punctuation\">-</span>entrypoint<span class=\"token punctuation\">-</span>initdb.d/</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      <span class=\"token punctuation\">-</span> MYSQL_ROOT_PASSWORD=123456</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>      <span class=\"token comment\"># 指定初始化 sql 文件的数据库，简单来书就是新建一个数据库</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>      <span class=\"token punctuation\">-</span> MYSQL_DATABASE=my_db</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>      <span class=\"token punctuation\">-</span> TZ=Asia/Shanghai</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>      <span class=\"token punctuation\">-</span> 3301<span class=\"token punctuation\">:</span><span class=\"token number\">3306</span></pre></td></tr></table></figure><h4 id=\"配置文件-mycnf\"><a class=\"anchor\" href=\"#配置文件-mycnf\">#</a> 配置文件 my.cnf</h4>\n<p>5.7：</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>mysql<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># 设置 mysql 客户端默认字符集</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>default-character-set<span class=\"token operator\">=</span>utf8mb4</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">[</span>mysqld<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token assign-left variable\">datadir</span><span class=\"token operator\">=</span>/var/lib/mysql</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token assign-left variable\">socket</span><span class=\"token operator\">=</span>/var/lib/mysql/mysql.sock</pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>symbolic-links<span class=\"token operator\">=</span><span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>log-error<span class=\"token operator\">=</span>/var/log/mysqld.log</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>pid-file<span class=\"token operator\">=</span>/var/run/mysqld/mysqld.pid</pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\"># 服务端使用的字符集默认为 8 比特编码的 latin1 字符集</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>character-set-server<span class=\"token operator\">=</span>utf8mb4</pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token comment\"># 创建新表时将使用的默认存储引擎</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>default-storage-engine<span class=\"token operator\">=</span>INNODB</pre></td></tr></table></figure><p>8.0：</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>mysql<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># 设置 mysql 客户端默认字符集</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>default-character-set<span class=\"token operator\">=</span>utf8mb4</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">[</span>mysqld<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># 允许最大连接数</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token assign-left variable\">max_connections</span><span class=\"token operator\">=</span><span class=\"token number\">200</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\"># 服务端使用的字符集默认为 8 比特编码的 latin1 字符集</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>character-set-server<span class=\"token operator\">=</span>utf8mb4</pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\"># 创建新表时将使用的默认存储引擎</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>default-storage-engine<span class=\"token operator\">=</span>INNODB</pre></td></tr></table></figure><h4 id=\"问题\"><a class=\"anchor\" href=\"#问题\">#</a> 问题</h4>\n<p>1、Can't create/write to file '/var/run/mysqld/mysqld.pid</p>\n<p>去配置文件中找到 errorlog 的地址，查看错误日志</p>\n<p><img data-src=\"/2022/10/07/DataBase/MySQL/MySQL_Basic/20190602012200812.png\" class=\"\"></p>\n<p>错误原因为：/var/run/mysqld/ 目录的拥有者为 root，mysql 不能在其中创建文件</p>\n<p>使用如下命令修改目录使用者</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 先查看目录是否存在</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">ls</span> <span class=\"token parameter variable\">-ld</span> /var/run/mysqld/</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 权限</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">chown</span> mysql.mysql /var/run/mysqld/</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># 修改后重启 mysql 服务</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>/etc/init.d/mysqld start</pre></td></tr></table></figure>\n<div id=\"gitalk-container\"></div>\n<script src=\"https://cdn.bootcss.com/blueimp-md5/2.12.0/js/md5.min.js\"></script><link rel=\"stylesheet\" href=\"https://unpkg.com/gitalk/dist/gitalk.css\"><script src=\"https://unpkg.com/gitalk/dist/gitalk.min.js\"></script>\n\n\t\t<script>\n\t\tvar gitalkConfig = {\"clientID\":\"eda74f740080fa01d0b5\",\"clientSecret\":\"c994dd2162a1dadaefbf078fcab49361438a7aca\",\"repo\":\"comments001\",\"owner\":\"onlymarryu\",\"admin\":[\"onlymarryu\"],\"distractionFreeMode\":false};\n\t    gitalkConfig.id = md5(location.pathname);\n\t\tvar gitalk = new Gitalk(gitalkConfig);\n\t    gitalk.render(\"gitalk-container\");\n\t    </script>",
            "tags": []
        }
    ]
}